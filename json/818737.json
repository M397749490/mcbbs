{
    "title": "[已解决][Bukkit]关服时，如何让某个插件优先卸载？",
    "author": "1139365029",
    "replyCount": 1,
    "timestamp": 1535787240,
    "txt_content": " 本帖最后由 1139365029 于 2018-9-1 16:00 编辑 \n\n我想在关服的时候，统一将玩家的金钱数据保存到数据库里面，\n但却得到了一个报错信息：\nError occurred while disabling MoneySql v1.0 (Is it up to date?)\njava.lang.RuntimeException: Essentials API is called before Essentials is loaded.\n        at com.earth2me.essentials.api.Economy.getUserByName(Economy.java:86) ~[?:?]\n        at com.earth2me.essentials.api.Economy.getMoneyExact(Economy.java:106) ~[?:?]\n        at com.earth2me.essentials.api.Economy.getMoney(Economy.java:101) ~[?:?]\n        at net.milkbowl.vault.economy.plugins.Economy_Essentials.getBalance(Economy_Essentials.java:78) ~[?:?]\n        at com.FulingBing.api.MoneySql.MoneysqlSaveAll.save(MoneysqlSaveAll.java:29) ~[?:?]\n        at com.FulingBing.api.Moneysql.onDisable(Moneysql.java:40) ~[?:?]\n        at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:318) ~[JavaPlugin.class:1.7.10-R0.1-SNAPSHOT]\n        at org.bukkit.plugin.java.JavaPluginLoader.disablePlugin(JavaPluginLoader.java:392) [JavaPluginLoader.class:1.7.10-R0.1-SNAPSHOT]\n        at org.bukkit.plugin.SimplePluginManager.disablePlugin(SimplePluginManager.java:429) [SimplePluginManager.class:1.7.10-R0.1-SNAPSHOT]\n        at org.bukkit.plugin.SimplePluginManager.disablePlugins(SimplePluginManager.java:422) [SimplePluginManager.class:1.7.10-R0.1-SNAPSHOT]\n        at org.bukkit.craftbukkit.v1_7_R4.CraftServer.disablePlugins(CraftServer.java:367) [CraftServer.class:1.7.10-R0.1-SNAPSHOT]\n        at net.minecraft.server.MinecraftServer.func_71260_j(MinecraftServer.java:556) [MinecraftServer.class:?]\n        at net.minecraft.server.MinecraftServer.run(MinecraftServer.java:725) [MinecraftServer.class:?]\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_101]\n意思是Essentials插件已经优先卸载掉了，所以无法调用相关的API读取数据，\n我也不明白它为什么会调用Ess插件，不应该是Vault吗？\n我尝试和监听器一样写上优先级：\n@EventHandler(priority = EventPriority.LOWEST)\n        public void onDisable() {\n                MoneysqlSaveAll m=new MoneysqlSaveAll();\n                m.save();\n                getLogger().info(\"插件停用\");\n        }复制代码\n但是没有用，并且插件的卸载顺序和插件的名字貌似也没有关系，\n我也知道在玩家下线时保存、自己写API、读取Ess保存玩家数据的文件等方法都是可行解，\n但都不是最优解，浪费资源，所以不想用，\n所以，具体该如何做？还是说服务端根本就没有提供这个功能？\n\n备注：类型:Bukkit，数据库:Mysql 8.0（这个备注貌似是多余的）",
    "replies": [
        {
            "author": "1139365029",
            "timestamp": 1535788740,
            "txt_content": "Mgazul 发表于 2018-9-1 15:48\nplugin.yml 里面写上前置了？\n额，仔细看了一下好像真没写，我就是怎么别的插件都没问题，就这货不对，\n感谢解答"
        }
    ]
}