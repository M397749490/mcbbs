{
    "title": "1.8+ 关于给一个玩家显示title",
    "author": "ShiChunAn",
    "replyCount": 4,
    "timestamp": 1463840940,
    "txt_content": " 本帖最后由 ShiChunAn 于 2016-5-21 22:35 编辑 \n\nRT：\n假如有一个关于玩家的变量name,那么：\nname.sendMessage(…)可以向该玩家发送消息。\nname.setGameMode(…)可以设置该玩家的游戏模式。\n……\nHELP：\n1.如果要给玩家发送subtitle和title，name.应该加什么（如果有的话）\n2.我有一个TitleAPI\nTitleAPI.sendTitle(player,fadeIn,stay,fadeOut,\"Title\",\"Subtitle\");复制代码\n里面的player项是可以直接用name 还是要进行什么样的修改操作？\n求JAVA大神相助！！！\n\n\n（顺便：求一个JAVA编译器吧，我只有JAVA反编译器{:10_527:}）",
    "replies": [
        {
            "author": "GTA守护使者",
            "timestamp": 1465839360,
            "txt_content": "我也想知道!琢磨了几天了！最后结果游戏里面出现错误！而不是控制台！"
        },
        {
            "author": "TimmyOVO",
            "timestamp": 1465861080,
            "txt_content": "。。。你就不能看看文档么\nTitleAPI.sendTitle(Bukkit.getPlayer(\"玩家名字\"),淡出时间,停留在屏幕的时间,淡出时间,\"要发送的title\",\"要发送的子title\");\n看变量类型呀!!"
        },
        {
            "author": "GTA守护使者",
            "timestamp": 1465893240,
            "txt_content": " 本帖最后由 GTA守护使者 于 2016-6-14 16:41 编辑 \n\n已经找到解决方法！下面是完整代码以及注释！\n\n\n\n\n\n\nimport java.lang.reflect.Constructor;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.ChatColor;\nimport org.bukkit.entity.Player;\n\npublic class Title {\n\n        public void mains(){  //执行这里就可以看到效果！这是主方法\n                System.out.println(Bukkit.getOnlinePlayers());\n                Player player = Bukkit.getPlayer(\"name\") ; //玩家名字(name)\n                Integer fadeIn = 5; //淡出时间\n                Integer stay = 2; //停留在屏幕的时间\n                Integer fadeOut = 10 ; //淡出时间\n                String title = \"服务器将在30秒后重启！\"; //要发送的title\n                String subtitle = \"我要休息哦！~_~ 稍后回来！感谢大家对DYzjm的支持！\"; //要发送的子title\n                //new Title().Server_broadcast(\"服务器将在30秒后重启！\");//广播信息  服务器稍后开启！正在重启！让服务器更加流畅吧！感谢大家对DYzjm的支持！\n                Server_broadcast(player,fadeIn,stay,fadeOut,title,subtitle);//title广播信息\n        }\n\n\n\n        public void Server_broadcast(Player player, Integer fadeIn, Integer stay, Integer fadeOut, String title, String subtitle){\n                /*\n                 * Bukkit.broadcastMessage(ChatColor.DARK_RED + broadcast); 发送全服广播信息\n                 * Bukkit.getPlayer(\"name\")  玩家String name\n                 * Ftime 淡出时间\n                 * TimeS 停留在屏幕的时间\n                 * FsTime 淡出时间\n                 * title 要发送的title\n                 * subtitle 要发送的子title\n                 *\n                 * Player player, Integer fadeIn, Integer stay, Integer fadeOut, String title, String subtitle\n                 */\n                sendTitle(player,fadeIn,stay,fadeOut,title,subtitle);\n        }\n\n        @SuppressWarnings(\"rawtypes\")\n        public static void sendTitle(Player player, Integer fadeIn, Integer stay, Integer fadeOut, String title, String subtitle){\n                try {\n                        if (title != null) { //要发送的title\n                        title = ChatColor.translateAlternateColorCodes('&', title); //支持&b颜色代码\n                        title = title.replaceAll(\"%player%\", player.getDisplayName());\n                        Object enumTitle = getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0].getField(\"TITLE\").get(null);\n                        Object chatTitle = getNMSClass(\"IChatBaseComponent\").getDeclaredClasses()[0].getMethod(\"a\", new Class[] { String.class }).invoke(null, new Object[] { \"{\\\"text\\\":\\\"\" + title + \"\\\"}\" });\n                        Constructor titleConstructor = getNMSClass(\"PacketPlayOutTitle\").getConstructor(new Class[] { getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0], getNMSClass(\"IChatBaseComponent\"), Integer.TYPE, Integer.TYPE, Integer.TYPE });\n                        Object titlePacket = titleConstructor.newInstance(new Object[] { enumTitle, chatTitle, fadeIn, stay, fadeOut });\n                        sendPacket(player, titlePacket);\n                        }\n\n                        if (subtitle != null) { //要发送的子title\n                        subtitle = ChatColor.translateAlternateColorCodes('&', subtitle); //支持&b颜色代码\n                        subtitle = subtitle.replaceAll(\"%player%\", player.getDisplayName());\n                        Object enumSubtitle = getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0].getField(\"SUBTITLE\").get(null);\n                        Object chatSubtitle = getNMSClass(\"IChatBaseComponent\").getDeclaredClasses()[0].getMethod(\"a\", new Class[] { String.class }).invoke(null, new Object[] { \"{\\\"text\\\":\\\"\" + subtitle + \"\\\"}\" });\n                        Constructor subtitleConstructor = getNMSClass(\"PacketPlayOutTitle\").getConstructor(new Class[] { getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0], getNMSClass(\"IChatBaseComponent\"), Integer.TYPE, Integer.TYPE, Integer.TYPE });\n                        Object subtitlePacket = subtitleConstructor.newInstance(new Object[] { enumSubtitle, chatSubtitle, fadeIn, stay, fadeOut });\n                        sendPacket(player, subtitlePacket);\n                        }\n                } catch (Exception e) {\n                        e.printStackTrace();\n                }\n        }\n        public static Class<?> getNMSClass(String name) {\n                String version = org.bukkit.Bukkit.getServer().getClass().getPackage().getName().split(\"\\\\.\")[3];\n                try {\n                        return Class.forName(\"net.minecraft.server.\" + version + \".\" + name);\n                } catch (ClassNotFoundException e) {\n                        e.printStackTrace();\n                }return null;\n        }\n        public static void sendPacket(Player player, Object packet) {\n                try {\n                        Object handle = player.getClass().getMethod(\"getHandle\", new Class[0]).invoke(player, new Object[0]);\n                        Object playerConnection = handle.getClass().getField(\"playerConnection\").get(handle);\n                        playerConnection.getClass().getMethod(\"sendPacket\", new Class[] { getNMSClass(\"Packet\") }).invoke(playerConnection, new Object[] { packet });\n                } catch (Exception e) {\n                        e.printStackTrace();\n                }\n        }\n}\n\n\n\n\n\n\n\n\n\n\n\n坑爹！不能上传图片！不然有图片了！ 修改多次，为什么发帖内容不完整！MCBBS坑爹啊！\n\n"
        },
        {
            "author": "ShiChunAn",
            "timestamp": 1466089080,
            "txt_content": "GTA守护使者 发表于 2016-6-14 16:34\n已经找到解决方法！下面是完整代码以及注释！\n非常感谢！"
        }
    ]
}