{
    "title": "[聊天][信息][其他]RandomCommands——轻量地让指令和对话的所有参数随机化！[全版本]",
    "author": "南外丶仓鼠",
    "replyCount": 21,
    "timestamp": 1566800760,
    "txt_content": " 本帖最后由 南外丶仓鼠 于 2021-2-19 21:45 编辑 \n\nRandomCommads-随机化指令插件简介\n\n你是不是不满意某些插件的随机机制？\n比如……RPG插件的随机几率？\n你是不是苦恼于原版@r无法在服务器使用？\n你是不是渴望一下子执行很多重复并且随机参数的指令？\nRandomCommands就是你的菜！\n\n 插件使用指南\n本插件目前有三个变量\n但可以创造无限可能！\n1-随机玩家\n\n变量：#ranPlayer使用范围：指令或者对话使用者：玩家&控制台皆可使用方法：在指令中插入“#ranPlayer”，执行时自动替换成随机玩家\n2-随机数字\n\n变量：%[x,y]%\n使用范围：指令或者对话使用者：玩家&控制台皆可使用方法：在指令中插入“#%[x,y]%”，执行时自动替换成x-y之间的随机整数\n3-重复次数变量：.times:N使用范围：指令使用者：玩家使用方法：在指令中插入“.times:N”，自动会执行N次备注：在指令中插入\"%time%\"，会自动替换成第几次 插件使用技巧\n1-随机次数\n什么不试试看.times:%[x,y]%  呢？\n2-多次判定\n为什么不在信息中多次输入%[x,y]%呢？\n3-实例发红包：(假设以essentials为经济插件).times:%[1,10]%/echo give #ranPlayer %[100,100]%(假设以iconomy为经济插件).times:%[1,10]%/money give #ranPlayer %[100,100]%解读: 重复次数为1-10随机次数重复指令为/echo give #ranPlayer %[100,200]%指令会给随机玩家发100-200的随机游戏币任务随机奖励：/xp give {player} %[10,100]%  给玩家10-100点经验 这里{player}是完成任务的玩家RPG物品随机属性：以RPGitem为例：/rpgitem 物品 damage %[10,100]%  给物品随机伤害（但是每次伤害是固定值（即生成的随机数））以QuantamRPG为例：/qrpg set stat 类型 %[最低数值,最高数值]% 设置物品随机属性建议：如果你的服务器存储空间足够，或者RPG插件是以lore判定为基础，我建议玩家获取一个rpg物品就创建一个RPG给他，然后对这个RPG随机化属性。例如：/rpgitem 神剑 create/rpgitem 神剑 type ``/rpgitem 神剑 hand ``/rpgitem 神剑 display 神剑/rpgitem 神剑 damage %[1,5]% %[5,10]%/rpgitem 神剑 durability %[1000,2000]%等等插件下载\n版本：1.00    \n\n\n\nRandomCommands.jar\n(12.99 KB, 下载次数: 97, 售价: 5 粒金粒)\n\n\n\n2019-8-26 14:24 上传\n点击文件名下载附件\n插件v1.00\n售价: 5 粒金粒\t [记录]\n\n [购买]\n\n\n\n\n\n\n开源：\nimport org.bukkit.Bukkit;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.EventPriority;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.AsyncPlayerChatEvent;\nimport org.bukkit.event.player.PlayerCommandPreprocessEvent;\nimport org.bukkit.event.server.ServerCommandEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class RandomCommands extends JavaPlugin implements Listener{\n        @Override public void onEnable() {\n                getServer().getPluginManager().registerEvents(this, this);\n        }\n        @EventHandler(priority=EventPriority.LOWEST) public void onConsole(ServerCommandEvent event) {\n                String message=event.getCommand();\n                event.setCommand(commandAdapt(message));\n        }\n        @EventHandler(priority=EventPriority.LOWEST) public void onCommand(PlayerCommandPreprocessEvent event) {\n                String message=event.getMessage();\n                event.setMessage(commandAdapt(message));\n        }\n        private static String commandAdapt(String chatMessage) {\n                if(chatMessage.contains(\"#ranPlayer\")) {\n                        Player player=(Player) Bukkit.getOnlinePlayers().toArray()[(int) (Math.random()*Bukkit.getOnlinePlayers().toArray().length)];\n                        chatMessage=chatMessage.replace(\"#ranPlayer\", player.getName());\n                }\n                if(chatMessage.contains(\"%[\")&&chatMessage.contains(\"]%\")) {\n                        int markA=-1,markB=-1;\n                        String stra=\"\",strb=\"\";\n                        for(int i=0;i<chatMessage.length();i++){\n                                if(chatMessage.charAt(i)!='%') continue;\n                                i++; if(i==chatMessage.length()) continue;\n                                if(chatMessage.charAt(i)=='[') \n                                        markA=i-1;\n                                else {i--; continue;}\n                                for(int j=markA;j<chatMessage.length();j++)\n                                        if(chatMessage.charAt(j)!=']') markB=j;\n                                if(markA!=-1 &&markB!=-1) {\n                                        int markf=-1;\n                                        for(int j=markA;j<=markB;j++)\n                                                if(chatMessage.charAt(j)==',') {markf=j;break;}\n                                                else if(chatMessage.charAt(j)>=48 && chatMessage.charAt(j)<=57)\n                                                        stra+=chatMessage.charAt(j);\n                                        int tmp=-1;\n                                        for(int j=markf+1;j<=markB;j++) {\n                                                if(chatMessage.charAt(j)>=48 && chatMessage.charAt(j)<=57) {\n                                                        strb+=chatMessage.charAt(j);\n                                                        tmp=j;\n                                                        continue;\n                                                }\n                                                break;\n                                        }\n                                        markB=tmp+2;\n                                        chatMessage=getRandom(chatMessage,Integer.valueOf(stra),Integer.valueOf(strb),markA,markB);\n                                        markA=-1;markB=-1;\n                                }\n                                stra=\"\";strb=\"\";\n                        }\n                }\n                return chatMessage;\n        }\n        @EventHandler(priority=EventPriority.LOWEST) public void onChat(AsyncPlayerChatEvent event) {\n                String chatMessage=event.getMessage();\n                if(chatMessage.contains(\"#ranPlayer\")) {\n                        Player player=(Player) Bukkit.getOnlinePlayers().toArray()[(int) (Math.random()*Bukkit.getOnlinePlayers().toArray().length)];\n                        chatMessage=chatMessage.replace(\"#ranPlayer\", player.getName());\n                        event.setMessage(chatMessage);\n                }\n                if(chatMessage.contains(\"%[\")&&chatMessage.contains(\"]%\")) {\n                        int markA=-1,markB=-1;\n                        String stra=\"\",strb=\"\";\n                        for(int i=0;i<chatMessage.length();i++){\n                                if(chatMessage.charAt(i)!='%') continue;\n                                i++; if(i==chatMessage.length()) continue;\n                                if(chatMessage.charAt(i)=='[') \n                                        markA=i-1;\n                                else {i--; continue;}\n                                for(int j=markA;j<chatMessage.length();j++)\n                                        if(chatMessage.charAt(j)!=']') markB=j;\n                                if(markA!=-1 &&markB!=-1) {\n                                        int markf=-1;\n                                        for(int j=markA;j<=markB;j++)\n                                                if(chatMessage.charAt(j)==',') {markf=j;break;}\n                                                else if(chatMessage.charAt(j)>=48 && chatMessage.charAt(j)<=57)\n                                                        stra+=chatMessage.charAt(j);\n                                        int tmp=-1;\n                                        for(int j=markf+1;j<=markB;j++) {\n                                                if(chatMessage.charAt(j)>=48 && chatMessage.charAt(j)<=57) {\n                                                        strb+=chatMessage.charAt(j);\n                                                        tmp=j;\n                                                        continue;\n                                                }\n                                                break;\n                                        }\n                                        markB=tmp+2;\n                                        chatMessage=getRandom(chatMessage,Integer.valueOf(stra),Integer.valueOf(strb),markA,markB);\n                                        markA=-1;markB=-1;\n                                }\n                                stra=\"\";strb=\"\";\n                        }\n                        event.setMessage(chatMessage);\n                }\n                if(chatMessage.startsWith(\".times:\")) {\n                        String num=\"\";\n                        String trueMessage=\"\";\n                        chatMessage=chatMessage.replace(\".times:\",\"\");\n                        boolean isCommand=false,end=false;\n                        for(int i=0;i<chatMessage.length();i++) {\n                                if(end) {trueMessage+=chatMessage.charAt(i); continue;}\n                                if(chatMessage.charAt(i)=='/'){isCommand=true; end=true;continue;}\n                                if(chatMessage.charAt(i)>=48 && chatMessage.charAt(i)<=57) \n                                        num+=chatMessage.charAt(i);\n                                else end=true;\n                        }\n                        System.out.println(num+\"   \"+trueMessage);\n                        int times=Integer.valueOf(num);\n                        if(isCommand) {\n                                event.setCancelled(true);\n                                for(int i=0;i<times;i++) {\n                                        String cmd=trueMessage.replace(\"%time%\",String.valueOf(i+1));\n                                        event.getPlayer().performCommand(cmd);\n                                }\n                                        \n                        }\n                }\n        }\n        private static String getRandom(String chatMessage, int a, int b, int markA, int markB) {\n                int ran=(int) (Math.random()*(b+1-a)+a);\n                String newMessage=\"\";\n                for(int i=0;i<markA;i++) \n                        newMessage+=chatMessage.charAt(i);\n                newMessage+=String.valueOf(ran);\n                for(int i=markB+1;i<chatMessage.length();i++) \n                        newMessage+=chatMessage.charAt(i);\n                return newMessage;\n        }\n}复制代码\n给点人气好不好 \n",
    "replies": [
        {
            "author": "南外丶仓鼠",
            "timestamp": 1566800820,
            "txt_content": "bug提交楼"
        },
        {
            "author": "Azitate",
            "timestamp": 1566802500,
            "txt_content": "造轮子插件，挺不错的\n希望可以加随机指令组"
        },
        {
            "author": "南外丶仓鼠",
            "timestamp": 1566803340,
            "txt_content": "Azitate 发表于 2019-8-26 14:55\n造轮子插件，挺不错的\n希望可以加随机指令组\n目前的计划是\n腐竹们可以在配置文件自定义集合\n然后随机取集合里面的元素"
        },
        {
            "author": "Iron-HIM",
            "timestamp": 1566873480,
            "txt_content": "源码简洁明了，适合新手腐竹的随机数发生器！\n但是..这个功能貌似用skript就可以实现吧。"
        },
        {
            "author": "云云大魔王",
            "timestamp": 1567853340,
            "txt_content": "nb的插件呀，我服务器正好需要awa！"
        },
        {
            "author": "z446066151",
            "timestamp": 1569605580,
            "txt_content": "请问大佬  变量适用在MM装备配置上吗？"
        },
        {
            "author": "1522952496",
            "timestamp": 1570240260,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "南外丶仓鼠",
            "timestamp": 1570250040,
            "txt_content": "1522952496 发表于 2019-10-5 09:51\n要是能在指定期间自动使用设置好的指令就好了\n已经有同类插件\n定时指令"
        },
        {
            "author": "1522952496",
            "timestamp": 1570252020,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "2539695017",
            "timestamp": 1570279560,
            "txt_content": "66666666666"
        },
        {
            "author": "小六子鸭.",
            "timestamp": 1573282500,
            "txt_content": "讲真我没看懂那个.times: 怎么用..."
        },
        {
            "author": "lin84149719",
            "timestamp": 1576759560,
            "txt_content": "后台好像没法识别%[x,y]%这个变量= =也可能是其他插件不能识别"
        },
        {
            "author": "FireworkPolymer",
            "timestamp": 1588259280,
            "txt_content": "建议添加权限节点，因为指令一下用一堆可不是什么好事。。"
        },
        {
            "author": "Daleynf",
            "timestamp": 1588262820,
            "txt_content": "插件很好用，感谢楼主分享"
        },
        {
            "author": "FireworkPolymer",
            "timestamp": 1588342380,
            "txt_content": "南外丶仓鼠 发表于 2019-8-26 14:27\nbug提交楼\n是eco不是echo\n(假设以essentials为经济插件).times:%[1,10]%/echo give #ranPlayer %[100,100]%"
        },
        {
            "author": "242121899",
            "timestamp": 1588344540,
            "txt_content": "emmm还是有点没整明白这插件是干啥的"
        },
        {
            "author": "し不懂丶装懂つ",
            "timestamp": 1590732780,
            "txt_content": "mcbbs有你更精彩"
        },
        {
            "author": "FireworkPolymer",
            "timestamp": 1590847440,
            "txt_content": "图没了，补一下"
        },
        {
            "author": "sbsg5s55",
            "timestamp": 1592442300,
            "txt_content": "插件执行指令的话这个随机的变量就没用了..."
        },
        {
            "author": "wschenxu",
            "timestamp": 1599811620,
            "txt_content": "非常优秀的作品"
        },
        {
            "author": "飞虎卫",
            "timestamp": 1608640200,
            "txt_content": "图片炸了      "
        }
    ]
}