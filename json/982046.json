{
    "title": "关于服务器维度ID应该怎么查询",
    "author": "lucien寓言",
    "replyCount": 8,
    "timestamp": 1583832480,
    "txt_content": "我的服务器使用了暮色mod /多世界管理插件\n\n现在需要知道维度ID，请问服务器应该如何查询？",
    "replies": [
        {
            "author": "xmdhs",
            "timestamp": 1583832480,
            "txt_content": "https://www.mcbbs.net/thread-631329-1-1.html\n\n看这"
        },
        {
            "author": "结城希亚",
            "timestamp": 1583832540,
            "txt_content": "默认名称为DIM7\n关于id的话参考这个\n多世界世界ID怎么查询？\nhttps://www.mcbbs.net/thread-631329-1-1.html\n(出处: Minecraft(我的世界)中文论坛)"
        },
        {
            "author": "小天铄",
            "timestamp": 1583832660,
            "txt_content": "https://www.mcbbs.net/thread-631329-1-1.html\n这个帖子写的很详细，可以看这个帖子"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1583833020,
            "txt_content": " 本帖最后由 GiNYAi 于 2020-3-10 17:55 编辑 \n\n正好 我刚刚写了一个插件\n命令是getworlddir 可以tab补全\n\npackage dev.ginyai.getworlddir;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.World;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.entity.Player;\nimport org.bukkit.plugin.java.JavaPlugin;\n\nimport java.lang.invoke.MethodHandle;\nimport java.lang.invoke.MethodHandles;\nimport java.lang.invoke.MethodType;\nimport java.lang.reflect.Method;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Locale;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\n\npublic class GetWorldDir extends JavaPlugin {\n\n    @Override\n    public void onEnable() {\n        super.onEnable();\n    }\n\n    private String getUsage(String label, CommandSender sender) {\n        if (sender instanceof Player) {\n            return label + \" [player|world]\";\n        } else {\n            return label + \" <player|world>\";\n        }\n    }\n\n    @Override\n    public boolean onCommand(CommandSender sender, Command command, String label, String[] args) {\n        World world;\n        if (args.length == 0 && sender instanceof Player) {\n            world = ((Player) sender).getWorld();\n        } else if (args.length == 1) {\n            if (Bukkit.getWorld(args[0]) != null) {\n                world = Bukkit.getWorld(args[0]);\n            } else {\n                Player player = Bukkit.getPlayer(args[0]);\n                if (player != null) {\n                    world = player.getWorld();\n                } else {\n                    sender.sendMessage(getUsage(label, sender));\n                    return true;\n                }\n            }\n        } else {\n            sender.sendMessage(getUsage(label, sender));\n            return true;\n        }\n        try {\n            sender.sendMessage(\"DimensionId: \" + getDimensionId(world));\n        } catch (Throwable t) {\n            sender.sendMessage(\"Failed to get dimensionId\");\n            t.printStackTrace();\n        }\n        sender.sendMessage(world.getWorldFolder().toString());\n        return true;\n    }\n\n    private MethodHandle getOnlinePlayerStream;\n\n    @Override\n    public List<String> onTabComplete(CommandSender sender, Command command, String alias, String[] args) {\n        if (getOnlinePlayerStream == null) {\n            MethodHandles.Lookup lookup = MethodHandles.lookup();\n            try {\n                MethodHandle getOnlinePlayers = lookup.findStatic(Bukkit.class, \"getOnlinePlayers\", MethodType.methodType(Collection.class));\n                MethodHandle stream = lookup.findVirtual(Collection.class, \"stream\", MethodType.methodType(Stream.class));\n                getOnlinePlayerStream = MethodHandles.collectArguments(stream, 0, getOnlinePlayers);\n            } catch (NoSuchMethodException e) {\n                try {\n                    MethodHandle getOnlinePlayerArray = lookup.findStatic(Bukkit.class, \"getOnlinePlayers\", MethodType.methodType(Player[].class));\n                    MethodHandle stream = lookup.findStatic(Arrays.class, \"stream\", MethodType.methodType(Stream.class, Object[].class));\n                    getOnlinePlayerStream = MethodHandles.collectArguments(stream, 0, getOnlinePlayerArray);\n                } catch (NoSuchMethodException | IllegalAccessException ex) {\n                    ex.printStackTrace();\n                    return Collections.emptyList();\n                }\n            } catch (IllegalAccessException e) {\n                e.printStackTrace();\n                return Collections.emptyList();\n            }\n        }\n        if (args.length == 1) {\n            try {\n                Stream<Player> playerStream = (Stream<Player>) getOnlinePlayerStream.invoke();\n                Stream<World> worldStream = Bukkit.getWorlds().stream();\n                String prefix = args[0].toLowerCase(Locale.ROOT);\n                return Stream.concat(playerStream.map(Player::getName), worldStream.map(World::getName))\n                    .filter(s -> s.toLowerCase(Locale.ROOT).startsWith(prefix))\n                    .collect(Collectors.toList());\n            } catch (Throwable t) {\n                t.printStackTrace();\n            }\n        }\n        return Collections.emptyList();\n    }\n\n    private MethodHandle getDimensionId;\n\n    public int getDimensionId(World world) throws Throwable {\n        if (getDimensionId == null) {\n            MethodHandles.Lookup lookup = MethodHandles.lookup();\n            Method getHandle = world.getClass().getMethod(\"getHandle\");\n            MethodHandle getDimId = lookup.findGetter(getHandle.getReturnType(), \"dimension\", int.class);\n\n            getDimensionId = MethodHandles.collectArguments(\n                getDimId, 0, lookup.unreflect(getHandle)\n            ).asType(MethodType.methodType(int.class, World.class));\n        }\n        return (int) getDimensionId.invokeExact(world);\n    }\n}\n\n\n\n\nGetWorldDir-1.0.jar\n(4.53 KB, 下载次数: 8)\n\n\n\n2020-3-10 17:37 上传\n点击文件名下载附件\n\n\n\n\n\n"
        },
        {
            "author": "落花雨喵",
            "timestamp": 1583833140,
            "txt_content": "/forge tps"
        },
        {
            "author": "1846042683",
            "timestamp": 1596362580,
            "txt_content": "GiNYAi 发表于 2020-3-10 17:37\n正好 我刚刚写了一个插件\n命令是getworlddir 可以tab补全\n有图可以看吗？\n这不清楚啊"
        },
        {
            "author": "1846042683",
            "timestamp": 1596425520,
            "txt_content": "1846042683 发表于 2020-8-2 18:03\n有图可以看吗？\n这不清楚啊\n有没有效果图"
        },
        {
            "author": "1846042683",
            "timestamp": 1596437100,
            "txt_content": "GiNYAi 发表于 2020-3-10 17:37\n正好 我刚刚写了一个插件\n命令是getworlddir 可以tab补全\n没有效果图么大佬"
        }
    ]
}