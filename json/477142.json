{
    "title": "论坛昨天开始大规模出现500错误页面！",
    "author": "778563781",
    "replyCount": 1,
    "timestamp": 1438127880,
    "txt_content": " 本帖最后由 778563781 于 2015-7-29 08:04 编辑 \n\n如图所示，，\n\n\n\n\nQQ截图20150729075642.png (99.51 KB, 下载次数: 2)\n\n下载附件\n\n2015-7-29 07:56 上传\n\n\n\n\n\n我也是刷新了好久，写了好多遍才发了这个帖子，这次不知道能不能出去\n\n\n刚才百度了一下\n主要是由于IWAM账号（在我的计算机即是IWAM_MYSERVER账号）的密码错误造成了HTTP 500内部错误。\n以下是解决方案\n\n简介知道了导致HTTP 500内部错误的原因，解决起来就比较简单了，那就是人工同步IWAM账号在Active Directory、IIS metabase数据库和COM+应用程序中的密码。具体操作分三步,均需要以管理员身份登录计算机以提供足够的操作权限（IWAM账号以IWAM_MYSERVER为例）。\n\n设置（一）更改Active Directory中IWAM_MYSERVER账号的密码因IWAM账号的密码由系统控制，随机产生，我们并不知道是什么，为完成下面两步的密码同步工作，我们必须将IWAM账号的密码设置为一个我们知道的值。1、选择“开始”->“程序”->“管理工具”->\"Active Directory用户和计算机\"，启动“Active Directory用户和计算机”管理单元。2、单击“user”，选中右面的“IWAM_MYSERVER”，右击选择“重设密码(T)...”，在跳出的重设密码对方框中给IWAM_MYSERVER设置新的密码，这儿我们设置成“A boutnt2001”（没有引号的），确定，等待密码修改成功。\n\n同步（二）同步IIS metabase中IWAM_MYSERVER账号的密码可能因为这项改动太敏感和重要，微软并没有为我们修改IIS metabase中IWAM_MYSERVER账号密码提供一个显式的用户接口，只随IIS5提供了一个管理脚本adsutil.vbs，这个脚本位于 C:\\inetpub\\adm inscripts子目录下（位置可能会因你安装IIS5时设置的不同而有所变动）。adsutil.vbs脚本功能强大，参数非常多且用法复杂，这里只提供使用这个脚本修改IWAM_MYSERVER账号密码的方法:adsutil SET w3svc/WAMUserPass Password\"Password\"参数就是要设置的IWAM账号的新的密码。因此我们将IIS metabase中IWAM_MYSERVER账号的密码修改为“Aboutnt2001”的命令就是：c:\\Inetpub\\AdminScripts>adsutil SET w3svc/WAMUserPass \"Aboutnt2001\"修改成功后，系统会有如下提示：WAMUserPass: (String) \"Aboutnt2001\"\n\n选择（三）同步COM+应用程序所用的IWAM_MYSERVER的密码同步COM+应用程序所用的IWAM_MYSERVER的密码，我们有两种方式可以选择:一种是使用组件服务MMC管理单元，另一种是使用IWAM账号同步脚本s ynciwam.vbs。1、使用组件服务MMC管理单元（1）启动组件服务管理单元：选择“开始”->“运行”->“MMC”，启动管理控制台,打开“添加/删除管理单元”对话框,将“组件服务”管理单元添加上。（2）找到“组件服务”->“计算机”->“我的电脑”->“COM+应用程序”->“Out-Of-Process Pooled Applications”，右击“Out-Of-Process Pooled Applications”->“属性”。（3）切换到“Out-Of-Process Pooled Applications”属性对话框的“标志”选项卡。“此应用程序在下列账户下运行”选择中“此用户”会被选中，用户名是“IWAM_MYSERVE R”。这些都是缺省的，不必改动。在下面的“密码”和“确认密码”文本框内输入正确的密码“Aboutnt2001”，确定退出。（4）系统如果提示“应用程序被一个以上的外部产品创建。你确定要被这些产品支持吗？”时确定即可。（5）如果我们在IIS中将其它一些Web的“应用程序保护”设置为“高（独立的）”,那么这个WEB所使用的COM+应用程序的IWAM账号密码也需要同步。重复（1 ）-（4）步，同步其它相应Out of process application的IWAM账号密码。2、使用IWAM账号同步脚本synciwam.vbs实际上微软已经发现IWAM账号在密码同步方面存在问题，因此在IIS5的管理脚本中单独为IWAM账号密码同步编写了一个脚本synciwam.vbs ，这个脚本位于C:\\inetpub\\adminscripts子目录下（位置可能会因你安装IIS5时设置的不同而有所变动）。synciwam.vbs脚本用法比较简单：cscript synciwam.vbs [-v|-h]“-v”参数表示详细显示脚本执行的整个过程(建议使用)，“-h”参数用于显示简单的帮助信息。我们要同步IWAM_MYSERVER账号在COM+应用程序中的密码，只需要执行“cscript synciwam.vbs -v”即可，如下：cscript c:\\inetpub\\adminscripts\\synciwam.vbs -vMicrosoft (R) Windows Script Host Version 5.6版权所有(C) Microsoft Corporation 1996-2000。保留所有权利。WamUserName:IWAM_MYSERVERWamUserPass:Aboutnt2001IIS Applications Defined:Name, AppIsolated, Package IDw3svc, 0, {3D14228C-FBE1-11d0-995D-00C04FD919C1}Root, 2,IISHelp, 2,IISAdmin, 2,IISSamples, 2,MSADC, 2,ROOT, 2,IISAdmin, 2,IISHelp, 2,Root, 2,Root, 2,Out of process applications defined:Count: 1{3D14228D-FBE1-11d0-995D-00C04FD919C1}Updating Applications:Name: IIS Out-Of-Process Pooled Applications Key: {3D14228D-FBE1-11D0-995D-00C04FD919C1}从上面脚本的执行情况可以看出，使用synciwam.vbs脚本要比使用组件服务的方法更全面和快捷。它首先从IIS的metabase数据库找到IWA M账号\"IWAM_MYSERVER\"并取出对应的密码“Aboutnt2001”，然后查找所有已定义的IIS Applications和Out of process applications，并逐一同步每一个Out of process applications应用程序的IWAM账号密码。使用synciwam.vbs脚本时，要注意一个问题，那就是在你运行 synciwam.vbs之前，必须保证IIS metabase数据库与Active Directory中的IWAM密码已经一致。因为synciwam.vbs脚本是从IIS metabase数据库而不是从Active Directory取得IWAM账号的密码，如果IIS metabase中的密码不正确，那synciwam.vbs取得的密码也会不正确，同步操作执行到“Updating Applications”系统就会报80110414错误，即“找不到应用程序{3D14228D-FBE1-11D0-995D- 00C04FD919C1}”。以信息来源于搜狗百科并非本人所写！！还请各位版主们尽快解决=-=  无限刷新中  哈哈这次复制了=-=\n\n",
    "replies": [
        {
            "author": "Max亡魂烈火",
            "timestamp": 1438151760,
            "txt_content": "论坛这两天好像只是卡吧，我的平板刷新几下就好了，没有出现500"
        }
    ]
}