{
    "title": "求助如何判定玩家是否击杀一个指定怪物",
    "author": "2032154564321",
    "replyCount": 10,
    "timestamp": 1550905560,
    "txt_content": "我想写一个关于RPG的一个小型类似于活动插件就是 建立一个局部变量 然后注册监听器EntityDeathEvent 监听玩家每杀死一个指定怪物 建立的那个局部变量+1\n疑问来了 局部变量应该建在那？ 怎么去判定玩家杀死了一个指定怪物 从而达到 变量+1",
    "replies": [
        {
            "author": "fitexmage",
            "timestamp": 1550907480,
            "txt_content": " 本帖最后由 fitexmage 于 2019-2-23 15:40 编辑 \npublic static int count = 0;\n    \n@EventHandler\npublic void onEntityDeath(EntityDeathEvent event){\n        if(event.getEntity().getType().equals(EntityType.COW)){\n            count++;\n        }\n}复制代码请问你是想要这个效果吗？"
        },
        {
            "author": "hoshizorayuki",
            "timestamp": 1550914260,
            "txt_content": "\n    private void onEntityDeath(EntityDeathEvent e) {\n        if (e.getEntity().getKiller() != null) {\n            playerKillEntity(e.getEntity().getKiller(), e.getEntityType());\n        }\n    }\n\n    void playerKillEntity(Player player, EntityType entityType) {\n        // TODO: \n    }复制代码"
        },
        {
            "author": "2032154564321",
            "timestamp": 1550914620,
            "txt_content": "hoshizorayuki 发表于 2019-2-23 17:31\n楼上那个容易 看懂了 你这个身为小白的我是真心看不懂 我没看到你建立的变量"
        },
        {
            "author": "2032154564321",
            "timestamp": 1550914800,
            "txt_content": "fitexmage 发表于 2019-2-23 15:38\n请问你是想要这个效果吗？\n您这个的话 是只要是牛死了 都计算在这个变量 Count上吧 必须是玩家击杀才行\n然后我问一下 这个是全服玩家共享的吗？要那种单个玩家的\n就比如 这个玩家杀了 12只牛\n另外一个玩家 杀了 20只牛 貌似涉及到储存 然后这里我思路就没了"
        },
        {
            "author": "OMG666",
            "timestamp": 1550915820,
            "txt_content": "2032154564321 发表于 2019-2-23 17:40\n您这个的话 是只要是牛死了 都计算在这个变量 Count上吧 必须是玩家击杀才行\n然后我问一下 这个是全服玩 ...\n可以用数组"
        },
        {
            "author": "Gyzer",
            "timestamp": 1550916600,
            "txt_content": " 本帖最后由 Gyzer 于 2019-2-23 18:11 编辑 \n2032154564321 发表于 2019-2-23 17:40\n您这个的话 是只要是牛死了 都计算在这个变量 Count上吧 必须是玩家击杀才行\n然后我问一下 这个是全服玩 ...\n\n\n我来我来~~\n\n-------------关于储存方法\n\n先注册一个玩家进入监听器，然后创建玩家存档\npublic void onJ(PlayerJoinEvent e)\n{\n#检测该玩家是否有存档，如果没有则创建一个\nFile file = new File(\"./plugins/插件名\", e.getPlayer().getName()+\".yml\");\n    YamlConfiguration yml = YamlConfiguration.loadConfiguration(file);\nif (!file.exists())\n    {\n#因为你举的例子说是牛这里就先用牛吧~\n      yml.set(\"牛\", 0); \n#保存设置，如果没有以下的代码将不会生成一个玩家存档文件    \n  try\n      {\n        yml.save(file);\n      }\n      catch (IOException e1)\n      {\n        e1.printStackTrace();\n      }\n    } \n}\n\n\n然后写一个读取玩家存档方法：\npublic static YamlConfiguration getData(Player p)\n  {\n    File file = new File(\"./plugins/插件名\", p.getName() + \".yml\");\n    YamlConfiguration yml = YamlConfiguration.loadConfiguration(file);\n    return yml;\n  }\n\n写一个修改存档方法\n public static void setData(Player p, int amount)\n  {\n    File file = new File(\"./plugins/插件名\", p.getName() + \".yml\");\n    YamlConfiguration yml = YamlConfiguration.loadConfiguration(file);\n    l \n    yml.set(\"牛\", amount));\n    \n\n     \n    try\n    {\n      yml.save(file);\n    }\n    catch (IOException e)\n    {\n      e.printStackTrace();\n    }\n  }\n  \n\n\n然后注册一个击杀监听器\n\n判断当一个玩家击杀一个“牛”时候写: setData(p,getData(p).getInt(\"牛\")+1);\n\n——————\n这里的代码是针对有特殊名字的生物，比如用MythicMob插件做出来的有颜色名字的生物\n @EventHandler\n  public void onEntd(EntityDeathEvent e)\n  {\n    #先判断是否是指定的世界\n    if (e.getEntity().getWorld().getName().equals(\"world\")) {\n      #判断击杀的是不是玩家\n      if ((e.getEntity().getKiller() instanceof Player)) {\n        #判断该生物是否有自定义名子\n        if (e.getEntity().isCustomNameVisible()) {\n          #判断该生物的名字\n           if (e.getEntity().getCustomName().equals(\"§4愤怒的牛\"))\n          {\n           Player p = e.getEntity().getKiller();\n          #先获取一下玩家已经击杀该生物的次数\n          int a=getData(p).getInt(\"牛\"); \n          #因为玩家击杀了指定的怪物，所以要在玩家的存档里加1             \n           setData(p,a+1);\n          #完成！！\n          #最后要是需要的话可以发一发消息~ \n          p.sendMessage(\"你击杀了1头§4愤怒的牛 ， 你已经累计击杀了 \"+getData(p)。getInt(\"牛\")+\"只\");\n          }\n        }\n       }\n     }\n}\n\n当要获取玩家击杀多少个“牛”时候写到: p.sendMessage(\"你击杀了 \"+getData(p).getInt(\"牛\")+ \"头牛\");"
        },
        {
            "author": "fitexmage",
            "timestamp": 1550995920,
            "txt_content": "2032154564321 发表于 2019-2-23 17:40\n您这个的话 是只要是牛死了 都计算在这个变量 Count上吧 必须是玩家击杀才行\n然后我问一下 这个是全服玩 ...public static int count = 0;\n\n@EventHandler\npublic void onEntityDeath(EntityDeathEvent event) {\n        if (event.getEntity().getType().equals(EntityType.COW)) {\n            if (event.getEntity().getKiller().getDisplayName().equals(\"abc\")) {\n                count++;\n            }\n        }\n}复制代码\n上面这个就可以实现如果名字是“abc”的话，count就会加一，然后你可以在count++底下再写一个if，如果count == 10 这样"
        },
        {
            "author": "fitexmage",
            "timestamp": 1550996160,
            "txt_content": " 本帖最后由 fitexmage 于 2019-2-24 16:18 编辑 \n2032154564321 发表于 2019-2-23 17:40\n您这个的话 是只要是牛死了 都计算在这个变量 Count上吧 必须是玩家击杀才行\n然后我问一下 这个是全服玩 ...\n如果你是想分开储存每一个玩家的信息的话，可以用HashMap。这个可以将名字和杀的数量都储存起来，我这里是储存名字，UUID什么的也可以。那个getOrDefault的意思是如果map里已经有了这个数据，就再加一个，如果没有，就设置成一个。\nHashMap<String, Integer> map = new HashMap<>();\n\n@EventHandler\npublic void onEntityDeath(EntityDeathEvent event) {\n        if (event.getEntity().getType().equals(EntityType.COW)) {\n            String name = event.getEntity().getKiller().getDisplayName();\n            map.put(name, map.getOrDefault(name, 0) + 1);\n        }\n}复制代码"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1551091080,
            "txt_content": "变量在哪里随你喜欢, 但是我看了上面的代码, 提醒楼主一句: 注意线程安全"
        },
        {
            "author": "2032154564321",
            "timestamp": 1551450420,
            "txt_content": "emmmm问题解决了 谢谢各位大佬"
        }
    ]
}