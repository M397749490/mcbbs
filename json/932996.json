{
    "title": "有关开放嵌入 H5 页面标签使用权的提议",
    "author": "langyo",
    "replyCount": 7,
    "timestamp": 1576384620,
    "txt_content": " 本帖最后由 langyo 于 2019-12-19 17:54 编辑 \nH5 出来那么久，Flash 又已快死透，居然还没人提起此事，那我便提一下吧。\n\n众所周知，基于 Discuz! 的论坛可以通过 Flash 动画的 UUB 标签加入多媒体动画，借此提升帖子的可读性与互动性。许多老坛友以前还为此专门自行制作了一批小动画，或是将国外诸如 Flash 动画版合成表这样的实用工具转载过来，大大丰富了帖子的内容。同时，各版帖子的 BGM（背景音乐）也依赖于此（例如网易云音乐的外链 Flash 动画播放器）。\n\n但现在，不同了。我举三个事例：\n\nGoogle 很早就发布了声明，Chrome 浏览器将在 2020 年 1 月彻底弃用 PPAPI 版本的 Flash 插件。这意味着 Chrome 在未来的版本将无法正常使用论坛内原有的一切 Flash 动画。也许大家会对此不以为然，认为如果用国产 360 腾讯百度QQ 2345 UC 小米浏览器，它们不禁用 Flash，我们何必担心呢？在此我想提醒，除了 QQ 浏览器与 UC 浏览器的内核分别是自行研发的 X5 内核与 UC 内核，其它的凡是标有双核的浏览器均在使用 Chrome 的 Chromium 内核。这也意味着，如果这些浏览器厂家想让自己的浏览器跟上时代、可以浏览以最新标准构建的 H5 网页，就不得不步入 Chrome 的后尘，弃用 Flash。苹果公司的 Safari 浏览器很早便停止了对 Flash 动画的支持，原因可归结为 Flash 动画运行时的不安全、不稳定与高耗损。苹果的设备一贯要求尽可能长的续航时间，所以它们不仅在电池等硬件设备上一再创新，对于运行的程序也有近乎苛刻的耗电量限制（至于怎么苛刻，做过苹果开发的人都懂）。另外，苹果设备对安全性的要求也特别严格，不仅所有应用对外的链接都必须使用 HTTPS 加密链接 + 拉白名单，用户对设备的一切敏感操作也都必须要进行验证。由此观之，已故的乔布斯当年炮轰 Flash 也不无道理。Flash 的开发商 Adobe 近日偷偷地对原有的 Flash 插件做了手脚，也像 Minecraft 被网易分成了国际版与中国版一样，Flash 插件现在也有了国际版与中国版之分。不过，这种分割要比网易那边恶心的多——如果你使用中国版，你将会无止尽地隔几分钟就看到来自 Adobe 亲切的弹窗广告。如果你将用于弹窗的“Flash Helper Service”程序卸载，Flash 插件将无法正常运行。如果你使用国际版并且处于中国境内（然而我不知道它是如何判断你是否需要用中国版的），它还会强行停止对 Flash 动画的运行，提示你地区不符，要求你使用中国版的 Flash 插件。更令人厌恶的是，“Flash Helper Service”程序还会无条件收集用户的个人隐私信息（例如上网记录），明目张胆地写进安装时的用户协议中，不同意便无法使用。（详见关于Flash Player必要组件缺失影响Flash运行的公告、如何看待Adobe Flash Player锁区？）\n\n由此观之，现在的 Flash 动画真的已经在走下坡路了，过个几年应该就成为历史的过客了。\n\n那么，H5 怎么样呢？\n\nH5 全称 HTML5，是新一代 HTML 标准的名称。现在，不论是谷歌、微软、苹果这些国际大厂，还是百度、腾讯、 B 站和网易这些国内大厂，都在加紧对 H5 的转型与深入研发，使得我们现在看到的各个站点门户没有了以前的眼花缭乱，并且也由于浏览器市场的活跃与进步，使得页面性能优异、运行流畅。\n\n嵌入 H5 的 <iframe> 标签，本质上是在做与 Flash 动画标签一样的事情，但 H5 明显要比原有的 Flash 动画强的多：\n\n优异的安全性。Flash 动画允许跨域以及 socket 链接，不过在 H5 这里，这些安全隐患特别大的接口被统统禁止了。Flash 动画对外发送的数据是不作加密的（除非制作者自行使用额外的加密库，在其上补充），但对于 H5 来讲，只要连接的是有效的 HTTPS 页面，H5 对外发送的数据都会是经过加密的。广泛的适用性。H5 不仅兼容一切 Flash 兼容的平台、浏览器（也就 IE 6 - 9 不能使用，但 IE 6 - 9 整体的市场份额只有可怜的 0.15%），并且也同样兼容绝大部分 Flash 所不支持的平台。另外，Flash 一般需要 Unity 插件才可以使用 3D 动画，但在 H5 这里直接有自带的 WebGL 可用，性能与耗电量情况也远比插件好得多。市场方面拥有丰富的支持。不论是 B 站、优酷、爱奇艺、Youtube 的视频播放器，还是网易云音乐的外链音乐播放器，都拥有可供用户以 iframe 引用形式嵌入页面的接口。较低的开发难度与成本。Flash 动画的制作还需要专用的来自 Adobe 的商业付费软件，但 H5 哪怕只用系统自带的笔记本都能进行开发。论坛自身技术力量的转型。现今，越来越多的以技术研发方向为主的坛友们都开始接触并深入学习有关 H5 的知识，并且现已有一批 H 5 应用开始面向广大玩家了。例如 @土球球 的 MD 转 UUB 工具、@SPGoding 的 SPU 等等。如果能够开放，并能提供些许的论坛 API，将能极大地激励论坛技术圈对论坛基础设施与游戏相关作品的研发热情，进而提升论坛对用户的粘性。\n\n现在，我正式提议：\n\n加入用于嵌入 H5 内嵌页面的 UUB 标签（iframe）。对使用此标签的用户作出一些限制：\n仅允许引用协议为 HTTPS 的地址仅允许 3 级以上用户使用该标签，目的是减少滥用\n完善各板块对此的管理运行机制：\nFlash 播放器的使用守则后面，补充 H5 播放器的使用守则在全坛范围内禁止用户以 H5 投放商业广告（服务器版宣传服务器、交易版宣传店铺除外）、违反法律法规及论坛总坛规的内容\n如有可能，论坛可以为内嵌 H5 模块提供 API：\n论坛提供的 API 仅用于告知访问目的网站，访问者是否已登录论坛、使用的账号 UID内嵌页面 UUB 渲染为 HTML 时，会首先判断该 UUB 是否额外提供了需要 API 的参数，然后视编辑者的等级决定是否提供 API（个人建议最低开放等级为 7 级）如果经过上述检查后可以提供 API，渲染时将自动在原有要渲染的网址的基础上加入页面参数 uid 和 token（即形式为 https://xx.xx/x?uid=xxx&token=xxx 的网址）页面提供者可自行验证该 uid 及 token 的有效性，具体办法是向论坛的某个插件页面发送 POST 请求，论坛服务器返回一个 JSON 表示验证结果论坛数据库可以但无需储存由此产生的随机 token 到数据库，并且保留有效时间也建议仅为 1 分钟为防止形成攻击或其它可能的不良行为，该 API 应当每分钟仅响应同一 IP 15 次，每小时仅响应同一 IP 200 次；拒绝请求时可以直接发拒绝服务 403宅魂群里的坛友们提到了社工钓鱼的问题，例如载入的 iframe 可能会伪造登陆界面诱骗用户输入账号密码，这其实是有解决方案的：在用户第一次载入某域名的 iframe 之前（通过 cookies 或 localstorage 记录），先询问是否载入，并且也可以选择是否允许提供给该网站访问者的论坛 UID（就像 Wechat 的身份权限请求提示一样），直到用户允许之前，不会真的载入对应的 iframe；iframe 旁边会有一个小提示栏，说明这是一个内嵌页面如果上一条仍然不放心，还可以增加备案机制——开一个帖子统一接受申请，通过备案的链接能够直接载入（或是在点击加载的窗口中提示这是经过审核的网址，可以放心载入），不需要用户手动点击加载\n在添加 Flash 动画的 UUB 菜单中加入提示，不再建议使用 Flash 动画标签，建议使用 H5 标签。\n\n以上。欢迎各坛友深入探讨。\n\n",
    "replies": [
        {
            "author": "悠然学院",
            "timestamp": 1576385820,
            "txt_content": "每小时200次，你开什么玩笑，那还怎么刷新，蹲问答？？？"
        },
        {
            "author": "45gfg9",
            "timestamp": 1576385880,
            "txt_content": "Safari用户表示强烈支持\n\nH5很强 除了小学信息技术教材 Flash还有什么存在的必要么（\n\n以及弹窗广告是真的恶心\n虽然我Mac没有遇到过 但我有很多次打开磁盘管理就看见挂了两个未装载的Flash卷\n看来也是想对我耍流氓了\n\n\n\n但是可能实现起来很复杂很漫长 咱也不知道 咱也不敢问 dz插件我又不会又没了解过\n\n但是如果能实现，肯定是一大飞跃\n\n<--站着说话不腰疼"
        },
        {
            "author": "晓夜Port",
            "timestamp": 1576386540,
            "txt_content": "支持。\n中国版 Flash 太恶心了。"
        },
        {
            "author": "6B不止铅笔",
            "timestamp": 1576387140,
            "txt_content": "Flash 的开发商 Adobe 近日偷偷地对原有的 Flash 插件做了手脚\n隔几分钟就看到来自 Adobe 亲切的弹窗广告早在2018年adobe公司就把flash卖给了重.庆重橙网络科技有限公司（下简称重橙网络）。弹广告，收集用户隐私信息等是重橙网络干出来的事。一开始重橙网络的中国特供版flash在用户协议中写道不仅收集用户隐私信息，还要“合理”使用"
        },
        {
            "author": "langyo",
            "timestamp": 1576388820,
            "txt_content": "梦萍_云皓 发表于 2019-12-15 12:57\n每小时200次，你开什么玩笑，那还怎么刷新，蹲问答？？？\n设置每小时 200 次的原因很简单，根据目前 MCBBS 的人流量，你每个帖子每小时最多也只有两百个不同的人查看(而且如此高的查看量一般都是过年时发锭才有\n\n当然了，刷新的人肯定是有的，可难道您就不能自个在服务器上留个缓存么…验证过的 token 在同一 ip 访问的情况下是可以信任最少一小时的"
        },
        {
            "author": "SHEEP_REALMS",
            "timestamp": 1576409700,
            "txt_content": " 本帖最后由 SHEEP_REALMS 于 2019-12-15 19:37 编辑 \n\niframe标签的话在DZ中完全可以做到，不过要对其内容和参数加以约束的话略有难度，但不是大问题。主要是做好防滥用工作。不过如果内容约束做得并不完美的话，建议将用户使用权限提升到7级。"
        },
        {
            "author": "simon3000",
            "timestamp": 1576478640,
            "txt_content": "iframe挺好的，个人感觉api可能有些多余？"
        }
    ]
}