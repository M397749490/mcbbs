{
    "title": "[Sponge]求助：如何格式化Text类？",
    "author": "Tollainmear",
    "replyCount": 6,
    "timestamp": 1504018440,
    "txt_content": " 本帖最后由 Tollainmear 于 2017-8-29 23:04 编辑 \n\n描述：最近学习在Sponge服务端上写一个修改Sign的插件，但是在分析参数的时候，不知道如何利用传进来的参数来格式化文本。\n例如：传入参数\"&a测试&b&l一下\"，我利用String.split[\"&\"]将args.toString收入一个list，然后for（String str：ArryList），在通过识别String.charAt(0);获取这个颜色标记，然后用方法将整个字符串格式化为有TextFormat（TextColors&TextStyles）的Text，但是在最后（使用Text.join）连起来的时候，不能通过前面的&a给紧随其后的&l粗体字染色。\n\n问题所在：应该如何分析玩家传入参数并且根据参数内的\"&\"关键字修改颜色和字体？\n\n因为我嘴笨，描述不好，所以贴上自己的垃圾代码。。。。\n\n第一次写插件，请轻喷（@ustc_zzzz   @1012033254 ）\npublic Text buildString(String text){\n        String colorToken = \"0123456789abcdefnmlkor\";\n        Text.Builder newText = null;\n        if(text.contains(\"&\")){\n            String[] textArray = text.split(\"&\");\n            int Count = 0;\n            for(String str:textArray){\n                if(str.length()==0) continue;\n                if(Count==0){\n                    if(text.charAt(0) == '&'){\n                        newText = formatter(str).toBuilder();\n                        Count++;\n                        continue;\n                    }\n                    else {\n                        newText = Text.of(str).toBuilder();\n                        Count++;\n                        continue;\n                    }\n                }\n                formatter(str).applyTo(newText);\n                Count++;\n            }\n            return newText.build();\n        }\n        else return Text.of(text);\n    }\n\n    public Text formatter(String str){\n        Text CTtext;\n        switch (str.substring(0,1)){\n            case \"1\":\n                CTtext = Text.of(TextColors.DARK_BLUE,str.substring(1));\n                break;\n            case \"2\":\n                CTtext = Text.of(TextColors.DARK_GREEN,str.substring(1));\n                break;\n            case \"3\":\n                CTtext = Text.of(TextColors.DARK_AQUA,str.substring(1));\n                break;\n            case \"4\":\n                CTtext = Text.of(TextColors.DARK_RED,str.substring(1));\n                break;\n            case \"5\":\n                CTtext = Text.of(TextColors.DARK_PURPLE,str.substring(1));\n                break;\n            case \"6\":\n                CTtext = Text.of(TextColors.GOLD,str.substring(1));\n                break;\n            case \"7\":\n                CTtext = Text.of(TextColors.GRAY,str.substring(1));\n                break;\n            case \"8\":\n                CTtext = Text.of(TextColors.DARK_GRAY,str.substring(1));\n                break;\n            case \"9\":\n                CTtext = Text.of(TextColors.BLUE,str.substring(1));\n                break;\n            case \"0\":\n                CTtext = Text.of(TextColors.BLACK,str.substring(1));\n                break;\n            case \"r\":\n                CTtext = Text.of(TextColors.RESET,TextStyles.RESET,str.substring(1));\n                break;\n            case \"a\":\n                CTtext = Text.of(TextColors.GREEN,str.substring(1));\n                break;\n            case \"b\":\n                CTtext = Text.of(TextColors.AQUA,str.substring(1));\n                break;\n            case \"c\":\n                CTtext = Text.of(TextColors.RED,str.substring(1));\n                break;\n            case \"d\":\n                CTtext = Text.of(TextColors.LIGHT_PURPLE,str.substring(1));\n                break;\n            case \"e\":\n                CTtext = Text.of(TextColors.YELLOW,str.substring(1));\n                break;\n            case \"f\":\n                CTtext = Text.of(TextColors.WHITE,str.substring(1));\n                break;\n            case \"l\":\n                CTtext = Text.of(TextStyles.BOLD,str.substring(1));\n                break;\n            case \"k\":\n                CTtext = Text.of(TextStyles.OBFUSCATED,str.substring(1));\n                break;\n            case \"m\":\n                CTtext = Text.of(TextStyles.STRIKETHROUGH,str.substring(1));\n                break;\n            case \"n\":\n                CTtext = Text.of(TextStyles.UNDERLINE,str.substring(1));\n                break;\n            case \"o\":\n                CTtext = Text.of(TextStyles.ITALIC,str.substring(1));\n                break;\n            default:\n                CTtext = Text.of(str);\n        }\n        return CTtext;\n    }复制代码\n",
    "replies": [
        {
            "author": "土球球",
            "timestamp": 1504053060,
            "txt_content": "https://docs.spongepowered.org/s ... mpersand-formatting"
        },
        {
            "author": "Tollainmear",
            "timestamp": 1504065240,
            "txt_content": "ustc_zzzz 发表于 2017-8-30 08:31\nhttps://docs.spongepowered.org/stable/zh-CN/plugin/text/representations/formatting-code-legacy.html# ...\n谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢谢"
        },
        {
            "author": "Tollainmear",
            "timestamp": 1504067400,
            "txt_content": "ustc_zzzz 发表于 2017-8-30 08:31\nhttps://docs.spongepowered.org/stable/zh-CN/plugin/text/representations/formatting-code-legacy.html# ...\n已经解决~！！谢谢！"
        },
        {
            "author": "1012033254",
            "timestamp": 1504242540,
            "txt_content": " 本帖最后由 1012033254 于 2017-9-1 13:11 编辑 \n\n.....其实我觉得用文字识别会好一点，代码很多人记不到public static Optional<TextColor> GetColor(String name) {\n        for (Field f : TextColors.class.getDeclaredFields()) {\n            boolean b = f.isAccessible();\n            f.setAccessible(true);\n            if (f.getName().equalsIgnoreCase(name)) {\n                try {\n                    TextColor c = (TextColor) f.get(null);\n                    f.setAccessible(b);\n                    return Optional.of(c);\n                } catch (IllegalArgumentException | IllegalAccessException e) {\n                    return Optional.empty();\n                }\n            }\n        }\n        return Optional.empty();\n    }\n\n    public static Optional<TextStyle> GetStyle(String name) {\n        for (Field f : TextStyles.class.getDeclaredFields()) {\n            boolean b = f.isAccessible();\n            f.setAccessible(true);\n            if (f.getName().equalsIgnoreCase(name)) {\n                try {\n                    TextStyle c = (TextStyle) f.get(null);\n                    f.setAccessible(b);\n                    return Optional.of(c);\n                } catch (IllegalArgumentException | IllegalAccessException e) {\n                    return Optional.empty();\n                }\n            }\n        }\n        return Optional.empty();\n    }复制代码\n"
        },
        {
            "author": "1012033254",
            "timestamp": 1504242780,
            "txt_content": "而且我用的Text的格式化方式你可以看看我BlockAction的帖子...也可以去看一看代码"
        },
        {
            "author": "Tollainmear",
            "timestamp": 1504281720,
            "txt_content": "1012033254 发表于 2017-9-1 13:09\n.....其实我觉得用文字识别会好一点，代码很多人记不到\n这个看起来好复杂，我要理解一会儿。。。。。\n\n不过谢谢！"
        }
    ]
}