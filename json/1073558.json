{
    "title": "手把手教你搭建自己的 blessing-skin 皮肤站并使用高大上的 authlib-injector 外置...",
    "author": "10935336",
    "replyCount": 6,
    "timestamp": 1594041720,
    "txt_content": " 本帖最后由 10935336 于 2020-7-8 16:20 编辑 \n\n想搭建自己的 blessing-skin 皮肤站并使用高大上的 authlib-injector 外置登录吗？本文以 blessing-skin-server4.4 与 authlib-injector 配合 Centos7 + nginx 进行演示。\n因为发稿前 blessing-skin-server5.0 仍未发布正式版\n所需材料：一台有公网的服务器，需要支持 nginx 或者 apache ,支持 PHP7.2 以上一个会学习的大脑\n1.服务器购买\n如果你已经有服务器了，请跳过此步骤\n你的服务器需要有公网，并且能支持 nginx 或者 apache ,支持 PHP7.2 以上如果你的年龄小于24岁，可以到 阿里云 腾讯云 华为云 购买到一台每个月10元左右的学生服务器，配置通常在1C2G阿里云：https://promotion.aliyun.com/ntms/act/campus2018.html\n腾讯云：https://cloud.tencent.com/act/campus\n华为云：https://developer.huaweicloud.com/campus?productType=KC1_1&timeType=1®ionType=1&domainItemData=请注意，如果你的服务器在中国大陆且要使用域名，那么是需要进行备案的。我这里使用一台 阿里云的轻量应用服务器，安装 Centos7 系统进行演示，因为上面的学生机一般都提供 Centos7购买完成后记好你的 IP 地址和密码\n\n2.使用SSH连接到服务器\n这里你需要一款 SSH 工具，用于连接到服务器\n我这里用的是 finalshell，这款工具可以很方便的管理服务器上的文件\n下载地址：https://www.hostbuf.com/t/988.html打开以后如下图\n\n\n\n\n\njr52UdP358jhlZeH-image-1594020686667.png (10.9 KB, 下载次数: 1)\n\n下载附件\n\n2020-7-6 21:12 上传\n\n\n\n\n\n\n主机那里填入你从服务商那里拿到的 IP，如果服务商没有说明的话，端口就是22\n认证方式，如果给你的是密码的话就填密码，是秘钥就填私钥\n用户名：国内的一般都直接给你 root ，本教程都默认使用 root 账户进行\n密码：按照服务商给的填\n\n\n\n\njInxCA93Kal4nVlr-image-1594020320404.png (38.07 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:13 上传\n\n\n\n\n\n\n\n3.安装环境\n链接到服务器后，先输入下面的命令\n\n\n\n\nimage.png (3.79 KB, 下载次数: 1)\n\n下载附件\n\n2020-7-6 21:13 上传\n\n\n\n\n\nyum install screen复制代码#安装 screen，因为 ali 的系统没有预装screen -S lnmp复制代码#创建一个叫 lnmp 的窗口，防止 ssh 意外断开等wget http://soft.vpser.net/lnmp/lnmp1.7.tar.gz -cO lnmp1.7.tar.gz && tar zxf lnmp1.7.tar.gz && cd lnmp1.7 && ./install.sh lnmp复制代码#运行 lnmp 一键脚本，这会直接帮你装完大部分环境You have 11 options for your DataBase install.\n1: Install MySQL 5.1.73                                                                                              |\n2: Install MySQL 5.5.62 (Default)                                                                                    |\n3: Install MySQL 5.6.48                                                                                              |\n4: Install MySQL 5.7.30                                                                                              |\n5: Install MySQL 8.0.20                                                                                              |\n6: Install MariaDB 5.5.68                                                                                            |\n7: Install MariaDB 10.1.45                                                                                           |\n8: Install MariaDB 10.2.32                                                                                           |\n9: Install MariaDB 10.3.23                                                                                           |\n10: Install MariaDB 10.4.13                                                                                          |\n0: DO NOT Install MySQL/MariaDB                                                                                      |\nEnter your choice (1, 2, 3, 4, 5, 6, 7, 8, 9, 10 or 0): 5                                                            |\nYou will install MySQL 8.0.20                                                                                        |\n===========================                                                                                          |\nPlease setup root password of MySQL.\nPlease enter: mysql\nMySQL root password: mysql\n===========================\nDo you want to enable or disable the InnoDB Storage Engine?\nDefault enable,Enter your choice [Y/n]: y\nNo input,The InnoDB Storage Engine will enable.\n===========================\nYou have 9 options for your PHP install.\n1: Install PHP 5.2.17\n2: Install PHP 5.3.29\n3: Install PHP 5.4.45\n4: Install PHP 5.5.38\n5: Install PHP 5.6.40 (Default)\n6: Install PHP 7.0.33\n7: Install PHP 7.1.33\n8: Install PHP 7.2.31\n9: Install PHP 7.3.19\n10: Install PHP 7.4.7\nEnter your choice (1, 2, 3, 4, 5, 6, 7, 8, 9, 10): 9\nYou will install PHP 7.3.19\n===========================\nYou have 3 options for your Memory Allocator install.\n1: Don't install Memory Allocator. (Default)\n2: Install Jemalloc\n3: Install TCMalloc\nEnter your choice (1, 2 or 3): 2复制代码#mysql 版本可以自选，安装MySQL 5.6或5.7及MariaDB 10必须1G以上内存，更高版本至少要2G以上内存。\n#php选择7.3，blessskin4.0 不支持 php 7.4，但至少需要php 7.2。安装PHP 7及以上版本必须1G以上内存。#记好你得mysql密码\n#其他选项跟着我选就好了选完以后就可以去玩游戏了，因为一般的机器配置较差，需要编译很长时间很长时间，比如一小时什么的。============================== Check install ==============================\nChecking ...\nNginx: OK\nError: MySQL install failed.\nPHP: OK\nPHP-FPM: OK\nSorry, Failed to install LNMP!\nPlease visit https://bbs.vpser.net/forum-25-1.html feedback errors and logs.\nYou can download /root/lnmp-install.log from your server,and upload lnmp-install.log to LNMP Forum.复制代码\n#这里我选了 mysql 8 但是因为配置不足或是某些原因，安装失败了\n\n\n\n./install.sh复制代码#重新运行安装脚本\n这一次我们选 mysql 5.7\n经过漫长的等待Install lnmp takes 69 minutes.\nInstall lnmp V1.7 completed! enjoy it.复制代码\n\n如果果你看到这个，那么说明 lnmp 我们已经安装完成了，脚本应该会自动退出，如果没有的话 请按 Ctrl+C\n\n\n4.安装blessing skin\n首先我们到 https://github.com/bs-community/blessing-skin-server/releases 下载你想要的版本\n\n\n\n\nimage.png (8.83 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:14 上传\n\n\n\n\n\n这里我们下载 blessing-skin-server-4.4.0.zip接着mkdir /home/wwwroot/blessskin\ncd /home/wwwroot/blessskin复制代码\n\n\n\n\nL435LxwDD8616mWX-image-1594026508472.png (49.13 KB, 下载次数: 1)\n\n下载附件\n\n2020-7-6 21:16 上传\n\n\n\n\n\n确保你的路径是这样的，然后把你下载好的 blessing-skin-server-4.4.0.zip 拖进空白的地方，等待上传完毕\n\n上传完毕之后<blockquote>unzip blessing-skin-server-4.4.0.zip复制代码\n\n\n\n\nimage.png (54.83 KB, 下载次数: 3)\n\n下载附件\n\n2020-7-6 21:17 上传\n\n\n\n\n\n 然后右键空白的地方新建文件 名字叫 .user.ini  新建后双击打开\n\n\n\n\nimage.png (37.65 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:26 上传\n\n\n\n\n\n在里面写open_basedir=/home/wwwroot/blessskin/:/tmp/:/proc/复制代码然后点击文件按钮 点击保存cd /usr/local/nginx/conf复制代码\n\n\n\n\nimage.png (56.8 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:18 上传\n\n\n\n\n\n在下面的文件里面找到 fastcgi.conf 双击打开在最后两行前面加上#也就是这样：\nfastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;\nfastcgi_param  QUERY_STRING       $query_string;\nfastcgi_param  REQUEST_METHOD     $request_method;\nfastcgi_param  CONTENT_TYPE       $content_type;\nfastcgi_param  CONTENT_LENGTH     $content_length;\n\nfastcgi_param  SCRIPT_NAME        $fastcgi_script_name;\nfastcgi_param  REQUEST_URI        $request_uri;\nfastcgi_param  DOCUMENT_URI       $document_uri;\nfastcgi_param  DOCUMENT_ROOT      $document_root;\nfastcgi_param  SERVER_PROTOCOL    $server_protocol;\nfastcgi_param  REQUEST_SCHEME     $scheme;\nfastcgi_param  HTTPS              $https if_not_empty;\n\nfastcgi_param  GATEWAY_INTERFACE  CGI/1.1;\nfastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;\n\nfastcgi_param  REMOTE_ADDR        $remote_addr;\nfastcgi_param  REMOTE_PORT        $remote_port;\nfastcgi_param  SERVER_ADDR        $server_addr;\nfastcgi_param  SERVER_PORT        $server_port;\nfastcgi_param  SERVER_NAME        $server_name;\n\n# PHP only, required if PHP was built with --enable-force-cgi-redirect\nfastcgi_param  REDIRECT_STATUS    200;\n#fastcgi_param PHP_ADMIN_VALUE \"open_basedir=$document_root/:/tmp/:/proc/\";\n#fastcgi_param PHP_ADMIN_VALUE \"open_basedir=$document_root/:/tmp/:/proc/\";复制代码保存后 双击 nginx.conf 打开，把原来的内容全部删掉，改成下面的user  www www;\n\nworker_processes auto;\nworker_cpu_affinity auto;\n\nerror_log  /home/wwwlogs/nginx_error.log  crit;\n\npid        /usr/local/nginx/logs/nginx.pid;\n\n#Specifies the value for maximum file descriptors that can be opened by this process.\nworker_rlimit_nofile 51200;\n\nevents\n    {\n        use epoll;\n        worker_connections 51200;\n        multi_accept on;\n        accept_mutex on;\n    }\n\nhttp\n    {\n        include       mime.types;\n        sendfile on;\n        tcp_nopush on;\n        keepalive_timeout 60;\n        tcp_nodelay on;\n        gzip on;\n        #limit_conn_zone $binary_remote_addr zone=perip:10m;\n        ##If enable limit_conn_zone,add \"limit_conn perip 10;\" to server section.\n\n        server_tokens off;\n        access_log off;\n\nserver\n    {\n        #listen 443 ssl http2;\n        listen 80;\n        server_name localhost 你的域名;\n        index index.html index.htm index.php default.html default.htm default.php;\n        root  /home/wwwroot/blessskin/public;\n        \n        #ssl_protocols TLSv1.2 TLSv1.3;\n        #ssl_ciphers TLS-CHACHA20-POLY1305-SHA256:TLS-AES-256-GCM-SHA384:TLS-AES-128-GCM-SHA256:HIGH:!aNULL:!MD5;\n        \n        #ssl_certificate 你的证书路径;\n        #ssl_certificate_key 你的证书秘钥路径;\n        #ssl_dhparam ;\n\n        #add_header Strict-Transport-Security \"max-age=63072000; includeSubdomains; preload\" always;\n        #开启HSTS，并设置有效期为“63072000秒”（2年），包括子域名(根据情况可删掉)，预加载到浏览器缓存(根据情况可删掉)\n\n        add_header X-Frame-Options SAMEORIGIN;\n        add_header X-Content-Type-Options nosniff;\n        #ssl_prefer_server_ciphers on;\n        #ssl_session_cache builtin:1000 shared:SSL:10m;\n        #ssl_session_tickets on;\n        #ssl_session_timeout 10m; \n\n        add_header Referrer-Policy no-referrer always;\n\n\n        include rewrite/other.conf;\n\n\nlocation / {\n    try_files $uri $uri/ /index.php?$query_string;\n}\n\nlocation ~ /\\. { deny all; }\n        \n\n        include enable-php-pathinfo.conf;\n\n        location ~ .*\\.(gif|jpg|jpeg|bmp|swf|ico)$\n        {\n            expires      30d;\n        }\n\n        location ~ .*\\.(js|css)?$\n        {\n            expires      12h;\n        }\n\n        location ~ /.well-known {\n            allow all;\n        }\n\n        location ~ /\\.\n        {\n            deny all;\n        }\n   }\n\n}复制代码把 你的域名 换成你的域名，或者直接删掉使用IP访问有关于 https 加密访问的部分我都注释掉了，要使用的时候把#删掉，填入对应的东西即可然后输入下面的命令重启 nginx 和 phpnginx -s reload\nservice php-fpm restart复制代码\n\n5.设置数据库\nmysql -uroot -p你的密码复制代码#注意 -u -p后面没有空格，直接填写这时候你的界面会出现mysql>这时候输入下面的内容create DATABASE blessskin;\n\nCREATE USER 'blessskin'@'localhost' IDENTIFIED BY 'skin';\n\nGRANT ALL ON blessskin.* TO 'blessskin'@'localhost';\n\nquit复制代码意思是创建一个叫 blessskin 的数据库，创建一个叫 blessskin 的本地用户密码是 skin，然后给 blessskin 用户 blessskin 数据库的全部权限\n6.设置Blessing Skin\n现在访问服务商给你的 IP，就能看到下面的界面\n\n\n\n\n8gRZ0IdwZzBIh8lS-image-1594027953672.png (11.41 KB, 下载次数: 3)\n\n下载附件\n\n2020-7-6 21:19 上传\n\n\n\n\n\n由于上面我们设置了数据库，所以在这里填入\n\n\n\n\nPelkAGwWCNVjpkw2-image-1594033326870.png (38.67 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:19 上传\n\n\n\n\n\n数据库用户名：blessskin\n数据库密码：skin\n数据库名称：blessskin下一步填写你的邮箱密码昵称，稍后用这些登录Blessing Skin\n\n\n\n\nfile_1594041656000.jpg (170.39 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:20 上传\n\n\n\n\n\n至此，你的 Blessing Skin 皮肤站就安装完成了\n\n7.安装yggdrasil API\n打开管理面板，在插件市场中找到 yggdrasil API 安装并启用。\n\n\n\n\neeQz0nqHc9QlBYvh-image-1594037277508.png (62.89 KB, 下载次数: 3)\n\n下载附件\n\n2020-7-6 21:21 上传\n\n\n\n\n\n然后打开插件设置，记好 你的Yggdrasil API地址\n\n\n\n\nJRHOj5ePzCFWJffK-image-1594039086235.png (7.76 KB, 下载次数: 2)\n\n下载附件\n\n2020-7-6 21:21 上传\n\n\n\n\n\n\n8.配置你的服务端\n在您的原有服务端启动参数的 -jar 前面加上 -javaagent:authlib-injector.jar=你的Yggdrasil API地址例如你原来的服务端启动参数是这样的java -Xmx1024M -Xms1024M -jar minecraft_server.1.12.2.jar nogui</span></font>复制代码那么应该修改成这样java -Xmx1024M -Xms1024M -javaagent:authlib-injector.jar=你的Yggdrasil API地址 -jar minecraft_server.1.12.2.jar nogui复制代码然后在 server.properties 里面把 online-mode 改成 true，就像这样 online-mode=true启动后您的服务端应该就只能通过皮肤站验证登录了\n8.配置你的客户端\n以HCML 3为例，添加账户，登录方式选择 authlib-injector ，然后点添加认证服务器，地址写上 你的Yggdrasil API地址 ，用户名是你的皮肤站邮箱，密码是你的皮肤站密码 \n\n\n\n\n\nfile_1594041719000.jpg (235.3 KB, 下载次数: 1)\n\n下载附件\n\n2020-7-6 21:22 上传\n\n\n\n\n\n*此图片摘自官方\n\n如果没有什么意外，你的皮肤站+外置登录就这样配置好了。\n\n\n\n",
    "replies": [
        {
            "author": "-Limoncello",
            "timestamp": 1596440400,
            "txt_content": "感谢大佬，找了好久了"
        },
        {
            "author": "无为之才",
            "timestamp": 1602815460,
            "txt_content": " 本帖最后由 无为之才 于 2020-10-16 10:35 编辑 \n\n有个问题哎！如果租的vps是公用ip，我所能用的是其中的几个端口，那么配置文件里，哪里改端口呢QAQ"
        },
        {
            "author": "635419450",
            "timestamp": 1609694580,
            "txt_content": "虽然是用的windows，但是自己摸索了3小时终于整完了，趴"
        },
        {
            "author": "Wkurumi",
            "timestamp": 1610641800,
            "txt_content": "我居然失败了"
        },
        {
            "author": "路人丁2020",
            "timestamp": 1610788380,
            "txt_content": "访问时显示：\n请将 Web 根目录设为当前目录下的 public 目录。\nPlease define your web server root directory as the \"public\" directory under current directory."
        },
        {
            "author": "10935336",
            "timestamp": 1610794020,
            "txt_content": "路人丁2020 发表于 2021-1-16 17:13\n访问时显示：\n请将 Web 根目录设为当前目录下的 public 目录。\nPlease define your web server root direct ...\nnginx设置内\nroot blessing-skin路径/public;"
        }
    ]
}