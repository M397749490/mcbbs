{
    "title": "1.12.2 自製怪物開啟gui遊戲崩潰",
    "author": "lycorisrad",
    "replyCount": 3,
    "timestamp": 1591697100,
    "txt_content": " 本帖最后由 lycorisrad 于 2020-6-9 18:08 编辑 \n\n各位大大好，這陣子研究自製怪物想說增加個gui，結果執行的時候一切正常對怪物按右鍵也有反應，但是沒開到gui遊戲就直接crash了\n以下是我編寫的程序，還勞煩各位大大幫忙。\n\nguihandler.class\npublic class GuiHandler implements IGuiHandler{\n        \n        //以下為變數更新\n        public static EntityCentaur monster;\n        \n        \n        @Override\n        public Object getServerGuiElement(int ID, EntityPlayer player, World world, int x, int y, int z) \n        {\n                                \n            if(ID == Reference.GUI_MONSTER ) {\n            return new MonsterMainContainer(player.inventory, monster); }\n                if(ID == Reference.GUI_SINTERING_FURNACE) return new ContainerSinteringFurnace(player.inventory, (TileEntitySinteringFurnace)world.getTileEntity(new BlockPos(x,y,z)));\n                return null;        \n        }\n        \n        @Override\n        public Object getClientGuiElement(int ID, EntityPlayer player, World world, int x, int y, int z) \n        { \n            if(ID == Reference.GUI_MONSTER ) {\n            return new MonsterGuiMainContainer(player.inventory, monster) ;}\n                if(ID == Reference.GUI_SINTERING_FURNACE) return new GuiSinteringFurnace(player.inventory, (TileEntitySinteringFurnace)world.getTileEntity(new BlockPos(x,y,z)));\n                 return null;\n        }\n        \n\n}\n复制代码\n\nMonsterMainContainer.class\n\npublic class MonsterMainContainer extends Container{\n        \n        private EntityCentaur monster;\n\n        public MonsterMainContainer(IInventory player,EntityCentaur monster) {\n                this.monster = monster;\n                \n                IItemHandler handler = monster.getCapability(CapabilityItemHandler.ITEM_HANDLER_CAPABILITY,null);\n                this.addSlotToContainer(new SlotItemHandler(handler, 0, 98, 30));\n                this.addSlotToContainer(new SlotItemHandler(handler, 1, 116, 30));\n                this.addSlotToContainer(new SlotItemHandler(handler, 2, 134, 30));\n                this.addSlotToContainer(new SlotItemHandler(handler, 3, 152, 30));\n                this.addSlotToContainer(new SlotItemHandler(handler, 4, 98, 48));\n                this.addSlotToContainer(new SlotItemHandler(handler, 5, 116, 48));\n                this.addSlotToContainer(new SlotItemHandler(handler, 6, 134, 48));\n                this.addSlotToContainer(new SlotItemHandler(handler, 7, 152, 48));\n                int xPos = 7;\n                int yPos = 77;\n                for (int y = 0; y < 3; ++y) {\n                        \n                        for (int x = 0; x < 9; ++x) {\n                                \n                                this.addSlotToContainer(new Slot(player, x + y * 9 + 9, xPos + x * 18, yPos + y * 18));\n                        }\n                }\n                                \n                for (int x = 0; x < 9; ++x) {\n                        this.addSlotToContainer(new Slot(player, x, xPos + x * 18, yPos + 58));\n                }\n        }\n        @Override\n        public boolean canInteractWith(EntityPlayer playerIn) {\n                return !playerIn.isSpectator();\n        }\n}复制代码\n\nMonsterGuiMainContainer.class\n\npublic class MonsterGuiMainContainer extends GuiContainer{\n\n        private EntityCentaur monster;\n        private IInventory player;\n        private final MonsterMainContainer monsterMainContainer;\n        \n        private float mousePosX;\n    private float mousePosY;\n    private GuiTextField nameField;\n    private int tabno;\n    \n    private static final ResourceLocation WOLF_GUI_INV = new ResourceLocation(Reference.MODID + \"textures/gui/copper_chest.png\");\n\n    public MonsterGuiMainContainer(IInventory player,EntityCentaur monster) {\n            super(new MonsterMainContainer(player, monster));\n            \n            this.xSize = 174;\n            this.ySize = 157;\n            this.tabno = 0;\n            \n            this.monster = monster;\n            this.player = player;\n            this.monsterMainContainer = (MonsterMainContainer)this.inventorySlots;\n    }\n\n\n        @Override\n        protected void drawGuiContainerBackgroundLayer(float partialTicks, int mouseX, int mouseY) {\n                GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);\n        int i = (this.width - this.xSize) / 2;\n        int j = (this.height - this.ySize) / 2;\n        if (this.tabno == 0)\n        {\n                this.mc.getTextureManager().bindTexture(WOLF_GUI_INV);\n                    this.drawTexturedModalRect(this.guiLeft, this.guiTop, 0, 0, this.xSize, this.ySize);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 4, 30, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 32, 0, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 60, 0, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 88, 0, 0, 30, 28);\n        }\n        else if (this.tabno == 1)\n        {\n                    this.drawTexturedModalRect(this.guiLeft, this.guiTop, 0, 0, this.xSize, this.ySize);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 4, 0, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 32, 30, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 60, 0, 0, 30, 28);\n                    this.drawTexturedModalRect(this.guiLeft+175, this.guiTop + 88, 0, 0, 30, 28);\n        }\n\n                GuiInventory.drawEntityOnScreen(i + 37, j + 52, 40, (float)(i + 41) - this.mousePosX, (float)(j + 75 - 50) - this.mousePosY, this.monster);\n\n                \n        }\n        @Override\n        protected void drawGuiContainerForegroundLayer(int mouseX, int mouseY)\n        {\n\n        }\n        \n\n    public void drawScreen(int mouseX, int mouseY, float partialTicks)\n    {\n        super.drawScreen(mouseX, mouseY, partialTicks);\n        this.mousePosX = (float)mouseX;\n        this.mousePosY = (float)mouseY;\n        GlStateManager.disableLighting();\n        GlStateManager.disableBlend();\n        this.nameField.drawTextBox();\n    }\n\n\n}\n复制代码entity.class  (這是實體entity的processinteract 方法)\n@Override\n         public boolean processInteract(EntityPlayer player, EnumHand hand) {\n        if(hand== EnumHand.MAIN_HAND) {\n                ItemStack itemStack = player.getHeldItem(hand);\n            player.openGui( Main.instance,Reference.GUI_MONSTER, world,  this.getEntityId(), 0, 0);        \n        }\n        return true;\n         }复制代码\n\nReference.class\npublic class Reference {\n        public static final String MODID = \"hiro\";\n        public static final String NAME = \"hiro's mod\";\n        public static final String VERSION = \"1.0\";\n        public static final String CLIENT = \"hiro.mod.proxy.ClientProxy\";\n        public static final String COMMON = \"hiro.mod.proxy.CommonProxy\";\n        public static final int ENTITY_CENTAUR =120;\n        public static final int GUI_SINTERING_FURNACE = 0;\n        public static final int GUI_MONSTER = 1;\n        \n\n}\n复制代码反勞煩各位大大幫我看看，我已經研究兩個月了，我希望能做出像女僕模組一下的介面但是弄不出來，好不容易有了反應卻是遊戲崩潰，但是代表我在processinteract上是沒有寫錯。對我來說這個錯誤是一個大進步，麻煩各位大大了。",
    "replies": [
        {
            "author": "自然_Hungteen",
            "timestamp": 1591702260,
            "txt_content": "只在服务端打开,在processinteract里面加一个isRemote的判断 再试试？"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1591709100,
            "txt_content": "自然_Hungteen 发表于 2020-6-9 19:31\n只在服务端打开,在processinteract里面加一个isRemote的判断 再试试？\n好的 謝謝大大您解答 我再試試看"
        },
        {
            "author": "3TUSK",
            "timestamp": 1591720140,
            "txt_content": "好不容易有了反應卻是遊戲崩潰\n請用 https://pastebin.com 等上傳 crash report，謝謝！"
        }
    ]
}