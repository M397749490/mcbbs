{
    "title": "有什么方法能查看服务器内存被什么地方占用了吗",
    "author": "CorC果茶",
    "replyCount": 27,
    "timestamp": 1585732320,
    "txt_content": " 本帖最后由 CorC果茶 于 2020-4-1 18:43 编辑 \n\n我服务器配置为 19 9900k 35G 8核\n以前日均在线80人内存也占不完\n现在日均在线30人就占完导致卡顿\n请问有什么办法能查内存被那些地方占用了吗\n最好是能详细列出来的\n\n启动器参数:https://paste.ubuntu.com/p/3qjcHP7H6y/",
    "replies": [
        {
            "author": "结城希亚",
            "timestamp": 1585732380,
            "txt_content": "ess的/gc可以看\n\n\n其他的话，貌似没的看\n\n你是tps低吗？还是只是单纯内存占用太高了"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1585732380,
            "txt_content": "没有，内存在java内分配很复杂，无法查看是什么导致的，而且就算有也看不懂\n\n建议你使用\ntimings采样(服务器内输入/timings on三分钟后输入/timings paste,然后发报告)\n或者\n[管理][PoS]Spark —— Spark性能分析器[1.8-1.15]\nhttps://www.mcbbs.net/thread-823209-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n这两个可以看出是什么导致卡服的"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585732440,
            "txt_content": "结城希亚 发表于 2020-4-1 17:13\ness的/gc可以看\n内存占用过大导致TPS降低或者后台卡死\n已经编辑图片了"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585732500,
            "txt_content": "CorC果茶 发表于 2020-4-1 17:14\n内存占用过大导致TPS降低或者后台卡死\n已经编辑图片了\n[优化]LaggRemover —— 智能降低延迟★优化TPS&内存【汉化】[1.7-1.14]\nhttps://www.mcbbs.net/thread-603072-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n用这个插件，然后输入/lr gc\n你tps挺健康的"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585732560,
            "txt_content": "EmptyLava 发表于 2020-4-1 17:13\n没有，内存在java内分配很复杂，无法查看是什么导致的，而且就算有也看不懂\n\n建议你使用\n好，稍等"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585732740,
            "txt_content": "结城希亚 发表于 2020-4-1 17:15\n[优化]LaggRemover —— 智能降低延迟★优化TPS&内存【汉化】[1.7-1.14]\nhttps://www.mcbbs.net/thread-6 ...\n别看tps挺高，再进来一两个人马上卡死，崩服- -"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585732800,
            "txt_content": "CorC果茶 发表于 2020-4-1 17:19\n别看tps挺高，再进来一两个人马上卡死，崩服- -\ntimings发出来或者log也行"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585732920,
            "txt_content": "EmptyLava 发表于 2020-4-1 17:13\n没有，内存在java内分配很复杂，无法查看是什么导致的，而且就算有也看不懂\n\n建议你使用timings采样(服务器内输入/timings on三分钟后输入/timings paste,然后发报告)\n这个没反应啊= =\n"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1585733040,
            "txt_content": "CorC果茶 发表于 2020-4-1 17:22\n这个没反应啊= =\n你服务器总没有禁止外网吧"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585733100,
            "txt_content": "EmptyLava 发表于 2020-4-1 17:24\n你服务器总没有禁止外网吧\n没,输入timings on是有反应的，timings paste输入完了什么反应都没"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1585733220,
            "txt_content": "CorC果茶 发表于 2020-4-1 17:25\n没,输入timings on是有反应的，timings paste输入完了什么反应都没\n截图看看呢"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1585733400,
            "txt_content": "EmptyLava 发表于 2020-4-1 17:13\n没有，内存在java内分配很复杂，无法查看是什么导致的，而且就算有也看不懂\n\n建议你使用\n他的意思是内存快满了 频繁触发gc 导致的卡顿 timings 之类的应该看不出来\n\n我比较好奇启动参数是怎么样的（虽然大概并没有什么用\n\n可以安装spark 在内存快满的时候 发一下/spark heapsummary"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585733400,
            "txt_content": "GiNYAi 发表于 2020-4-1 17:30\n他的意思是内存快满了 频繁触发gc 导致的卡顿 timings 之类的应该看不出来\n\n我比较好奇启动参数是怎么样 ...\n启动参数我给你发了看看"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585733580,
            "txt_content": "GiNYAi 发表于 2020-4-1 17:30\n他的意思是内存快满了 频繁触发gc 导致的卡顿 timings 之类的应该看不出来\n\n我比较好奇启动参数是怎么样的 ...\nhttps://paste.ubuntu.com/p/3qjcHP7H6y/"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585736220,
            "txt_content": "GiNYAi 发表于 2020-4-1 17:30\n他的意思是内存快满了 频繁触发gc 导致的卡顿 timings 之类的应该看不出来\n\n我比较好奇启动参数是怎么样的 ...\nhttps://spark.lucko.me/#xX972sKGSn"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585736280,
            "txt_content": "EmptyLava 发表于 2020-4-1 17:13\n没有，内存在java内分配很复杂，无法查看是什么导致的，而且就算有也看不懂\n\n建议你使用\nhttps://spark.lucko.me/#xX972sKGSn"
        },
        {
            "author": "DE_SHARK",
            "timestamp": 1585736400,
            "txt_content": "java -server -d64 -Xms16G -Xmx16G -Xss6M -XX:+UseG1GC -XX:+AggressiveOpts -XX:+UseCompressedOops -jar CatServer.jar\n\n参数用这个试试，太多花里花哨的反而不好用"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585736400,
            "txt_content": "CorC果茶 发表于 2020-4-1 18:17\nhttps://spark.lucko.me/#xX972sKGSn\n这个spark的报告看不懂呀"
        },
        {
            "author": "DE_SHARK",
            "timestamp": 1585736460,
            "txt_content": "DE_SHARK 发表于 2020-4-1 18:20\njava -server -d64 -Xms16G -Xmx16G -Xss6M -XX:+UseG1GC -XX:+AggressiveOpts -XX:+UseCompressedOops -ja ...\n更正一下，我突然出bug手机编辑不了\n\n把\n-Xss6M\n改成\n-Xss3M"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585736580,
            "txt_content": "DE_SHARK 发表于 2020-4-1 18:21\n更正一下，我突然出bug手机编辑不了\n\n把\n这个参数啥意思"
        },
        {
            "author": "DE_SHARK",
            "timestamp": 1585736760,
            "txt_content": "CorC果茶 发表于 2020-4-1 18:23\n这个参数啥意思\n设置每个线程的堆栈大小"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1585738440,
            "txt_content": "CorC果茶 发表于 2020-4-1 17:33\nhttps://paste.ubuntu.com/p/3qjcHP7H6y/\n刚刚在做饭 回复慢了一点\n建议换成G1垃圾回收试一下 #18楼的那个就可以\n\n我认为应该会有所改善 \n\n如果仍然不行的话 /spark heapdump\n生成堆快照 发一下"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585740540,
            "txt_content": "GiNYAi 发表于 2020-4-1 18:54\n刚刚在做饭 回复慢了一点\n建议换成G1垃圾回收试一下 #18楼的那个就可以\n\n\nG1垃圾回收是什么意思"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1585743300,
            "txt_content": "CorC果茶 发表于 2020-4-1 19:29\nG1垃圾回收是什么意思\nG1GC    \n\n\n"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585755600,
            "txt_content": " 本帖最后由 CorC果茶 于 2020-4-1 23:46 编辑 \nGiNYAi 发表于 2020-4-1 18:54\n刚刚在做饭 回复慢了一点\n建议换成G1垃圾回收试一下 #18楼的那个就可以\nspark heapdump输入之后生成了一个22G的文件\n卧槽这要怎么发\n"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1585756680,
            "txt_content": "CorC果茶 发表于 2020-4-1 23:40\nspark heapdump输入之后生成了一个22G的文件\n卧槽这要怎么发\n也没有什么办法嘛  你也可以把最大内存减小一点 再生成 不过效果可能会差一点？"
        },
        {
            "author": "CorC果茶",
            "timestamp": 1585757940,
            "txt_content": "GiNYAi 发表于 2020-4-1 23:58\n也没有什么办法嘛  你也可以把最大内存减小一点 再生成 不过效果可能会差一点？ ...\n.......22G 我这个问题可能解决不了啦.."
        }
    ]
}