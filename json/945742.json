{
    "title": "[原创|开源]updater2——客户端更新小工具2，支持Git",
    "author": "innc",
    "replyCount": 6,
    "timestamp": 1579850040,
    "txt_content": " 本帖最后由 innc 于 2020-1-26 21:01 编辑 \n\n时隔2年我又回来了距离上一个帖子  [原创|开源]updater——更新客户端文件小程序，Mod服好帮手，2020年1.2.1诈尸小更新 好像已经鸽了快两年了，updater有许多的问题，比如对面板服不友好，客户端要用Java启动等问题，这次采用Git源更新。本软件面向有一定基础的用户，需要了解Git流程，简单命令，目前发现一个问题就是客户端必须要安装git，或者添加git路径到path里，git有200多m，不是太划算，而且暂时没法修复。\n介绍：\n本软件是为了快速方便的更新客户端的mod，设置，材质等文件资源而做出来的辅助工具，能免去玩家下载整个客户端的烦恼。updater这个软件是采用的Java编写的客户端，这对一部分玩家不友好，所以这次直接打成了EXE包并且开源，updater2采用的是Git更新源，每次运行的时候都会与指定的Repository中的master分支保持更新，这样避免了服主单独架设服务端，没有直接的带宽限制。可以使用GitHub作为更新源，但国内网络情况不是特别稳定，有条件的服主可以搭建Git服务端，或者选择国内的平台：腾讯开发者平台(好像是叫这个，以前叫coding)，国内访问速度比较快\n\n配置：\n首先下载主程序(updater2-1.0.exe)和配置文件(setting.json)\n\n\n\n\n批注 2020-01-24 031241.png (19.8 KB, 下载次数: 0)\n\n下载附件\n\n2020-1-24 13:29 上传\n\n\n\n\n\n编辑setting.json\n\n\n\n\n批注 2020-01-24 133209.png (31.08 KB, 下载次数: 0)\n\n下载附件\n\n2020-1-24 13:32 上传\n\n\n\n\n\n\n可以看到有4个可以编辑的项目：\n\nurl: Git仓库的地址，命名规则可以参考这里https://mirrors.edge.kernel.org/pub/software/scm/git/docs/git-clone.html#URLS如果使用Https风格则必须以.git结尾，私有仓库可以使用\n\n\n\n\nQQ截图20200124152105.png (3.12 KB, 下载次数: 0)\n\n下载附件\n\n2020-1-24 15:21 上传\n\n\n\n\n这种规范来填写账号密码，但要注意泄露的问题\n\nprojDir: 需要被更新的目录地址，这里只能使用相对路径，切勿使用绝对路径，其它需要忽略的文件也需要一起写入这个文件(.gitignore)， .gitignore的写法篇幅太长不在此讲解请自行查阅Git资料，如果用于更新主程序所在目录，(如果不是请忽略以下文字)(一般不会遇到这种情况)，务必将主程序加入到.gitignore，原因参考下方的原理。第一次初始化的时候，不能检测到主程序文件否则无法初始化Git仓库，参考下方的原理，需要先把projDir写成别的目录，初始化以后再把projDir留空，然后把初始化后的.git目录提取出来移动到对应需要更新的目录下(也就是真正的projDir的目录里)然后在真正的projDir的目录里创建.gitignore并写上主程序文件名即可，如果仍有疑惑欢迎随时提问，第一时间解答！\n\ncommand: 这个填写一条命令，这个命令会在所有的更新完成后被执行，可以在此启动启动器或者执行其它指令，写法规则参考Windows的命令行，如果无法连接到服务器那么则不会执行，建议使用相对路径，通常直接写文件名即可，演示中使用的是7zip的安装包不要在意。\n\ntimeout: 当连接到服务器和执行pull的时间超过了这个timeout的值，单位秒，就会提示连接超时，国内使用Github尤其如此，chekout和clean不包括在内，如果更新的文件非常大，那么pull操作相应的会消耗更多的时间，建议内容在30Mb以内设为60s，100Mb建议180s\n\n关于projDir的说明，如果要被更新的目录为程序所在的文件夹，请直接留空，否则填写相对路径\"aaa\\bbb\\ccc\"\n\n到此配置结束，直接双击运行主程序即可。建议把主程序，配置文件和启动器放到一起，更新完成后可以实现自动打开启动器\n\n\n\n原理：\n主程序使用git仓库来维护相应的目录，请不要删除.git文件夹，每次更新会pull远程仓库的master分支，然后chekout然后clean，这会有个弊端，如果commit太多，会导致第一次pull消耗非常多的时间，所以非常建议定期更新群内的完整包（尤其是更新了超大文件(100Mb+)以后），避免因为pull内容太多导致timeout，此外无法将主程序放入Git仓库进行更新，因为Windows不允许删除正在运行的程序，但是setting.json可以。每次需要更新新的文件直接push到对应的远程仓库就可以。\n\n\n\n如果使用过程中遇到问题或者疑问，最好能够带上运行截图，用终端运行，而不是双击以方便截图。以下示例：\n\n\n\n\nQQ截图20200124145258.png (18.18 KB, 下载次数: 0)\n\n下载附件\n\n2020-1-24 15:24 上传\n\n\n\n\n\n\n\n下载:\nhttps://pan.baidu.com/s/1OtZVHbVsr0-gAH4QgFMrGA\n注意：玩家电脑上需要安装Git才能，否则无法运行，今天刚刚发现的问题，目前暂时无法解决，因为Git本身就有200Mb，仅供研究。\n\n排版稍微有些乱，如果喜欢记得给个评分，不会消耗自己的人气！\n\n\n源代码文件：\n1.0:  \n\n\n\naa2.py.txt\n(2.19 KB, 下载次数: 5)\n\n\n\n2020-1-26 21:01 上传\n点击文件名下载附件\n\n\n\n\n\n 使用pyinstaller构建\n\n\n\n",
    "replies": [
        {
            "author": "Neonatalsun",
            "timestamp": 1579856520,
            "txt_content": "感谢开源 很有用233"
        },
        {
            "author": "Aikini",
            "timestamp": 1579857780,
            "txt_content": "能用Git仓库好评"
        },
        {
            "author": "馒头爱世界",
            "timestamp": 1580009220,
            "txt_content": "有点疑惑，可以加个QQ什么的吗。。。"
        },
        {
            "author": "innc",
            "timestamp": 1580012160,
            "txt_content": "馒头爱世界 发表于 2020-1-26 11:27\n有点疑惑，可以加个QQ什么的吗。。。\n有疑问可以直接私聊我，我会尽可能解答！"
        },
        {
            "author": "2106758890",
            "timestamp": 1580653020,
            "txt_content": "需要安装git环境就麻烦了，，可不可以提取需要用的部分环境作为支持库，需要能打开软件直接启动才好，不然200MB文件还要自己安装玩家肯定不干。其实发展网盘方面的也不错！"
        },
        {
            "author": "innc",
            "timestamp": 1580743260,
            "txt_content": "2106758890 发表于 2020-2-2 22:17\n需要安装git环境就麻烦了，，可不可以提取需要用的部分环境作为支持库，需要能打开软件直接启动才好，不然2 ...\n这的确是个问题，但提取需要用的部分环境作为支持库有些不太现实，因为Git本身依赖很多东西，特别是一些常用命令像mv,cp,rm,cd类似的，最小大小也在130Mb左右，，是真的没办法，直接启动软件是没问题，可200多m的额外大小不会有人买单，，也行Git这个主意本身就是个坏主意吧，我想考虑下阿里的OSS之类的，应该简单很多"
        }
    ]
}