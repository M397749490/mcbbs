{
    "title": "服务器自动重启“脚本”更新版本10月2号",
    "author": "hyx1521",
    "replyCount": 7,
    "timestamp": 1345894260,
    "txt_content": " 本帖最后由 hyx1521 于 2012-10-2 06:17 编辑 \n\n10月2号更新服务器自动重启脚本 \n更新内容\n             更新了句柄的获取 开启服务器后不用在等几秒了\n             降低了输入字的延迟\n             添加了重启前的最后提示信息\n\n首先把开服用的bat文件编辑下 在里面加入 title 服务器 一条 \n例子：\n@ECHO OFF\ncolor b\ntitle 服务器\nSET BINDIR=%~dp0\nCD /D \"%BINDIR%\"\n\"D:\\java6\\bin\\java.exe\" -Xincgc -Xmx1G -jar craftbukkit.jar\nPAUSE\n\n下面就是脚本了 \n\n//下面的指令“”里写你开服用的bat文件路径\nRunApp \"E:\\TDDOWNLOAD\\mc\\1.3.2服务器端\\运行服务器.bat\"\nDelay 5000\nHwnd = Plugin.Window.Find(0, \"管理员:  服务器\")\n//下面是重启时间默认的是1小时\nDelay 3600000\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,89)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,86)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,84)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,84)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,73)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,78)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,101)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,77)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,13)\nDelay 300000\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,86)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,189)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,76)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,76)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,13)\nDelay 5000\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,89)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,86)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,32)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,69)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,84)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,65)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,82)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,84)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,13)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,83)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,84)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,79)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,80)\nDelay 500\nCall Plugin.Bkgnd.KeyPress(Hwnd,13)\nDelay 60000\nCall Plugin.Bkgnd.KeyPress(Hwnd,13)\nDelay 5000\n\n         ",
    "replies": [
        {
            "author": "strawmaine",
            "timestamp": 1345896060,
            "txt_content": "可以附上按键精灵然后发到我的软件资源版，哈哈哈哈"
        },
        {
            "author": "深渊小恶魔",
            "timestamp": 1346170380,
            "txt_content": "太谢谢楼主了！----------------------------------------------------------------------------------可是。怎么上传到按键精灵呢？"
        },
        {
            "author": "深渊小恶魔",
            "timestamp": 1346202360,
            "txt_content": "哦，我会了，谢谢楼主。"
        },
        {
            "author": "深渊小恶魔",
            "timestamp": 1346218200,
            "txt_content": "楼主！为什么我用了脚本，它重新帮我打开了服务端，可是之前的服务端却没有关掉呢！？"
        },
        {
            "author": "hyx1521",
            "timestamp": 1346237700,
            "txt_content": "注意事项\n             确认打开的路径正确  \n             开启时等待3秒 （因为打开后设置了2秒的延迟 才会设置当前最前的窗口为句柄）\n             循环次数为直到按中指键为止\n打开服务器后等待3秒 因为我设置了获得句柄的延迟 "
        },
        {
            "author": "hyx1521",
            "timestamp": 1346237760,
            "txt_content": "深渊小恶魔 发表于 2012-8-29 13:30 \n楼主！为什么我用了脚本，它重新帮我打开了服务端，可是之前的服务端却没有关掉呢！？\n打开服务器后等待3秒 因为我设置了获得句柄的延迟 也就是说当服务器端出现时先别切到别的窗口 先等几秒\n"
        },
        {
            "author": "きのこMogu_",
            "timestamp": 1408649340,
            "txt_content": "哇，技术党。。。感谢楼主分享"
        }
    ]
}