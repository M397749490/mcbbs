{
    "title": "有毒！背包拿起移动点击打开   修改物品无效！",
    "author": "494308843",
    "replyCount": 1,
    "timestamp": 1457703060,
    "txt_content": " 本帖最后由 lichi2050 于 2016-3-11 17:25 编辑 \n\n{:10_494:}让我撞死算了\n\n这有毒\n我想当然的写了一个程序\n太蛋疼了\n\n调试了半天\n代码如下    \n想实现的是  玩家点击背包的物品更新物品LORE 把英文替换成中文\n结果 实际发现\n事件触发了 （点击  拿起 ）\n物品也修改了  LORE也验证了 确实替换了  但是就是没变\n但是！打开箱子 然后点击物品  神TM变了\n我真是给跪了\n搞了一晚上\n这都什么鬼(╯‵□′)╯︵┻━┻\n要疯了  这有毒啊\n这什么原因啊\n\n而且玩家按E打开背包的时候不会触发背包被打开\n而且移动也不会触发  在打开\n还有\n\npackage net.mcud.mcudm.FormatLore;\n\nimport java.util.List;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.entity.HumanEntity;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.inventory.InventoryClickEvent;\nimport org.bukkit.event.inventory.InventoryMoveItemEvent;\nimport org.bukkit.event.inventory.InventoryOpenEvent;\nimport org.bukkit.event.inventory.InventoryPickupItemEvent;\nimport org.bukkit.inventory.Inventory;\nimport org.bukkit.inventory.ItemStack;\nimport org.bukkit.inventory.meta.ItemMeta;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class main extends JavaPlugin implements Listener\n\n{   \npublic void onEnable(){\n        getServer().getPluginManager().registerEvents(this, this);\n                getLogger().info(\"FormatLore已开启.\");\n\n        }\n    public void onDisable() {\n        getLogger().info(\"FormatLore已关闭.\");\n\n    }\n    @EventHandler\n    public void onInventoryMoveEvent(InventoryMoveItemEvent event) {\n            return;\n            Bukkit.broadcastMessage(\"物品移动\");\n            ItemStack IS=event.getItem();\n        FormatItemStackLore(IS);\n            event.setItem(IS);\n\n\n      }            \n    @EventHandler\n    public void onInventoryPickupItemEvent(InventoryPickupItemEvent event){\n            \n\n      ItemStack IS = event.getItem().getItemStack();\n      FormatItemStackLore(IS);\n      event.getItem().setItemStack(IS);\n\n\n    }\n    @EventHandler\n    public void onInventoryClick(InventoryClickEvent event){\n            \n            //Bukkit.broadcastMessage(\"背包点击\");\n\n            \n            ItemStack IS=event.getCurrentItem();\n            FormatItemStackLore(IS);\n\n\n\n\n\n    }\n\n\n    @EventHandler\n    public void onPlayerInteract(PlayerInteractEvent event){\n            ItemStack IS=event.getPlayer().getItemInHand();\n            if(!(IS==null)){\n                    FormatItemStackLore(IS);\n                            \n                    \n            }\n            \n    }\n    @EventHandler\n    public void onInventoryOpen(InventoryOpenEvent event)\n    {\n            return;\n            //Bukkit.broadcastMessage(\"背包打开\");\n\n      Inventory inventory = event.getInventory();\n\n      for (ItemStack itemStack : inventory.getContents()){\n              FormatItemStackLore(itemStack);\n      }\n          inventory = event.getPlayer().getInventory();\n\n      for (ItemStack itemStack : inventory.getContents()){\n              FormatItemStackLore(itemStack);\n      }\n\n\n    }\n\n\n\n    public void FormatItemStackLore(ItemStack IS){\n\n        ItemMeta im=IS.getItemMeta();\n        if(!im.hasLore()){\n                return;\n                }\n\n        List<String> lore=im.getLore();\n        for(int i=0;i<lore.size();i+=1){\n                lore.set(i, FormatLore(lore.get(i)));\n        }\n        im.setLore(lore);\n        IS.setItemMeta(im);\n\n    }\n    public String FormatLore(String r){\n            String str=r.toString();\n            str=str.replaceAll(\"speed\", \"加速\");\n            str=str.replaceAll(\"slow\", \"减速\");\n            str=str.replaceAll(\"fast_digging\", \"快速挖掘\");\n            str=str.replaceAll(\"slow_digging\", \"缓慢挖掘\");\n            str=str.replaceAll(\"increase_damage\", \"伤害提升\");\n            str=str.replaceAll(\"heal\", \"瞬间恢复\");\n            str=str.replaceAll(\"harm\", \"瞬间伤害\");\n            str=str.replaceAll(\"jump\", \"跳跃提升\");\n            str=str.replaceAll(\"confusion\", \"反胃\");\n            str=str.replaceAll(\"regeneration\", \"生命再生\");\n            str=str.replaceAll(\"damage_resistance\", \"抗性提升\");\n            str=str.replaceAll(\"fire_resistance\", \"抗火\");\n            str=str.replaceAll(\"water_breathing\", \"水下呼吸\");\n            str=str.replaceAll(\"invisibility\", \"隐形\");\n            str=str.replaceAll(\"blindness\", \"失明\");\n            str=str.replaceAll(\"night_vision\", \"夜视\");\n            str=str.replaceAll(\"hunger\", \"饥饿\");\n            str=str.replaceAll(\"weakness\", \"虚弱\");\n            str=str.replaceAll(\"poison\", \"中毒\");\n            str=str.replaceAll(\"wither\", \"凋零\");\n            return str;\n    }\n\n\n}\n\n\n之前发编程求助  2次  不通过\n只好发这里了\nMCBBS  学习插件开发好局限啊",
    "replies": [
        {
            "author": "494308843",
            "timestamp": 1457703240,
            "txt_content": "这个是之后修改的  弄成玩家交互了\n\nreturn是后来加的\n\n其他情况如帖子内容所写"
        }
    ]
}