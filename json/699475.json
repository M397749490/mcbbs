{
    "title": "如何更改玩家头顶的Tag",
    "author": "zhanshi123",
    "replyCount": 3,
    "timestamp": 1497972180,
    "txt_content": "如题，想这一个类似于AnimatedNames的插件，如何更改玩家头顶的tag，求各位dalao帮助",
    "replies": [
        {
            "author": "黑",
            "timestamp": 1498007580,
            "txt_content": " 本帖最后由 583736449 于 2017-6-21 09:23 编辑 \n\n如果字符串超过16字节，会直接崩溃无法进服，除非移除积分版数据。\n\npublic class API\n{\n  public void setTag(Player p, String prefix, String suffix)\n    throws Exception\n  {\n    prefix = ChatColor.translateAlternateColorCodes('&', prefix);\n    suffix = ChatColor.translateAlternateColorCodes('&', suffix);\n    if (prefix.length() > 16) {\n      prefix = prefix.substring(0, 16);\n    }\n    if (suffix.length() > 16) {\n      suffix = suffix.substring(0, 16);\n    }\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    Team t = board.getTeam(p.getName());\n    if (t == null)\n    {\n      t = board.registerNewTeam(p.getName());\n      t.setPrefix(prefix);\n      t.setSuffix(suffix);\n      t.addPlayer(p);\n    }\n    else\n    {\n      t = board.getTeam(p.getName());\n      t.setPrefix(prefix);\n      t.setSuffix(suffix);\n      t.addPlayer(p);\n    }\n    for (Player o : Bukkit.getOnlinePlayers()) {\n      o.setScoreboard(board);\n    }\n  }\n  \n  public void setTag(Player p, String prefix)\n    throws Exception\n  {\n    prefix = ChatColor.translateAlternateColorCodes('&', prefix);\n    if (prefix.length() > 16) {\n      prefix = prefix.substring(0, 16);\n    }\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    Team t = board.getTeam(p.getName());\n    if (t == null)\n    {\n      t = board.registerNewTeam(p.getName());\n      t.setPrefix(prefix);\n      t.addPlayer(p);\n    }\n    else\n    {\n      t = board.getTeam(p.getName());\n      t.setPrefix(prefix);\n      t.addPlayer(p);\n    }\n    for (Player o : Bukkit.getOnlinePlayers()) {\n      o.setScoreboard(board);\n    }\n  }\n  \n  public void setTag(Player p, String suffix, boolean notUsed)\n    throws Exception\n  {\n    suffix = ChatColor.translateAlternateColorCodes('&', suffix);\n    if (suffix.length() > 16) {\n      suffix = suffix.substring(0, 16);\n    }\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    Team t = board.getTeam(p.getName());\n    if (t == null)\n    {\n      t = board.registerNewTeam(p.getName());\n      t.setSuffix(\" \" + suffix);\n      t.addPlayer(p);\n    }\n    else\n    {\n      t = board.getTeam(p.getName());\n      t.setSuffix(\" \" + suffix);\n      t.addPlayer(p);\n    }\n    for (Player o : Bukkit.getOnlinePlayers()) {\n      o.setScoreboard(board);\n    }\n  }\n  \n  public void unregisterTag(Player p)\n    throws Exception\n  {\n    Bukkit.getScoreboardManager().getMainScoreboard().getPlayerTeam(p).unregister();\n  }\n  \n  public void unregisterAll()\n    throws Exception\n  {\n    for (Player o : ) {\n      unregisterTag(o);\n    }\n  }\n  \n  public void registerAll(String prefix, String suffix)\n    throws Exception\n  {\n    for (Player o : ) {\n      setTag(o, prefix, \" \" + suffix);\n    }\n  }\n  \n  public void refresh()\n  {\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    for (Player o : Bukkit.getOnlinePlayers()) {\n      o.setScoreboard(board);\n    }\n  }\n  \n  public String getPrefix(Player p)\n    throws Exception\n  {\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    Team t = board.getTeam(p.getName());\n    if ((t != null) && (board.getPlayerTeam(p).getPrefix() != null) && (!board.getPlayerTeam(p).getPrefix().isEmpty())) {\n      return board.getPlayerTeam(p).getPrefix();\n    }\n    return \"\";\n  }\n  \n  public String getSuffix(Player p)\n    throws Exception\n  {\n    Scoreboard board = Bukkit.getScoreboardManager().getMainScoreboard();\n    Team t = board.getTeam(p.getName());\n    if ((t != null) && (board.getPlayerTeam(p).getSuffix() != null) && (!board.getPlayerTeam(p).getSuffix().isEmpty())) {\n      return board.getPlayerTeam(p).getSuffix();\n    }\n    return \"\";\n  }\n}"
        },
        {
            "author": "zhanshi123",
            "timestamp": 1498011480,
            "txt_content": "583736449 发表于 2017-6-21 09:13\n如果字符串超过16字节，会直接崩溃无法进服，除非移除积分版数据。\n感谢坏黑dalao"
        },
        {
            "author": "602723113",
            "timestamp": 1498052220,
            "txt_content": "emmmm...之前在dev.bukkit.org上面看到一个方法是更改玩家的gameprofile，但是需要nms"
        }
    ]
}