{
    "title": "[无聊向]MCBBS Extender里的技术细节 #1 为啥勋章是亮闪闪的",
    "author": "Zapic",
    "replyCount": 10,
    "timestamp": 1597428240,
    "txt_content": " 本帖最后由 Zapic 于 2020-8-15 09:45 编辑 \n\n有人可能用过MCBBS Extender.\n也可能没有用过,但是可能看到过宣传图:\n\n\n大概好看多了.\n但是我们今天不说他好看与否,我们来聊聊为啥他能亮闪闪的.\n\n今天的文风是说明文,不要问我为啥不可爱.\n\n#0 思路\n这种亮闪闪的东西有点眼熟么?\n那再看一下?\n\n这个东西就是由这个启发而来的.\n我们只需要在鼠标悬浮到勋章上的时候将勋章\"抬起\",并在旁边显示勋章的信息就行了.\n我们今天只说如何让勋章\"抬起\"并\"反光\".\n\n有条件的观众可以打开你的DevTools跟我们一起动手.\n这种改造兼容IE 11+,Chrome 49+,Firefox 16+,以及其他的基于Webkit的国产垃圾套壳浏览器.\n就算你的浏览器不满足以上条件,你也可以动手试试,看看旧浏览器与新浏览器的区别.\n\n以下内容已经假定您可以熟练的使用您所使用的浏览器提供的DevTools.\n我们将以拥有市面上90%占有量的Chrome浏览器 ---- 的老对手 Firefox浏览器做例子.\n\n#1 尝试\n\n让我们先来改造勋章.\n\n先打开你的个人主页,找到你的勋章.\n\n\n\n\nselect1.png (31.66 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-14 23:02 上传\n\n\n\n\n\n如你所见,这是一个非常简单的HTML结构.\n<img \n        src=\"static//image/common/m_rc1.png\" \n        alt=\"小麦种勋章\" \n        id=\"md_107\" \n        onmouseover=\"showMenu({'ctrlid':this.id, 'menuid':'md_107_menu', 'pos':'12!'});\" \n        initialized=\"true\"\n>复制代码\n为了方便讲解,我们去掉那些没用的东西.\n<img \n        src=\"static//image/common/m_rc1.png\" \n        id=\"md_107\" \n        onmouseover=\"showMenu({'ctrlid':this.id, 'menuid':'md_107_menu', 'pos':'12!'});\" \n>复制代码\n一个图片源,一个元素id,一个onmouseover(鼠标悬浮在元素上面)事件,这就是你所看到的那个勋章.\n我们看一下他的样式:\na img {\n    border: none;\n}复制代码\n有用的大概只有这一个.\n这个样式去掉了某些浏览器上图片原本有的边框,但是现代浏览器一般没有这种边框了.\n\n扯远了,我们先给勋章加一个基础的阴影.\n这里用到的是box-shadow属性,兼容性查询: https://caniuse.com/#search=box-shadow\n兼容性还行.\n\nMCBBS Extender的阴影是这样加的:\nbox-shadow: 0px 2px 5px 0px black;复制代码\n我们直接复制过来.\n点击样式查看器右上角的加号,为这个元素新建一个样式规则.\n在新建的样式规则括号空白处单击,可以添加新的属性.\n按Ctrl+V可以把剪切板里的规则直接粘贴进里面.\n然后按下回车,就可以应用你的样式.\n\n回到页面查看你修改的的那个勋章:\n我的天怎么跟屎一样?\n\n\n\n\nshit1.gif (76.78 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-14 23:20 上传\n\n\n\n\n\n由于勋章图片并不能与img元素完全契合,我们可能需要对这个元素进行一些额外的调整.\n首先更改这个元素的长宽,让他去掉边框.\n继续在空白处单击,添加新的属性:width: 35px;\nheight: 55px;复制代码\n这里输入的是勋章图片的原宽高\n点击数字并按上下键可以调整他们的值,调整直至边框消失.\n调好了么?\n调不好的放弃吧.你会发现貌似边框会一直存在.\n\n这是因为图片会根据img元素的大小而改变大小,永远不会超出元素.\n那我们是不是就没辙了?\n小场面,CSS可以让图片不再根据img元素的大小而决定大小.object-fit: none;\nobject-position: center;复制代码\nobject-fit 属性可以改变图片的契合行为,none就是不跟随img元素的大小而改变大小.\nobject-position可以决定图片显示的位置,因为边框存在于四周,所以这里用的是居中显示,方便裁剪.\n\n再点击数字,按上下键尝试调整直至边框恰好消失,而不裁剪图片原本的内容.\n\n\n\n\nresize.gif (40.49 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-14 23:48 上传\n\n\n\n\n\n\n但是仔细观察,貌似四个角还有一些白点没被裁剪掉.\n这是因为图片上勋章的边框并非完整的长方形,而是带有圆角的.\n那我们也为img元素添加圆角即可.\n这里用到的是border-radius属性:border-radius: 0px;复制代码\n点击数字,按上下键调整直至白点消失.\n好了,这看起来就像MCBBS Extender里的勋章了.\n\n事实上,MCBBS Extender里的勋章并不是这样实现的,以上内容都是扯犊子.\n为什么不这样实现呢?\n\nimg标签是一种特殊的元素,不像其他大多元素一样,img标签不允许拥有子元素.\n这就为后期向勋章上添加反光制造了麻烦.\n\n所以我们需要把原来的勋章改写一下,这里用的是span标签.\n在Devtools里,选中原先的img元素,右键,编辑HTML.\n换行,写入以下内容:<span></span>复制代码\n再将上面img标签的核心内容复制下来:<span \n        src=\"static//image/common/m_rc1.png\"\n        id=\"md_107_new\" \n        onmouseover=\"showMenu({'ctrlid':this.id, 'menuid':'md_107_menu', 'pos':'12!'});\"\n></span>复制代码\n由于元素的id必须唯一,我们修改了元素的id.\n\n点击文本框外的空白区域保存更改.\n你会发现:\n啥都没有发生.\n这是因为span标签并不能直接显示图片.\n所以我们将把图片作为背景显示.\n在Devtools里选中span,在样式编辑器里添加新的规则,顺便把之前的阴影也弄下来:width: 35px;\nheight: 55px;\ndisplay: inline-block;\nbox-shadow: 0px 2px 5px 0px black;复制代码\n\n再使用background-image属性,为span添加背景图片:width: 35px;\nheight: 55px;\ndisplay: inline-block;\nbox-shadow: 0px 2px 5px 0px black;\nbackground-image: url(static//image/common/m_rc1.png)复制代码\n于是边框又出来了,让我们再把边框削掉.\n\n由于背景图片默认不会跟随他所在的元素大小,我们只需要把背景图片居中:background-position: center;复制代码\n再像上面一样,调整长宽和圆角.\n\n好多了,这就是第一步,也是MCBBS Extender里勋章的样子.\n\n接下来,让鼠标悬浮在上面的时候\"抬起\"勋章.\n我们在上面看到了onmouseover事件,在鼠标悬浮在上面是会触发.\n我们只需要在触发事件时用JavaScript改变元素的样式就行了...\n才不是.\n\n接下来是CSS选择器小课堂,我们要来谈谈:hover伪类.\n首先,我们在上面编辑代码的时候,可能已经见到了一些简单的选择器,就像这样:\n\n\n\n\nselector.png (2.73 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 00:19 上传\n\n\n\n\n\n\"#md_107_new\"就是一个选择器,这个选择器永远会选中这个元素,无论这个元素处于什么状态.\n伪类提供了选中处于特殊状态元素的能力,通过hover伪类,我们可以只选中处于\"被鼠标悬浮\"状态下的元素:#md_107_new:hover {\n/* ... */\n}复制代码\n这个规则里的样式只会当这个元素\"被鼠标悬浮\"时才会生效.\n想要了解更多,可以参考MDN的文档: https://developer.mozilla.org/zh-CN/docs/Web/CSS/Pseudo-classes\n\n好了,讲完了.\n开始上手实践.\n选中你新建的span,添加一个新的规则.\n与之前不一样,你需要先修改他的选择器,在自动生成的选择器后添加\":hover\",并按下回车.\n你会发现整个规则都变灰了.\n这是因为没有选中这个元素,因为鼠标没有悬浮在上面.\n即使你将鼠标悬浮在上面,他也可能还是灰色的.这是因为浏览器没有及时刷新他的状态.\n但这不会影响样式生效,我们继续编辑样式.\n为了方便调试,我们可以使span一直保持\"被鼠标悬浮\"的状态.\n在加号旁边找到\":hov\"按钮,勾选\":hover\",即可让元素保持\"被鼠标悬浮\"的状态.\n\n\n\n\nhover.png (5.16 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 00:36 上传\n\n\n\n\n\n\n接下来就是要让勋章\"抬起\",我们推荐使用WebGL实现,因为效率更高...\n并不,大材小用了.\n我们将使用CSS的transform属性,对元素进行变形.\n使用transform提供的矩阵变换功能,可以很轻松的让勋章\"抬起\".\n由于该功能较为复杂,我们不在这里说明每一个数字都是干啥的,详细说明请参考这里: https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform-function/matrix3d (英文页面)\n不过也并不需要理解,点击数字,按上下键,即可即时的展示每一个参数的功能.\n慢慢调整可能有些麻烦,我们直接从MCBBS Extender里扒代码:transform: matrix3d(1, 0, 0, 0, 0, 1, 0, -0.003, 0, 0, 1, 0, 0, -1.5, 0, 0.9);复制代码\n解除掉:hover状态,移动鼠标指针到上面:\n\n\n\n\nhover2.gif (28.96 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 00:48 上传\n\n\n\n\n\n好像不大对.\n这是因为没有添加过渡动画.\n所以,在原先的规则(而非带:hover伪类的)里添加过渡动画参数:transition-duration: .3s;复制代码只需要指定动画时长,就可以非常简单的为元素添加过渡动画,这里指定了一个0.3秒的过渡时长.\n再把鼠标放上去:\n\n\n\n\nhover4.gif (31.56 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 00:54 上传\n\n\n\n\n\n差不多了.\n\"抬起\"之后,由于勋章离开了\"地面\",我们需要减淡他的阴影,直接扒MCBBS Extender调整好的阴影代码.\n在:hover的规则里将原先的阴影覆盖掉:box-shadow: 0px 2px 10px -3px black;复制代码\n再把鼠标放上去:\n\n\n\n\nhover5.gif (36.72 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 00:58 上传\n\n\n\n\n\n很好.\n\n接下来就是第二章了.\n\n #2 反光 \n你知道吗?前面一共有7000多个字节的说.\n花了我一个多小时的说.\n为了放松一下,这一小章会换一个文风的说.\n奇怪的口癖增加了的说(\n有了前面一章的知识,这一章的内容会比较简单的说.\n\n开始了哦.\n\n还记得上一章里说为啥要用span去替代img标签么?\n诶,不记得了么?\n真是的,没有好好听课嘛...\n下次一定要认真看哦.\nimg标签是一种特殊的元素,不像其他大多元素一样,img标签不允许拥有子元素.\n这就为后期向勋章上添加反光制造了麻烦.\n为什么说会\"制造了麻烦\"呢?\n反光其实只是叠在元素上的一层\"滤镜\",如果不能添加子元素,把\"滤镜\"叠在上面会非常的麻烦desu\n所以换成了span哦.\n\n事到如今,原先的img元素已经没有任何用处了,真是悲哀呢...\n所以,不如趁这个机会练习一下怎么删除元素desu\n点击Devtools里原先的img元素,按下键盘上的Delete就可以了哦.\n但是,你可知道元素的4中删除方法?\n不----告----诉----你----\n\n现在碍事的img已经消失了哦,现在就让勋章KiraKira的吧~\n\"滤镜\"也是一个元素,所以我们要把新的\"滤镜\"元素插进span里面哦~\n...\n听起来好糟糕的说...\n\n\n所以我们在这里使用其他的东西替代好了.\n铛铛铛铛~\n是时候让伪元素出场了!\n\n等等,你还记得伪类是什么么?\n...\n又没有认真看desu...\n我真的码了一个多小时啊...\n\n伪类提供了选中处于特殊状态元素的能力\n伪元素提供了在元素内创建不存在的元素的能力,而且十分优雅desu.\n伪元素有两个,before和after,为了让\"滤镜\"盖在勋章上,这里用的是after哦.\n\n我们就拿刚刚的span开始吧.\n创建伪元素,不需要直接编辑原来的DOM,只需要编写样式就可以了,十分便利desu:#md_107_new:after{\n/* ... */\n}复制代码\n直接在里面编写样式就可以为伪元素添加样式,但是伪元素在没有内容的情况下不会显示哦.\n怎么办呢,很简单哦:#md_107_new:after{\n        content: ''\n/* ... */\n}复制代码\n就可以让伪元素正常显示了哦.\n接下来就是添加反光\"滤镜\",滤镜的素材已经做好了哦,可以从这个链接获取desu: https://i.loli.net/2020/08/15/D3euvxyhY4iaMZG.png .\n然后让\"滤镜\"完全覆盖住勋章,在伪元素上添加这些样式desu:display: block;\nbackground-image: url(https://i.loli.net/2020/08/15/D3euvxyhY4iaMZG.png);\nwidth: 100%;\nheight: 100%;\ntransition-duration: .3s;\n复制代码\n就盖住了desu:\n\n\n\n\nreflect1.png (3.79 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 01:31 上传\n\n\n\n\n\n但是,不是应该\"抬起\"时反光更明显嘛...\n所以呢,要降低没有\"抬起\"时\"滤镜强度\",顺便加上过渡动画:opacity: 0.6;\ntransition-duration: .3s;复制代码\n就好了:\n\n\n\n\nreflect2.png (3.81 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 01:34 上传\n\n\n\n\n\n接下来,就是要增加\"抬起\"时的\"滤镜强度\"desu.\n直接用:hover伪类去选中\"被鼠标悬浮\"的伪元素就可以了嘛...#md_107_new:after:hover...复制代码\n然后往里面写样式,敲下回车!再把鼠标往上放!\n然而什么都没有发生.\n\n\n\n\nreflect3.gif (36.57 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 01:45 上传\n\n\n\n\n\n为什么嘛...\n\n\n\"我是伪元素,这样选是不行的啦,笨蛋.\"\n\"被骂笨蛋了...\"\n\"没关系啦,你不是选中了我的父元素再选中了我么,不如再选中'被悬浮'的父元素再选择我吧\"\n\"诶诶诶,是这样么?\"\n\"试试嘛.\"#md_107_new:hover:after{\n        opacity: 1;\n}复制代码\n好像...可以了诶...\n\n\n\n\nreflect5.gif (36.29 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 02:06 上传\n\n\n\n\n\n\n最后,为了模拟真实的反光,只要加上反光的视差效果就可以了哦.\n反射素材的光源是固定在勋章右上的,\"抬起\"时勋章会有更大的反射面积,所以只需要上下移动\"滤镜\"来模拟反射面积的改变就可以了哦:#md_107_new:after {\n        /* ... */\n        margin-top: -15px;\n}复制代码#md_107_new:hover:after {\n        /* ... */\n        margin-top: 0;\n}复制代码\nmargin-top就是用来移动\"滤镜\"距离顶部的位置的哦.\n再把鼠标放上去:\n\n\n\n\nreflect6.gif (45.67 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 01:56 上传\n\n\n\n\n\n\n终于...弄好了呢...KiraKira的...\n\n\n#2 结束\n\n\n\n\nH`M58}[BW)YPSM1T}5)~[YN.png (9.09 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 01:59 上传\n\n\n\n\n\n写了差不多三个小时呢...\n\n\n\n\nfile_1597428072000.jpg (78.66 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-15 02:01 上传\n\n\n\n\n\n素材也在桌面上堆成了小山(\n歌单也反反复复播放了四五遍...\n不过各位看得开心就好~\n晚安.\n",
    "replies": [
        {
            "author": "StreamReader",
            "timestamp": 1597444560,
            "txt_content": "只学过HTML和CSS表示只能看懂前半段\n话说最后几段代码也是css吧\n动画那一段果然是javascript做的，话说steam里面的集换式卡牌还有根据鼠标位置不同从而改变光照和抬起角度 大佬能做一个吗\n我虽然没学过js，但是你看看这种思路对不对：通过判断鼠标与图片的相对位置从而以数学关系计算出\"抬起的角度和方向\"，然后光源...\n只有margin我也不知道怎么弄\n\n\n果然是大佬 在我熟睡的时候偷偷码字"
        },
        {
            "author": "PercyDan",
            "timestamp": 1597452900,
            "txt_content": "看不懂css的路过"
        },
        {
            "author": "Zapic",
            "timestamp": 1597456260,
            "txt_content": "SHZLP 发表于 2020-8-15 06:36\n只学过HTML和CSS表示只能看懂前半段\n话说最后几段代码也是css吧\n动画那一段果然是javascript ...\n这次全都是CSS,没有用js.\nsteam那种效果确实可以用js做出来,思路也确实是像你说的那样.\n\nmargin这东西比较玄学,有时生效有时不生效,反正调整位置的时候都试一下就行:\nmargin>top,left>pos:abs,top,left"
        },
        {
            "author": "45gfg9",
            "timestamp": 1597456440,
            "txt_content": "谢谢 滚进收藏夹吃灰\n再过几天一定学css（"
        },
        {
            "author": "BigKillBla",
            "timestamp": 1597457640,
            "txt_content": "哇的天 大佬这是个什么东西"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1597458240,
            "txt_content": "前端带师！\n请您出书罢！！（震声）"
        },
        {
            "author": "ZJY2021",
            "timestamp": 1597458840,
            "txt_content": "只会玩MC的萌新真的看不懂.jpg"
        },
        {
            "author": "JohnnyLee0215",
            "timestamp": 1597458900,
            "txt_content": "不愧是你 ✌ 给大佬跪了"
        },
        {
            "author": "Оil",
            "timestamp": 1597466880,
            "txt_content": "【抽烟（不我不抽烟，我宁愿拿个艾草棒点了吸也不抽烟）】\n\n第二部分看了有种“极光creeper参与协同编辑”的赶脚。\n\n当然也顶多是有部分相似，如果是极光的话早就以“吾辈”自称了。\n\n文风还是蛮好分辨的，只不过突然可爱有点不适应。\n【和M18A1去贴贴吧（无感情）】"
        },
        {
            "author": "豆沙包的mc",
            "timestamp": 1597468920,
            "txt_content": " 本帖最后由 豆沙包的mc 于 2020-8-15 13:23 编辑 \n\n哇，原来是这么弄的，学到了…于是我去看了看我的勋章墙\n\n留下了不争气的眼泪，2019年注册现在只有一个勋章\n\n\n\n\n"
        }
    ]
}