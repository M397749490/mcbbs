{
    "title": "服务器linux脚本带崩溃重启自动备份",
    "author": "q59541511",
    "replyCount": 1,
    "timestamp": 1483537320,
    "txt_content": "要求:\nshell或者py都行能崩溃重启.\n每到2点定时关闭服务端备份.\n如果金粒不够我还可以加。\n",
    "replies": [
        {
            "author": "zts123456",
            "timestamp": 1483537320,
            "txt_content": "#!/bin/bash\nDIR=$HOME/mc # Minecraft Directory. Plz Modify this line before running. 先在这里修改你的MC目录，然后运行此脚本\nM_OLDPWD=$OLDPWD\nM_PWD=$PWD\nLOGDIR=$DIR/srvlog\nLOG=$LOGDIR/launcher.log\n[[ -d \"$LOGDIR\" ]] || ( mkdir \"$LOGDIR\" ; echo \"$(date)[Info]Created log directory.\">>$LOG )\ncd \"$DIR\"\necho \"$(date)[Info]Launching.\">>$LOG\nMCSTAT=0\nfalse\nwhile [[ \"$?\" != \"0\" || -f \"$DIR/restart.lck\" ]]; do\n    if [[ \"$MCSTAT\" == \"0\" ]]; then\n        echo \"$(date)[Info]Start server.\">>$LOG\n        MCSTAT=1\n    elif [[ -f \"$DIR/restart.lck\" ]]; then\n        echo \"$(date)[Info]Restart server.\">>$LOG\n        sleep 2\n    else\n        echo \"$(date)[Warn]Crashed. Restart server.\">>$LOG\n        sleep 10\n    fi\n    if [[ -f \"$DIR/restart.lck\" ]]; then\n        rm \"$DIR/restart.lck\"\n    fi\n    # Commands here will execute before launch\n    java -server -Xmx1024M -Djava.awt.headless=true -jar $DIR/craftbukkit.jar #这里看你的情况来改\ndone\necho \"$(date)[Info]Exit.\">>$LOG\ncd \"$M_PWD\"\nOLDPWD=$M_OLDPWD"
        }
    ]
}