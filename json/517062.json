{
    "title": "[CBL·lxy][1.8+] 实现stats记录多个实体执行信息",
    "author": "jack_lxy",
    "replyCount": 22,
    "timestamp": 1446028860,
    "txt_content": " 本帖最后由 jack_lxy 于 2015-10-28 19:40 编辑 \n\n事先声明本教程需要一定指令基础！！！\n时间原因来不及美化，改颜色什么的，有点枯燥，但是内容肯定是有用的！本作品1.8的14w28a之后就可以制作，但是没有tag的话探测就会比较烦，需要比较长的指令。所以我们在1.9中制作\n\n事实上stat可以绑定假名的实体，因此其实可以很简单完成。本帖是针对这个提出一种新的执行方法，针对不能这样使用的命令，应用不限于此，而是可以应用在很多其他的命令作品中。\n\n\n在1.9中的/stats可以直接调取命令的执行结果，相比之前版本，省去了很多冗杂的穷举工作，是CB的又一次重大加强，这大家应该已经知道。比如我们举一个例子：\n/stats entity @p AffectedBlocks 1 airCount复制代码/clone ~-5 ~-5 ~-5 ~5 ~5 ~5 ~-5 ~-5 ~-5 filtered move minecraft:air复制代码执行结果是这样的：409 blocks cloned复制代码同时，指定的变量被更新为409\n\n这样，当我对方块操作时就可以直接看见上一次执行的统计。\n\n但是，在如今的指令方块作品中，我们常常需要得到多个实体的执行信息。执行的目标实体是不确定的，实体数目也是巨大的，无法使用穷举法等一般方法。我们需要找到一种可以同时对多个实体进行自动绑定、执行指令并记录的系统。\n\n\n\n[red_wool]命令部分[pink_wool]\n先执行：\n/scoreboard players set 1 airCount 0复制代码给假名设初始值\n按照顺序执行：\n/scoreboard players tag @e[tag=airuseEntity,tag=!detected,c=1] add detect复制代码随机一个实体添加标签。这样，接下来的操作只针对这一个有标记的。！detected为了避免重复执行。\nairuseEntity是探测的范围。有这个tag后就会探测他。不用多管\n\n/stats entity @e[tag=detect] set AffectedBlocks 1 airCount复制代码为标记实体绑定stat，这样目标只有一个。\n\n/execute @e[tag=detect] ~ ~ ~ /clone ~-5 ~-5 ~-5 ~5 ~5 ~5 ~-5 ~-5 ~-5 filtered move minecraft:air复制代码通过EXE执行指令，执行探测。这里我探测的是周围空气的数量。探测的结果将会被输出至计分板。命令就不多说了\n\n/stats entity @e[tag=detect] clear AffectedBlocks 1 airCount复制代码探测后马上清除关联。避免兼容问题。\n\n/scoreboard players operation @e[tag=detect] airCount = 1 airCount复制代码把探测结果导出存储，这时是可以指定自己的。\n\n/scoreboard players tag @e[tag=detect] add detected复制代码/scoreboard players tag @e[tag=detected] remove detect复制代码打上另一个标记detected声明已经探测完毕，并清除临时标记detect。\n命令部分终\n\n\n接下来从头开始。将指定另一个没探测过的实体（！detected）进行同样动作，直到全部执行探测完毕后停止。\n效果：\n\n所有执行结果都被记录了。包括我自己。\n\n但是，所有都打上detected后就不会探测了。我们该怎样让它循环重复执行呢？\n只需要清除所有的detected标签就行了。自己搞个时钟隔几秒不断执行\n/scoreboard players tag @e remove detected复制代码效果保证亮瞎你的眼。所有实体实时旁边的空气量都会被不断刷新到变量。\n这样，我们就可以随便调用这些执行结果，用它做更多更酷的东西了。\n\n\n\n有些人可能不理解，我就再讲一遍。有时执行的实体只知道范围，却不知道具体，但是操作时又有较精细的要求，不能直接@e搞定。这时，我们需要单个单个的执行，但所有实体分别执行的顺序无关痛痒。因此我们先随机一个，执行完打上另外一个标签，这样下一次随机执行 就不会再 执行v 执行过的adj 实体。（不标词性怕你们看不懂，太绕了）直到全部执行完被标记。接着，只要重置这个标记就会立刻再进行一轮执行。\n\n但是，有个很严肃的问题……就是卡顿。由于执行量过大，同时探测太多就会连区块都加载不出来。。。本人电脑神机，还是会卡成狗。。。\n因此，我们得缩小范围。\n制作模组时有时只要探测玩家一段距离内的实体就有效果。因此我们多加点条件，一开始的命令变成：\n/execute @r ~ ~ ~ /scoreboard players tag @e[r=50,tag=airuseEntity,tag=!detected,c=1] add detect复制代码\n之探测玩家50格内，就远离卡顿了。效果依旧。\n\n\n本教程仅仅是个简单的例子。大家可以开脑洞制作出各种批量探测，没有做不出的东西。希望这个帖子能给你们帮助，促进更多的优秀CB作品诞生！\n\n教程完\n\n\n\n\n\n\n\n\n\n\n\n\n[groupid=546]Command Block Logic[/groupid]",
    "replies": [
        {
            "author": "superflat",
            "timestamp": 1446029580,
            "txt_content": "A.A\n有这功能了？\n9以下都不行，这个竟然行了"
        },
        {
            "author": "乾.坤",
            "timestamp": 1446030060,
            "txt_content": "好评，其实共用一个变量在1.8就有类似的做法了，最好能说说与1.8的区别，我记得似乎1.8也是可以将执行值绑定入某个假名的。。。吧还有指出两个小错误:即使能同事绑定多个实体事打错了，还有/stats entity@e set AffectedBlocks @e airCountentity@e中间应该有空格吧，总之无伤大雅2333，支持。"
        },
        {
            "author": "jack_lxy",
            "timestamp": 1446030120,
            "txt_content": " 本帖最后由 jack_lxy 于 2015-10-28 19:10 编辑 \n乾.坤 发表于 2015-10-28 19:01\n好评，其实共用一个变量在1.8就有类似的做法了，最好能说说与1.8的区别，我记得似乎1.8也是可以将执行值绑 ...\n谢谢！我马上修改，的确可以只是1.9更加精简，标题修改为了1.8+"
        },
        {
            "author": "qxdnfsy",
            "timestamp": 1446030420,
            "txt_content": "cb太吊，看不懂了"
        },
        {
            "author": "林扬骐",
            "timestamp": 1446030540,
            "txt_content": "我从来不知道clone可以这样用……"
        },
        {
            "author": "乾.坤",
            "timestamp": 1446030900,
            "txt_content": "jack_lxy 发表于 2015-10-28 19:02\n谢谢！我马上修改，的确可以只是1.9更加精简，标题修改为了1.8+\n恩，还有这个东西1.8似乎也可用吧"
        },
        {
            "author": "jack_lxy",
            "timestamp": 1446030960,
            "txt_content": "乾.坤 发表于 2015-10-28 19:15\n恩，还有这个东西1.8似乎也可用吧\n对的。不好意思，搞错了~~~"
        },
        {
            "author": "hear_brave",
            "timestamp": 1446032100,
            "txt_content": "玩控制台都已经超越红石了...."
        },
        {
            "author": "秋一",
            "timestamp": 1446032400,
            "txt_content": " 本帖最后由 acordome 于 2015-10-28 19:42 编辑 \n\n如图，我设置（变量名随便写的不要介意233）/stats entity @e[type=ArmorStand] set AffectedEntities @e[r=0] aircount复制代码\n然后执行/execute @e[rm=2] ~ ~ ~ testfor @e[r=3]复制代码\n得到这样的结果：\n\n\n\n\n\nQQ截图20151028193747.png (136.73 KB, 下载次数: 0)\n\n下载附件\n\n2015-10-28 19:39 上传\n\n\n\n\n\n\n按楼主的说法，@e[r=0]应该被识别为假名，然而我这边测试，的确是符合条件的选择器参数。\n\n"
        },
        {
            "author": "jack_lxy",
            "timestamp": 1446032520,
            "txt_content": "acordome 发表于 2015-10-28 19:40\n如图，我设置（变量名随便写的不要介意233）\n然后执行\n得到这样的结果：\n我也发现了这一点，所以这是一个失误，已经对帖子进行修改。"
        },
        {
            "author": "840196733mw",
            "timestamp": 1446033120,
            "txt_content": "原来不可@e怪不得我弄不成功"
        },
        {
            "author": "jack_lxy",
            "timestamp": 1446033300,
            "txt_content": "840196733mw 发表于 2015-10-28 19:52\n原来不可@e怪不得我弄不成功\n@e指定所有实体会出错，自己想想就明白了"
        },
        {
            "author": "840196733mw",
            "timestamp": 1446034380,
            "txt_content": "jack_lxy 发表于 2015-10-28 19:55\n@e指定所有实体会出错，自己想想就明白了\n2333，话说r=0到底可不可以，或者说c=1可不可以"
        },
        {
            "author": "呆瓜Domado",
            "timestamp": 1446034500,
            "txt_content": "这么说可以进行提成生物信息检测仪了，太好了~"
        },
        {
            "author": "lzs1234",
            "timestamp": 1446035400,
            "txt_content": "840196733mw 发表于 2015-10-28 20:13\n2333，话说r=0到底可不可以，或者说c=1可不可以\n选择器c参数在1.8有bug，1.9不知道有没有。\nc=1在命令方块中执行要加上r=0不然都会被识别为离CB最近的实体（无论有没有execute）\n其实r=0代表就是这个实体"
        },
        {
            "author": "lzs1234",
            "timestamp": 1446035640,
            "txt_content": "我记得我原来是用/stats entity @e XXX @e[c=1,r=0] SCB 来实现把所有实体的信息储存在这个实体的计分板上的……不过事先要预设0\nlz用1.9的tag好评，看到大堆计分板加减就头疼（倒不是不会，总之觉得太麻烦）"
        },
        {
            "author": "kongbaiyo",
            "timestamp": 1446036780,
            "txt_content": "qxdnfsy 发表于 2015-10-28 19:07\ncb太吊，看不懂了\n应该一条指令就能实现这个效果 stats工作原理其实是这样：给第一个实体加个nbt 记录的是一个选择器 这个选择器是以第一个实体为中心的 当这个实体执行一个命令之后 就会把这个命令的执行结果放到它所记录的选择器(以第一个实体为中心)所选择到的实体上去 所以说当执行/stats这个指令的时候 第二个选择器根本没有执行过 这里和scoreboard operation有区别 我的帖子里有写的样子 这个做个实验就可以证明了√"
        },
        {
            "author": "840196733mw",
            "timestamp": 1446038760,
            "txt_content": "lzs1234 发表于 2015-10-28 20:30\n选择器c参数在1.8有bug，1.9不知道有没有。\nc=1在命令方块中执行要加上r=0不然都会被识别为离CB最近的实 ...\n233，明白了（这是特性）\n\n\n\n坑爹的mojang，害的我学了半个月的stats因为执行失败而放弃"
        },
        {
            "author": "chyx",
            "timestamp": 1446046320,
            "txt_content": "lz真辛苦 可惜完全没必要 \n本来一下就能搞定"
        },
        {
            "author": "qxdnfsy",
            "timestamp": 1446064500,
            "txt_content": "kongbaiyo 发表于 2015-10-28 20:53\n应该一条指令就能实现这个效果 stats工作原理其实是这样：给第一个实体加个nbt 记录的是一个选择器 这个 ...\n。。。\n大部分的命令都不行，目前暂时不学cb了。。。"
        },
        {
            "author": "jack_lxy",
            "timestamp": 1446119100,
            "txt_content": "chyx 发表于 2015-10-28 23:32\nlz真辛苦 可惜完全没必要 \n本来一下就能搞定\n对啊，做完才发现。就当是一种思路，以后一定会用到的"
        },
        {
            "author": "RedStoneMC",
            "timestamp": 1446340200,
            "txt_content": "kongbaiyo 发表于 2015-10-28 20:53\n应该一条指令就能实现这个效果 stats工作原理其实是这样：给第一个实体加个nbt 记录的是一个选择器 这个 ...\n表示tag到底是什么鬼。。。1.8没见过，这是1.9的吗？是的话LZ为什么写是1.8+？"
        }
    ]
}