{
    "title": "服务器出现关于org.fusesource.jansi.WindowsAnsiOutputStream的错误之解决办法",
    "author": "andylizi",
    "replyCount": 41,
    "timestamp": 1454118240,
    "txt_content": " 本帖最后由 andylizi 于 2016-1-30 10:14 编辑 \n\n诶话说这帖子又触到哪个审核关键字了。。\n\n正题。\n以前开Cauldron服务器时，遇到个很奇怪的事情：在我自己电脑（Windows 7）上能正常运作的服务端，放到机房（Windows Server 2008）上就打不开了。启动时老是出现“Unable to instantiate org.fusesource.jansi.WindowsAnsiOutputStream”。然后就自动退出。百思不得其解。去问百度，翻了半天，最后在百度知道的一个提问里找到了答案。\n\n\n此问题出现的原因（看不懂的可以跳过直接到“解决方案”）\norg.fusesource.jansi是一个叫JAnsi的使用Native的Java库的包名。作者对这个包的描述是：Jansi is a small java library that allows you to use ANSI escape sequences to format your console output which works even on windows.通俗的说就是，在控制台中输出彩色文字。所有Bukkit和基于Bukkit的服务端都使用了这个包用于在控制台输出显示包含颜色代码的信息。我专门去jansi的repository看了看（地址），README里最后一段是：Windows XP UsersThe JNI library that JANSI uses depends on the \"Microsoft Visual C++ 2008 SP1 Redistributable\" You can get a free copy from MS at:http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=5582大意是，Windows的用户要想正常使用这个库，必须安装“Microsoft Visual C++ 2008 SP1 Redistributable“这个程序，才能正常使用。\n所以之前我感到奇怪的”我自己电脑上能正常运作的服务端，放到机房上就打不开了“就是因为，我自己电脑上除了MC还有各种其他程序，有些程序本来就需要Microsoft Visual C++ Redistributable，所以已经安装了这个运行库了，不会出现问题（还有些系统映像会内置在里面）。而机房是刚装的系统，而且就运行个服务端，自然不会想到需要啥运行库啦。\n\n\n解决方案1 【推荐】\n必须要安装”Microsoft Visual C++ 2008 SP1 Redistributable“？那就安装呗。不过需要注意的一点是，必须安装与你的Java位数相同版本的运行库。意思就是，如果你的Java是32位的，那么你必须安装32位的运行库才有效。如果你的Java是64位的，就必须安装64位的运行库。如果你不能肯定你的Java是几位，那就两个都装了吧。。没关系。其他很多程序都会用到这个运行库的。\n官方下载地址：\nMicrosoft Visual C++ 2008 Redistributable Package (x86)  【32位下载地址】\nMicrosoft Visual C++ 2008 Redistributable Package (x64)  【64位下载地址】\n重复：如果你的Java是32位的，那么你必须安装32位的运行库才有效。如果你的Java是64位的，就必须安装64位的运行库。如果你不能肯定你的Java是几位，那就两个都装了吧\n\n\n解决方案2\n关闭服务器，在服务器的启动脚本的启动命令的“-jar jar名字”参数之后（注意一定得放在-jar之后，否则就变成JVM参数了）添加程序参数\" --nojline\"\n如果你看不懂上面那就话，那就在启动命令”最后面“添加吧。这样总看得懂吧。。还是看不懂就看下面的梨子，啊呸，例子吧\n比如如果你的启动脚本原来是@echo off\njava -Xmx2G -jar spigot-1.7.2.jar\npause复制代码那么需要变为\n@echo off\njava -Xmx2G -jar spigot-1.7.2.jar --nojline\npause复制代码这个方法我没试过，不保证一定能行\n但这方法有个副作用：因为其原理是直接禁用jansi，所以控制台会变成黑白的，彩色代码会无效。\n\n以后再在问答版遇到这问题，直接找出这帖子把链接发上去就好。翻了半天问答版发现这种问题居然没一个人答对。。\n\n[groupid=324]上古之石美工工作组[/groupid]",
    "replies": [
        {
            "author": "Bryan33",
            "timestamp": 1455161220,
            "txt_content": "打破0回复\n\n话说我从来没遇到这个问题"
        },
        {
            "author": "andylizi",
            "timestamp": 1455175440,
            "txt_content": "a390807154 发表于 2016-2-11 11:27\n打破0回复\n\n话说我从来没遇到这个问题\n一般在家用机上不会有这个问题，，因为其他很多应用都需要这个运行库。这问题一般发生在服务器卖主单独给分出一个除了java啥都没装的虚拟机"
        },
        {
            "author": "云闪",
            "timestamp": 1455234000,
            "txt_content": "现在我知道有的服务端蹦出这玩意是什么意思了_(:_」∠)_不过我出现了这个仍然能启动服务器，或许水龙头要求不严_(:_」∠)_\n\n再问个问题_(:_」∠)_为啥同是水龙头核心，有的可以输出彩色文字有的却不行呢qwq(话说跟启动的bat有关吗)"
        },
        {
            "author": "andylizi",
            "timestamp": 1455258900,
            "txt_content": "splt 发表于 2016-2-12 07:40\n现在我知道有的服务端蹦出这玩意是什么意思了_(:_」∠)_不过我出现了这个仍然能启动服务器，或许水龙头要求 ...\n1、如果在启动命令最后面加入了 --nojline 参数，那么服务器就会不再使用jansi（彩字）和jline（控制台输入组件），这样就不需要那个运行库的支持，也就能正常启动服务器了。但是副作用就是：不能再显示彩色文字，控制台的输入提示符“> \"换为Java自带的输入方法\n2、如果没有那个运行库，有两种情况：无法开服，启动时出错 / 开服时出现错误提示但可以正常开启，无法显示彩字"
        },
        {
            "author": "云闪",
            "timestamp": 1455272940,
            "txt_content": "andylizi 发表于 2016-2-12 14:35\n1、如果在启动命令最后面加入了 --nojline 参数，那么服务器就会不再使用jansi（彩字）和jline（控制台输 ...\n如果没加--nojline参数且没出现这个错误提示_(:зゝ∠)_仍然没有彩字_(:зゝ∠)_是啥问题=￣ω￣="
        },
        {
            "author": "andylizi",
            "timestamp": 1455275760,
            "txt_content": "splt 发表于 2016-2-12 18:29\n如果没加--nojline参数且没出现这个错误提示_(:зゝ∠)_仍然没有彩字_(:зゝ∠)_是啥问题=￣ω￣= ...\n这个似乎没见过，，服务器所在的平台？\n还有你是怎么知道没有彩字的，，？本该有的地方没有么？"
        },
        {
            "author": "云闪",
            "timestamp": 1455278640,
            "txt_content": "andylizi 发表于 2016-2-12 19:16\n这个似乎没见过，，服务器所在的平台？\n还有你是怎么知道没有彩字的，，？本该有的地方没有么？ ...\n都是在我的电脑上测试的_(:зゝ∠)_\n嗯嗯没错，本该有的地方没有_(:зゝ∠)_另一个服务端就能显示彩字_(:зゝ∠)_偏偏那个不行_(:зゝ∠)_"
        },
        {
            "author": "Deater",
            "timestamp": 1455518280,
            "txt_content": "andylizi 发表于 2016-2-12 14:16\n这个似乎没见过，，服务器所在的平台？\n还有你是怎么知道没有彩字的，，？本该有的地方没有么？ ...\nwin sever 2012R2 在控制台打字变成其他字 无法正常输入文字什么情况 其他地方无法输入中文 需要复制黏贴过去"
        },
        {
            "author": "andylizi",
            "timestamp": 1455518640,
            "txt_content": "Deater 发表于 2016-2-15 14:38\nwin sever 2012R2 在控制台打字变成其他字 无法正常输入文字什么情况 其他地方无法输入中文 需要复制黏贴 ...\n首先检查一下控制台的编码（在cmd窗口的标题栏上右键——属性），看看是不是默认的GBK？\n如果不是，问百度怎么解决。如果是，还有这个情况，，，并且不止MC服务端，在命令提示符里输入任何中文都不行，那这是系统的锅问百度去。如果只是MC服务端，在启动参数最后面添加 -nojline \n哦对了，检查下你的输入法，有些输入法无法正常在cmd里打字"
        },
        {
            "author": "Deater",
            "timestamp": 1455519720,
            "txt_content": "andylizi 发表于 2016-2-15 09:44\n首先检查一下控制台的编码（在cmd窗口的标题栏上右键——属性），看看是不是默认的GBK？\n如果不是，问百 ...\n其他一切正常 试试添加-nojline  这个先"
        },
        {
            "author": "happyvalley",
            "timestamp": 1455521520,
            "txt_content": "说白就是安装VC++运行库\n\n这个貌似在所有的Cauldron与MCPC+的下载帖子都有写吧..."
        },
        {
            "author": "andylizi",
            "timestamp": 1455522180,
            "txt_content": "happyvalley 发表于 2016-2-15 15:32\n说白就是安装VC++运行库\n\n这个貌似在所有的Cauldron与MCPC+的下载帖子都有写吧... ...\n然而并没有，，至少我没见到过"
        },
        {
            "author": "happyvalley",
            "timestamp": 1455522420,
            "txt_content": "andylizi 发表于 2016-2-15 15:43\n然而并没有，，至少我没见到过\n但是那些制作整合包的没有一个人写了要安装"
        },
        {
            "author": "芒果苦力怕",
            "timestamp": 1458533520,
            "txt_content": "我研究过了\n在启动脚本下加入\nif exist \"plugins\\RestartEvolution\\restart.mcs\" goto MAIN\nif not exist \"plugins\\RestartEvolution\\restart.mcs\" goto END\n这两条就可以了"
        },
        {
            "author": "andylizi",
            "timestamp": 1458533640,
            "txt_content": "芒果苦力怕 发表于 2016-3-21 12:12\n我研究过了\n在启动脚本下加入\nif exist \"plugins\\RestartEvolution\\restart.mcs\" goto MAIN\n这两条唯一的功能就是RestartEvolution插件的崩溃重启，你确定?"
        },
        {
            "author": "芒果苦力怕",
            "timestamp": 1458533760,
            "txt_content": "andylizi 发表于 2016-3-21 12:14\n这两条唯一的功能就是RestartEvolution插件的崩溃重启，你确定?\n亲测可解决\n（你去试试不就知道了）"
        },
        {
            "author": "zhanshi123",
            "timestamp": 1463847540,
            "txt_content": "没有用怎么办，装了之后，虽然不显示这个了，但是还是显示什么一个问题在服务器启动器发生，求解"
        },
        {
            "author": "andylizi",
            "timestamp": 1463847660,
            "txt_content": "zhanshi123 发表于 2016-5-22 00:19\n没有用怎么办，装了之后，虽然不显示这个了，但是还是显示什么一个问题在服务器启动器发生，求解 ...\n给出详细信息"
        },
        {
            "author": "yjz1368568129",
            "timestamp": 1466726640,
            "txt_content": "我安装了两个运行库，但是服务器还是有那个报错（系统是windows server 2016）"
        },
        {
            "author": "Super_Wanzi",
            "timestamp": 1472176620,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "good12",
            "timestamp": 1472178360,
            "txt_content": "这个你也知道，我到现在才知道，厉害"
        },
        {
            "author": "不死之躯",
            "timestamp": 1472196660,
            "txt_content": "还是有点没看懂，能在简单说一下吗\n另外，你不是插件的版主吗，你是被撤职了吗"
        },
        {
            "author": "DME",
            "timestamp": 1472729100,
            "txt_content": "芒果苦力怕 发表于 2016-3-21 12:12\n我研究过了\n在启动脚本下加入\nif exist \"plugins\\RestartEvolution\\restart.mcs\" goto MAIN\n如果是租的淘宝的服务器 这代码文件的位置在哪里？求大神回复.."
        },
        {
            "author": "DME",
            "timestamp": 1472741160,
            "txt_content": "你说的方法2里的文件在哪里。。怎么打开。。"
        },
        {
            "author": "952298061",
            "timestamp": 1473821280,
            "txt_content": "请问您，我是淘宝租的服务器，出现无法实例化，怎么解决？{:10_566:}就为了加一个叫做精灵翅膀的MOD~~什么MOD都搞定了就他加上去就酱紫了！！"
        },
        {
            "author": "Z_Dreams_",
            "timestamp": 1478399760,
            "txt_content": "蛤，怪不得我控制台的黑白的"
        },
        {
            "author": "1137305770",
            "timestamp": 1479306060,
            "txt_content": "原来这个问题，怪说不得，我都换了好几个windows系统在vps，只有win 7启动勉强"
        },
        {
            "author": "1137305770",
            "timestamp": 1479465120,
            "txt_content": "没发现此问题，icraft服务器就算好"
        },
        {
            "author": "Aaron.Hzy",
            "timestamp": 1482658080,
            "txt_content": "为什么Linux面板服也有- -\nWARN Unable to instantiate org.fusesource.jansi.WindowsAnsiOutputStream复制代码"
        },
        {
            "author": "上官绝洛",
            "timestamp": 1484661420,
            "txt_content": "问题解决了 谢谢楼主！"
        },
        {
            "author": "shenhong000",
            "timestamp": 1494434520,
            "txt_content": "装了运行库 还是不行的"
        },
        {
            "author": "5595454",
            "timestamp": 1503478980,
            "txt_content": "问一下楼主，方案一是在那里安装运行库？"
        },
        {
            "author": "AlbertBlue",
            "timestamp": 1505479140,
            "txt_content": "终于解决了！"
        },
        {
            "author": "0战神0",
            "timestamp": 1506083460,
            "txt_content": "表示初学者看不懂，能更简单粗暴点吗？"
        },
        {
            "author": "MagicalLogic+",
            "timestamp": 1548509100,
            "txt_content": "你好，我用了你的方法1之后仍然出现一样的问题，请问有进一步的解决方案吗？"
        },
        {
            "author": "outtoutt",
            "timestamp": 1559208000,
            "txt_content": "啊哈，感谢啊！试着去解决"
        },
        {
            "author": "怪咖7",
            "timestamp": 1585019400,
            "txt_content": "楼主 我按照你的方法还是不行"
        },
        {
            "author": "抱枕丶蓝晨",
            "timestamp": 1585700040,
            "txt_content": "按照做了为什么仍然无法启动"
        },
        {
            "author": "woshirenaa",
            "timestamp": 1587637080,
            "txt_content": "如果是租的服务器该怎么解决这问题啊 启动脚本应该在哪里找啊"
        },
        {
            "author": "zhengyixuan.",
            "timestamp": 1587793500,
            "txt_content": "用了你的办法没用唉"
        },
        {
            "author": "dalaobbs",
            "timestamp": 1591927860,
            "txt_content": "感觉还是centos系统开服就没这些事了..."
        }
    ]
}