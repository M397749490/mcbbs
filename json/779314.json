{
    "title": "[NyaaCore]一个用于Spigot的前置插件及其简要说明",
    "author": "RecursiveG",
    "replyCount": 1,
    "timestamp": 1517803560,
    "txt_content": " 本帖最后由 RecursiveG 于 2018-2-5 12:18 编辑 \n\n这是啥？\nNyaaCore作为曾经的NyaaUtils的一部分，是我们在开发过程中提炼出来的一个库。\n它给我们的开发提供了不少便利，拯救了开发人员的大量脑细胞（和时间）。部分功能列举如下：\n基于注释的配置文件序列化基于注释的命令传递基于注释的简易ORM统一的I18n支持\n\n代码呢？\n1.配置序列化样例\n/**\n * 用于存储配置文件的类 \n */\npublic class Configuration extends PluginConfigure {\n    private final DemoPlugin plugin;\n\n    public Configuration(DemoPlugin plugin) {\n        this.plugin = plugin;\n    }\n\n    @Override\n    protected JavaPlugin getPlugin() {\n        return plugin;\n    }\n\n    @Serializable\n    public String language = \"en_US\"; // 配置项及默认值\n\n    // ... more items\n}\n\n/**\n * 插件主类\n */\npublic class DemoPlugin extends JavaPlugin {\n    public Configuration cfg;\n    \n    @Override\n    public void onEnable() {\n        this.cfg = new Configuration(this);\n        this.cfg.load(); // 服务器启动时载入配置文件\n    }\n\n    @Override\n    public void onDisable() {\n        this.cfg.save(); // 服务器停止时保存配置文件\n    }\n\n    private String changeLanguage(String newLang) {\n        String oldLang = this.cfg.language; // 直接访问配置项\n        this.cfg.language = newLang;        // 直接修改配置项\n        this.cfg.save();                    // 保存修改\n        return oldLang;\n    }\n}复制代码\n2.I18n\n/**\n * 继承LanguageRepository\n */\npublic class I18n extends LanguageRepository {\n    public static I18n instance = null;\n    private String lang = null;\n    private final DemoPlugin plugin;\n\n    @Override\n    protected JavaPlugin getPlugin() {\n        return plugin;\n    }\n\n    @Override\n    protected String getLanguage() { // 返回语言偏好\n        return lang;\n    }\n\n    public I18n(DemoPlugin plugin, String lang) {\n        instance = this;\n        this.plugin = plugin;\n        this.lang = lang;\n        load(); // 载入语言条目\n    }\n\n    public static String format(@LangKey String key, Object... args) { // 将getFormatted包装成静态方法\n        return instance.getFormatted(key, args);\n    }\n}\n\n@Override\npublic void onEnable() {\n    ...\n    cfg = new Configuration(this);\n    cfg.load();\n    this.i18n = new I18n(this, cfg.language);\n    ...\n}复制代码\n3.命令解析\npublic class CommandHandler extends CommandReceiver {\n    private final DemoPlugin plugin;\n\n    public CommandHandler(DemoPlugin plugin, ILocalizer i18n) {\n        super(plugin, i18n);\n        this.plugin = plugin;\n    }\n\n    @Override\n    public String getHelpPrefix() {\n        return \"\";\n    }\n\n    /**\n     * 输入“/<PLUGIN_COMMAND_NAME> debug test”即会回显当前世界名和“test”\n     */\n    @SubCommand(value = \"debug\", permission = \"demoplugin.debug\") // 定义子指令名和所需权限\n    public void debug(CommandSender sender, Arguments args) {\n        Player p = asPlayer(sender);    //强制要求为玩家\n        String str = args.nextString(); // 获得下一个参数\n        p.sendMessage(String.format(\"Current World: %s, Cmd Arg: %s\", p.getLocation().getWorld().getName(), str));\n    }\n}\n\n@Override\npublic void onEnable() {\n    ...\n    cmd = new CommandHandler(this, i18n);\n    getCommand(PLUGIN_COMMAND_NAME).setExecutor(cmd);\n    getCommand(PLUGIN_COMMAND_NAME).setTabCompleter(cmd);\n    ...\n}复制代码\n那么在哪里才能买的到呢？\n请前往Github的Release页面下载jar包：https://github.com/NyaaCat/NyaaCore\n更多用法（有文档的或是没文档的）请参考Github的Wiki页面和我们其他插件的代码。\n也可以在build.gradle中添加为依赖\nrepositories {\n    maven {\n        name 'NyaaCore'\n        url 'https://raw.githubusercontent.com/NyaaCat/NyaaCore/maven-repo'\n    }\n}\n\ndependencies {\n    compile('cat.nyaa:nyaacore:4.1-SNAPSHOT') {\n        transitive = false\n    }\n}复制代码\n另外，NyaaCore还依赖Vault和LangUtils\n其实并不好用嘛？\n嘛，毕竟小作坊产品日常滚(API)动(breaks)更(every)新(time)。\n欢迎各路大佬使用并开Issue/PR\n\nSpecial Thanks: @Librazy @OAO_miao @phoenixlzx \nPS：我几乎不会在论坛上及时更新内容，最新变化请至Github查看\n[Made by Nyaa Community]",
    "replies": [
        {
            "author": "etapc",
            "timestamp": 1569561300,
            "txt_content": "https://github.com/NyaaCat/NyaaCore/releases/"
        }
    ]
}