{
    "title": "问题已解决",
    "author": "WERKXXT",
    "replyCount": 16,
    "timestamp": 1589643840,
    "txt_content": " 本帖最后由 WERKXXT 于 2020-5-19 13:34 编辑 \n\n目前想制作类似这样的效果\n去spigot网站找到了Axis 事件打算使用PlayerItemConsumeEvent\n但是不会的是是保存传送前的坐标然后几秒后传送回去\n以及检测物品名称 如果名称正确使用则触发折跃效果\n希望大佬帮帮忙 能不能帮忙提一些建议和想法 帮忙解决一下！\nqwq",
    "replies": [
        {
            "author": "Ir.Nep",
            "timestamp": 1589646660,
            "txt_content": "记录传送前的坐标\n监听PlayerTeleportEvent，通过getCause()判断TeleportCause\n如果是末影珍珠就记录\n\n\n判断是否能折跃PlayerItemConsumeEvent获取消耗的物品进行判断并setCancelled"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589649120,
            "txt_content": "Ir.Nep 发表于 2020-5-17 00:31\n记录传送前的坐标\n监听PlayerTeleportEvent，通过getCause()判断TeleportCause\n如果是末影珍珠就记录\n我尝试写了一下获取 但是不知道为什么在if那一行会有红色波浪线报错 能否帮忙看一下（本人白中白）\n@EventHandler\n    public void tp (PlayerTeleportEvent event){\n        if (event.getCause(PlayerTeleportEvent.TeleportCause.ENDER_PEARL)) {\n            \n            \n        }复制代码"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589652780,
            "txt_content": "WERKXXT 发表于 2020-5-17 01:12\n我尝试写了一下获取 但是不知道为什么在if那一行会有红色波浪线报错 能否帮忙看一下（本人白中白）\n ...\n哦哦哦 经过一晚上的研究红色波浪线已经破了 那么请问如何制作保存坐标并且在指定的秒数后传送回去呢？"
        },
        {
            "author": "Ir.Nep",
            "timestamp": 1589674440,
            "txt_content": "最简单的方法是使用BukkitRunnable\n在传送事件里使用\nnew BukkitRunnable(){\n    public  void run(){\n        e.getPlayer().teleport(e.getFrom());\n    }\n}.runTaskLater(你的插件实例, 秒数*20);复制代码"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589692020,
            "txt_content": "Ir.Nep 发表于 2020-5-17 08:14\n最简单的方法是使用BukkitRunnable\n在传送事件里使用\n要用两个事件么？"
        },
        {
            "author": "Ir.Nep",
            "timestamp": 1589693760,
            "txt_content": "应用在PlayerTeleportEvent的监听中"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589695680,
            "txt_content": " 本帖最后由 WERKXXT 于 2020-5-17 15:04 编辑 \nIr.Nep 发表于 2020-5-17 13:36\n应用在PlayerTeleportEvent的监听中\n好的谢谢带佬顺便想问最后一个问题\n那串码子里的.runTaskLater的用法是怎样的？\n\n以及能不能帮我看看我的用法是否正确？public class test implements Listener {\n    private Object test;\n    @EventHandler\n    public void tp (PlayerTeleportEvent event) throws InterruptedException {\n        Player player = event.getPlayer();\n        if (event.getCause() == PlayerTeleportEvent.TeleportCause.ENDER_PEARL){\n            new BukkitRunnable(){\n                public void run(){\n                    event.getPlayer().teleport(event.getFrom());\n                }\n            }.runTaskLater((Plugin) test,3000);\n        }\n    }\n}复制代码这样的插件编译后投掷末影珍珠还是正常的 不知道是哪出了问题\n"
        },
        {
            "author": "William_Shi",
            "timestamp": 1589716140,
            "txt_content": "WERKXXT 发表于 2020-5-17 14:08\n好的谢谢带佬顺便想问最后一个问题\n那串码子里的.runTaskLater的用法是怎样的？\ntest这个主类实例获取是否正确？\n\n你在哪里给test赋值的？"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589727420,
            "txt_content": "William_Shi 发表于 2020-5-17 19:49\ntest这个主类实例获取是否正确？\n\n你在哪里给test赋值的？\n主类实例 应该都正确吧。。。\n下头的runTaskLater应输入的实例我研究了一下 有可能是错误的。。。\n话说test需要赋值么\n我好像并没有声明任何一个变量。。。\n（本人小白最近初学开发 如果有些话太弱智请大佬原谅qaq）"
        },
        {
            "author": "Ir.Nep",
            "timestamp": 1589775060,
            "txt_content": "1、是否注册了监听器test\n2、BukkitRunnable时间参数的单位是tick而非毫秒，1秒=20tick=1000毫秒，你的时间参数设定为3000，意味着玩家在使用末影珍珠传送后3000tick即150秒才会被传送回原来的位置，想来这并非你的本意\n3、你的private Object test参数指的是插件主类，那么你应该为这个类加一个构造器\npublic test(Plugin plugin){\n    this.test = plugin;\n}复制代码\n\n规范：类名要大写开头；\nBukkitRunnable不会抛出InterruptedException；\n要存储插件主类的实例，就应该用private Plugin testPlugin，既说明testPlugin是个插件实例，也省去你在执行BukkitRunnable时的强转操作"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589779320,
            "txt_content": "Ir.Nep 发表于 2020-5-18 12:11\n1、是否注册了监听器test\n2、BukkitRunnable时间参数的单位是tick而非毫秒，1秒=20tick=1000毫秒，你的时间 ...\n好的 谢谢大佬 我会尝试修改一下"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589806020,
            "txt_content": "不知道 为啥 报错[Server thread/ERROR]: Could not pass event PlayerTeleportEvent to Xiazuo v1.0-SNAPSHOT\norg.bukkit.event.EventException: null\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:320) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.java:70) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.plugin.SimplePluginManager.fireEvent(SimplePluginManager.java:529) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.java:514) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.EntityEnderPearl.a(EntityEnderPearl.java:81) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.EntityProjectile.tick(EntityProjectile.java:109) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.EntityEnderPearl.tick(EntityEnderPearl.java:121) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.WorldServer.entityJoinedWorld(WorldServer.java:568) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.World.a(World.java:745) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.WorldServer.doTick(WorldServer.java:344) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.MinecraftServer.b(MinecraftServer.java:1067) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.DedicatedServer.b(DedicatedServer.java:396) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.MinecraftServer.a(MinecraftServer.java:969) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at net.minecraft.server.v1_14_R1.MinecraftServer.run(MinecraftServer.java:814) [Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at java.lang.Thread.run(Unknown Source) [?:1.8.0_201]\nCaused by: java.lang.IllegalArgumentException: Plugin cannot be null\n        at org.apache.commons.lang.Validate.notNull(Validate.java:192) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.craftbukkit.v1_14_R1.scheduler.CraftScheduler.validate(CraftScheduler.java:443) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.craftbukkit.v1_14_R1.scheduler.CraftScheduler.runTaskTimer(CraftScheduler.java:176) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.craftbukkit.v1_14_R1.scheduler.CraftScheduler.runTaskTimer(CraftScheduler.java:167) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.craftbukkit.v1_14_R1.scheduler.CraftScheduler.runTaskLater(CraftScheduler.java:131) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at org.bukkit.scheduler.BukkitRunnable.runTaskLater(BukkitRunnable.java:79) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        at me.xiazuo.xiazuo.zheyue.test.tp(test.java:23) ~[?:?]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_201]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_201]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_201]\n        at java.lang.reflect.Method.invoke(Unknown Source) ~[?:1.8.0_201]\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:316) ~[Spigot-1.14.4.jar:git-Spigot-1981d55-3e7b386]\n        ... 14 more复制代码\n我的代码是public class test implements Listener {\n\n    private Plugin test1;\n\n    @EventHandler\n    public void tp (PlayerTeleportEvent event) throws InterruptedException {\n        Player player = event.getPlayer();\n        if (event.getCause() == PlayerTeleportEvent.TeleportCause.ENDER_PEARL){\n            player.teleport(event.getFrom());\n            new BukkitRunnable(){\n                public void run(){\n                    event.getPlayer().teleport(event.getFrom());\n                }\n            }.runTaskLater(test1,60);\n        }\n    }\n}复制代码\n搞得我很没有头绪 麻烦劳烦大佬如果可以的话 帮忙解答一下！\n感激不尽！"
        },
        {
            "author": "Ir.Nep",
            "timestamp": 1589809020,
            "txt_content": "WERKXXT 发表于 2020-5-18 20:47\n不知道 为啥 报错\n我的代码是\n搞得我很没有头绪 麻烦劳烦大佬如果可以的话 帮忙解答一下！Caused by: java.lang.IllegalArgumentException: Plugin cannot be null\n如我上面提到的第3点，因为你在监听类里面使用test1来存储插件主类，那么你需要为监听类加个构造器，在插件主类注册监听时把主类传入\n\n监听类：\npublic class test implements Listener {\n        private Plugin test1;\n\n        public test(Plugin pluginMain){\n                this.test1 = pluginMain;\n        }\n\n        @EventHandler\n        public void tp (PlayerTeleportEvent event) throws InterruptedException {\n                Player player = event.getPlayer();\n                if (event.getCause() == PlayerTeleportEvent.TeleportCause.ENDER_PEARL){\n                        player.teleport(event.getFrom());\n                        new BukkitRunnable(){\n                                public void run(){\n                                        event.getPlayer().teleport(event.getFrom());\n                                }\n                        }.runTaskLater(test1,60);\n                }\n        }\n}复制代码\n\n主类：\n\n@Override\npublic void onEnable(){\n        getServer().getPluginManager().registerEvents(new test(this), this);\n}\n复制代码"
        },
        {
            "author": "William_Shi",
            "timestamp": 1589864040,
            "txt_content": "WERKXXT 发表于 2020-5-18 20:47\n不知道 为啥 报错\n我的代码是\n搞得我很没有头绪 麻烦劳烦大佬如果可以的话 帮忙解答一下！\n早就提醒了\n\ntest这个主类实例 有问题\n\n建议你使用 PluginManager#getPlugin（你的插件名字）\n这个方法获取主类实例\n\n当然方法很多\n\n只不过这个是什么地方通用的\n\n不需要用构造函数（构造函数必须要类名，】\n你的类，命名很混乱啊\n"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589866380,
            "txt_content": "Ir.Nep 发表于 2020-5-18 21:37\n如我上面提到的第3点，因为你在监听类里面使用test1来存储插件主类，那么你需要为监听类加个构造器，在 ...\n真正的解决了 太谢谢大佬了！受教了！"
        },
        {
            "author": "WERKXXT",
            "timestamp": 1589887500,
            "txt_content": "William_Shi 发表于 2020-5-19 12:54\n早就提醒了\n\ntest这个主类实例 有问题\n命名都是随便起的 还没想着认真起 所以一般结果没出来前命名都是想怎么起就怎么起\n主类实例我是真没想到哈哈 所以一直没有头绪 不过都多亏了大佬们的帮助\n谢谢提醒！"
        }
    ]
}