{
    "title": "[管理|安全]GamemodeLock —— 游戏模式锁，方便的游戏模式管理插件[全版本]",
    "author": "Greensky",
    "replyCount": 14,
    "timestamp": 1435713300,
    "txt_content": " 本帖最后由 henry5041 于 2019-7-31 13:48 编辑 \n\nGamemodeLock\n\n还在为服务器中创造到处飞难以管理而发愁吗？此插件允许你通过控制玩家权限以管理玩家游戏模式，方便地管理玩家的游戏模式。\n\n特性\n游戏模式权限化，即玩家只有在有某一游戏模式的权限时才能切换到某一游戏模式，如果没有这一权限则会被设置回原来的游戏模式。注意：此插件涉及玩家游戏模式更改，如发现bug请务必第一时间反馈，谢谢。\n权限\ngamemode.creative - 玩家使用创造模式的权限gamemode.survival - 玩家使用生存模式的权限（所有玩家默认拥有，如果你想让玩家限制在冒险模式的话可以取消此权限）gamemodelock.bypass - 无视此插件功能的权限，op默认拥有gamemodelock.command - 使用/gamemodelock指令的权限\n使用方法\n首先安装插件。\n\n如果你想要给玩家创造模式权限的话：\n先给予想要给创造模式的玩家gamemode.creative权限，再设置玩家游戏模式。（若不先给权限的话则无法）\n对于使用GroupManager组权限插件的服务器来说，上述权限可以简单地通过以下指令给予：\n/manuaddp [想给权限的玩家] gamemode.creative复制代码\n\n如果想要取消玩家创造模式权限的话：\n先删除玩家的gamemode.creative权限，再使用/gamemodelock刷新插件。\n对于使用GroupManager组权限插件的服务器来说，上述权限可以简单地通过以下指令删除：\n/manudelp [想给权限的玩家] gamemode.creative复制代码\n\n如果你想取消玩家生存模式权限的话：\n先使用以下指令:\n/manuaddp [想给权限的玩家] -gamemode.survival复制代码\n再使用/gamemodelock指令来刷新游戏模式。\n\n（请不要跟我提旁观者模式，我使用的包版本太旧了没这东西）\n指令\n/gamemodelock - 用于在修改玩家游戏模式权限后刷新插件以应用新的权限\n\n下载\n\n\n\nGamemodeLock-0.0.1.jar\n(16.51 KB, 下载次数: 312)\n\n\n\n2015-6-30 22:37 上传\n点击文件名下载附件\n\n\n\n\n\n\n如果喜欢这个插件的话，请在百忙之中回复这一句，我将不胜感激：\n支持GamemodeLock，支持Henry5041！希望此插件越做越成功！复制代码\n卧槽居然把上一个帖子没有改直接放过来了我在想些什么…\n\n源代码\n（我没那个功夫放到github上，你们将就着看吧）\npackage org.greensky.gamemodelock;\n\nimport java.io.IOException;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.GameMode;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.EventPriority;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.PlayerGameModeChangeEvent;\nimport org.bukkit.event.player.PlayerJoinEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.mcstats.Metrics;\n\npublic final class GamemodeLock extends JavaPlugin implements Listener {\n        @Override\n        public void onEnable() {\n                // TODO Insert logic to be performed when the plugin is enabled\n                for (Player player : Bukkit.getServer().getOnlinePlayers()) {\n                        if (!player.hasPermission(\"gamemodelock.bypass\")) {\n                                switch (player.getGameMode()) {\n                                case CREATIVE:\n                                        if (!player.hasPermission(\"gamemode.creative\")) {\n                                                if (player.hasPermission(\"gamemode.survival\")) {\n                                                        player.setGameMode(GameMode.SURVIVAL);\n                                                } else {\n                                                        player.setGameMode(GameMode.ADVENTURE);\n                                                }\n                                        }\n                                        break;\n                                case SURVIVAL:\n                                        if (!player.hasPermission(\"gamemode.survival\")) {\n                                                if (player.hasPermission(\"gamemode.creative\")) {\n                                                        player.setGameMode(GameMode.CREATIVE);\n                                                } else {\n                                                        player.setGameMode(GameMode.ADVENTURE);\n                                                }\n                                        }\n                                        break;\n                                default:\n                                }\n                        }\n                }\n                getServer().getPluginManager().registerEvents(this, this);\n\n                try {\n                        Metrics metrics = new Metrics(this);\n                        metrics.start();\n                } catch (IOException e) {\n                        // Failed\n                        getLogger().info(\"enable metrics failed\");\n                }\n\n        }\n\n        @EventHandler(priority = EventPriority.HIGH)\n        public void onPlayerJoinEvent(PlayerJoinEvent event) {\n\n                // Your code here...\n                Player player = event.getPlayer();\n                player.sendMessage(\"You have logged in\");\n                if (!player.hasPermission(\"gamemodelock.bypass\")) {\n                        switch (player.getGameMode()) {\n                        case CREATIVE:\n                                if (!player.hasPermission(\"gamemode.creative\")) {\n                                        if (player.hasPermission(\"gamemode.survival\")) {\n                                                player.setGameMode(GameMode.SURVIVAL);\n                                        } else {\n                                                player.setGameMode(GameMode.ADVENTURE);\n                                        }\n                                }\n                                break;\n                        case SURVIVAL:\n                                if (!player.hasPermission(\"gamemode.survival\")) {\n                                        if (player.hasPermission(\"gamemode.creative\")) {\n                                                player.setGameMode(GameMode.CREATIVE);\n                                        } else {\n                                                player.setGameMode(GameMode.ADVENTURE);\n                                        }\n                                }\n                                break;\n                        default:\n                        }\n                }\n\n        }\n\n        @EventHandler\n        public void onPlayerGameModeChangeEvent(PlayerGameModeChangeEvent event) {\n\n                Player player = event.getPlayer();\n                player.sendMessage(\"You have changed game mode\");\n                if (!player.hasPermission(\"gamemodelock.bypass\")) {\n                        switch (event.getNewGameMode()) {\n                        case CREATIVE:\n                                if (!player.hasPermission(\"gamemode.creative\")) {\n                                        event.setCancelled(true);\n                                }\n                                break;\n                        case SURVIVAL:\n                                if (!player.hasPermission(\"gamemode.survival\")) {\n                                        event.setCancelled(true);\n                                }\n                                break;\n                        default:\n                        }\n                }\n\n        }\n\n        @Override\n        public boolean onCommand(CommandSender sender, Command cmd, String label,\n                        String[] args) {\n                if (cmd.getName().equalsIgnoreCase(\"gamemodelock\")) {\n                        for (Player player : Bukkit.getServer().getOnlinePlayers()) {\n                                if (!player.hasPermission(\"gamemodelock.bypass\")) {\n                                        switch (player.getGameMode()) {\n                                        case CREATIVE:\n                                                if (!player.hasPermission(\"gamemode.creative\")) {\n                                                        if (player.hasPermission(\"gamemode.survival\")) {\n                                                                player.setGameMode(GameMode.SURVIVAL);\n                                                        } else {\n                                                                player.setGameMode(GameMode.ADVENTURE);\n                                                        }\n                                                }\n                                                break;\n                                        case SURVIVAL:\n                                                if (!player.hasPermission(\"gamemode.survival\")) {\n                                                        if (player.hasPermission(\"gamemode.creative\")) {\n                                                                player.setGameMode(GameMode.CREATIVE);\n                                                        } else {\n                                                                player.setGameMode(GameMode.ADVENTURE);\n                                                        }\n                                                }\n                                                break;\n                                        default:\n                                        }\n                                }\n                        }\n                        sender.sendMessage(\"Game mode locked\");\n                        return true;\n                } // If this has happened the function will return true.\n                        // If this hasn't happened the value of false will be returned.\n                return false;\n        }\n}\n复制代码\n\n后记\n中考刚结束，正好有时间把一直以来想写的插件写出来，希望这个插件能对大家有用。因为是赶制出来的，插件里面的提示信息不太清晰，不过插件功能也不复杂，根据这里的教程使用即可。",
    "replies": [
        {
            "author": "矿工小周",
            "timestamp": 1435713540,
            "txt_content": " 本帖最后由 矿工小周 于 2015-7-1 09:36 编辑 \n\n支持GamemodeLock，支持Henry5041！希望此插件越做越成功！"
        },
        {
            "author": "onijiri",
            "timestamp": 1435713660,
            "txt_content": "好棒的插件啊，真的幸苦了服主(≧▽≦)！Onijiri前排支持！"
        },
        {
            "author": "2285214727",
            "timestamp": 1435715580,
            "txt_content": "前排支持\n出售爆米花"
        },
        {
            "author": "可可可可可乐",
            "timestamp": 1435715760,
            "txt_content": "不错，手机看源代码乱成一排。。。功能赞，回家电脑看看"
        },
        {
            "author": "爱拍丿刀锋",
            "timestamp": 1440430080,
            "txt_content": "支持GamemodeLock，支持Henry5041！希望此插件越做越成功！"
        },
        {
            "author": "枫影绝尘",
            "timestamp": 1444228440,
            "txt_content": "非常不错的插件，正好解决了服务器的问题！"
        },
        {
            "author": "枫影绝尘",
            "timestamp": 1444228440,
            "txt_content": "非常不错的插件，正好解决了服务器的问题！"
        },
        {
            "author": "MC_apple",
            "timestamp": 1444557600,
            "txt_content": "不错      "
        },
        {
            "author": "xiazai",
            "timestamp": 1451812080,
            "txt_content": "能解决mv多世界切换世界游戏模式更新么"
        },
        {
            "author": "啊木哥",
            "timestamp": 1451812260,
            "txt_content": "支持原创，希望楼主继续加油"
        },
        {
            "author": "XueRe",
            "timestamp": 1578239700,
            "txt_content": "谢谢楼主分享~~"
        },
        {
            "author": "Mark666",
            "timestamp": 1578492480,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "1260755449",
            "timestamp": 1581481440,
            "txt_content": "谢谢分享  支持原创"
        },
        {
            "author": "Jasonloin",
            "timestamp": 1609471500,
            "txt_content": "不错的插件"
        }
    ]
}