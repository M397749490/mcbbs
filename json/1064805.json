{
    "title": "[管理]OhMyCmd —— 付费命令/世界限制 | 用脚本写自定义命令[1.7-1.15]",
    "author": "蕾米洛伊",
    "replyCount": 6,
    "timestamp": 1592661720,
    "txt_content": " 本帖最后由 蕾米洛伊 于 2020-6-22 16:31 编辑 \n\n\n\n\n\n\nimage.png (60.44 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-20 21:57 上传\n\n\n\n\n\nOhMyCmd!命令付费 | 世界限制 | 脚本自定义指令 | 命令管理\n\n\n# OhMyCmd 可以做什么?\n1. 命令以参数为粒度匹配, 支持通配符。领地TP付费, 领地设置特定权限付费, warp到指定地点需付费都不在话下;2. 不再受限于单个限制, 支持多限制。比如只有特定权限/等级玩家才能传送到某副本/世界等.3. 甚至可以通过本插件的脚本自己写命令。 没有ess想用/suicide? 没问题! 想让玩家通过 /副本 xxx /世界 xxx 快捷输入命令? 没问题!4. 支持与 JavaScript 或网站进行交互! (返回值可以看的清 清 楚 楚)\n\nStep 1. 我就是想单个命令付费/世界限制, 我要怎么写?\n\"res tp +*\":\n  requirements:\n    - \"如果: {玩家是否OP} == true\"\n    - \"是否在世界: survival_world\"\n    - \"检测是否足够经济然后直接扣费: 1.00\"\n这个配置可以做到对领地 res tp xxx... 的命令扣费, 对OP玩家和在 survival_world 世界的玩家免除费用.\nAttention! 当您写下多个限制时, 插件只要求命令执行的玩家满足一个即可, 而不是所有限制必须全部满足。\n如果有其他免扣费的条件, 必须写在扣费指令之前, 否则会优先扣费!\n\"res tp +*\":\n  requirements:\n    - \"是否在世界: survival_world\"\n这个配置可以做到玩家只能在 survival_world 世界里执行 res tp xxx...\n\n\nStep 2. 写一个领地TP付费吧!\n\n# 每传送一次领地就花费1元, 否则不传送\n# 下面的条件, 意味着任何以 /res tp 开头的指令都会被拦截。\n# +* 的意思是向后通配符, 匹配后面的所有参数\n  \"res tp +*\":\n    requirements:\n      # |-> 如果玩家是OP忽略扣费直接进行\n      - \"如果: {玩家是否OP} == true\"\n      # |-> 或者玩家在生存世界, 就可以免费 res tp\n      - \"是否在世界: survival_world\"\n      # |-> 或者玩家为此支付1元, 如果玩家经济不足一元会直接阻挡命令执行\n      - \"检测是否足够经济然后直接扣费: 1.00\"\n    # --> on-toggle 字段可以省略\n    on-reject:\n      - \"私聊: &&c进入领地 >{命令参数:2}< 需要 1 元经济, 你没有足够的钱!\"\n      # {命令参数:2} 代表命令用空格分隔的第三个字符, 在这里是领地的名字\n这是在配置文件里的一个例子, 你可以下载插件之后直接输入 /res tp xx 体验\n玩家没有足够钱的效果:\n\n\n\nStep 3. 我想自定义一个 /suicide 指令试试!\n\n\"suicide\":\n    # 执行命令的必要条件, 满足下列其一才会执行\n    requirements:\n      # |-> 如果玩家名是 Saber 就可以直接执行命令\n      - \"如果: {玩家} == Saber\"\n      # |-> 或者如果玩家金钱够1,就满足条件,并直接扣费,否则不会执行\n      - \"检测是否足够经济然后直接扣费: 1.00\"\n    on-toggle:\n      # 杀.死这个操作, 可以忽略参数, 默认只对执行命令的玩家有效果。\n      - \"杀.死\"\n      - \"私聊: &&e再见, 世界!\"\n      - \"广播: &&6{玩家} 结束了他自己的生命\"\n      - \"阻止命令继续执行\"\n      # |-> 如果你在自定义命令, 必须要先或者在最后阻止命令继续执行\n    on-reject:\n      - \"私聊: &&c这么做需要花费你 1 元钱! 你没有足够的钱!\"\n      - \"条件执行: (如果:{玩家游戏模式} == creative) {私聊:&&c你是神，不能xx!}\"\n这是在配置文件里的一个例子, 你可以下载插件之后直接输入 /suicide 体验另: 那个xx是为了避免屏蔽词2333\n\n\nStep 4. 人生苦短, 我用Pyt.. JS! 写一个 /motd 吧!\n\n\"motd\":\n    # --> requirements 省略后, 这个指令所有人都不能执行\n    requirements:\n      # |-> 这么写, 让所有人都可以执行这个指令\n      - \"直接返回: true\"\n    on-toggle:\n      - \"JS执行: (string) '今天的日期是: '+new Date()\"\n      # |-> 运行JS之后的结果将输出到变量 {执行结果}\n      - \"私聊: &&6欢迎来到服务器! {执行结果}\"\n      - \"阻止命令继续执行\"\n这是在配置文件里的一个例子, 你可以下载插件之后直接输入 /motd 体验\nAttention: 我们来看看如何调用 JavaScript\n语法是: javascript: (string/bool) JS代码....\n中间的 (string) (bool) 用于定义本JS的返回值, 如果JS代码返回布尔值, 那么就需要 (bool), 字符串则为 (string)\n然后, 你就可以愉快地使用 {执行结果} 或者 {result} 调用JS返回值了!\n效果:\n\n\n\nStep 5. 用上更多语法: 做个没有灵.魂的结婚指令咋样\n\n这一次我们挑战一把纯英文写指令!\n把下面的替换成中文也是可以执行的!\n\"marry *\":\n    requirements:\n      # 是否有权限\n      - \"haveperm: ohmycmd.marry\"\n      - \"if: {player_isop} == true\"\n    on-toggle:\n      # 控制台执行 console:\n      - \"console: tp {player} {命令参数:1}\"\n      - \"broadcast: &&b{player} married with {命令参数:1}\"\n      - \"playsound: ENTITY_BLAZE_BURN\"\n      - \"javascript: (string) (new Date()).toString()\"\n      - \"tell: &&cYou married with {命令参数:1} on {result}!\"\n      # 向某个URL发起 GET 请求, 可通过 {执行结果} 获得返回的数据\n      - \"http get: h ttps://baidu.com\"\n      # 自定义指令最后需要阻止命令继续执行, 否则会出现 Unknown command.\n      - \"setcancel\"\n这是在配置文件里的一个例子, 你可以下载插件之后直接输入 /marry 玩家ID 体验\n效果:\n\n\n\nStep6. 体验一把通配符: 制作必须是OP才能为某领地设置权限的规则\n\n首先我们知道, 设置领地权限的指令是 res pset [玩家ID] [领地名称] [权限] [true/false] 对吧\n# 这里的意思是, 只要玩家执行\n  # /res pset [随便填什么] OPRes xxx true/false/t/f\n  # 都会被检测，比如\n  # /res pset hypergryph OPRes move true, /res pset notch OPRes health false\n  # 以上指令都会被检测到\n  \"res pset * OPRes * *\":\n    requirements:\n      # 只有是OP才会允许执行\n      - \"如果: {玩家是否OP} == true\"\n    on-reject:\n      - \"私聊: &&c只有OP才能为OPRes领地设置玩家权限!\"\n其实这个例子比较鸡肋，可以按照这个逻辑来配置其它你需要的逻辑\n效果: 迷hotel，尝一尝甜不甜啊，哎，没吃呢\n\n\n\n当然实际上 Loiscript/OhMyCmd 有更多内建指令, 支持对玩家做更多事♂情, 在下一页可以看到文档.\n\n# OhMyCmd 指令\n\n> /ohmycmd 或 /ohcmd\n/ohmycmd <reload/test> [测试指令,不需要/]\n\n/ohmycmd reload: 重载\n/ohmycmd test: 测试某个指令, 可显示出命令被解析的详细过程, 由于大部分指令需要事件作为上下文, 所以很多东西实际上用不了, 之后会逐步完善\n如: /ohmycmd test res tp xxx\n\n# OhMyCmd 权限\nohmycmd.command:\n  使用 OhMyCmd 指令\n 默认所有玩家拥有\nohmycmd.bypass:\n  拥有此权限的人将不会被本插件影响\n  默认无人拥有, 因为会影响自定义指令\nohmycmd.test:\n  使用 /ohmycmd test 指令测试命令\n  默认OP\nohmycmd.reload:\n  可以重载本插件\n  默认OP\n\n# 配置文件\nsettings:\n  # 我们希望通过 bStat 了解都有谁在使用这个插件\n  # 您可在我们的 bStat 页面上了解统计信息\n  # 设置下面的值为 false, 禁止 bStat 传输您的使用统计\n  allow-bstats: true\n\n# 启用的命令拦截器列表,\n# 写完拦截器后, **请一定不要忘记** 把它添加在这里！！！\n# 写完拦截器后, **请一定不要忘记** 把它添加在这里！！！\n# 写完拦截器后, **请一定不要忘记** 把它添加在这里！！！\nenabled-listeners:\n  - \"suicide\"\n  - \"res tp +*\"\n  - \"motd\"\n  - \"marry *\"\n  - \"传送领地 *\"\n\n# 定义命令\nlistener:\n  \"suicide\":\n    # 执行命令的必要条件, 满足下列其一才会执行\n    requirements:\n      # |-> 如果玩家金钱够1,就满足条件,并直接扣费,否则不会执行\n      - \"检测是否足够经济然后直接扣费: 1.00\"\n      # |-> 或者如果玩家名是 Saber 就可以直接执行命令\n      - \"如果: {玩家} == Saber\"\n    on-toggle:\n      - \"杀死: {player}\"\n      - \"私聊: &&e再见, 世界!\"\n      - \"广播: &&6{player} 结束了他自己的生命\"\n      - \"阻止命令继续执行\"\n      # |-> 如果你在自定义命令, 必须要先或者在最后阻止命令继续执行\n    on-reject:\n      - \"私聊: &&c这么做需要花费你 1 元钱!\"\n      - \"条件执行: (如果:{玩家游戏模式} == creative) {私聊:&&c你是神，不能xx!}\"\n\n  # 每传送一次领地就花费1元, 否则不传送并且播放打龙音效\n  # 下面的条件, 意味着任何以 /res tp 开头的指令都会被拦截。\n  # +* 的意思是向后通配符, 匹配后面的所有参数\n  \"res tp +*\":\n    requirements:\n      # |-> 如果玩家是OP忽略扣费直接进行\n      - \"如果: {玩家是否OP} == true\"\n      # |-> 或者玩家为此支付1元, 如果玩家经济不足一元会直接阻挡命令执行\n      - \"检测是否足够经济然后直接扣费: 1.00\"\n      # |-> 或者玩家在生存世界, 就可以免费 res tp\n      - \"是否在世界: survival_world\"\n    # --> on-toggle 字段可以省略\n    on-reject:\n      - \"私聊: &&c进入领地 >{命令参数:2}< 需要 1 元经济!\"\n      # {命令参数:2} 代表命令用空格分隔的第三个字符, 在这里是领地的名字\n\n  \"motd\":\n    # --> requirements 省略后, 这个指令所有人都不能执行\n    requirements:\n      # |-> 这么写, 让所有人都可以执行这个指令\n      - \"直接返回: true\"\n    on-toggle:\n      - \"JS执行: (string) '今天的日期是: '+new Date()\"\n      # |-> 运行JS之后的结果将输出到变量 {执行结果}\n      - \"私聊: &&6欢迎来到服务器! {执行结果}\"\n      - \"阻止命令继续执行\"\n\n  # 你还可以通过 OhMyCmd 定义中文快捷指令\n  \"传送领地 *\":\n    requirements:\n      - \"直接返回: true\"\n    on-toggle:\n      - \"玩家执行: res tp {命令参数:2}\"\n      - \"阻止命令继续执行\"\n\n  # 试试用纯英文做个指令?\n  \"marry *\":\n    requirements:\n      - \"haveperm: ohmycmd.marry\"\n      - \"if: {player_isop} == true\"\n    on-toggle:\n      - \"console: tp {player} {命令参数:1}\"\n      - \"broadcast: &&b{player} married with {命令参数:1}\"\n      - \"playsound: ENTITY_BLAZE_BURN\"\n      - \"javascript: (string) (new Date()).toString()\"\n      - \"tell: &&cYou married with {命令参数:1} on {result}!\"\n      - \"http get: <a href=\"https://baidu.com\" target=\"_blank\">https://baidu.com</a>\"\n      - \"setcancel\"\n\n\n我的代码水平比较菜233, 可能会出现各种各样奇怪的 bug, 如果发现欢迎各位提交!另外, 请尽量避免过多使用 JavaScript, 目前 loiscript 尚未做到复用 ScriptEngine, 可能会有性能损耗, 当然代码少的话可以忽略。\n感谢下载！\n\n# 下载！\n\n\n\nOhMyCmd-v1.1.jar\n(81.73 KB, 下载次数: 20)\n\n\n\n2020-6-20 21:58 上传\n点击文件名下载附件\n\n\n\n\n\n\n由于是实时解析的脚本, 所以理论上全版本通用, 老版本不支持某些变量, 只有使用时会报错。\n\n\n\n\n\n\nimage.png (12.14 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-20 21:59 上传\n\n\n\n\n如果帮到你的话, 就评个分吧 (雾)本插件所用所有代码均为原创,不存在借用/抄袭等行为\n\n\n\n以下是脚本原生支持的语法:\nif: xxx ==(!=) xxx\nset: 变量名 值...\nprintln: 消息\njavascript: (bool/string/boolean) 代码...\n  参数分两段以空格分隔 第一段声明后面一段代码的返回值 可通过 {result} 调用 返回值不正确会导致报错\nif then: (返回布尔值的某个语句 (如 \"if: hello == hello\") ) {执行的代码1;执行的代码2...}\n  如果那么, 如果括号中语句返回为true, 那么执行花括号中的语句, 以;分割\nreturn: true/false\n  直接返回\n\n插件支持的额外语法:\n\n私聊: xxxxx..\n  给执行命令的玩家发送私聊消息\n杀.死\n  kill 执行命令玩家\n阻止命令继续执行\n  取消事件, 如果你有自定义指令务必在语句的最前或最后执行这个, 防止出现 Unknown command\n广播: xxxx...\n  世界广播消息\n检测是否足够经济然后直接扣费: x.xx\n  首先检测玩家是否足够经济, 如果不够直接返回否(阻止执行指令), 够就直接扣费\n给予玩家经济: x.xx\n  给玩家钱\n控制台执行: say xxx...\n  以控制台身份执行指令 不需要/\n玩家执行: sethome...\n  以玩家身份执行 不需要/\n是否在世界: 世界名\n  返回玩家是否在指定世界\n是否有权限: xx.xxx\n  返回玩家是否有指定权限\nplaysound: 声音枚举\n  给玩家播放声音, 声音枚举请在这里获取 https://bukkit.windit.net/javadoc/org/bukkit/Sound.html\n插件支持的变量:\n{执行结果} - 有返回值的地方, 比如JS和HTTP操作会用到\n{玩家} - 执行命令的玩家ID\n{玩家游戏模式} - survival,creative,adventure,spectator\n{玩家血量} - 20.0\n{玩家是否OP} - true/false\n{玩家语言} - zh_cn, en_us\n{玩家等级} - 12\n\n\n其实自己一个写一个脚本指令非常简单(但是不知道有没有人真这么干)，你可以反编译看它的处理逻辑。\n\n所有的命令都继承了 loi.lois.ParseWorker.CommandWorker 和 run(String value, HandleWorker handler),\nrun() 方**在命令被触发时调用, value 是命令的参数, handler 是上下文, 比如获取PlayerCommandPreprocessEvent, 你可以通过 (PlayerCommandPreprocessEvent) handler.getContext(\"event\") 来获取, 或者会返回 null.\n\n写好事件之后, 还需要有一步注册, 使用:\nink.loi.lois.ParseWorker.EnvironmentManager.workerRegister(\"命令触发词\", (CommandWorker) new 命令所在类());\n\n事实上, 插件的中文命令是通过创建别名实现的,\nink.loi.lois.ParseWorker.EnvironmentManager.createAlias(\"私聊\", \"tell\");这就可以为 tell 指令创建一个别名, 之后使用该别名就可以触发, 如果存在重复别名那么后注册的的会覆盖前面的。\n插件的命令是通过需要额外定义的解析器来解析的, 需要继承 StandardDecoder, 在解析时会调用 decode(String cmd) 方法, 由解析器去调用 handler 调用相关的指令类。\n才发现我写的好复杂 TAT\n\n",
    "replies": [
        {
            "author": "1182350036",
            "timestamp": 1592662200,
            "txt_content": "woc woc牛逼 赞"
        },
        {
            "author": "结城希亚",
            "timestamp": 1592665020,
            "txt_content": "论，为了一个服务器学N种知识的重要性"
        },
        {
            "author": "TNT8",
            "timestamp": 1592667540,
            "txt_content": "\n\n\n\n\nimage.png (16.34 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-20 23:39 上传\n\n\n\n\n\n"
        },
        {
            "author": "乐死自认",
            "timestamp": 1594253940,
            "txt_content": "推荐添加指令冷却塔就可以成一套\n绝对很牛"
        },
        {
            "author": "蕾米洛伊",
            "timestamp": 1594257540,
            "txt_content": "乐死自认 发表于 2020-7-9 08:19\n推荐添加指令冷却塔就可以成一套\n绝对很牛\n竟然还有人用这个又复杂又难用的插件hhhhc 感动了 马上安排"
        },
        {
            "author": "黑崎丶一护",
            "timestamp": 1596630480,
            "txt_content": "感谢你，这个插件可以有脑洞可以搞许多花样出来"
        }
    ]
}