{
    "title": "【原版模组】【前置】方块通用处理",
    "author": "ruhuasiyu",
    "replyCount": 8,
    "timestamp": 1569727680,
    "txt_content": " 本帖最后由 ruhuasiyu 于 2019-10-9 15:49 编辑 \n\n方块通用处理\n\n本模组并非具有实际效果的模组，而是为了给原版模组的方块基本操作提供功能。使用本模组作为前置后，方块的放置、破坏、机器的基本操作都无需再编写函数来处理了。\n\n\n例如，放置模组内方块时，本来用视线追踪即可实现，然而放置不完整方块（作物、树苗、告示牌等），或者在台阶上放置方块等情形，要做进一步的调整才可将bug调至最低。而使用本前置模组后，无需再考虑这些问题，只需要专心设计方块内容即可。\n\n\n本模组支持的版本为：19w38a-19w39a\n\n\n事件与接口\n\n方块的放置\n\n事件：玩家放置方块条件：方块拥有tag.id标签结果：在方块位置align xyz positioned ~0.5 ~ ~0.5处生成盔甲架，盔甲架头部为放置的方块物品，标签为cpp_block；执行函数标签#cpp_block:put接口：使用函数标签#cpp_block:put来添加额外的指令，其中\n@s为放置方块的玩家@e[type=minecraft:armor_stand,tag=cpp_block,distance=..0.1,limit=1] 为放置的盔甲架执行位置为盔甲架位置若要改变盔甲架位置，请勿将其放置在方块中心0.5米外的位置\n注意事项\n一般而言，放置告示牌等不完整方块，需要做额外处理一般而言，放置植物等物品和方块为不同模型的方块，需要做额外处理支持原版所有生存可破坏的方块和屏障\n\n方块的破坏\n\n事件：玩家破坏方块条件：方块处拥有标签为cpp_block的盔甲架结果：执行函数标签#cpp_block:break，将最近的Age:0s或Age:1s的物品修改为盔甲架头部物品，杀死相应盔甲架接口：使用函数标签#cpp_block:break来添加额外的指令，其中\n@s为盔甲架执行位置为盔甲架位置通过修改盔甲架头部物来实现修改掉落品\n注意事项\n若放置时对物品做了修改，破坏时需要反向修改会原物品屏障默认无掉落\n\n机器的处理\n\n目标：拥有cpp_block标签的盔甲架，且其头部物品拥有hasGUI:1b标签目标：下方漏斗，下方漏斗矿车，掉落物，玩家结果：禁止漏斗吸取，清除漏斗和漏斗矿车内、地面、玩家背包内拥有标签isMachineBg:1b的物品接口：为你的机器内的所有用于图形界面的物品添加标签isMachineBg:1b即可默认只支持物品石化橡木台阶、淡灰色染色玻璃板和烟火之星，如果需要可以在物品标签#cpp_block:machine_gui中额外添加\n\n机器的输出\n\n事件：执行函数cpp_block:dist结果：将存储的物品信息输出到当前位置的容器，支持大箱子\n位置：根据执行者记分板cppOutputFace修改输出位置(1-6,东南西北上下)；若修改后的位置处容器已满，会尝试输出到大箱子的另一半物品信息来源：storage cpp_block:dist Item若当前位置无容器、容器已满、大箱子两个全满，则输出失败；否则会成功输出，会为执行者添加标签cpp_block_dist_success\n也可执行函数cpp_block:dist/pos来直接指定当前位置为输出位置扩展：若要支持更多容器\n方块标签#container:all内添加容器方块id方块标签#container:chests内添加占据两格的大箱子方块id，需与原版橡木箱子拥有相同的方块状态函数标签#container:check内添加函数，函数指令为execute if block ~ ~ ~ [方块id] run scoreboard players remove @s container [容器容量]复制代码\n可以直接添加原版模组容器扩展中的数据包来支持相应模组\n\n检测强充能\n\n事件：执行函数cpp_block:check_power结果：若当前位置被强充能(不识别本身方块是否可被充能)，则为执行者添加标签cpp_block_redstone_powered注意：\n仅识别原版红石元件不识别陷阱箱\n\n例子\ngive @s gold_block{display:{Name:'{\"translate\":\"item.cpp.moon_stone\"}'},id:\"cpp:moon_stone\",CustomModelData:12970001}复制代码然后创建相应模型，即可自动放置和破坏。\n\n\ngive @s barrel{display:{Name:'{\"translate\":\"item.cpp.all_in_one_machine\"}'},id:\"cpp:all_in_one_machine\",CustomModelData:12970001,hasGUI:1b}复制代码然后创建相应模型和机器背景板。机器的背景高频放置、产出、经验条、选项等操作需要额外编写。\n\n\n安装方式\n\n将文件 \n\n\n\n方块通用处理1.1.zip\n(19.27 KB, 下载次数: 62)\n\n\n\n2019-9-30 16:10 上传\n点击文件名下载附件\n\n\n\n\n\n 下载后放入存档datapacks文件夹即可。 \n\n本模组支持的版本为：19w38a-19w39a。 \n\n若你安装了模组【更多箱子】或【更多潜影盒】，你还需要下载原版模组容器扩展中相应的数据包以支持相应容器。\n\n备用下载地址： Github\n\n原理简述\n\n方块的放置\n\n通过断言来判断玩家放置的方块来自主手还是副手，检测tag.id然后视线追踪。每个位置检测方块位置左下角是否有标记，若有则跳过；若无则生成标记并判断当前方块精准采集的掉落物是否与手持物一致，若一致则检测是否当前方块已有盔甲架标记，若无则生成盔甲架并复制物品信息。目的是为了防止放置不完整方块盔甲架位置错误。然后在y轴±1位置也执行，因为放置在台阶上下方会导致视线上没有相应方块。\n\n机器的输出\n\n检测当前位置的槽位空余数量，若满则检测大箱子另一半。最后用潜影盒技巧来输出物品。 \n\n其它略。\n\n更新日志\n\n1.1 2019/09/30\n\n移除了无用的函数。物品标签`#cpp_block:machine_gui`中添加了石化橡木台阶。\n\n\nv1.0 2019/09/29\n\n提交第一个版本。\n\n\nPowered by MM2BC - MCBBS Markdown To BBCode Converter\n\n[groupid=1009]The Command's Power[/groupid]",
    "replies": [
        {
            "author": "ruhuasiyu",
            "timestamp": 1569729960,
            "txt_content": "排版炸了，去github看吧……"
        },
        {
            "author": "腿短啊",
            "timestamp": 1569806460,
            "txt_content": "看不懂也学不会"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1569829080,
            "txt_content": "我觉得你说的很有道理，然后我选择自己写（跑 "
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1569830460,
            "txt_content": "隐退 发表于 2019-9-30 15:38\n我觉得你说的很有道理，然后我选择自己写（跑\n我认为你重头写的话，可能会遇到一些不易发觉的bug，而我都帮你调试好了多方便啊。。。"
        },
        {
            "author": "凌空的猫",
            "timestamp": 1569849300,
            "txt_content": "我决定重新造轮子"
        },
        {
            "author": "CR_019",
            "timestamp": 1579926780,
            "txt_content": "研究了一个月的方块，没搞出来。。\n所以我来“借鉴”了"
        },
        {
            "author": "SolidBlock",
            "timestamp": 1581998580,
            "txt_content": "Minecraft不支持方块自定义，甚至连方块实体的自定义模型也不行，而且物品的自定义模型必须是数字且替换原版资源包有关的模型文件，而不能直接给方块实体数据设置模型，造成很大的不便以及兼容性低，这是很大的遗憾。不过自定义模型数据相对于之前的版本而言，已经是很大的进步了。希望Minecraft 1.16能够继续改进。"
        },
        {
            "author": "神经幺",
            "timestamp": 1583550720,
            "txt_content": "SolidBlock 发表于 2020-2-18 12:03\nMinecraft不支持方块自定义，甚至连方块实体的自定义模型也不行，而且物品的自定义模型必须是数字且替换原 ...\n真的太遗憾了, 我翻了整整两天教程才发现局限性这么大\n"
        }
    ]
}