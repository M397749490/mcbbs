{
    "title": "[NPCmod][图文][常更][例子]CNPC-自定义NPC 脚本教学",
    "author": "DJMC",
    "replyCount": 13,
    "timestamp": 1541068800,
    "txt_content": " 本帖最后由 DJMC 于 2018-11-15 09:31 编辑 \n\n本人：本杰明i [qq]269139141[/qq]\n现在正在制作RPG单机存档英雄黎明4的工作\n\n关于脚本我也是初级水平，在我的RPG制作中我会把一些初级常用的简单脚本\n在此分享给大家，并加以解释，如果有不对的大佬，地方们错误来指出\n此贴给那些不会脚本，对于编程0认知，但想用脚本做出一些基本效果的朋友有用\n    脚本的功能是真的强大\n 注:主要的版本是关于1.7.10，关于1.12版本偶尔会讲\n\n正题   1.关于脚本最基本的安装配置详细可参考搬运者@@Leo 的教程贴戳这里\n\n         2. 关于脚本的另外一个教程贴 skpsk自己家 戳这里\n         里面详细的讲述了JS脚本的基础知识，我这个贴只是分享一些我自己平时用的实用的例子并加以讲解\n\n         3.我们在游戏中所用到的各种功能实现的【API】在此十分重要记得书签收藏\n\n我会从非常简单基础的例子开始到难的讲解\n       首先的例子教程系列是 NPC的生活起居    1.从出生到当场去世↓\n         NPC的出生这个\"世界\"(world)所决定的，你掌握着NPC的生杀大权，\n   而与之相对应的脚本的类就是(ScriptWorld)这个\"类\"中包含了脚本里世界的可执行的API选项。我们找到要用的API “生成克隆\"\n\n脚本功能: 生成一个复制魔杖中server列表中的NPC（一定要复制好NPC到server列表中哦）\n       world.spawnClone(x,y,z,第几页，列表内NPC的名字)               注意[英文逗号相隔而不是空格]\n        对应指令/noppes clone spawn 列表内NPC名字 1 x,y,z\n实际应用:a1.复制一个传令兵到server列表内\n\n\n    a2.在另一个NPC\"克里刚\"的脚本内写入生成一个传令兵的脚本\n\n\n代码如下，复制粘贴到脚本窗口下的Hooks下的第三个选项对话里\nvar x=npc.getX();\n    y=npc.getY();\n    z=npc.getZ();\nnpc.say(\"天降传令兵！\");\nworld.spawnClone(x+1,y+8,z+3,1,(\"传令兵\"));复制代码\na3.完成了，如果右击NPC的话，NPC就会召唤一个传令兵\n    记住最后，记得检查自己的NPC脚本功能是否开启了\n\n\na4.找到让传令兵去世的方法（API）\n\n   虽然世界提供了生物出生的方法，但并没有直接将生物赐死的方法，生物的非自然死亡源于生物自己   于是我们在（ScriptNpc）类中找到了 kill 这个【Api】又在（ScriptEntity）实体类中找到了despawn这个【Api】\n\nKill的意思是杀死掉这个NPC而对于实体却没有用，而实体类中despawn的意思却是让这个实体消失掉\n\na5.写实现右击传令兵，就会当场去世的代码（两个我们都用一下）都是写在Hooks【对话】下的代码\n\nnpc.say(\"右击我就当场去世\");\nnpc.kill();复制代码效果:\n\n\n这个↓注意:写完代码后有必要记得复制保存好NPC，因为会NPC会消失\nnpc.say(\"右击我就当场消失\");\nnpc.despawn();复制代码\n这个我就不放图了，因为消失的NPC就等于删除的数据再也回不来了，233什么？你说右击之前没有保存NPC？\n\n\n\n2.了解到了NPC的出生和去世还有消失的【API】方法，但不能让NPC自己自发演绎一场生与死的一生，只能不停的与NPC互动触发，着实无聊\n那么这里我就给大家写一场生与死的脚本，这样就要用到判定方法了\n    生命的轮回交替↓\na1.首先我介绍一下本场演出的NPC们           \n\n我的思路是熔岩之魔死后会诞生 熔岩之心，熔岩之心会成长为熔岩之灵,而熔岩之灵又会成长为熔岩之魔但是成长过程中如果死亡就真的死了\na2.之后我要找到我所要用的【API】\n     （ScriptNpc）类中我找到了 \"获得年龄\"  的【API】getAge,剩下两个API就用我们已经知道的spawnClone，despawn（生成克隆，消失)    注意：就算复制魔杖也会把NPC的年龄复制进来的\n这个NPC的年龄是从NPC诞生到这个世界开始计算的，以我的世界刻为单位（20刻/1秒）我们在脚本中只要除于20就得出的是秒数值:npc.getAge()/20复制代码\na3.开始给每个NPC写他们自己专属的代码首先是熔岩之魔，他的就比较简单了，只是死后变成 熔岩之心就好了\n\n\n题外话：\n每个人写代码的习惯不一样，我希望你们能有一个好习惯，下载一个写代码的软件，因为会很明显直观的看自己的代码的错误，我自己用Notepad++\n至于详细配置软件等操作上面有一个家伙开的详细的教程贴，在首页目录就能看到，再次把链接放在这戳这\n\n我们在 熔岩之魔 的脚本窗口 监听死亡的页面粘贴好我们写好的脚本\nvar    x=npc.getX();\n                      z=npc.getZ();\n                     y=npc.getY();\n\nworld.spawnClone(x,y+1,z,1,\"熔岩之心\");\nnpc.despawn();\n\n//熔岩之魔的死后操作复制代码\n\n注意；写完后先不着急测试，因为我们还没把这几个写好的NPC复制到server列表里，所以就算NPC死了也生成不出来\n\n接下来我们来看熔岩之心和熔岩之灵的\n成长为\n这里我们就要用到getAge来获得NPC的年龄，但怎么让NPC随时随地监听自己的年龄状态呢？首先我们要确定NPC的出生日期并输出个 出生日期的信息，这里我们就要用到，最常用的两个【API】\nsetTempData设置临时信息 ，和 getTempData得到临时信息\n\n\n我们在熔岩之心的监听窗口运行页面下写上脚本var css=npc.getAge()/20;\nnpc.setTempData(\"出生时间\",css);复制代码不知道怎么回事总是显示不出来在贴子上？？\n\n会不会觉得有点繁琐，一个信息还要双重设置才可以用\n\n\n设置完这个信息之后，我们开始考虑计算年龄的问题\n接下来要说的这个HOOKs下的监听选项 【更新】就是每时每刻都在执行的脚本页面【更新】每0.5秒执行一次页面的脚本\n正是因为有这个特性，所以我们才需要先关闭掉NPC的脚本启用开关，记得关闭\n有可能自己操作失误导致Game 炸掉\n\n关闭后，我们可以安心粘贴上我们在软件里写好的脚本了var 现在时间=npc.getAge()/20;\n    年龄=现在时间-npc.getTempData(\"出生时间\");\n    npc.say(\"我的年龄是\"+年龄);//这一行可以去掉\nif (年龄>=38){\n   var x=npc.getX();\n        z=npc.getZ();\n                y=npc.getY();\n   world.spawnClone(x,y+2,z,1,(\"熔岩之灵\"));\n   npc.say(\"熔岩之心成长了！\");\n   npc.despawn();}\n   //计算NPC的年龄\n   //当NPC年龄大于或等于38秒时\n   //在NPC的坐标位置生成“熔岩之灵”\n   //原NPC.当场消失复制代码\n这时候出现了判断条件的语法，并且符合还很简单用到了大于等于符合>=\nif (判断条件){\n    要执行的内容;}复制代码\n之后我们要开启这个NPC的的脚本开关\n\n准备好复制魔杖，赶在 NPC 38秒成长之前，将熔岩之心复制进server列表一中\n将这三位NPC全部复制进Server列表一中\n大功告成\n这样我们就实现了击杀熔岩之魔后变成了熔岩之心，过38秒后成长为了熔岩之灵\n3个NPC的完善版本，我会整理一下上传上来，以供参考，今天就更新到这里\n\n今天就讲喂食熔岩之灵或设定一些条件，让熔岩之灵进化成熔岩之魔\n要用到检测玩家手里的物品作为为条件↓\n这里图床出现了问题我就暂时不加了，文字描述\n在 熔岩之灵 的脚本面板下对话窗口输入以下代码\nif (player.getHeldItem()!=null){\nvar Hd=player.getHeldItem().getDisplayName();\nif (Hd==\"圆石\"){\n        player.removeItem(player.getHeldItem(),1);\nnpc.say(\"谢谢喂食，我要进化了~~QwQ\");\nvar    x=npc.getX();\n                z=npc.getZ();\n                y=npc.getY();\n                world.spawnClone(x,y+1,z,1,(\"熔岩之魔\"));\nnpc.despawn();}}\n//当玩家手上的物品不是空时\n//声明变量HD为玩家手里此时拿着的东西的展示名字\n//当HD是圆石时，删除玩家手里拿着的物品，数量为1个\n//成长进化为熔岩之魔复制代码这样玩家用圆石右击一下 熔岩之灵 就进化成了熔岩之魔了。开心吗？\n\n",
    "replies": [
        {
            "author": "117779284",
            "timestamp": 1541071680,
            "txt_content": "1.12有很大的不同·"
        },
        {
            "author": "Hueihuea",
            "timestamp": 1541073060,
            "txt_content": "117779284 发表于 2018-11-1 19:28\n1.12有很大的不同·\n也不算太大\n主要是钩子的注册不同和API不同"
        },
        {
            "author": "Mccraft-pepsi",
            "timestamp": 1541074680,
            "txt_content": "杰明大佬终于舍得发帖啦233，其实年龄可以直接用获取时间var time来解决的这样可以省略很多步骤:D"
        },
        {
            "author": "Hueihuea",
            "timestamp": 1541074860,
            "txt_content": "Mccraft-pepsi 发表于 2018-11-1 20:18\n杰明大佬终于舍得发帖啦233，其实年龄可以直接用获取时间var time来解决的这样可以省略很多步骤:D ...\n咳咳\n那个是date对象\n当场指正"
        },
        {
            "author": "SOP_PANANDHAO",
            "timestamp": 1541128680,
            "txt_content": "看着真不错，我也来学学"
        },
        {
            "author": "Mccraft-pepsi",
            "timestamp": 1541224380,
            "txt_content": "skpsk自己家 发表于 2018-11-1 20:21\n咳咳\n那个是date对象\n当场指正\n我说的是用时间来代替年龄..."
        },
        {
            "author": "Hueihuea",
            "timestamp": 1541225400,
            "txt_content": "Mccraft-pepsi 发表于 2018-11-3 13:53\n我说的是用时间来代替年龄...\n我觉得初始化的时候生成个tempdata\n然后更新获取并增加tempdata以计算age会更好吧"
        },
        {
            "author": "jincongwei520",
            "timestamp": 1557620280,
            "txt_content": ""
        },
        {
            "author": "隐刃",
            "timestamp": 1559979480,
            "txt_content": "服务器不适合脚本\n用了=炸服"
        },
        {
            "author": "家园崛起",
            "timestamp": 1590913800,
            "txt_content": "脚本制作只能局限在自定义NPCmod里吗？可不可以结合其它mod物品制作？"
        },
        {
            "author": "清风卍",
            "timestamp": 1590928560,
            "txt_content": ".............."
        },
        {
            "author": "a86968948",
            "timestamp": 1601297340,
            "txt_content": "腻害呀~~~~~~~~~~"
        },
        {
            "author": "安营",
            "timestamp": 1612704120,
            "txt_content": "膜拜大佬2333"
        }
    ]
}