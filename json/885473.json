{
    "title": "[1.14.x]调试崩溃（含Mod）时发现的一系列问题",
    "author": "ItIsEnderman",
    "replyCount": 3,
    "timestamp": 1563066540,
    "txt_content": " 本帖最后由 ItIsEnderman 于 2019-7-14 09:16 编辑 \n\n以下内容没有提到版本时，默认为1.14.2或1.14.3\n\n最近搭建调试整合包时发现，crash-report里的Mod状态信息列表没影了。具体表现看下方的两次调试：\n\nFabric：使用fabric-loader-0.4.8+build.155打开Minecraft 1.14.3，安装并正常加载的Mod有VoxelMap 1.9.12和RoughlyEnoughItems 2.9.5 build.133。启动器为Minecraft官启。\n以下为调试崩溃报告：\n---- Minecraft Crash Report ----\n// Ooh. Shiny.\n\nTime: 19-7-14 上午8:18\nDescription: Manually triggered debug crash\n\njava.lang.Throwable\n        at net.minecraft.class_309.method_1474(class_309.java:530)\n        at net.minecraft.class_310.method_1574(class_310.java:1477)\n        at net.minecraft.class_310.method_1523(class_310.java:925)\n        at net.minecraft.class_310.method_1514(class_310.java:411)\n        at net.minecraft.client.main.Main.main(Main.java:154)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:497)\n        at net.fabricmc.loader.game.MinecraftGameProvider.launch(MinecraftGameProvider.java:170)\n        at net.fabricmc.loader.launch.knot.Knot.init(Knot.java:129)\n        at net.fabricmc.loader.launch.knot.KnotClient.main(KnotClient.java:26)\n\n\nA detailed walkthrough of the error, its code path and all known details is as follows:\n---------------------------------------------------------------------------------------\n\n-- Head --\nThread: Client thread\nStacktrace:\n        at net.minecraft.class_309.method_1474(class_309.java:530)\n\n-- Affected level --\nDetails:\n        All players: 1 total; [class_746['ItIsEnderman'/158, l='MpServer', x=68.48, y=3.00, z=1.30]]\n        Chunk stats: Client Chunk Cache: 729, 488\n        Level dimension: minecraft:overworld\n        Level name: MpServer\n        Level seed: 0\n        Level generator: ID 01 - flat, ver 0. Features enabled: false\n        Level generator options: {}\n        Level spawn location: World: (0,4,208), Chunk: (at 0,0,0 in 0,13; contains blocks 0,0,208 to 15,255,223), Region: (0,0; contains chunks 0,0 to 31,31, blocks 0,0,0 to 511,255,511)\n        Level time: 4169 game time, 4169 day time\n        Level storage version: 0x00000 - Unknown?\n        Level weather: Rain time: 0 (now: false), thunder time: 0 (now: false)\n        Level game mode: Game mode: creative (ID 1). Hardcore: false. Cheats: false\n        Server brand: fabric\n        Server type: Integrated singleplayer server\nStacktrace:\n        at net.minecraft.class_638.method_8538(class_638.java:421)\n        at net.minecraft.class_310.method_1587(class_310.java:1923)\n        at net.minecraft.class_310.method_1514(class_310.java:426)\n        at net.minecraft.client.main.Main.main(Main.java:154)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:497)\n        at net.fabricmc.loader.game.MinecraftGameProvider.launch(MinecraftGameProvider.java:170)\n        at net.fabricmc.loader.launch.knot.Knot.init(Knot.java:129)\n        at net.fabricmc.loader.launch.knot.KnotClient.main(KnotClient.java:26)\n\n-- System Details --\nDetails:\n        Minecraft Version: 1.14.3\n        Operating System: Windows 10 (amd64) version 10.0\n        Java Version: 1.8.0_51, Oracle Corporation\n        Java VM Version: Java HotSpot(TM) 64-Bit Server VM (mixed mode), Oracle Corporation\n        Memory: 1599115584 bytes (1525 MB) / 2147483648 bytes (2048 MB) up to 2147483648 bytes (2048 MB)\n        JVM Flags: 8 total; -XX:HeapDumpPath=MojangTricksIntelDriversForPerformance_javaw.exe_minecraft.exe.heapdump -Xmx2G -XX:+UnlockExperimentalVMOptions -XX:+UseG1GC -XX:G1NewSizePercent=20 -XX:G1ReservePercent=20 -XX:MaxGCPauseMillis=50 -XX:G1HeapRegionSize=32M\n        Launched Version: fabric-loader-0.4.8+build.155-1.14.3\n        LWJGL: 3.2.2 build 10\n        OpenGL: GeForce 820M/PCIe/SSE2 GL version 4.5.0 NVIDIA 375.86, NVIDIA Corporation\n        GL Caps: Using GL 1.3 multitexturing.\nUsing GL 1.3 texture combiners.\nUsing framebuffer objects because OpenGL 3.0 is supported and separate blending is supported.\nShaders are available because OpenGL 2.1 is supported.\nVBOs are available because OpenGL 1.5 is supported.\n\n        Using VBOs: Yes\n        Is Modded: Definitely; Client brand changed to 'fabric'\n        Type: Client (map_client.txt)\n        Resource Packs: \n        Current Language: 简体中文 (中国)\n        CPU: 4x Intel(R) Core(TM) i5-4210U CPU @ 1.70GHz\n\nForge：使用forge-26.0.61打开Minecraft 1.14.2，安装并正常加载的Mod有WorldEdit 7.01 beta1和VoxelMap 1.9.12。启动器为PCL 1.0.8。\n以下为调试崩溃报告：\n---- Minecraft Crash Report ----\n// Don't be sad. I'll do better next time, I promise!\n\nTime: 19-7-14 上午8:37\nDescription: Manually triggered debug crash\n\njava.lang.Throwable: null\n        at net.minecraft.client.KeyboardListener.func_204870_b(KeyboardListener.java:424) ~[?:?] {pl:runtimedistcleaner:A}\n        at net.minecraft.client.Minecraft.func_71407_l(Minecraft.java:1387) ~[?:?] {pl:accesstransformer:B,pl:runtimedistcleaner:A}\n        at net.minecraft.client.Minecraft.func_195542_b(Minecraft.java:864) ~[?:?] {pl:accesstransformer:B,pl:runtimedistcleaner:A}\n        at net.minecraft.client.Minecraft.func_99999_d(Minecraft.java:384) ~[?:?] {pl:accesstransformer:B,pl:runtimedistcleaner:A}\n        at net.minecraft.client.main.Main.main(SourceFile:154) ~[1.14.2.jar:?] {}\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_181] {}\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_181] {}\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_181] {}\n        at java.lang.reflect.Method.invoke(Unknown Source) ~[?:1.8.0_181] {}\n        at net.minecraftforge.fml.loading.FMLClientLaunchProvider.lambda$launchService$0(FMLClientLaunchProvider.java:51) ~[forge-1.14.2-26.0.61.jar:26.0] {}\n        at cpw.mods.modlauncher.LaunchServiceHandlerDecorator.launch(LaunchServiceHandlerDecorator.java:37) [modlauncher-2.1.4.jar:?] {}\n        at cpw.mods.modlauncher.LaunchServiceHandler.launch(LaunchServiceHandler.java:50) [modlauncher-2.1.4.jar:?] {}\n        at cpw.mods.modlauncher.LaunchServiceHandler.launch(LaunchServiceHandler.java:68) [modlauncher-2.1.4.jar:?] {}\n        at cpw.mods.modlauncher.Launcher.run(Launcher.java:77) [modlauncher-2.1.4.jar:?] {}\n        at cpw.mods.modlauncher.Launcher.main(Launcher.java:62) [modlauncher-2.1.4.jar:?] {}\n\n\nA detailed walkthrough of the error, its code path and all known details is as follows:\n---------------------------------------------------------------------------------------\n\n-- Head --\nThread: Client thread\nStacktrace:\n        at net.minecraft.client.KeyboardListener.func_204870_b(KeyboardListener.java:424)\n\n-- Affected level --\nDetails:\n        Level name: MpServer\n        All players: 1 total; [ClientPlayerEntity['ItIsEnderman'/1, l='MpServer', x=-16.01, y=21.00, z=-15.78]]\n        Chunk stats: MultiplayerChunkCache: 729, 481\n        Level seed: 0\n        Level generator: ID 01 - flat, ver 0. Features enabled: false\n        Level generator options: {}\n        Level spawn location: World: (8,4,8), Chunk: (at 8,0,8 in 0,0; contains blocks 0,0,0 to 15,255,15), Region: (0,0; contains chunks 0,0 to 31,31, blocks 0,0,0 to 511,255,511)\n        Level time: 107937 game time, 1645849861 day time\n        Level dimension: 0\n        Level storage version: 0x00000 - Unknown?\n        Level weather: Rain time: 0 (now: true), thunder time: 0 (now: false)\n        Level game mode: Game mode: creative (ID 1). Hardcore: false. Cheats: false\n        Server brand: forge\n        Server type: Integrated singleplayer server\nStacktrace:\n        at net.minecraft.client.world.ClientWorld.func_72914_a(ClientWorld.java:409)\n        at net.minecraft.client.Minecraft.func_71396_d(Minecraft.java:1744)\n        at net.minecraft.client.Minecraft.func_99999_d(Minecraft.java:400)\n        at net.minecraft.client.main.Main.main(SourceFile:154)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at net.minecraftforge.fml.loading.FMLClientLaunchProvider.lambda$launchService$0(FMLClientLaunchProvider.java:51)\n        at cpw.mods.modlauncher.LaunchServiceHandlerDecorator.launch(LaunchServiceHandlerDecorator.java:37)\n        at cpw.mods.modlauncher.LaunchServiceHandler.launch(LaunchServiceHandler.java:50)\n        at cpw.mods.modlauncher.LaunchServiceHandler.launch(LaunchServiceHandler.java:68)\n        at cpw.mods.modlauncher.Launcher.run(Launcher.java:77)\n        at cpw.mods.modlauncher.Launcher.main(Launcher.java:62)\n\n-- System Details --\nDetails:\n        Minecraft Version: 1.14.2\n        Operating System: Windows 8.1 (amd64) version 6.3\n        Java Version: 1.8.0_181, Oracle Corporation\n        Java VM Version: Java HotSpot(TM) 64-Bit Server VM (mixed mode), Oracle Corporation\n        Memory: 563584112 bytes (537 MB) / 1073741824 bytes (1024 MB) up to 1073741824 bytes (1024 MB)\n        JVM Flags: 6 total; -XX:HeapDumpPath=MojangTricksIntelDriversForPerformance_javaw.exe_minecraft.exe.heapdump -XX:+UseG1GC -XX:-UseAdaptiveSizePolicy -XX:-OmitStackTraceInFastThrow -Xmn128m -Xmx1024m\n        FML: New FML!\n        Loaded coremods (and transformers): Nothing\n        Launched Version: 1.14.2-forge-26.0.61\n        LWJGL: 3.2.1 build 12\n        OpenGL: GeForce 820M/PCIe/SSE2 GL version 4.5.0 NVIDIA 375.86, NVIDIA Corporation\n        GL Caps: Using GL 1.3 multitexturing.\nUsing GL 1.3 texture combiners.\nUsing framebuffer objects because OpenGL 3.0 is supported and separate blending is supported.\nShaders are available because OpenGL 2.1 is supported.\nVBOs are available because OpenGL 1.5 is supported.\n\n        Using VBOs: Yes\n        Is Modded: Definitely; Client brand changed to 'forge'\n        Type: Client (map_client.txt)\n        Resource Packs: \n        Current Language: 简体中文 (中国)\n        CPU: 4x Intel(R) Core(TM) i5-4210U CPU @ 1.70GHz\n\n由于Fabric很陌生、Forge重构了代码，传统的“早期加载→构建→预初始化→加载材质与音效-关闭音效→初始化→后初始化→完成Mod加载→完成游戏本体加载”加载阶段链可能已经不适用新版Mod，传统的“LCHIJAAAA”到新版就不知变成了什么。而且Mod状态信息列表排列Mod的顺序通常就是Mod加载的先后顺序，这也是判断崩溃原因一大重要线索。\n\n目前我的状态为：\n1.Forge和Fabric调试崩溃报告里都找不到Mod状态信息列表，只能根据崩溃报告前段极不全面地分析错误原因\n2.不清楚哪一些Mod含有coremod和Transformer，难以进行Mod含coremod和Transformer的调试崩溃\n3.暂时没有在配置文件里找到相关设置\n4.不清楚哪一些Mod冲突，而且1.14的Mod没几个，不很好触发真正的Mod冲突引发的崩溃\n5.经测试，1.12.2的调试崩溃报告含有Mod状态信息列表\n\n所以，在此提问或请求：\n1.如何设法让Forge或者Fabric在崩溃报告尽量全面的展示出Mod状态信息，或者显示Mod状态信息列表\n2.推荐几组存在抢注ID、功能重复、相互作用导致访问权限错误、自身存在Bug、存在联动但又再联动中存在不兼容等冲突类型的Mod。\n3.讲解一下新版Fabric和Forge的加载流程，简单介绍一下各阶段主要完成的任务\n\n注意：第二个是可选作答，但我还是希望回答者能解答一下。\n\n其他的问题，形如“触发Minecraft以永久无响应方式崩溃”、“触发JVM崩溃”、“Launchwrapper在崩溃方面的功能替代品”之类的，我继续自行测试。本帖就不问了。",
    "replies": [
        {
            "author": "gooding300",
            "timestamp": 1563066540,
            "txt_content": " 本帖最后由 gooding300 于 2019-7-14 19:47 编辑 \n\n崩溃报告显示Mod信息\nForge\n观察Forge有关崩溃报告的源代码，可以发现只是单纯的提供了一个可供注册的接口，自己并没有实现任何往CrashReport内添加实际内容的代码，只会固定显示以下两行：\nFML: New FML!\nLoaded coremods (and transformers): Nothing\n无论使用任何版本的FML，添加了任何的CoreMod，这两行的内容都不会发生改变，所以不是实际内容。\n但是，Forge毕竟预留了相关的接口，我们可以制作一个简单的Mod让他输出已加载的Mod列表。\n尝试编写了一下Mod，可以显示Mod列表和CoreMod列表，效果如下：\n\n可以从GitHub上下载到这个Mod，请务必给一个star，如果还有其他需要显示的信息欢迎继续补充。\nFabric\nFabric loader本身不会对Minecraft进行任何反混淆以外的实际更改，因此不会修改崩溃报告的任何内容。\n我们只需要安装Fabric API，就会对崩溃报告进行修改，会显示mod的id、名称以及版本信息。\n\n加载流程\nForge\nCommonSetup 原preinit\nModEnqueue/ModProcess 和其他mod进行通信/接受其他mod的通信\nClientSetup/ServerStarting 处理客户端/服务端启动前的最后操作\n\n主动触发崩溃\n无响应崩溃\nMinecraft.getInstance().addScheduledTask(() -> Thread.sleep(114514));\n让Minecraft的主线程直接休眠就可以无响应。\nJVM崩溃\nMinecraft.getInstance().addScheduledTask(() -> GL11.glDrawBuffer(1919810));\n乱填参数调用GL操作就可以让JVM崩溃。\n请注意，GL操作必须委托主线程进行，不然会是Java的LWJGLException。\n游戏内也可以直接通过Ctrl+F3+C来强制触发VM崩溃。\n\nLW的代替品\nLaunchWrapper实现了一个ClassLoader，是用来加载类，并对类进行修改的一个加载器，Forge在1.13使用了ModLauncher来代替，Fabric使用自己的Fabric Loader起到了相同的作用，不过类修改就交给Mixin了。\n如果有兴趣了解LaunchWrapper和ModLauncher工作流程和加载原理的话，请参考我的CoreMod开发教程。\n\n哭了……200金粒又写mod又翻代码……"
        },
        {
            "author": "a1294790523",
            "timestamp": 1563074520,
            "txt_content": "emmmmmm，日志是个好东西？\n我目前感觉很少是以mod信息来判断崩溃原因的\n关于这些问题，我感觉叫叫这个dalao比较好：\n@gooding300 "
        },
        {
            "author": "mine新时代xs",
            "timestamp": 1563089580,
            "txt_content": " 本帖最后由 mine新时代xs 于 2019-7-14 15:35 编辑 \n\nFabric和Forge有着天差地别\nFabric是一个轻量级API，仅添加读取mods文件夹中的模组的功能\n众所周知，原版的崩溃报告都是玩家无法读出来的at agl.a(SourceFile:239)，而你的Fabric崩溃报告中类似  at net.minecraft.class_309.method_1474(class_309.java:530)这样的东西其实同理，它们仅对技术人员有意义\n而Forge对崩溃报告的机制进行了不同于Fabric的魔改，使用了命名空间来显示收集到的崩溃信息使得玩家也能读懂崩溃报告，并且会收集mod列表和运行状态相关信息\n而Fabric提供的这样的功能不太相同，事实上，它连在游戏里显示mod列表都做不到，也不像Forge那样可以在游戏里查看mod的版本信息、作者、modid等信息，也不能选择config或Disable\n而1.13时扁平化重写代码以及LaunchWrapper不支持Java9，导致Forge不再使用LaunchWrapper启动游戏，传统的游戏加载过程已经被完全淘汰\n因此，从1.13.2版本的Forge(25.0.9)开始，游戏不再提供mod状态信息列表\n所以，第一个问题我给出的回答是：1.13.2开始的所有MOD API(包括Rift在内)，都无法给出mod状态信息列表，没有任何办法让它们做到这一点\n第二个问题，由于minecraft 1.13扁平化更新，数字ID已经被完全淘汰，使用命名空间ID不会存在抢注ID，LaunchWrapper的淘汰也使得功能重复、相互作用等也很少造成访问权限错误，自身存在bug的情况仅限mod版本与Forge或Fabric或Rift版本不兼容(比如我签名档里面那个科技模组，下载第一个版本，那个版本只能在快照版本运行，在1.14.3运行会崩溃)，当然高清修复与Forge的不兼容就是典型存在联动但又在联动中存在不兼容\n第三个问题，新版本Forge的加载流程，这个我已经在帮你问一位老外了\n老实说我也挺想知道的"
        }
    ]
}