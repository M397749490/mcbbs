{
    "title": "[安全|管理]Yzm——验证码插件",
    "author": "隔壁老吕",
    "replyCount": 2,
    "timestamp": 1521208980,
    "txt_content": " 本帖最后由 隔壁老吕 于 2018-3-16 22:05 编辑 \n\n—————————————————Yzm—————————————————\n验证码插件\n指令：\n/yzm 验证码\n详细信息：\n当玩家进入游戏时向玩家聊天栏发送一个随机4位数字字符串\n要求玩家输入/yzm 验证码\n进行验证，通过验证后才能进行游戏\n以下是几种基于未输入验证码被踢出服务器（非ban的情况）1\n1.输入其他指令\n2.聊天\n3.移动\n4.输错\n游戏截图：\n\n\n\n\n\n2.png (9.47 KB, 下载次数: 0)\n\n下载附件\n\n2018-3-16 21:59 上传\n\n\n\n\n\n\n\n\n\n\n3.png (9.95 KB, 下载次数: 0)\n\n下载附件\n\n2018-3-16 21:59 上传\n\n\n\n\n\n\n\n\n\n\n4.png (8.3 KB, 下载次数: 0)\n\n下载附件\n\n2018-3-16 21:59 上传\n\n\n\n\n\n\n\n\n\n\n5.png (16.66 KB, 下载次数: 0)\n\n下载附件\n\n2018-3-16 21:59 上传\n\n\n\n\n\n\n\n\n\n\n6.png (16.93 KB, 下载次数: 0)\n\n下载附件\n\n2018-3-16 21:59 上传\n\n\n\n\n\n接下来是喜闻乐见的下载：\n\n\n\n\nYzm.jar\n(5.19 KB, 下载次数: 44)\n\n\n\n2018-3-16 22:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n接下来是无人问津的源代码：\n\npackage yzm;\n\nimport java.util.Random;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.PlayerJoinEvent;\nimport org.bukkit.event.player.PlayerKickEvent;\nimport org.bukkit.event.player.AsyncPlayerChatEvent;\nimport org.bukkit.event.player.PlayerMoveEvent;\nimport java.util.List;\nimport java.util.ArrayList;\n\npublic final class Yzm extends JavaPlugin implements Listener\n{\n    List <Player> pList;\n    @Override\n    public void onEnable()      //插件启动时\n    {\n        getLogger().info(\"Yzm已被加载！\");     //显示消息   \n        this.getServer().getPluginManager().registerEvents(this,this);\n        pList = new ArrayList();\n    }\n    @Override\n    public void onDisable()     //插件卸载时\n    {\n        getLogger().info(\"Yzm已被卸载。\");     //显示消息\n    }\n    public String getYzm()\n    {\n        String y = \"\";\n        for(int a = 0;a<4;a++)\n        {\n            Random rnd = new Random();\n            int num = rnd.nextInt(9);        \n            y += String.valueOf(num);\n        }\n        return y;\n    }\n    String yzm;\n    Player player;\n    @EventHandler\n    public void onJoin(PlayerJoinEvent event) \n    {   \n        yzm = getYzm();\n        player = event.getPlayer();     //获取玩家指示符        \n        player.sendMessage(\"§e[§a验证码§e]§e§l请输入验证码：\"+yzm);        \n    }\n    @EventHandler\n    public void onKick(PlayerKickEvent event) \n    {   \n        yzm = getYzm();\n        player = event.getPlayer();     //获取玩家指示符      \n        if(pList.indexOf(player)!=-1)\n        {\n            pList.remove(player);\n        }\n    }\n    @EventHandler\n    public void onMove(PlayerMoveEvent event) \n    {   \n        player = event.getPlayer();     //获取玩家指示符      \n        if(pList.indexOf(player)==-1)\n        {\n            player.kickPlayer(\"§4你因为未输入验证码或者输错了而被踢出服务器！\");\n        }     \n    }\n    @EventHandler\n    public void onChat(AsyncPlayerChatEvent event) \n    {   \n        player = event.getPlayer();     //获取玩家指示符      \n        if(pList.indexOf(player)==-1)\n        {\n            player.kickPlayer(\"§4你因为未输入验证码或者输错了而被踢出服务器！\");\n            event.setCancelled(true);\n        }     \n    }\n    @Override\n    public boolean onCommand(CommandSender sender, Command command, String label, String[] args)        //创建命令执行器   \n    {\n        player = (Player)sender;\n        if (label.equalsIgnoreCase(\"yzm\") && pList.indexOf(player)==-1)\n        { \n            if(pList.indexOf(player)==-1) \n            {\n                if (args[0].equalsIgnoreCase(yzm))\n                {                    \n                    player.sendMessage(\"§e[§a验证码§e]§e§l验证成功\"); \n                    pList.add(player);\n                    yzm = getYzm();\n                    return true;\n                }\n                else\n                {\n                    player.kickPlayer(\"§4你因为未输入验证码或者输错了而被踢出服务器！\");\n                    return true;\n                }  \n            }\n            else\n            {\n                player.sendMessage(\"§e[§a验证码§e]§e§l你已经输入过验证码了\"); \n            }\n        }\n        else\n        {\n            player.kickPlayer(\"§4你因为未输入验证码或者输错了而被踢出服务器！\");\n            return true;\n        }\n        return false;                 \n    }\n}\n\n本插件所用所有代码均为原创,不存在借用/抄袭等行为\n\n\n",
    "replies": [
        {
            "author": "弱鸡绿毛怪",
            "timestamp": 1521209160,
            "txt_content": "这代码看得我心慌"
        },
        {
            "author": "海贼王#",
            "timestamp": 1521209340,
            "txt_content": "原创插件，支持\n不过验证码作用是..."
        }
    ]
}