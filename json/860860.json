{
    "title": "服务器脚本问题",
    "author": "小cheng",
    "replyCount": 7,
    "timestamp": 1556377320,
    "txt_content": "如果设置启动脚本有自动重启功能。",
    "replies": [
        {
            "author": "uz123",
            "timestamp": 1556377320,
            "txt_content": " 本帖最后由 uz123 于 2019-4-27 23:21 编辑 \n\n在最下行添加\ngoto start\n就好了附带完整的启动码\n如果对你有帮助请把我设置成最佳\n\n\n@echo off\n::关闭回显\nset isre=1\n::是否重启 0为关 , 1为开\nset retime=5\n::设置重启等待时间\nset restart=0\n::设置重启次数初始值，默认为0，请勿修改\nset maxre=-1\n::重启多少次后不再重启,设置成-1关闭\n:start\n::start节点\n\nCLS\n::清除屏幕上内容\n\nset server_name=服务器名字[25565]\n::服务器名称，会在服务端的标题处显示\nset min_ram=1024\n::最小内存，默认2048，单位MB\nset max_ram=2048\n::最大内存，默认8192，单位MB\nset tm1=%time:~0,2%\nset tm2=%time:~3,2%\nset tm3=%time:~6,2%\n@echo. \necho  现在时间：%date% %tm1%点%TM2%分\n@echo. -----------------------------------------------------------------\n@echo.                         %server_name%服务器     \n\n@echo.           注意:关闭服务器前请在后台输入stop保存玩家数据\n@echo.                      否则可能会出现回档情况\n@echo.\n@echo.                      服务器正在启动中,请稍等……\n@echo.\n@echo. -----------------------------------------------------------------\n::启动时的一些显示\n\n::警告，如果你使用x86架构的Java(即32位)，最大内存不能超过1024MB\nset jar_name= spigot.12.2.jar\n::设置服务端核心名称，默认路径为该批处理文件所在的根目录，需要写入文件后缀\nif %isre% == 0 (title %server_name% 最大内存%max_ram%M) else (title %server_name%服务器 最大内存%max_ram%M 重启次数%restart%次)\n::设置的服务端标题，调用上面的一些变量，可酌情修改\n\njava -javaagent:1.jar -server -Xincgc -Xmx%max_ram%M -Xms%min_ram%M -Xss512K -XX:+AggressiveOpts -XX:+UseCompressedOops -XX:+UseCMSCompactAtFullCollection -XX:+UseFastAccessorMethods -XX:ParallelGCThreads=4 -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=2 -XX:CMSInitiatingOccupancyFraction=70 -XX:-DisableExplicitGC -XX:-DisableExplicitGC -XX:TargetSurvivorRatio=90 -jar %jar_name%\n::Java命令行开服代码，不推荐修改，已进行优化，32位Java运行可能会有些许问题，如有问题请替换为下方代码\n::java -Xincgc -Xmx%max_ram%M -Xms%min_ram%M -Xss512K -XX:+AggressiveOpts -XX:+UseFastAccessorMethods -XX:ParallelGCThreads=4 -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=2 -XX:CMSInitiatingOccupancyFraction=70 -XX:-DisableExplicitGC -XX:-DisableExplicitGC -XX:TargetSurvivorRatio=90 -jar %jar_name%\n\n@echo. -----------===服务端关闭，即将在五秒内重启,按Ctrl+C终止重启===------------\n@echo.\n@echo.               %server_name% --- 玩家数据保存完毕 已关服\n@echo.\n@echo. -----------------------------------------------------------------\n\nset/a restart=restart+1\n\nif %isre% == 0 (goto stop) else (goto restart)\n:restart\n::restart标签\n::设置重启次数自加一，请勿修改\ntimeout /t %retime% /NOBREAK\nif %restart% == %maxre% (goto stop) else (goto start)\n:stop\nif %isre% == 0 (echo 未开启自动重启，如果需要，请到bat中开启) else (echo 已经自动重启%maxre%次，停止自动重启，按任意键关闭)\npause\n\n\n"
        },
        {
            "author": "mo_ying_meng",
            "timestamp": 1556377560,
            "txt_content": "有的呀，直接更改BAT文件即可"
        },
        {
            "author": "世予予",
            "timestamp": 1556378220,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "小cheng",
            "timestamp": 1556411460,
            "txt_content": "uz123 发表于 2019-4-27 23:17\n在最下行添加\ngoto start\n就好了附带完整的启动码\n我看了下完整码，上面有设置重启的配置，那不加这些行不行，还有我要的是服务器自动关服了然后重启，这个是不是这样的功能"
        },
        {
            "author": "小cheng",
            "timestamp": 1556418960,
            "txt_content": "世予 发表于 2019-4-27 23:17\nbat末尾加上goto start即可\n可以用我的bat 记得调整分配的内存\n这些不加行不行"
        },
        {
            "author": "世予予",
            "timestamp": 1556425800,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "uz123",
            "timestamp": 1556447460,
            "txt_content": "小cheng 发表于 2019-4-28 08:31\n我看了下完整码，上面有设置重启的配置，那不加这些行不行，还有我要的是服务器自动关服了然后重启，这个 ...\n这个就是重启的代码啊 、\n不加就没有自动重启\n而且我给的完整代码是优化版 \n对服务器有优化 的功能\n不会因为代码多 影响"
        }
    ]
}