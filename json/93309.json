{
    "title": "Minecraft自建皮肤服务器教程",
    "author": "elxy",
    "replyCount": 11,
    "timestamp": 1361716560,
    "txt_content": " 本帖最后由 elxy 于 2013-2-24 22:35 编辑 \n\n    Minecraft皮肤服务器有McMySkin、SkinMe、HDMinecraftSkins、Minecrack，以及Minecraft官方服务器。但作为教育网用户，访问访问不了啊……下面介绍如何自建皮肤服务器。\n    需要使用：\n    1、Minecraft客户端\n    2、解压软件\n    3、JD-GUI\n    Java反编译工具，用于查看Java Class文件的源代码。\n    下载地址：http://java.decompiler.free.fr/?q=jdgui\n    4、jclasslib\n    字节码阅读器，并提供了一个类库允许读取、修改、写入Java Class文件与字节码。此软件依赖于32位的Java环境。\n    下载地址：http://www.ej-technologies.com/products/jclasslib/overview.html\n    5、Eclipse\n    集成开发环境（IDE），本文中利用jclasslib修改Java Class文件。\n    下载地址：http://www.eclipse.org/downloads/\n    6、HFS ~ Http File Server\n    HTTP服务器，用于在本机建立HTTP服务器。\n    下载地址：http://www.rejetto.com/hfs/?f=dl\n\n    Minecraft客户端通过访问“http://skins.minecraft.net/MinecraftSkins/用户名.png”显示用户皮肤，访问“http://skins.minecraft.net/MinecraftSkins/用户名.png”显示用户斗篷，我们的目标是找出相关源码，将其修改为指向HTTP服务器的URL地址。\n\n    第〇步、建立HTTP服务\n    利用HFS在本机建立HTTP服务，skins文件夹储存用户皮肤，cloaks文件夹储存用户斗篷，图片文件以“用户名.png”形式命名，如下图所示：\n\n\n\n\n\nimage001.png (70.44 KB, 下载次数: 8)\n\n下载附件\n\nHFS软件界面\n2013-2-24 21:51 上传\n\n\n\n\n    利用动态DNS服务，让其他人可以使用固定的域名来访问。这里我将本机外部地址与myskins.f3322.org绑定，访问http://myskins.f3322.org/skins/test.png，也可显示皮肤文件：\n\n\n\n\n\nimage003.png (17.63 KB, 下载次数: 6)\n\n下载附件\n\n访问HTTP服务\n2013-2-24 21:51 上传\n\n\n\n\n    注：若用户处在局域网之中，可以通过修改路由器，配置静态地址与端口映射，确保外网正确访问。可以参考：建服教程\n    如果本机可以访问，而外网用户无法访问，可能的解决方式是修改HTTP服务器端口，比如25566之类的，这样第三步里就应使用“http://myskins.f3322.org:25566/skins/”替换了。\n\n    第一步，找出源代码文件\n    使用JD-GUI打开minecraft.jar文件（在.minecraft/bin/目录下面），点击搜索（Ctrl+Shift+S），查找“http://skins.minecraft.net/MinecraftSkins/”，如下图所示，注意勾选搜索类型：\n\n\n\n\n\nimage004.png (102.14 KB, 下载次数: 5)\n\n下载附件\n\nJD-GUI搜索字符串\n2013-2-24 21:51 上传\n\n\n\n\n    由于Minecraft发布时通过模糊处理隐藏了源文件名，所以不同的版本的源文件名可能会不同。这里我们以1.4.6版本为例，需要修改bag.class、bah.class、bdu.class文件。\n\n\n\n\n\nimage006.png (55.05 KB, 下载次数: 7)\n\n下载附件\n\njclasslib界面\n2013-2-24 21:51 上传\n\n\n\n\n\n    第二步，定位字符串位置\n    接着使用jclasslib打开minecraft.jar文件，选择bag，如下图所示：\n    从Methods文件夹定位待修改的字符串常量：\n\n\n\n\n\nimage008.png (92.37 KB, 下载次数: 6)\n\n下载附件\n\n定位字符串1\n2013-2-24 21:51 上传\n\n\n\n\n    点击#17，跳转到Constant Pool（常量池）的第17个常量：\n\n\n\n\n\nimage010.png (75.66 KB, 下载次数: 5)\n\n下载附件\n\n定位字符串2\n2013-2-24 21:51 上传\n\n\n\n\n    点击cp_info #536，跳转到Constant Pool（常量池）的第536个常量，这就是我们要修改的位置：\n\n\n\n\n\nimage012.png (78.55 KB, 下载次数: 5)\n\n下载附件\n\n定位字符串3\n2013-2-24 21:51 上传\n\n\n\n\n\n    第三步，修改Class文件\n    打开Eclipse，新建一个Java工程，命名为test。然后将jclasslib的源代码导入工程：\n\n\n\n\n\nimage014.png (138.67 KB, 下载次数: 5)\n\n下载附件\n\n新建java工程\n2013-2-24 21:51 上传\n\n\n\n\n\n\n\n\n\nimage016.png (116.93 KB, 下载次数: 9)\n\n下载附件\n\n导入jclasslib源代码\n2013-2-24 21:51 上传\n\n\n\n\n    新建一个Class文件，拷贝如下代码：\nimport java.io.*;   \nimport org.gjt.jclasslib.io.ClassFileWriter;   \nimport org.gjt.jclasslib.structures.CPInfo;   \nimport org.gjt.jclasslib.structures.ClassFile;   \nimport org.gjt.jclasslib.structures.constants.ConstantUtf8Info;   \npublic class test {   \n    public static void main(String[] args) throws Exception {   \n  \n        String filePath = \"D:\\\\bag.class\";   \n        FileInputStream fis = new FileInputStream(filePath);   \n           \n        DataInput di = new DataInputStream(fis);   \n        ClassFile cf = new ClassFile();   \n        cf.read(di);   \n        CPInfo[] infos = cf.getConstantPool();   \n           \n        int count = infos.length;   \n        for (int i = 0; i < count; i++) {   \n            if (infos[i] != null) {   \n                System.out.print(i);   \n                System.out.print(\" = \");   \n                System.out.print(infos[i].getVerbose());   \n                System.out.print(\" = \");   \n                System.out.println(infos[i].getTagVerbose());   \n                if(i == 536){   \n                    ConstantUtf8Info uInfo = (ConstantUtf8Info)infos[i];   \n                    uInfo.setBytes(\"http://myskins.f3322.org/skins/\".getBytes());   \n                    infos[i]=uInfo;   \n                }   \n            }   \n        }   \n        cf.setConstantPool(infos);   \n        fis.close();   \n        File f = new File(filePath);   \n        ClassFileWriter.writeToFile(f, cf);   \n    }   \n}  复制代码    其中：\n    \"D:\\\\bag.class\"是bag.class的路径，要利用解压软件从minecraft.jar里解压出来。\n    if(i == 536)是第二步找到的字符串常量的位置。\n    \"http://myskins.f3322.org/skins/\"是用户皮肤的URL地址。\n\n    运行test.java，会有如下提示信息。没有报错就证明正常的，否则就有问题：\n\n\n\n\n\nimage018.png (90.31 KB, 下载次数: 5)\n\n下载附件\n\n运行提示\n2013-2-24 21:51 上传\n\n\n\n\n    此时再使用JD-GUI打开D:\\bag.class，验证修改成功：\n\n\n\n\n\nimage020.png (71.94 KB, 下载次数: 6)\n\n下载附件\n\n验证修改\n2013-2-24 21:51 上传\n\n\n\n\n    使用同样的方法修改http://skins.minecraft.net/MinecraftSkins/字段，以及bah.class、bdu.class文件。全部修改完成后，替换minecraft.jar中的同名文件，删除META-INF文件夹，以test用户名进入游戏，这是测试结果：\n\n\n\n\n\nimage022.png (193.57 KB, 下载次数: 5)\n\n下载附件\n\n测试结果\n2013-2-24 21:51 上传\n\n\n\n\n\n    若要支持高清皮肤，可使用其他高清补丁。\n    本文参考了本人纯属虚构的文章：直接修改别人jar包里面的class文件工具:jclasslib。半原创，转载请注明。\n\n\n",
    "replies": [
        {
            "author": "sayway123",
            "timestamp": 1361716680,
            "txt_content": "这个贴终于出现了。。。\n等了10分钟了。。。"
        },
        {
            "author": "cwc",
            "timestamp": 1361717340,
            "txt_content": "同样等了很久 很期待 很棒@！"
        },
        {
            "author": "704009905",
            "timestamp": 1361729340,
            "txt_content": "支持！~~~~~~~~"
        },
        {
            "author": "卧榻哎呦",
            "timestamp": 1361775180,
            "txt_content": "LZ灰常的用心啊·················"
        },
        {
            "author": "darkdark",
            "timestamp": 1363629180,
            "txt_content": " 本帖最后由 darkdark 于 2013-3-19 02:12 编辑 \n\n一步一步按照楼主的教程，在第三步[...将jclasslib的源代码导入工程]卡了一阵。\n楼主第三步说得（对于零基础的人）不够详细，最后还是自己摸索着成功了。\n\n论坛等级不够，无法上传图片补充说明，以后再来。\nps：搜索斗篷的地址是\nhttp://skins.minecraft.net/MinecraftCloaks/"
        },
        {
            "author": "darkdark",
            "timestamp": 1363799700,
            "txt_content": "发现用一个汉化jar的小工具就可以跳过第二第三步，直接打开Class修改里面的地址\n\nhhclass\n\n来自 http://www.mcbbs.net/thread-26367-1-1.html"
        },
        {
            "author": "antecer",
            "timestamp": 1368715500,
            "txt_content": "经测试 1.5.2 使用这个方法无效。。。"
        },
        {
            "author": "610108634",
            "timestamp": 1370257200,
            "txt_content": "好麻烦的"
        },
        {
            "author": "dwmejama",
            "timestamp": 1386362400,
            "txt_content": "\n    打开Eclipse，新建一个Java工程，命名为test。然后将jclasslib的源代码导入工程\n\n请教这一步是怎么做到的 ？ 弄了一晚上也没搞明白 该有图的没图！"
        },
        {
            "author": "LolliCandy",
            "timestamp": 1406472660,
            "txt_content": "darkdark 发表于 2013-3-19 01:53\n一步一步按照楼主的教程，在第三步[...将jclasslib的源代码导入工程]卡了一阵。\n楼主第三步说得（对于零基 ...\n第三部怎样做?"
        },
        {
            "author": "LolliCandy",
            "timestamp": 1406472720,
            "txt_content": "dwmejama 发表于 2013-12-7 04:40\n打开Eclipse，新建一个Java工程，命名为test。然后将jclasslib的源代码导入工程\n\n请教这一步是怎么做 ...\n同求QAQ。。。。。"
        }
    ]
}