{
    "title": "求一个bat启动脚本",
    "author": "MisakaFish",
    "replyCount": 11,
    "timestamp": 1586017260,
    "txt_content": " 本帖最后由 MisakaFish 于 2020-4-5 00:48 编辑 \n\n预加载了资源分区的地图,希望弄一个自动刷新。\n嗯,具体来说就是这样的，在我 开始运行bat时\n检测现在是否是周六的00:00-00:05分,如果是,则执行任务,删除world文件夹后复制我备份好的world文件夹过来\n如果不是这个时间段,则执行服务器正常启动任务。 (goto配合一下 应该不难)\n\n然后,需要一个...嗯  （服务端老更新）\n例如服务端的名字为 spigot-123-dev.jar \n我需要忽略掉 123 这段,直接执行 “-jar spigot-***-dev.jar”  就是说忽略数字\n不知道表达清楚没有\n以上。\n资源区是每天零点自动重启,我希望重启的时候就检测一下,然后替换.  麻烦懂行的dalao讲解一下 谢谢\n\n我参考了https://blog.csdn.net/smartsmile2012/article/details/82703876\n这条,但实在没有找到如何确定时间段。。。\n\n\n\n我在这里看见了 if 和 else我想 我的要求 组合一下  应该是可以实现的  但是 我对这方面没有过多了解 所以写不来...\n\n",
    "replies": [
        {
            "author": "GiNYAi",
            "timestamp": 1586017260,
            "txt_content": "MisakaFish 发表于 2020-4-5 11:12\n就很棒！\n\n可是  周六的呢  只看见了时间段\n没有看到 emmmm\n\n@echo off\nSET WORLD_DIR=world\nSET BACKUP_DIR=backup\nSET DATE_LOG=date.txt\nSET TIME_LOWER=0000\nSET TIME_UPPER=0005\nSET DAY_OF_WEEK=周六\n\n:head\nif exist %DATE_LOG% (goto checkfile) else (goto checkdate)\n:checkfile\nset /P tmp=<%DATE_LOG%\nif %tmp%==%date:~0,10% goto start\n:checkdate\nif %date:~11,2%==%DAY_OF_WEEK% (goto checktime) else (goto start)\n:checktime\nfor /f %%i in ('time /T') do set tmp=%%i\nset tmp=%tmp:~0,2%%tmp:~3,2%\nif /I %tmp% LSS %TIME_LOWER% goto start\nif /I %tmp% GTR %TIME_UPPER% goto start\nREM copy\nrd /S /Q %WORLD_DIR%\nxcopy %BACKUP_DIR% %WORLD_DIR%\\ /E \necho %date:~0,10%>%DATE_LOG%\n:start\necho \"Starting server...\" \n@echo on\njava -version\n@echo off\nchoice /T 10 /D Y /M \"Press 'N' in 10 seconds to stop...\"\nif errorlevel 2 goto end\nif errorlevel 1 goto head\n:end"
        },
        {
            "author": "one_",
            "timestamp": 1586017740,
            "txt_content": "我建议是使用自动刷新区块插件达到刷新世界的目的这样既不会卡服也不会增多你的工作量插件地址：https://www.mcbbs.net/thread-895450-1-1.html\n"
        },
        {
            "author": "MisakaFish",
            "timestamp": 1586017980,
            "txt_content": "one_ 发表于 2020-4-5 00:29\n我建议是使用自动刷新区块插件达到刷新世界的目的这样既不会卡服也不会增多你的工作量插件地址：https://ww ...\n不大行 我服装载了暮色\n这个mod就是出了名的加载区块卡\n所以我才提前预载了区块 以免玩家跑图时在生成区块 对服务器造成负担"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1586018640,
            "txt_content": "MisakaFish 发表于 2020-4-5 00:33\n不大行 我服装载了暮色\n这个mod就是出了名的加载区块卡\n所以我才提前预载了区块 以免玩家跑图时在生成区 ...\n定时关服大概需要插件配合"
        },
        {
            "author": "MisakaFish",
            "timestamp": 1586018700,
            "txt_content": "GiNYAi 发表于 2020-4-5 00:44\n定时关服大概需要插件配合\n嗯...这个我已经弄了\n我现在需要的是我提出的问题\n\n（自动重启不是重点啊喂）"
        },
        {
            "author": "one_",
            "timestamp": 1586018880,
            "txt_content": "MisakaFish 发表于 2020-4-5 00:33\n不大行 我服装载了暮色\n这个mod就是出了名的加载区块卡\n所以我才提前预载了区块 以免玩家跑图时在生成区 ...这个只是单纯的刷新没玩家在线的区块可设置刷新速度，这样玩家不会察觉到也不会增加服务器额外的负担，也能达到刷新资源的目的建议先试试，看看效果，希望能够帮到你"
        },
        {
            "author": "MisakaFish",
            "timestamp": 1586019060,
            "txt_content": "one_ 发表于 2020-4-5 00:48\n这个只是单纯的刷新没玩家在线的区块可设置刷新速度，这样玩家不会察觉到也不会增加服务器额外的负担，也能 ...\n感谢你的回答 但这并非我想要的"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1586025060,
            "txt_content": "\n@echooff\nSET WORLD_DIR=world\nSET BACKUP_DIR=backup\nSET DATE_LOG=date_tmp.txt\nSET TIME_LOWER=0000\nSET TIME_UPPER=0005\n\n:head\nif exist %DATE_LOG% (goto checkfile) else (goto checktime)\n:checkfile\nset /P tmp=<%DATE_LOG%\nif %tmp%==%date:~0,10% goto start\n:checktime\nfor /f %%i in ('time /T') do set tmp=%%i\nset tmp=%tmp:~0,2%%tmp:~3,2%\nif /I %tmp% LSS %TIME_LOWER% goto start\nif /I %tmp% GTR %TIME_UPPER% goto start\nREM copy\nrd /S /Q %WORLD_DIR%\nxcopy %BACKUP_DIR% %WORLD_DIR%\\ /E \necho %date:~0,10%>%DATE_LOG%\n:start\necho \"Starting server...\" \n@echo on\njava -version\n@echo off\nchoice /T 10 /D Y /M \"Press 'N' in 10 seconds to stop...\"\nif errorlevel 2 goto end\nif errorlevel 1 goto head\n:end复制代码\n沉迷于画蛇添足\nGOTO令程序阅读困难"
        },
        {
            "author": "名副其实",
            "timestamp": 1586055660,
            "txt_content": "MisakaFish 发表于 2020-4-5 00:51\n感谢你的回答 但这并非我想要的\n在bat中的jar文件选择似乎无法使用正则表达式过滤"
        },
        {
            "author": "MisakaFish",
            "timestamp": 1586056320,
            "txt_content": "GiNYAi 发表于 2020-4-5 02:31\n沉迷于画蛇添足\nGOTO令程序阅读困难\n就很棒！\n\n可是  周六的呢  只看见了时间段"
        },
        {
            "author": "吃土的紫轩",
            "timestamp": 1586066220,
            "txt_content": "java -Xms -Xmx -jar 核心名称.jar -nogui"
        }
    ]
}