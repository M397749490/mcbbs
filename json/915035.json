{
    "title": "帮忙分析一下报告",
    "author": "二哈大魔王",
    "replyCount": 2,
    "timestamp": 1569119280,
    "txt_content": "http://sparkprofiler.jecvay.com/#ztQ0v49\n\n有点卡。帮忙分析一下报告。。\n\n",
    "replies": [
        {
            "author": "Jecvay",
            "timestamp": 1569119280,
            "txt_content": " 本帖最后由 Jecvay 于 2019-9-22 20:39 编辑 \n\npacket 占这么多, 服务器一定不是新周目了, 进入了大后期.\n某些玩家的家里的机器数量特别大\n当很多人来到他家\n网络包更是爆炸.\n看profile没有很明显的卡点, 但是就是消耗很大.\n\n还有一个特点就是 activate tile entity 和具体的 mods 机器的cpu消耗比值\n这个比值非常高, activate 要 8%  而 ic2 也就 2% 左右.\n可见方块特别多但是其实真正需要mod计算的方块没那么多.\n由此可见服务器进入了大后期\n机器摆的到处都是.\n\n对于服务器大后期的优化, 是非常难的事情, \n纵使 sponge 可以改变机器的 tick 周期\n但是要给玩家同步网络数据一样会遍历到他周围所有的机器.\n\n最好的方法是尽量让玩家 特别是造了特别多东西的玩家\n横向发展而不是纵向发展\n不要在一个区块里面放太多东西.\n\n只要玩家愿意把面积扩大, 机器摆出去, 后期的压力会小很多. 一个区块里面搞很多层, 密集在一起, \n再有几个玩家过来一起围观 瞬间爆炸\n\n关于科技mod里面很多的导线或者自动化运输线\n不太记得哪些mod用的是记录下联通记录, 哪些mod是每次都算一遍\n对于都算一遍的mod, 导线当然是不要网状布线最好\n记录联通记录的则无此问题, 但是当线路断开而服务器没有记录(比如硬盘满了的时候去改变线路, 或者服务器进程突然被杀)\n会造成一大堆报错(机器状态是已经联通, 但是实际上线路已经断开, 而断开的操作没有更新到机器的联通记录里)\n\n\n\n"
        },
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1569121440,
            "txt_content": "net.minecraft.server.MinecraftServer.updateTimeLightAndEntities()80.34%\n更新光照 实体\n占比80.34%\nmc这优化卡还能啥原因\n\nnet.minecraft.world.WorldServer.updateEntities()37.58%39824ms\nnet.minecraft.server.MinecraftServer.redirect$onRun$zjo000()15.28%\nnet.minecraft.world.WorldServer.tick()11.09%\nnet.minecraft.network.NetworkSystem.networkTick()9.25%\nnet.minecraftforge.fml.common.FMLCommonHandler.onPostWorldTick()4.86%\nnet.minecraft.entity.EntityTracker.updateTrackedEntities()1.10%\nnet.minecraftforge.fml.common.FMLCommonHandler.onPreWorldTick()1.09%\nnet.minecraftforge.common.chunkio.ChunkIOExecutor.tick()0.03%\nnet.minecraft.server.management.PlayerList.sendPacketToAllPlayersInDimension()0.02%\njava.util.Hashtable.get()0.01%\nnet.minecraft.server.dedicated.DedicatedServer.getAllowNether()0.01%\nnet.minecraftforge.common.DimensionManager.unloadWorlds()0.01%\nnet.minecraft.server.MinecraftServer.handler$onPostUpdateEntities$bef000()0.00%\n\n"
        }
    ]
}