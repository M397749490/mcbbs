{
    "title": "[New API]PVPHealth,PVP时得到对方血量",
    "author": "18wyj2",
    "replyCount": 9,
    "timestamp": 1408937460,
    "txt_content": "大家好....这是一个没什么用的插件.....PVP时，得到对方的血量\n它没有指令...也不需要指令\n算是一个娱乐插件吧....我不知道PVP插件的类型应该选什么\n它兼容iksaku的MoreHealth插件，可能算是HealthBar的翻版吧...\n提示音:\n当攻击者的血量小于被攻击者时:\n向攻击者发出提示:担心反击\n向被攻击者发出提示:反击吧\n\n\n当攻击者的血量大于被攻击者时:\n向攻击者发出提示:继续攻击\n向被攻击者发出提示:快逃吧\n\n\n当攻击者的血量=被攻击者:\n向两人提示：你们势均力敌\n\n\n当两人模式不同:\n攻击无效\n\n\n再说一遍下载地址\n\nBuild_1:\nhttp://pan.baidu.com/s/1qWlYMIw\n\n",
    "replies": [
        {
            "author": "xx12mm",
            "timestamp": 1408937580,
            "txt_content": "好厉害\n不过有服务器会用吗？"
        },
        {
            "author": "黑小白",
            "timestamp": 1408938600,
            "txt_content": "为何我觉得这个插件很无聊。。如果双方拿的都是钻石剑都是一样的衣服，同时出招。。一直打都打不完"
        },
        {
            "author": "18wyj2",
            "timestamp": 1408953060,
            "txt_content": "黑小白 发表于 2014-8-25 11:50\n为何我觉得这个插件很无聊。。如果双方拿的都是钻石剑都是一样的衣服，同时出招。。一直打都打不完 ...\npe应该不会发生吧......."
        },
        {
            "author": "18wyj2",
            "timestamp": 1408953120,
            "txt_content": "xx12mm 发表于 2014-8-25 11:33\n好厉害\n不过有服务器会用吗？\n这种插件PE貌似挺少的"
        },
        {
            "author": "llj070",
            "timestamp": 1415983080,
            "txt_content": "支持，求作者的qq,插件技术交流"
        },
        {
            "author": "18wyj2",
            "timestamp": 1416016620,
            "txt_content": "llj070 发表于 2014-11-15 00:38\n支持，求作者的qq,插件技术交流\nQQ1979931940"
        },
        {
            "author": "13865526510",
            "timestamp": 1420459200,
            "txt_content": "我的服务器想要加入一下试试，但是为什么我的服务器不能用php格式的插件，请楼主解答"
        },
        {
            "author": "minecraftpe8",
            "timestamp": 1423639200,
            "txt_content": "18wyj2 发表于 2014-11-15 09:57\nQQ1979931940\n\n[CRITICAL] Could not pass event pocketmine\\event\\entity\\EntityDamageEvent to PVPHealth vBuild_1: Argument 1 passed to PVPHealth\\main::onEntityDamageByEntity() must be an instance of pocketmine\\event\\entity\\EntityDamageByEntityEvent, instance of pocketmine\\event\\entity\\EntityDamageEvent given, called in phar:///home/pocketmine/PocketMine-MP.phar/src/pocketmine/plugin/MethodEventExecutor.php on line 36 and defined on PVPHealth\\main\n09:28:52 [NOTICE] InvalidArgumentException: \"Argument 1 passed to PVPHealth\\main::onEntityDamageByEntity() must be an instance of pocketmine\\event\\entity\\EntityDamageByEntityEvent, instance of pocketmine\\event\\entity\\EntityDamageEvent given, called in phar:///home/pocketmine/PocketMine-MP.phar/src/pocketmine/plugin/MethodEventExecutor.php on line 36 and defined\" (E_RECOVERABLE_ERROR) in \"/PVPHealth_vBuild_1.phar/src/PVPHealth/main\" at line 23\n\n你的PVPHealth运行报错,麻烦解决一下;这个插件增加的PVP互动性,很好玩,但是有BUG"
        },
        {
            "author": "minecraftpe8",
            "timestamp": 1423829820,
            "txt_content": "红色的地方为出错的地方,已经彻底修复过来了!\n错误1:onEntityDamageByEntity()函数接收到2个事件对象:onEntityDamageByEntity和EntityDamageByEntityEvent,必须做一下判断!\n错误2:僵尸没有对应的getgamemode()函数,所以获取模式的时候,必须限定为获取玩家模式!\n<?php\n\nnamespace PVPHealth;\n\nuse pocketmine\\utils\\TextFormat as MT;\n//想要自己插件色彩斑斓的同学不要忘了use这个\nuse pocketmine\\event\\Listener;\nuse pocketmine\\event\\entity\\EntityDamageEvent;\nuse pocketmine\\event\\entity\\EntityDamageByEntityEvent;\nuse pocketmine\\Player;\nuse pocketmine\\plugin\\PluginBase;\nclass main extends PluginBase implements Listener{\n                \n        public function onEnable(){ \n                $this->getLogger()->info(MT::BLUE . \"插件运行,by 18wyj2\");\n                $this->getServer()->getPluginManager()->registerEvents($this, $this);\n                $this->getLogger()->info(MT::YELLOW . \"加载成功,欢迎使用\");\n        }\n\n        public function onDisable(){\n                $this->getLogger()->info( MT::RED .\"PH关闭中....\");\n        }\n        \n        public function onEntityDamageByEntity(EntityDamageEvent $event){\n                if($event instanceof EntityDamageByEntityEvent){\n/*\n[CRITICAL] Could not pass event pocketmine\\event\\entity\\EntityDamageEvent to PVPHealth vBuild_1: \nArgument 1 passed to PVPHealth\\main::onEntityDamageByEntity() must be an instance of \npocketmine\\event\\entity\\EntityDamageByEntityEvent,\ninstance of pocketmine\\event\\entity\\EntityDamageEvent given, \ncalled in phar:///home/pocketmine/PocketMine-MP.phar/src/pocketmine/plugin/MethodEventExecutor.php on line 36 and defined on PVPHealth\\main\n09:28:52 [NOTICE] InvalidArgumentException: \"Argument 1 passed to \nPVPHealth\\main::onEntityDamageByEntity() must be an instance of \npocketmine\\event\\entity\\EntityDamageByEntityEvent, \ninstance of pocketmine\\event\\entity\\EntityDamageEvent given, \ncalled in phar:///home/pocketmine/PocketMine-MP.phar/src/pocketmine/plugin/MethodEventExecutor.php \non line 36 and defined\" (E_RECOVERABLE_ERROR) in \"/PVPHealth_vBuild_1.phar/src/PVPHealth/main\" \n\nat line 23\n*/\n                        $victim = $event->getEntity();\n                $attacker = $event->getDamager();\n                        $vhp = $victim->getHealth();\n                        $ahp = $attacker->getHealth();\n                        $vmhp = $victim->getMaxHealth();\n                        $amhp = $attacker->getMaxHealth();\n                        if($victim instanceof Player && $attacker instanceof Player){\n/*\nFatal error: Call to undefined method pocketmine\\entity\\Zombie::getgamemode() in phar:///home/pocketmine/plugins/PVPHealth_vBuild_1.phar/src/PVPHealth/main.php on line 30\n09:31:16 [EMERGENCY] An unrecoverable error has occurred and the server has crashed. Creating a crash dump\n09:31:16 [EMERGENCY] Please submit the \"/home/pocketmine/CrashDump_Mon_Feb_9-09.31.16-CST_2015.log\" file to the Bug Reporting page. Give as much info as you can.\n\n09:31:18 [EMERGENCY] The crash dump has been automatically submitted to the Crash Archive. You can view it onhttp://crash.pocketmine.net/view/116084 or use the ID #116084.\n*/\n                                $vgm = $victim->getgamemode();\n                                $agm = $attacker->getgamemode();\n                        }else{\n                                $vgm = 0;\n                                $agm = 0;        \n                        }\n                if($victim instanceof Player && $attacker instanceof Player){\n                                if($vgm == $agm){\n                                //当两人模式相同时\n                                    if($vhp > $ahp){\n                                                $victim->sendMessage(\"[PH]血量大于对方,反击吧,骚年!\\n对方血量\".$ahp.\"/\".$amhp);\n                                                $attacker->sendMessage(\"[PH]血量小于对方,小心反击!\\n对方血量\".$vhp.\"/\".$vmhp);\n                                    }elseif($ahp > $vhp){\n                                                $attacker->sendMessage(\"[PH]血量大于对方,乘胜追击吧!\\n对方血量\".$vhp.\"/\".$vmhp);\n                                                $victim->sendMessage(\"[PH]血量小于对方,快逃吧,小样!\\n对方血量\".$ahp.\"/\".$amhp);\n                                        }elseif($ahp == $vhp){\n                                            $victim->sendMessage(\"[PH]对方与你势均力敌!\\n对方血量\".$ahp.\"/\".$amhp);\n                                                $attacker->sendMessage(\"[PH]对方与你势均力敌!\\n对方血量\".$vhp.\"/\".$vmhp);\n                                        }\n                            }else{\n                                //当两人模式不相同时\n                                   $attacker->sendMessage(\"[PH]你们的游戏模式不同，没有可比性!对方模式为\".$vgm);\n                                   $event->setCancelled();\n                            }        \n                          }\n                }\n        }\n}\n\n"
        }
    ]
}