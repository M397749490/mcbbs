{
    "title": "VC++ 实现强制释放内存",
    "author": "duang2333",
    "replyCount": 7,
    "timestamp": 1462083000,
    "txt_content": "代码：\n#include <windows.h>\n#include <Psapi.h>\n\nint WINAPI WinMain(_In_ HINSTANCE hInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ LPSTR lpCmdLine, _In_ int nShowCmd)\n{\n//VS2013/VS2015编译通过\n    MEMORYSTATUSEX stcMemStatus = { sizeof(MEMORYSTATUSEX) };\n    GlobalMemoryStatusEx(&stcMemStatus);\n    DWORDLONG preUsedMem = stcMemStatus.ullTotalPhys - stcMemStatus.ullAvailPhys;\n\n    DWORD dwPIDList[1000] = { 0 };\n    DWORD bufSize = sizeof(dwPIDList);\n    DWORD dwNeedSize = 0;\n    EnumProcesses(dwPIDList, bufSize, &dwNeedSize);\n    for (DWORD i = 0; i < dwNeedSize / sizeof(DWORD); i++)\n    {\n        HANDLE hProcess = OpenProcess(PROCESS_SET_QUOTA, false, dwPIDList);\n        SetProcessWorkingSetSize(hProcess, -1, -1);\n    }\n    return 0;\n}\n\n未释放前：\n\n释放后：\n",
    "replies": [
        {
            "author": "duang2333",
            "timestamp": 1462181580,
            "txt_content": "mcbbs没玩VC的?"
        },
        {
            "author": "yzy_shuaige",
            "timestamp": 1475329080,
            "txt_content": "有哦 我就是"
        },
        {
            "author": "绅士囧",
            "timestamp": 1475411280,
            "txt_content": "强制折腾到虚拟内存里了，不更卡么"
        },
        {
            "author": "langyo",
            "timestamp": 1475411340,
            "txt_content": "绅士囧 发表于 2016-10-2 20:28\n强制折腾到虚拟内存里了，不更卡么\n所以这是强制啊→_→毕竟能够尽量使软件不占内存又不至于真的被清理掉只有用虚拟内存"
        },
        {
            "author": "langyo",
            "timestamp": 1475411820,
            "txt_content": "duang2333 发表于 2016-5-2 17:33\nmcbbs没玩VC的?\n有，不过玩的少\n\n实际上你把它弄成个dll就跨平台了，然后大家都来用→_→"
        },
        {
            "author": "天空之城TMD",
            "timestamp": 1475626920,
            "txt_content": "扔虚拟内存这种事只会变更卡啊。。。。"
        },
        {
            "author": "duang2333",
            "timestamp": 1475813700,
            "txt_content": "绅士囧 发表于 2016-10-2 20:28\n强制折腾到虚拟内存里了，不更卡么\n这玩意只是YY玩的，像360加速球 电脑管家加速球都是这个原理。"
        }
    ]
}