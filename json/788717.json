{
    "title": "如何在绘制GUI的时候呼出鼠标指针",
    "author": "白羊羊",
    "replyCount": 13,
    "timestamp": 1522302780,
    "txt_content": " 本帖最后由 mimimis 于 2018-3-31 17:14 编辑 \n\n\n\n\n\n如题，在打开GuiScreen的时候，鼠标指针不会出现，而是一种隐藏的状态\nGuiScreen没有任何方法可以对这个进行操作，这问题困扰我一个月了\n",
    "replies": [
        {
            "author": "ruhuasiyu",
            "timestamp": 1522308420,
            "txt_content": "@ustc_zzzz "
        },
        {
            "author": "耗子",
            "timestamp": 1522315800,
            "txt_content": "麻烦问问题的时候附上相关代码"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522316400,
            "txt_content": "耗子 发表于 2018-3-29 17:30\n麻烦问问题的时候附上相关代码\n但是...问题问的是代码是什么"
        },
        {
            "author": "耗子",
            "timestamp": 1522316820,
            "txt_content": "必须使用Minecraft.displayGuiScreen()方法打开一个界面，如果没有鼠标指针，可能可以使用Minecraft.setIngameNotInFocus()解决"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522422000,
            "txt_content": "耗子 发表于 2018-3-29 17:47\n必须使用Minecraft.displayGuiScreen()方法打开一个界面，如果没有鼠标指针，可能可以使用Minecraft.setIng ...\nMinecraft.setIngameNotInFocus()更改玩家的游戏状态为非游戏中，这样确实可以让玩家在GUI界面自由移动鼠标\n但是EntityPlayerSP.openGui方法默认在显示GUI时更改玩家的游戏状态为非游戏中，也就是说，你鼠标确实可以自由移动，但是始终无法绘制出鼠标准星"
        },
        {
            "author": "3TUSK",
            "timestamp": 1522431300,
            "txt_content": "mimimis 发表于 2018-3-30 23:00\nMinecraft.setIngameNotInFocus()更改玩家的游戏状态为非游戏中，这样确实可以让玩家在GUI界面自由移动鼠 ...\n请提供相关代码、游戏本体版本、Forge 版本。\n\n过去一星期中，我没有在开发 Mod 时注意到类似的现象。\n\n不过。EntityPlayerSP.openGui？不应该是先检查 World.isRemote 然后直接 EntityPlayer.openGui，借助动态绑定调用到正确的方法吗。"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522451160,
            "txt_content": " 本帖最后由 mimimis 于 2018-3-31 07:08 编辑 \nu.s.knowledge 发表于 2018-3-31 01:35\n请提供相关代码、游戏本体版本、Forge 版本。\n\n过去一星期中，我没有在开发 Mod 时注意到类似的现象。\n莫非使用opengui方法后，鼠标指针会默认显示吗还有一种打开gui的方法是minecraft.displayguiscreen()，同样无法显示鼠标指针\n以上问题发生在本人最近开发的vexview中"
        },
        {
            "author": "3TUSK",
            "timestamp": 1522462740,
            "txt_content": "mimimis 发表于 2018-3-31 07:06\n莫非使用opengui方法后，鼠标指针会默认显示吗还有一种打开gui的方法是minecraft.displayguiscreen()，同 ...莫非使用opengui方法后，鼠标指针会默认显示吗\n这里先道个歉，我又仔细检查了一下，发觉 openGui 这个方法是 Forge/FML 添加的，实际上封装了一系列和网络通信有关的操作。\n最终还是调用 displayGuiScreen 来在客户端侧消费 GuiScreen 对象。\n\n本人最近开发的vexview中\n那么问题来了，我从你的发布贴中能得出的结论是 VexView 是个服务器端用的插件，那么显示 GuiScreen 这种只可能发生在客户端的事情（GuiScreen 这个类，在 MCP 中是 net.minecraft.client.gui 包下的类，带有 @SideOnly(Side.CLIENT) 的注解，意味着只在客户端有）是用什么来完成的？ 我在写 Forge（Minecraft 1.10.2、1.12.2）的 Mod 的时候从未遇到过类似的问题。Minecraft.displayGuiScreen 方法中也有调用 Minecraft.setIngameNotInFocus。\n我对插件开发了解并不多，如有疏漏还望指正。\n但最好还是能把你打开 Gui 的那段代码贴出来，这样别人也可以尝试重现你的问题。\n"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522466220,
            "txt_content": " 本帖最后由 mimimis 于 2018-3-31 11:19 编辑 \nu.s.knowledge 发表于 2018-3-31 10:19\n这里先道个歉，我又仔细检查了一下，发觉 openGui 这个方法是 Forge/FML 添加的，实际上封装了一系列和 ...\n其实简单地说，就是mod使用了opengui方法鼠标指针不会被绘制出来到底是需要我做什么才能绘制鼠标指针，到底是需要我做什么才能绘制还是默认就可以绘制，主要是这里我不清楚"
        },
        {
            "author": "3TUSK",
            "timestamp": 1522474560,
            "txt_content": "mimimis 发表于 2018-3-31 11:17\n其实简单地说，就是mod使用了opengui方法鼠标指针不会被绘制出来到底是需要我做什么才能绘制鼠标指针，到 ...\n默认，打开 GUI 后就会显示鼠标指针。\n\n不显示的话，我只能认为是这两种可能：\n1. 有别的什么 Mod 干扰，但前提是“有别的 Mod”。如果只有 Forge 和你的 Mod 的话，那我只能认为是下面一个可能（虽然我更愿意相信是玄学）。\n2. 你的代码的某个地方有问题，但是什么地方的问题我也不知道。\n\n几小时前我自己重新检查了我自己的 Mod，开发环境使用的是 MinecraftForge 1.12.2-14.23.2.2628，所有新方块右击打开的 GUI 均能正常显示指针。\n打开 GUI 的方法均为重载 onBlockActivated：\n        @Override\n        public boolean onBlockActivated(World worldIn, BlockPos pos, IBlockState state, EntityPlayer playerIn, EnumHand hand, EnumFacing side, float hitX, float hitY, float hitZ) {\n                // !worldIn.isRemote 保证是在服务器线程上打开 GUI\n                // IHasGui.class.isAssignableFrom(this.type) 用于确认该方块所持有的 TileEntity 是否支持 GUI（自己的实现的一个玩具）\n                if (!worldIn.isRemote && IHasGui.class.isAssignableFrom(this.type)) {\n                        // FrogCraftRebirth.getInstance() 用于获得 Mod 入口类的唯一对象\n                        playerIn.openGui(FrogCraftRebirth.getInstance(), 0, worldIn, pos.getX(), pos.getY(), pos.getZ());\n                }\n                return true;\n        }复制代码\n我不知道你是在什么地方调用的 EntityPlayer::openGui 或者是 Minecraft::displayGuiScreen（如果你的确写了一个基于 MinecraftForge 的 Mod 用在客户端上的话），但是不论是哪一种都不应该导致鼠标指针不显示。"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522475940,
            "txt_content": "u.s.knowledge 发表于 2018-3-31 13:36\n默认，打开 GUI 后就会显示鼠标指针。\n\n不显示的话，我只能认为是这两种可能：\n我这个是这样的，在MOD接收到客户端发来的数据时，为玩家打开GUI（这个是次要的）\n大概操作就像这样：\n第一步：\nMinecraft.getMinecraft().player.openGui(instance, 1, Minecraft.getMinecraft().world, pos.getX(), pos.getY(),pos.getZ());复制代码\n第二步：\npublic void drawScreen(int par1, int par2, float par3) {\n        \n                int offsetX = VexView.gui_x == -1 ? (this.width - VexView.gui_xSize)/ 2 : VexView.gui_x\n                                , offsetY = VexView.gui_y == -1 ?  (this.height - VexView.gui_ySize) / 2 : VexView.gui_y;        \n                                \n                if(VexView.login_image_url.contains(\"[local]\")) {\n                        if(T.getResourcePath() != \"vexview/textures/custom/\"+VexView.login_image_url.replace(\"[local]\", \"\")) {\n                                T = new ResourceLocation(\"vexview\", \"textures/custom/\"+VexView.login_image_url.replace(\"[local]\", \"\"));\n                        }\n                        this.mc.getTextureManager().bindTexture(T);\n                        this.drawScaledCustomSizeModalRect(VexView.login_image_x != -1 ? VexView.login_image_x : offsetX,\n                                        VexView.login_image_y != -1 ? VexView.login_image_y : offsetY, 0, 0, VexView.login_image_xSize, VexView.login_image_ySize,\n                                        VexView.login_image_xShow >= this.width ? this.width : VexView.login_image_xShow,\n                                        VexView.login_image_yShow >= this.height ? this.height : VexView.login_image_yShow,\n                                        VexView.login_image_xSize,\n                                        VexView.login_image_ySize);\n                }else if(VexView.login_image_bufferedimage != null){\n                        if (d != null) {\n                                this.mc.getTextureManager().bindTexture(this.mc.getTextureManager().getDynamicTextureLocation(\"d\", d));\n                        } else {\n                                d = new DynamicTexture(VexView.login_image_bufferedimage);\n                        }\n                        this.drawScaledCustomSizeModalRect(VexView.login_image_x != -1 ? VexView.login_image_x : offsetX,\n                                VexView.login_image_y != -1 ? VexView.login_image_y : offsetY, 0, 0, VexView.login_image_xSize, VexView.login_image_ySize,\n                                VexView.login_image_xShow >= this.width ? this.width : VexView.login_image_xShow,\n                                VexView.login_image_yShow >= this.height ? this.height : VexView.login_image_yShow, VexView.login_image_xSize,\n                                VexView.login_image_ySize);\n                }\n                \n                this.mc.getTextureManager().bindTexture(Login);\n                if (par1 >=(int) (width*0.5)-34 && par2 >= (int)(height*0.80) && par1 <= (int) (width*0.5)-34+68 && par2 <= (int)(height*0.80)+16) {\n                         this.drawTexturedModalRect((int) (width*0.5)-34, (int)(height*0.80),0 ,16, 68, 16);\n                } else {\n                         this.drawTexturedModalRect((int) (width*0.5)-34, (int)(height*0.80),0 ,0, 68, 16);\n                }\n                \n                if(VexView.login_type.equals(\"register\")) {\n                        this.drawString(this.fontRenderer, \"\\u5728\\u4e0b\\u9762\\u8f93\\u5165\\u5bc6\\u7801\\u5373\\u53ef\\u5b8c\\u6210\\u6ce8\\u518c\", (int) (width*0.5)-60, (int)(height*0.65), 0xFFFFFF);\n                        this.drawString(this.fontRenderer, \"\\u6ce8\\u518c\" , (int) (width*0.5)-10, (int)(height*0.80)+3, 0xFFFFFF);\n                }else if(VexView.login_type.equals(\"login\")) {\n                        this.drawString(this.fontRenderer, \"\\u5728\\u4e0b\\u9762\\u8f93\\u5165\\u5bc6\\u7801\\u5373\\u53ef\\u5b8c\\u6210\\u767b\\u5f55\", (int) (width*0.5)-60, (int)(height*0.65), 0xFFFFFF);\n                        this.drawString(this.fontRenderer, \"\\u767b\\u5f55\", (int) (width*0.5)-10, (int)(height*0.80)+3, 0xFFFFFF);\n                }\n                text.drawTextBox();\n        }\n        \n        @Override\n        public void initGui() {\n                this.buttonList.add(new GuiButton(10, (int) (width*0.5)-34, (int)(height*0.80), 68, 16, \"\"));\n                Keyboard.enableRepeatEvents(true);\n                text =  new GuiTextField(0, fontRenderer, (int) (width*0.5)-150, (int)(height*0.70), 300, 15);\n        text.setMaxStringLength(64);\n        text.setFocused(true);\n                text.setCanLoseFocus(false);\n        }复制代码"
        },
        {
            "author": "白羊羊",
            "timestamp": 1522487580,
            "txt_content": "u.s.knowledge 发表于 2018-3-31 13:36\n默认，打开 GUI 后就会显示鼠标指针。\n\n不显示的话，我只能认为是这两种可能：\n问题终于被解决，是由于与Bukkit通信收包的那个事件不在主线程导致的\n将相关操作切回主线程即可（感谢4z指点）\nMinecraft.getMinecraft().addScheduledTask(() -> {\n                                Minecraft.getMinecraft().player.openGui(instance, 2, Minecraft.getMinecraft().world, pos.getX(), pos.getY(),        pos.getZ());\n                        });复制代码\n感谢各位帮助！"
        },
        {
            "author": "耗子",
            "timestamp": 1522492620,
            "txt_content": "在客户端不应该使用player的openGui方法打开界面，请用我前面所提到的方法"
        }
    ]
}