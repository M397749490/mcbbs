{
    "title": "【命令方块】长指令的合成与分割",
    "author": "tzdgreyd",
    "replyCount": 12,
    "timestamp": 1546590420,
    "txt_content": " 本帖最后由 tzdgreyd 于 2019-1-5 13:22 编辑 \n\n写了个Python的代码，用来把一些单个指令合成长指令，或者把一个长指令分割成多个小指令。\n这里的长指令就是说把一些代码浓缩到一条指令里、放在一个命令方块里。\n用到的方法是把命令方块堆高高+红石块激活+清除的方法，详见MC_taotao发布的教程，教程链接：http://**/thread-15860-1-1.html\n\n更新：之前没考虑命令堆叠造成的Y轴偏移，以及目标区域与命令方块可能有的水平方向偏移的需求。\n现在考虑进来了。\n\n话不多说，直接放代码，长指令的合成：import tkinter\nimport tkinter.filedialog as tf\nimport re\nfile1 = open(tf.askopenfilename(),encoding='UTF-8')\nn=0;\n#dx, dy为红石柱的偏移\ndx = 1;\ndz = 0;\n\n#DX,DY为整个代码要实现位置的偏移量。因为一条指令会产生一柱擎天，所以可能不适用于一些建筑。这里是建筑距离命令方块的距离。\nDX=10;\nDZ=10;\ntotalline='';\n\ndef _dealY(matched):\n    yi=[];\n    y='';\n    global n,DX,DZ\n    for mg in matched.groups():\n        if mg.strip()=='':\n            i=0\n        else:\n            i=int(mg);\n        yi.append(i)\n    yi[0]=yi[0]+DX;\n    yi[1]=yi[1]-n;\n    yi[2]=yi[2]+DZ;\n    print(n)\n    for i in range(0,3):\n        y = y+'~'+ str(yi[i])+' '\n    return y;\n\nwhile True:\n        lines = file1.readline().strip('\\n').replace('\"','\\\\\"');\n        lines = re.sub(r'~(-?[0-9]*?) ~(-?[0-9]*?) ~(-?[0-9]*?) ',_dealY,lines);\n        if not lines:\n                break;\n                pass\n        n = n + 1;    \n        if n==1:\n                totalline = '/summon falling_block ~ ~5 ~ {Time:1,Block:command_block,TileEntityData:{Command:\"' + lines +  '\"}';\n        else:\n                totalline = totalline + ',Passengers:[{id:falling_block,Time:1,Block:command_block,TileEntityData:{Command:\"'+lines+'\"}';\ntotalline = totalline + ',Passengers:[{{id:falling_block,Time:1,Block:command_block,TileEntityData:{{Command:\"/fill ~{0} ~{1} ~{2} ~{3} ~{4} ~{5} redstone_block\"}},Passengers:[{{id:falling_block,Time:1,Block:redstone_block,Passengers:[{{id:falling_block,Time:1,Block:command_block,TileEntityData:{{Command:\"/fill ~{6} ~{7} ~{8} ~{9} ~{10} ~{11} air \"}},Passengers:[{{id:falling_block,Time:1,Block:redstone_block}}]}}]}}]}}]}}'.format(dx,-n,dz,dx,2,dz,0,-(n+2),0,dx,3,dz)+']}'*(n-1);\nprint(totalline)\n\nwith open(file1.name.split('.')[0]+'_LongCommand.txt','w',encoding='UTF-8') as file2:\n    file2.write(totalline);复制代码\n打开的文件和生成的文件如图所示：\n\n\n长指令的分解：import tkinter\nimport tkinter.filedialog as tf\nimport re\n#file1 = tf.askopenfilename()\nn=0;\n#DX,DY为整个代码要实现位置的偏移量。因为一条指令会产生一柱擎天，所以可能不适用于一些建筑。这里是建筑距离命令方块的距离。\nDX=10;\nDZ=10;\n\ntotallines=[];\n\ndef _dealY(matched):\n    yi=[];\n    y='';\n    global n,DX,DZ\n    for mg in matched.groups():\n        if mg.strip()=='':\n            i=0\n        else:\n            i=int(mg);\n        yi.append(i)\n    yi[0]=yi[0]-DX;\n    yi[1]=yi[1]+n;\n    yi[2]=yi[2]-DZ;\n    print(n)\n    for i in range(0,3):\n        y = y+'~'+ str(yi[i])+' '\n    return y;\n\nfile1 = open(tf.askopenfilename(),encoding='UTF-8')\nwhile True:\n        lines = file1.readline().strip('\\n');\n        if not lines:\n                break;\n                pass\n        searchObj = re.findall( r'(/.*?)(?<!\\\\)\"', lines, re.M|re.I)\n        print(searchObj)\nfor i in range(1,len(searchObj)):\n        searchObj[i] = searchObj[i].replace('\\\\\"','\"');\n        searchObj[i] = re.sub(r'~(-?[0-9]*?) ~(-?[0-9]*?) ~(-?[0-9]*?) ',_dealY,searchObj[i]);\n        print(searchObj[i])\n        totallines = totallines+[searchObj[i]];\n        n=n+1;\nprint(totallines)\nwith open(file1.name.split('.')[0]+'_Units.txt','w',encoding='UTF-8') as file2:\n    for i in range(0,len(totallines)-2):\n        if i==len(totallines)-3:\n            file2.write(totallines[i])\n        else:\n            file2.write(totallines[i]+'\\n')复制代码\n效果和之前是反过来的，这个就不截图啦。\n本人编程很渣，有什么错的地方欢迎指出（轻喷）\n\n（真想快点水点经验）\n\n\n",
    "replies": [
        {
            "author": "tzdgreyd",
            "timestamp": 1546590780,
            "txt_content": "来个人回我一下帖子呀嘤嘤嘤，缺经验"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1546591380,
            "txt_content": "可是，我已经有函数了鸭"
        },
        {
            "author": "langyo",
            "timestamp": 1546595700,
            "txt_content": "可是，我已经有函数了鸭"
        },
        {
            "author": "。—。",
            "timestamp": 1546598340,
            "txt_content": "ruhuasiyu 发表于 2019-1-4 16:43\n可是，我已经有函数了鸭\n需要把一些远古级别的OOC拆开看的话还是有这个需求的……"
        },
        {
            "author": "xmdhs",
            "timestamp": 1546635540,
            "txt_content": " 本帖最后由 xmdhs 于 2019-1-5 06:50 编辑 \n\n停留在1.8........"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1546663440,
            "txt_content": "楼主想法不错，\n可是，我已经有函数了鸭。\n（楼主的这个有点像OOC生成器，\n另外多了一个分解的功能）\n分解的功能可以帮助我们把OOC转成函数。"
        },
        {
            "author": "tzdgreyd",
            "timestamp": 1546664340,
            "txt_content": "嘤……我完全不知道OOC生成器这种东西……\n我就只看了那个一条指令的教程，觉得要是有个程序能帮我合成指令就好了。\n于是就自己写了。\n我知道现在函数可以很有用啦，但是也有一些特别的情况，比如说到朋友的主机上玩，发现那里非常贫瘠，于是拿出珍藏的一段生成建筑的代码，xiu地一下给他变出来一个房子……\n之类的？"
        },
        {
            "author": "2386775413",
            "timestamp": 1546666260,
            "txt_content": "tzdgreyd 发表于 2019-1-5 12:59\n嘤……我完全不知道OOC生成器这种东西……\n我就只看了那个一条指令的教程，觉得要是有个程序能帮我合成指令 ...\n你不知道任务里有个可以领6人气的任务么QWQ"
        },
        {
            "author": "tzdgreyd",
            "timestamp": 1546667100,
            "txt_content": "2386775413 发表于 2019-1-5 13:31\n你不知道任务里有个可以领6人气的任务么QWQ\n震惊……听到你说，我去看了才发现有任务、甚至能签到！\n我说我的积分攒这么慢，你们都是怎么水到那种高度的，原来是我没签过到"
        },
        {
            "author": "2386775413",
            "timestamp": 1546667340,
            "txt_content": "tzdgreyd 发表于 2019-1-5 13:45\n震惊……听到你说，我去看了才发现有任务、甚至能签到！\n我说我的积分攒这么慢，你们都是怎么水到那种高 ...\n首页的签到不是很明显么...."
        },
        {
            "author": "xmdhs",
            "timestamp": 1546768080,
            "txt_content": "tzdgreyd 发表于 2019-1-5 12:59\n嘤……我完全不知道OOC生成器这种东西……\n我就只看了那个一条指令的教程，觉得要是有个程序能帮我合成指令 ...\n但是不同版本，指令是有差异的。。。\n\n比如你用 1.13 的指令来试试你这个工具。"
        },
        {
            "author": "305822437",
            "timestamp": 1547030700,
            "txt_content": "tzdgreyd 发表于 2019-1-5 13:45\n震惊……听到你说，我去看了才发现有任务、甚至能签到！\n我说我的积分攒这么慢，你们都是怎么水到那种高 ...\n震惊……还有签到"
        }
    ]
}