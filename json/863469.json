{
    "title": "Forge Energy 能量传递的问题",
    "author": "清华儒墨",
    "replyCount": 0,
    "timestamp": 1557072120,
    "txt_content": " 本帖最后由 s091424 于 2019-5-6 00:16 编辑 \n\nForge Energy就是Forge内建的CapabilityEnergy\n版本: 1.12.2\n使用以下代码对旁边有CapabilityEnergy的TileEntity发送能量是可行的\n(蓝色的方块为我弄的发电机)\n\n\n\n\n2019-05-05_23.59.54.png (164.41 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-6 00:00 上传\n\n\n\n\n\npublic static void sendToAround(TileEntity ote, World world, BlockPos pos, int maxSend) {\n        IEnergyStorage storage = ote.getCapability(CapabilityEnergy.ENERGY, null);\n        if (storage.getEnergyStored() > 0) {\n            HashMap<TileEntity, EnumFacing> sides = new HashMap<>();\n            Arrays.stream(EnumFacing.VALUES)\n                    .forEach(side -> {\n                        TileEntity te = world.getTileEntity(pos.offset(side));\n                        if (te != null && te.hasCapability(CapabilityEnergy.ENERGY, side)) {\n                            sides.put(te, side);\n                        }\n                    });\n            sides.forEach((te, side) -> {\n                doEnergyInteraction(ote, te, side, maxSend);\n            });\n        }\n    }\n\n    public static void doEnergyInteraction(TileEntity tileFrom, TileEntity tileTo, EnumFacing sideTo, int maxTransfer) {\n        if (maxTransfer > 0) {\n            EnumFacing opp = sideTo == null ? null : sideTo.getOpposite();\n            IEnergyStorage from = tileFrom.getCapability(CapabilityEnergy.ENERGY, sideTo);\n            IEnergyStorage to = tileTo.getCapability(CapabilityEnergy.ENERGY, opp);\n            if (from != null && to != null) {\n                int drain = from.extractEnergy(maxTransfer, true);\n                if (drain > 0) {\n                    int filled = to.receiveEnergy(drain, false);\n                    from.extractEnergy(filled, false);\n                    tileTo.getWorld().notifyBlockUpdate(tileTo.getPos(),\n                            tileTo.getWorld().getBlockState(tileTo.getPos()),\n                            tileTo.getWorld().getBlockState(tileTo.getPos()),\n                            3);\n                    tileTo.markDirty();\n                    return;\n                }\n            }\n        }\n    }复制代码\n可是使用Thermal Expansion导管传电的时候 \n这样传电是不行的，因为第一条导管只会向前面传电\n\n\n\n\n2019-05-05_23.50.22.png (340.71 KB, 下载次数: 1)\n\n下载附件\n\n2019-5-5 23:50 上传\n\n\n\n\n\n要在相同方向多放一条导管才会变为正常的传电\n\n\n\n\n2019-05-05_23.51.08.png (355.06 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-5 23:53 上传\n\n\n\n\n\nEnderIO导管更是只能传1格电\n\n\n\n\n2019-05-05_23.55.01.png (232.67 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-5 23:55 上传\n\n\n\n\n\n这样就不行了\n\n\n\n\n2019-05-05_23.55.32.png (258.98 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-5 23:55 上传\n\n\n\n\n\n\n问题: \n怎么会出现这个状况呢? \nTE与EnderIO导管的代码应该是正确的，而从代码中我也成功将能量发送到TileEntity中了。\n\n",
    "replies": []
}