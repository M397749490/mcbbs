{
    "title": "把方块炸飞。。。",
    "author": "Hineven",
    "replyCount": 0,
    "timestamp": 1453359360,
    "txt_content": "private static double func1(double num1,double num2){\n                if(num1<0)return num1+num2;\n                return num1-num2;\n        }\n        private static double disFromCenter(Vector v){\n                return Math.sqrt(v.getX()*v.getX()+v.getY()*v.getY()+v.getZ()*v.getZ());\n        }\n        private static void weaken(Vector v,double wval){\n                double dis=disFromCenter(v);\n                v.setX(func1(v.getX(),(wval/dis)*v.getX()));\n                v.setY(func1(v.getY(),(wval/dis)*v.getY()));\n                v.setZ(func1(v.getZ(),(wval/dis)*v.getZ()));\n        }\n        private static double distance(Location loc,double x,double y,double z){\n                return Math.sqrt((loc.getX()-x)*(loc.getX()-x)+(loc.getY()-y)*(loc.getY()-y)+(loc.getZ()-z)*(loc.getZ()-z));\n        }\n        \n        public static List<Entity> explore(Location loc,int damage,int raidus){\n                \n                World hdw=loc.getWorld();\n                \n                List<Entity> ret=new ArrayList<Entity>();\n                Collection<Entity> sch=loc.getWorld().getNearbyEntities(loc,raidus,raidus,raidus);\n                for(Entity e:sch){\n                        if(loc.distance(e.getLocation())<=raidus)ret.add(e);\n                }\n                for(int x=loc.getBlockX()-raidus;x<=loc.getBlockX()+raidus;x++)\n                        for(int y=loc.getBlockY()-raidus;y<=loc.getBlockY()+raidus;y++)\n                                for(int z=loc.getBlockZ()-raidus;z<=loc.getBlockZ()+raidus;z++){\n                                        if(distanceSquared(loc,x,y,z)<=raidus*raidus){\n                                                Block b=hdw.getBlockAt(x,y,z);\n                                                if(!b.getType().isBlock())continue;\n                                                if(b.getType().getMaxDurability()>(short)(damage-damage*((distance(loc,x,y,z)/raidus))))continue;\n                                                Location bkat=b.getLocation();\n                                                Material type=b.getType();\n                                                if(b.breakNaturally(null)){\n                                                        FallingBlock ent=hdw.spawnFallingBlock(bkat,type,(byte) 0);\n                                                        ret.add(ent);\n                                                }\n                                        }\n                }\n                for(Entity e:ret){\n                        Vector v=e.getVelocity();//\n                        Vector v2=e.getLocation().subtract(loc).toVector();\n                        double dis=e.getLocation().distance(loc);\n                        double proportion=(double)(raidus)/dis;\n                        v2.setX(v2.getX()*proportion);\n                        v2.setY(v2.getY()*proportion);\n                        v2.setZ(v2.getZ()*proportion);\n                        weaken(v2,dis);\n                        v2.multiply(0.2f);\n                        v.add(v2);\n                        e.setVelocity(v);\n                }\n                \n                return ret;\n                \n                //TODO\n                \n        }\n        private static double distanceSquared(Location loc, int x, int y, int z) {\n                return (loc.getX()-x)*(loc.getX()-x)+(loc.getY()-y)*(loc.getY()-y)+(loc.getZ()-z)*(loc.getZ()-z);\n        }复制代码\n顺便问一下其中的spawnFallingBlock不被推荐使用，不知道能用什么代替。\n",
    "replies": []
}