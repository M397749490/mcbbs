{
    "title": "[已解决] 写了个怪物后重启服务器它就拿着弓进行近战了..怎么解决",
    "author": "和煦樱",
    "replyCount": 2,
    "timestamp": 1592548620,
    "txt_content": " 本帖最后由 和煦樱 于 2020-7-22 18:11 编辑 \n\n生成出来时还是会射箭，但重启服务器或者单人游戏退出游戏重进后 它就失去了远程攻击AI，有什么好的方法解决吗..public class EntityGaiaCentaur extends EntityMob implements IRangedAttackMob {\n\n        private EntityAIArrowAttack AIArrowAttack = new EntityAIArrowAttack(this, 1.0D, 20, 60, 15.0F);\n        private EntityAIAttackOnCollide AIAttackOnCollide = new EntityAIAttackOnCollide(this, EntityPlayer.class, 1.2D, false);\n        \n        public EntityGaiaCentaur(World par1World) {\n                super(par1World);\n                stepHeight = 1.0F;\n                //浮在水上的AI\n                tasks.addTask(2, new EntityAISwimming(this));\n                //在周围漫步走动的AI\n                tasks.addTask(2, new EntityAIWander(this, 0.5D));\n                //看玩家的AI\n                tasks.addTask(3, new EntityAIWatchClosest(this, EntityPlayer.class, 8.0F));\n                tasks.addTask(3, new EntityAILookIdle(this));\n                //会攻击周围玩家的AI\n                targetTasks.addTask(1, new EntityAINearestAttackableTarget(this, EntityPlayer.class, 0, true));\n            if(par1World != null && !par1World.isRemote) {\n                    setCombatTask();\n            }\n        }\n        \n        protected void applyEntityAttributes() {\n                super.applyEntityAttributes();\n                this.getEntityAttribute(SharedMonsterAttributes.followRange).setBaseValue(35.0D);\n                this.getEntityAttribute(SharedMonsterAttributes.movementSpeed).setBaseValue(0.35D);\n        }\n        \n        //射箭代码优化\n        public void attackEntityWithRangedAttack(EntityLivingBase par1EntityLivingBase, float par2) {\n                EntityArrow entityarrow = new EntityArrow(this.worldObj, this, par1EntityLivingBase, 1.6F, (float)(14 - this.worldObj.difficultySetting.ordinal() * 4));\n                entityarrow.setDamage((double)(par2 * 2.0F) + this.rand.nextGaussian() * 0.25D + (double)((float)this.worldObj.difficultySetting.ordinal() * 0.11F));\n                entityarrow.setKnockbackStrength(1);\n                playSound(\"random.bow\", 1.0F, 1.0F / (this.getRNG().nextFloat() * 0.4F + 0.8F));\n                worldObj.spawnEntityInWorld(entityarrow);\n        }\n\n        public boolean isAIEnabled() {\n                return true;\n        }\n\n        protected String getLivingSound() {\n                return \"gaia:assist_say\";\n        }\n\n        protected String getHurtSound() {\n                return \"gaia:assist_hurt\";\n        }\n\n        protected String getDeathSound() {\n                return \"gaia:assist_death\";\n        }\n\n        protected void playStepSound(int par1, int par2, int par3, int par4) {\n                this.playSound(\"mob.pig.step\", 0.15F, 1.0F);\n        }\n        \n        public IEntityLivingData onSpawnWithEgg(IEntityLivingData par1IEntityLivingData) {\n                par1IEntityLivingData = super.onSpawnWithEgg(par1IEntityLivingData);\n                setCurrentItemOrArmor(0, new ItemStack(Items.bow));\n                return par1IEntityLivingData;\n        }\n\n        \n        public void setCombatTask() {\n                tasks.removeTask(AIAttackOnCollide);\n                tasks.removeTask(AIArrowAttack);\n            ItemStack MainWeapon = getHeldItem();\n            if(MainWeapon != null && MainWeapon.getItem() == Items.bow) {\n                    tasks.addTask(1, AIArrowAttack);\n            } else {\n                    tasks.addTask(1, AIAttackOnCollide);\n            }\n        }\n        \n        public void setCurrentItemOrArmor(int p_70062_1_, ItemStack MainWeapon) {\n            super.setCurrentItemOrArmor(p_70062_1_, MainWeapon);\n            if(!worldObj.isRemote && p_70062_1_ == 0) {\n                    setCombatTask();\n            }\n        }\n\n}复制代码\n",
    "replies": [
        {
            "author": "寒霜夜影",
            "timestamp": 1592552040,
            "txt_content": "看不懂。。。。。。。。。"
        },
        {
            "author": "和煦樱",
            "timestamp": 1595412660,
            "txt_content": "        public void readEntityFromNBT(NBTTagCompound p_70037_1_) {\n                super.readEntityFromNBT(p_70037_1_);\n            setCombatTask();\n        }复制代码"
        }
    ]
}