{
    "title": "[原创][NPS] 简单的Nukkit插件制作教程",
    "author": "Actahedral",
    "replyCount": 13,
    "timestamp": 1558784820,
    "txt_content": " 本帖最后由 wode490390 于 2019-7-29 21:10 编辑 \n\n本教程可以帮助Nukkit的新手开发者踏出Nukkit插件开发的第一步，阅读本文需要有一些Java基础以及英语基础。没有排版差评\n\nJava开发肯定需要JDK\n\n\n\n\n\n20190525171503.png (27.62 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-25 17:15 上传\n\n\n\n\n\n\n本文以JDK8u212为例\n\n\n\n\n\n20190525170808.png (30.49 KB, 下载次数: 3)\n\n下载附件\n\n2019-5-25 17:08 上传\n\n\n\n\n\n\n首先要接受协议，然后选择适用的JDK下载安装\n\n本文使用NetBeans作IDE\n\n\n\n\n\n20190525171154.png (19.58 KB, 下载次数: 5)\n\n下载附件\n\n2019-5-25 17:12 上传\n\n\n\n\n\n\n下载后解压到文件夹就能用了\n\n\n\n\n\n20190525171236.png (28.21 KB, 下载次数: 5)\n\n下载附件\n\n2019-5-25 17:12 上传\n\n\n\n\n\n\n下载Nukkit官方的例子插件\n\n\n\n\n\n20190525205358.png (34.74 KB, 下载次数: 6)\n\n下载附件\n\n2019-5-25 20:54 上传\n\n\n\n\n\n\n下载后解压到文件夹\n\n打开IDE，左上角“文件”-“打开项目”\n\n\n\n\n\n20190525171914.png (7.69 KB, 下载次数: 3)\n\n下载附件\n\n2019-5-25 17:19 上传\n\n\n\n\n\n\n选择刚才解压出来的例子插件打开\n\n\n\n\n\n20190525172314.png (38.48 KB, 下载次数: 5)\n\n下载附件\n\n2019-5-25 17:23 上传\n\n\n\n\n\n\n首先要修改包名，不能以 cn.nukkit 为包名\n\n展开“源包”内容，右击 cn.nukkit.exampleplugin 包\n\n选择“重构”，点击“重命名”\n\n\n\n\n\n20190525173115.png (37.65 KB, 下载次数: 3)\n\n下载附件\n\n2019-5-25 17:33 上传\n\n\n\n\n\n\n可以把它改成 mcbbs.wode490390.exampleplugin\n\n然后点击“重构”\n\n\n\n\n\n20190525173248.png (9.75 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-25 17:39 上传\n\n\n\n\n\n\n当然，改成其它的也行，如：\n\ncom.snake1999.examplepluginnet.mcbbs.tutorialpluginru.nukkit.nkexampleme.xxx.firstplugin\n\n\n然后打开ExamplePlugin类\n\n我们可以看见\n\npublic class ExamplePlugin extends PluginBase {复制代码\n\n这是ExamplePlugin类继承PluginBase类的意思\n\n每个插件都必须有一个主类继承PluginBase类以让Nukkit识别\n\n然后我们看见\n\n    @Override\n    public void onLoad() {\n        ...\n    }复制代码\n\n这是重写PluginBase类onLoad方法的意思\n\nonLoad方**在插件读取时触发\n\n下面我们还会看到\n\n    @Override\n    public void onEnable() {\n        ...\n    }复制代码\n\n这个方**在插件启用时触发\n\n    @Override\n    public void onDisable() {\n        ...\n    }复制代码\n\n这个方**在插件关闭时触发\n\n然后我们看到onLoad方法中\n\nthis.getLogger().info(TextFormat.WHITE + \"I've been loaded!\");复制代码\n\n这样能在本插件的日志器中记录一条白色字体的信息\n\n接着我们在onEnable方法中看到\n\nthis.getServer().getPluginManager().registerEvents(new EventListener(this), this);复制代码\n\n这是在服务器的插件管理器中注册事件监听器的意思\n\n现在来看看EventListener类\n\npublic class EventListener implements Listener {复制代码\n\n所有的事件监听器都需要实现Listener接口\n\n负责处理事件的方法必须加上 @EventHandler 注解\n\n    @EventHandler\n    public void onServerCommand(ServerCommandEvent event) {\n        ...\n    }复制代码\n\n例子中的注解有参数\n\n@EventHandler(priority = EventPriority.NORMAL, ignoreCancelled = false)复制代码\n\nignoreCancelled 是否忽略取消继续调用\n\npriority 监听器的优先级\n\n一般情况下不需要参数\n\n回到主类onEnable方法中继续看\n\nthis.getServer().getScheduler().scheduleRepeatingTask(new BroadcastPluginTask(this), 200);复制代码\n\n这是在服务器的调度器中每隔200tick重复调度一次BroadcastPluginTask任务的意思\n\n现在来看看BroadcastPluginTask类\n\npublic class BroadcastPluginTask extends PluginTask<ExamplePlugin> {复制代码\n\n插件任务应当继承PluginTask类\n\n    @Override\n    public void onRun(int currentTick) {\n        ...\n    }复制代码\n\n我们重写PluginTask类的onRun方法，把任务操作写进这个方法就行了\n\n回到主类onEnable方法中继续看\n\nthis.saveResource(\"string.txt\");复制代码\n\n这是保存string.txt资源到本插件数据文件夹的意思\n\n现在展开左侧项目“其它源”，直到“默认包”\n\n\n\n\n\n20190525183810.png (8.29 KB, 下载次数: 6)\n\n下载附件\n\n2019-5-25 18:38 上传\n\n\n\n\n\n\n我们看到string.txt就在“默认包”下\n\n“默认包”中还有一个plugin.yml，打开它\n\n先看重要的东西\n\nname: ExamplePlugin复制代码\n\nExamplePlugin改成插件的名称，不能和其它插件重名\n\nmain: cn.nukkit.exampleplugin.ExamplePlugin复制代码\n\nmain填写插件的主类\n\n例子插件的主类是ExamplePlugin，位于 mcbbs.wode490390.exampleplugin 包下\n\n那我们就改成\n\nmain: mcbbs.wode490390.exampleplugin.ExamplePlugin复制代码\n\n然后是其它的一些信息\n\n# 插件版本\nversion: \"1.0.0\"\n# API版本\napi: [\"1.0.5\"]\n# 加载顺序\nload: POSTWORLD\n#作者\nauthor: Nukkit Project\n# 介绍\ndescription: Example plugin showing the API复制代码\n\n然后就是一些不是很重要的东西了\n\n# 如果有多个作者\nauthors: [\"Example\", \"Another\"]\n# 网站\nwebsite: https://github.com/NukkitX/ExamplePlugin\n# 依赖\n#depend: [\"OtherPlugin\", \"ThisPlugin\"]\n# 软依赖\nsoftdepend: [\"PluginA\", \"PluginB\"]\n# 日志前缀\nprefix: \"Example\"\n# 在哪些插件加载前加载\nloadbefore: [\"ImportantPlugin\"]复制代码\n\n可以便捷地在这里配置命令\n\ncommands:\n  # 命令\n  example:\n    # 介绍\n    description: Example command\n    # 用法\n    usage: \"/example\"\n    # 别名\n    aliases: [\"xample\", \"nukkitexample\"]\n    # 权限\n    permission: exampleplugin.command.example\n    # 无权限的提示\n    permission-message: \"You do not have the required permission to run /example\"复制代码\n\n也可以便捷地在这里配置权限\n\npermissions:\n  # 权限节点\n  exampleplugin.command.example:\n    # 介绍\n    description: \"Allows the user to run the example command\"\n    # 默认拥有\n    default: true\n    # 子权限\n    children:\n      exampleplugin.command.example.test:\n        description: \"Use the test feature in the example command\"\n        default: true复制代码\n\n配置好了命令与权限，现在回到主类接收命令吧\n\n重写PluginBase类的onCommand方法\n\n    @Override\n    public boolean onCommand(CommandSender sender, Command command, String label, String[] args) {\n        ...\n        return boolean;\n    }复制代码\n\n插件每次收到命令都会调用这个方法\n\ncommand参数可以通过getName方法获得执行的命令\n\nsender参数是命令发送者\n\nargs是命令的参数\n\n这个方法需要返回一个布尔值\n\n返回false的话会发送命令的用法给发送者\n\n例子插件中\n\n        switch (command.getName().toLowerCase()) {\n            case \"example\":\n                ...\n                break;\n        }复制代码\n\n先将命令全部小写处理，这样就不用担心大小写问题了\n\n我们再次回到onEnable方法看最后一个部分\n\n            Config config = new Config(\n                new File(this.getDataFolder(), \"config.yml\"),\n                Config.YAML,\n                new LinkedHashMap<String, Object>() {\n                    {\n                        put(\"this-is-a-key\", \"Hello! Config!\");\n                        put(\"another-key\", true);\n                    }\n                });复制代码\n\n这样我们就在插件数据文件夹创建了名为config.yml的Yaml格式的配置文件\n\n并且有了两条数据\n\nthis.getLogger().info(String.valueOf(config.get(\"this-is-a-key\", \"this-is-default-value\")));复制代码\n\n配置可以用get方法读取某某键的值\n\nconfig.save();复制代码\n\n最后我们将配置保存\n\nthis-is-a-key: \"Hello! Config!\"\nanother-key: true复制代码\n\n配置文件应该是酱紫的\n\n完成代码后需要将其打包\n\n顶部点击“运行”-“清理并构建项目”\n\n\n\n\n\n20190525191752.png (36.78 KB, 下载次数: 3)\n\n下载附件\n\n2019-5-25 19:18 上传\n\n\n\n\n\n\n如果代码没有问题，片刻后就能构建成功\n\n\n\n\n\n20190525192316.png (13.78 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-25 19:23 上传\n\n\n\n\n\n\n成果在项目文件夹的target目录里\n\n把它复制到服务端plugins文件夹运行吧\n\n\n\n\n\n20190525192636.png (41.18 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-25 19:26 上传\n\n\n\n\n\n\n全文完\n\n任何问题都可以回帖询问\n\n\n\n\n[groupid=1572]Nukkit Plugin Studio[/groupid]",
    "replies": [
        {
            "author": "超神的冰凉",
            "timestamp": 1558964340,
            "txt_content": "你好，请问获取玩家所在世界的方法是什么？我在nukkitdoc的player和level类里没有找到。"
        },
        {
            "author": "Actahedral",
            "timestamp": 1558979640,
            "txt_content": "超神的冰凉 发表于 2019-5-27 21:39\n你好，请问获取玩家所在世界的方法是什么？我在nukkitdoc的player和level类里没有找到。 ...\nplayer.getLevel()"
        },
        {
            "author": "1723624171",
            "timestamp": 1559033220,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "三只猫m",
            "timestamp": 1559362440,
            "txt_content": "1723624171 发表于 2019-5-28 16:47\n**** 作者被禁止或删除 内容自动屏蔽 ****\n哈哈哈，活该让你不看介绍就瞎说瞎评论而且还恶意灌水被禁言了都是活该！"
        },
        {
            "author": "三只猫m",
            "timestamp": 1559362500,
            "txt_content": "教程不错就是...看起来小白学这个好难"
        },
        {
            "author": "FFF团总团长",
            "timestamp": 1564401780,
            "txt_content": "各种**哈哈，这个方法，会在XX时触发"
        },
        {
            "author": "ItsZeroHikari",
            "timestamp": 1564408380,
            "txt_content": "大佬大佬,怎么通过玩家名get到玩家"
        },
        {
            "author": "Actahedral",
            "timestamp": 1564412100,
            "txt_content": "tutity_tiger 发表于 2019-7-29 21:53\n大佬大佬,怎么通过玩家名get到玩家\nServer.getPlayer(name)"
        },
        {
            "author": "KingSmile",
            "timestamp": 1575860940,
            "txt_content": "很棒的教程,如果可以的话建议在内容结尾处添加个 nukkit的api文档"
        },
        {
            "author": "hanhelong11",
            "timestamp": 1576543680,
            "txt_content": "感谢大佬的分享"
        },
        {
            "author": "ddoc",
            "timestamp": 1577332440,
            "txt_content": "提示: 该帖被管理员或版主屏蔽"
        },
        {
            "author": "微醉的阳光",
            "timestamp": 1580510220,
            "txt_content": "有没有让插件给连接服务器的软件（不是同一个端口）发送信息"
        },
        {
            "author": "舞东芳",
            "timestamp": 1582111560,
            "txt_content": "某白楼主"
        }
    ]
}