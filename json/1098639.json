{
    "title": "mmocore数据库问题",
    "author": "w1632050253",
    "replyCount": 8,
    "timestamp": 1597069320,
    "txt_content": "服务器使用MMOCore的数据库每次跨服mmocore的数据清空\n后台就会报错\nmysql的版本是5.7以上（我不清楚5.7还是8）\n\n\nmmocore两个服的配置为：（俩都一样的）\n# Auto-Save feature automatically saves playerdata\n# (class, level, etc.) and guild data\n# (guild names, members, etc.) at a set interval.\nauto-save:\n    enabled: true\n    interval: 60 # In seconds (1800 = 30 minutes)\n\n# MySQL Support\nmysql:\n    enabled: true\n    database: mmo\n    host: localhost\n    port: 3306\n    user: root\n    pass: 123456\n    flags: '?autoReconnect=true&useSSL=true'\n每次跨服若设置了职业，或者加了职业点后就会报错，然后数据到那个服就会清空（重置）。\n\n[22:13:55] [Craft Scheduler Thread - 16/WARN]: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was 143,043 milliseconds ago.  The last packet sent successfully to the server was 0 milliseconds ago.\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.lang.reflect.Constructor.newInstance(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:990)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3517\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3417)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3860)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2524)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2675)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2465)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1912)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2020)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at net.Indyuce.mmocore.manager.data.mysql.MySQLDataProvider.getResult(MySQLDataProvider.java:36)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at net.Indyuce.mmocore.manager.data.mysql.MySQLPlayerDataManager.loadData(MySQLPlayerDataManager.java:37)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at net.Indyuce.mmocore.manager.data.PlayerDataManager.lambda$setup$1(PlayerDataManager.java:51)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at org.bukkit.craftbukkit.v1_15_R1.scheduler.CraftTask.run(CraftTask.java:81)\n[22:13:55] [Craft Scheduler Thread - 3/INFO]: [QuestCreator] DEBUG: Loaded QuestBoard for QCDataManager (took 12 ms)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at org.bukkit.craftbukkit.v1_15_R1.scheduler.CraftAsyncTask.run(CraftAsyncTask.java:54)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.lang.Thread.run(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]: Caused by: java.net.SocketException: Software caused connection abort: recv failed\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.net.SocketInputStream.socketRead0(Native Method)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.net.SocketInputStream.socketRead(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.net.SocketInputStream.read(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at java.net.SocketInputStream.read(Unknown Source)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:101)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:144)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:174)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2966)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3427)\n[22:13:55] [Craft Scheduler Thread - 16/WARN]:  ... 15 more\n[22:13:55] [Craft Scheduler Thread - 16/ERROR]: [MMOCore] Failed to load playerdata of 'W55' from MySQL server\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@59429795 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@4392abd0 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@202619be (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 21/WARN]: [MysqlPlayerDataBridge] Database connection is idle or terminated. Reconnecting...\n[22:13:55] [Craft Scheduler Thread - 21/WARN]: [MysqlPlayerDataBridge] Reconnecting the GetData connection...\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@6d15cc10 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@e4eedd (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@56fe193a (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 21/INFO]: [MysqlPlayerDataBridge] GetData connection reconnected!\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@468511b2 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@533303e (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@2206a443 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\n[22:13:55] [Craft Scheduler Thread - 13/WARN]: [Craft Scheduler Thread - 13] WARN me.Yi.libs.zaxxer.hikari.pool.PoolBase - XConomy - Failed to validate connection com.mysql.jdbc.JDBC4Connection@4974ef0 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.复制代码求大神救救孩子吧",
    "replies": [
        {
            "author": "The_jimeng",
            "timestamp": 1597074240,
            "txt_content": "mysql 那边截图看一下"
        },
        {
            "author": "w1632050253",
            "timestamp": 1597098420,
            "txt_content": "The_jimeng 发表于 2020-8-10 23:44\nmysql 那边截图看一下\n\n\n\n\n批注 2020-08-11 062640.png (80.09 KB, 下载次数: 0)\n\n下载附件\n\n2020-8-11 06:27 上传\n\n\n\n\n\n"
        },
        {
            "author": "xiaoliuwu",
            "timestamp": 1597115220,
            "txt_content": "这个插件没试过跨服！但是很多插件写支持mysql 但是实际上他只是换了一种存储方式！并不支持云组同步！\n还有一点就是数据库的连接池！你看看大小设置了多少！调大一点！\n报错里牵扯了2个 插件！\n你可以试一下单端连接数据库 看看插件有没有正常存储 玩家资料！如果正常存储！在开一个端跳过去报错 清档的话！\n要么插件不支持跨服同步！要么数据库连接池数值太低"
        },
        {
            "author": "w1632050253",
            "timestamp": 1597119120,
            "txt_content": "xiaoliuwu 发表于 2020-8-11 11:07\n这个插件没试过跨服！但是很多插件写支持mysql 但是实际上他只是换了一种存储方式！并不支持云组同步！\n还 ...\n请问如何设置mysql的连接池啊\n我将mysql的wait_timeout值改成388000\n然后就停止报错了。\n但是我看百度是要设置c3p0的连接池来解决这个问题\n我想问问怎么实现"
        },
        {
            "author": "xiaoliuwu",
            "timestamp": 1597119360,
            "txt_content": "w1632050253 发表于 2020-8-11 12:12\n请问如何设置mysql的连接池啊\n我将mysql的wait_timeout值改成388000\n然后就停止报错了。\n停止报错之后数据同步了吗？ 如果切换服务器不报错的话 数据且不能同步的情况！\n那就是此插件的数据库就是一个伪数据库！\n好多插件功能强大 无法支持跨服同步！只是做了一种数据库存储 让资料更安全一些而已！"
        },
        {
            "author": "w1632050253",
            "timestamp": 1597119480,
            "txt_content": "xiaoliuwu 发表于 2020-8-11 12:16\n停止报错之后数据同步了吗？ 如果切换服务器不报错的话 数据且不能同步的情况！\n那就是此插件的数据库就 ...\n实现同步了。数据库中表的内容也有了"
        },
        {
            "author": "xiaoliuwu",
            "timestamp": 1597207200,
            "txt_content": "w1632050253 发表于 2020-8-11 12:18\n实现同步了。数据库中表的内容也有了\n那为什么不给我金粒呀兄嘚！~"
        },
        {
            "author": "w1632050253",
            "timestamp": 1597211760,
            "txt_content": "xiaoliuwu 发表于 2020-8-12 12:40\n那为什么不给我金粒呀兄嘚！~\n哥们我自己解决的我为什么给你？"
        }
    ]
}