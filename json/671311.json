{
    "title": "重大地图生成BUG",
    "author": "Because.",
    "replyCount": 46,
    "timestamp": 1486350480,
    "txt_content": "\n\n\n\n\n\n--------“如果没有体会到同样的痛苦的话，是无法真正理解对方的。”\n            “即便真正理解了，也不意味着一定能志同道合。”\n            “这就是，事实。”\n\n",
    "replies": [
        {
            "author": "AlbertBlue",
            "timestamp": 1486351020,
            "txt_content": "标题: 重大地图生成BUG 本帖最后由 Lightning_Reed 于 2017-2-6 09:24 编辑 \n\n当你在地图生成时输入种子 107038380838084或者164311266871034的时候，地图就会出现矿洞和地牢无限重复BUG\n如下\n\n\n\n\n\n\n在youtube上看到的，顺便把视频搬过来了\n[bili=8432741]1[/bili]\n[bili=8432741]2[/bili]\n当然地图种子是一位玩家算出来的 \n原理如下\n\n由于本人不懂java所以看不懂  详情请看23楼  一位大佬给出了详细的解释\n\n一个种子是X轴无限重复 一个是Z轴无限重复 地狱的矿洞也是同样的现象，地狱堡垒不是,用这地图生存可以说...\n\n\n\n\n\n\n"
        },
        {
            "author": "670116890",
            "timestamp": 1486351260,
            "txt_content": "密集恐惧症感觉要命啊"
        },
        {
            "author": "YPXxiaoK",
            "timestamp": 1486351380,
            "txt_content": "没错，但是如果用这地图生存的话。。"
        },
        {
            "author": "葉子の",
            "timestamp": 1486351680,
            "txt_content": "Jeb:这叫特性！\n从何bug说起？"
        },
        {
            "author": "背着书包丶",
            "timestamp": 1486351860,
            "txt_content": "什么鬼 这太。。"
        },
        {
            "author": "BlackLanter",
            "timestamp": 1486352040,
            "txt_content": "天生可以拿来做地图"
        },
        {
            "author": "博中",
            "timestamp": 1486352700,
            "txt_content": "我更想知道，为什么会这样？"
        },
        {
            "author": "Smokey_Days",
            "timestamp": 1486352880,
            "txt_content": "实际上这个是彩蛋233=w="
        },
        {
            "author": "2387729849",
            "timestamp": 1486353180,
            "txt_content": "楼主这个种子是只要一移动就开始乱动吗？\n如果是，可能是楼主的硬件问题"
        },
        {
            "author": "AlbertBlue",
            "timestamp": 1486353360,
            "txt_content": "2387729849 发表于 2017-2-5 22:53\n楼主这个种子是只要一移动就开始乱动吗？\n如果是，可能是楼主的硬件问题 ...\n不是，你自己试试就知道了,地图生成的BUG，而且其他人也是这样。"
        },
        {
            "author": "3705",
            "timestamp": 1486353420,
            "txt_content": "这个地图不会是mojang玩坏的吧。。。\n“bugjump”：特性！都说了我们出的是特性！！！"
        },
        {
            "author": "月lonely",
            "timestamp": 1486359480,
            "txt_content": "如果拿这个地图搞服务器的话...."
        },
        {
            "author": "smallord",
            "timestamp": 1486361280,
            "txt_content": "貌似这bug已经有老多实况主拍视频了......我3个月就知道了.....不过混乱出现我真的感到意外.."
        },
        {
            "author": "TNT嘉音",
            "timestamp": 1486361700,
            "txt_content": "应该是1.7以上的种子吧。"
        },
        {
            "author": "2639358455",
            "timestamp": 1486362120,
            "txt_content": "不知官方是怎么想的"
        },
        {
            "author": "sheephot",
            "timestamp": 1486362720,
            "txt_content": "66666这到底是多小的概率啊"
        },
        {
            "author": "AWA5189456",
            "timestamp": 1486363200,
            "txt_content": "没一颗树咋生存呐"
        },
        {
            "author": "AWA5189456",
            "timestamp": 1486363260,
            "txt_content": "AWA5189456 发表于 2017-2-6 14:40\n没一颗树咋生存呐\n等等废弃矿...好吧"
        },
        {
            "author": "Time_Paradox",
            "timestamp": 1486363980,
            "txt_content": "居然把混乱骗进来了（滑稽"
        },
        {
            "author": "Kelcoin",
            "timestamp": 1486367580,
            "txt_content": "唯一的BUG就是帧数过高的BUG\n这是特性！！"
        },
        {
            "author": "憨怂蚂蚁",
            "timestamp": 1486369320,
            "txt_content": "那不就有无限多的矿了"
        },
        {
            "author": "土球球",
            "timestamp": 1486381500,
            "txt_content": " 本帖最后由 ustc_zzzz 于 2017-2-7 10:25 编辑 \n\n这一现象的代码解释？其实楼主的第一个视频的1分20秒已经给出解释了。。。\n其实这要是硬说是Mojang往里塞的彩蛋也不是不可以。。。这件事和Java的随机数生成有关。\n\nMinecraft中，地形生成以区块为单位，我们先看看作用在每个区块上的，生成相关地下地形的代码：\n    public void generate(World worldIn, int x, int z, ChunkPrimer primer)\n    {\n        int i = this.range;\n        this.world = worldIn;\n        this.rand.setSeed(worldIn.getSeed());\n        long j = this.rand.nextLong();\n        long k = this.rand.nextLong();\n\n        for (int l = x - i; l <= x + i; ++l)\n        {\n            for (int i1 = z - i; i1 <= z + i; ++i1)\n            {\n                long j1 = (long)l * j;\n                long k1 = (long)i1 * k;\n                this.rand.setSeed(j1 ^ k1 ^ worldIn.getSeed()); // 设置单独为区块所用的种子\n                this.recursiveGenerate(worldIn, l, i1, x, z, primer); // 针对该区块的具体的生成\n            }\n        }\n    }复制代码\n（该代码由MCP生成，对应的类为“net.minecraft.world.gen.MapGenBase”）\n\n我们知道计算机只能生成伪随机数，比如说对于MC而言，设置一个种子就可以保证每次生成的世界是几乎相同的，这是因为对于计算机的随机数生成器而言，设置一个种子就能保证每次生成的随机数序列是一致的，对于MC依赖的Java而言，如果我们设置种子为1和2，那么生成的随机数序列为：\n1：-4964420948893066024，7564655870752979346，3831662765844904176，6137546356583794141。。。\n2：-4959463499243013640，-1817970389778669801，9164759175887871693，-260524486875061426。。。复制代码\n如果设置为其他数：\n4：-4969378402838085704，-1499461942424923123，-1501433639903096045，-5911126865076967316。。。\n5：-4971030886054769832，1628080142987304160，9018696937790626762，8519392794254051655。。。\n0：-4962768465676381896，4437113781045784766，-6688467811848818630，-8292973307042192125。。。复制代码\n当我们设置种子为107038380838084和164311266871034时，神奇的事情发生了：\n107038380838084：0，18177319682724942，3258481617619292844，1684752427500229010。。。\n164311266871034：7884338545699851846，0，18177319682724942，3258481617619292844。。。复制代码\n正如各位看官所见到的那样，两个种子分别生成的随机数序列的第一个数和第二个数分别为0。\n\n我们现在把这件事再代入到代码中看看：\n        this.rand.setSeed(worldIn.getSeed());\n        long j = this.rand.nextLong();\n        long k = this.rand.nextLong();复制代码\n第一行代码设置了Java的随机数发生器的种子为世界的种子，第二行代码和第三行代码分别取了随机数发生器生成的随机数序列的第一个数和第二个数，也就是说，对于这两个种子而言，j和k中的一个肯定为0。\n然后是后面的代码片段：\n                long j1 = (long)l * j;\n                long k1 = (long)i1 * k;\n                this.rand.setSeed(j1 ^ k1 ^ worldIn.getSeed());复制代码\nj1和k1本身应该随代表区块位置的l和i1变化的，但是由于后面的乘数j和k变成了0，所以说对于任何一个区块，种子107038380838084会导致j1永远为0，而种子164311266871034会导致k1永远为0。\n后一行代码重新设置了随机数发生器的种子，用于单独为专门的区块生成，如果这一值对于任何x坐标一致或者z坐标一致的区块都是一样的，生成的结果也可想而知了吧= =\n如果各位看官只是想大概了解一下怎么回事的话，看到这里就可以了，如果有想了解到底为什么是这两个随机数的，请继续往下看。\n\n================一点也不好看的分割线================\n\n关于为什么不是其他的数，偏偏是这两个数，我们就要从伪随机数的生成算法开始说起了。\n目前而言，最主流的随机数生成算法是一种名为线性同余法的算法，该算法首先生成一个种子（x为setSeed的输入）：\nseed = f(x)复制代码\n在Java中f(x)有（%为取余数操作，^为异或操作）：\nf(x) = (x ^ a) % c复制代码\n然后每次生成随机数的时候执行下面的操作，并将seed准备用作输出：\nseed = (a * seed + b) % c = g(seed)复制代码\n其中a、b、和c都是常数，不同的随机数生成器实现对这三个常数的定义不同，对于Java而言，这三个常数分别是：\na = 25214903917，b = 11，c = 281474976710656复制代码\n这样可以保证生成的随机数位于0（包含）和281474976710656（2的48次方，不包含）之间，也就是48bit。\n但是呢，储存MC的种子的整数大小为64bit，48bit不够用啊？所以每次生成的时候其实是生成了两个整数，每个整数各取32bit拼在一起：\nseed1 = g(seed)\nseed2 = g(seed1)\nreturn floor(seed1 / 65536) * 4294967296 + floor(seed2 / 65536)复制代码\n其中floor为向下取整函数，65536是2的16次方，4294967296是2的32次方。\n所以说，我们要先找到一个seed，使得seed1和seed2都小于65536，实际上这样的解只有一个：\nseed1 = 0，seed2 = 11复制代码\n现在我们需要找到一个数seed，它满足：\ng(seed) = (a * seed + b) % c = 0复制代码\n具体的找法，读者可以去搜索“扩展欧几里得算法”得到解答，这里本人已经把它解出来了：\nseed = 107048004364969复制代码\n对于f(x)的处理就很简单的，异或过来的再异或回去不就得了，所以我们得到了x：\nx = seed ^ 25214903917 = 107038380838084复制代码\n正好和楼主提供的世界种子一致。\n对于第二个种子，我们要保证生成的第二个随机数是0，也就是说，seed = g(seed)的操作要多进行两次：\nseed1 = g(g(g(seed)))\nseed2 = g(seed1)复制代码\n同时有：\nseed1 = 0，seed2 = 11复制代码\n具体的求解读者可以亲自试一下。反正答案上面早就有了2333\n\n展望：\n这两个种子可以做到每个区块都是一致的，但如果随机数序列中生成了“2的63次方”的话，那么是不是每两个区块就会重复一次呢？如果能够生成“2的62次方”，是不是四个区块就会重复一次呢？本人目前还没有得到解答，有兴趣的读者可以尝试一下。"
        },
        {
            "author": "1903863054",
            "timestamp": 1486385820,
            "txt_content": "那末影遗迹会是这么样的？"
        },
        {
            "author": "dwch",
            "timestamp": 1486388340,
            "txt_content": "感觉这个没法修复吧。。"
        },
        {
            "author": "孤独的MCer",
            "timestamp": 1486400160,
            "txt_content": "这个bread也拍过视频了吧"
        },
        {
            "author": "Jim_rong",
            "timestamp": 1486425780,
            "txt_content": "拿来做地图蛮好的，咕咕咕"
        },
        {
            "author": "马龙游笙",
            "timestamp": 1486441800,
            "txt_content": "我只拍了个短片http://www.mcbbs.net/forum.php?mod=viewthread&tid=654682"
        },
        {
            "author": "2877606721",
            "timestamp": 1486464600,
            "txt_content": "一不小心就掉虚空..."
        },
        {
            "author": "wh2426669379",
            "timestamp": 1486564140,
            "txt_content": "Because. 发表于 2017-2-6 11:08\n这是特性\n用这bug做个服务器不错"
        },
        {
            "author": "Soul丶233",
            "timestamp": 1486574820,
            "txt_content": "= =这也算不上是什么BUG的吧。"
        },
        {
            "author": "Zevn",
            "timestamp": 1486645980,
            "txt_content": "好像不是无限重复？中间断断续续的"
        },
        {
            "author": "Rilet",
            "timestamp": 1556859240,
            "txt_content": "算出来的...神啊"
        },
        {
            "author": "joycy",
            "timestamp": 1556890260,
            "txt_content": "这些其实都是巧合，有些是特性"
        },
        {
            "author": "1677343686",
            "timestamp": 1557033900,
            "txt_content": "emmmmm,一会去试试"
        },
        {
            "author": "yuen27787231",
            "timestamp": 1558209840,
            "txt_content": "有時候我生地圖時也會不知道為何會穿了一個16X16的無底洞"
        },
        {
            "author": "2529110944",
            "timestamp": 1558265280,
            "txt_content": "这叫特性"
        },
        {
            "author": "超人152",
            "timestamp": 1558269420,
            "txt_content": "这。。。。。厉害了"
        },
        {
            "author": "cf6513272991",
            "timestamp": 1558830480,
            "txt_content": "拿这个地图搞服务器的话...."
        },
        {
            "author": "liaoyongkang",
            "timestamp": 1562149500,
            "txt_content": "加载不吃来，看不了"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1568419080,
            "txt_content": "670116890 发表于 2017-2-6 11:21\n密集恐惧症感觉要命啊\n但是强迫症却感觉很舒服~"
        },
        {
            "author": "liguanlei10",
            "timestamp": 1568434800,
            "txt_content": "厉害啊 无线复制粘贴"
        },
        {
            "author": "liguanlei10",
            "timestamp": 1568434920,
            "txt_content": "一个矿坑就多少狂了 更何况一排"
        },
        {
            "author": "liguanlei10",
            "timestamp": 1568434920,
            "txt_content": "emmmmmmmmm"
        },
        {
            "author": "860813",
            "timestamp": 1583154480,
            "txt_content": "或许这个地图也是一个彩蛋吧，我尝试用一下这个地图生存一下，感觉玩起来挺好玩的。"
        },
        {
            "author": "大大大神",
            "timestamp": 1583225280,
            "txt_content": "太....太强大了，这要是生存是不是能找到一大堆矿车箱子！前期不就不愁发育了吗！"
        },
        {
            "author": "357k",
            "timestamp": 1583230200,
            "txt_content": "图片ban了看不到"
        }
    ]
}