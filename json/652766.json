{
    "title": "pocketmine-mp 插件开发",
    "author": "lovemeforever",
    "replyCount": 6,
    "timestamp": 1481040960,
    "txt_content": " 本帖最后由 lovemeforever 于 2016-12-7 00:25 编辑 \n\n后续会不断更新。\n\n今天先说一下前置条件。\n\n首先要安装php7 ,然后下载pocketmine 包，解压后。好了，先睡觉，后续更新。\n\n我会用一个随机礼物的插件来举例子。\n\n<?php\n\nnamespace LDX\\RandomItem;\n\nuse pocketmine\\command\\Command;\nuse pocketmine\\command\\CommandSender;\nuse pocketmine\\Player;\nuse pocketmine\\plugin\\PluginBase;\nuse pocketmine\\Server;\nuse pocketmine\\utils\\TextFormat;\nuse pocketmine\\item\\Item;\n\nclass Main extends PluginBase {\n\n  public function onEnable() {\n    $this->saveDefaultConfig();\n    $c = $this->getConfig()->getAll();\n    $t = $c[\"Interval\"] * 1200;\n    $num = 0;\n    foreach ($c[\"Items\"] as $i) {\n      $r = explode(\":\",$i);\n      $this->itemdata[$num] = array(\"id\" => $r[0],\"meta\" => $r[1],\"amount\" => $r[2]);\n      $num++;\n    }\n    $this->getServer()->getScheduler()->scheduleRepeatingTask(new Gift($this),$t);\n  }\n\n  public function onCommand(CommandSender $issuer,Command $cmd,$label,array $args) {\n    if((strtolower($cmd->getName()) == \"gift\") && isset($args[0])) {\n      if($this->getServer()->getPlayer($args[0]) instanceof Player) {\n        $d = $this->generateData();\n        $p = $this->getServer()->getPlayer($args[0]);\n        $this->give($p,$d);\n        $p->sendMessage(\"Random item given! (\" . $data[\"id\"] . \":\" . $data[\"meta\"] . \")\");\n      } else {\n        $issuer->sendMessage(\"Player not connected.\");\n      }\n      return true;\n    } else if((strtolower($cmd->getName()) == \"gift\") && !(isset($args[0]))) {\n      $this->giveAll();\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  public function give($p,$data) {\n    if($p instanceof Player && ($p->hasPermission(\"randomitem\") || $p->hasPermission(\"randomitem.receive\"))) {\n      $item = new Item($data[\"id\"],$data[\"meta\"],$data[\"amount\"]);\n      $p->getInventory()->addItem($item);\n    }\n  }\n\n  public function giveAll() {\n    $data = $this->generateData();\n    $this->broadcast(\"Random item given! (\" . $data[\"id\"] . \":\" . $data[\"meta\"] . \")\");\n    foreach($this->getServer()->getOnlinePlayers() as $p) {\n      $this->give($p,$data);\n    }\n  }\n\n  public function broadcast($m) {\n    foreach($this->getServer()->getOnlinePlayers() as $p) {\n      $p->sendMessage($m);\n    }\n    $this->getLogger()->info(TextFormat::YELLOW . $m);\n  }\n\n  public function generateData() {\n    return $this->itemdata[mt_rand(0,(count($this->itemdata) - 1))];\n  }\n\n}复制代码\n\n",
    "replies": [
        {
            "author": "yellow_Gay",
            "timestamp": 1481043960,
            "txt_content": "作为 java才会输出一句话的萌新完全不懂"
        },
        {
            "author": "喵鱿",
            "timestamp": 1481080860,
            "txt_content": "yellow_Gay 发表于 2016-12-7 01:06\n作为 java才会输出一句话的萌新完全不懂\n等楼主更新吧。哈哈哈。"
        },
        {
            "author": "lunyasha",
            "timestamp": 1481088120,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "lovemeforever",
            "timestamp": 1481089440,
            "txt_content": "lunyasha 发表于 2016-12-7 13:22\n直接举报\n你真是个好人呢。说了我还没有更新呢"
        },
        {
            "author": "159835",
            "timestamp": 1517049420,
            "txt_content": "啧啧啧.看看。"
        },
        {
            "author": "Jonjs_Dada",
            "timestamp": 1564795500,
            "txt_content": "php算简单的了，不要整天坐在电脑前写，否则你会。。。恩。"
        }
    ]
}