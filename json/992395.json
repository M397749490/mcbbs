{
    "title": "[原创]Minecraft启动器制作教程——第一章-嵌入dll",
    "author": "网易MC",
    "replyCount": 3,
    "timestamp": 1584758700,
    "txt_content": " 本帖最后由 网易MC 于 2020-4-12 23:17 编辑 \n\n索引贴制作中，有人必更\n-第1章嵌入dll如果你是一个经验丰富的C＃大佬，你可以跳过这一章\n\n 因为作者电脑的VisualStudio出了点问题，正在重装，所以本计划今天早上发两个帖只发了一个帖\n新建一个基于.NET的Winform项目\n\n\n\n\n\na.png (37.27 KB, 下载次数: 0)\n\n下载附件\n\n2020-3-21 07:47 上传\n\n\n\n\n\n\n\n\n\n\na.png (83.03 KB, 下载次数: 0)\n\n下载附件\n\n2020-3-21 07:49 上传\n\n\n\n\n\n准备好所有dll\n\n\n\n\n\na.png (9.56 KB, 下载次数: 0)\n\n下载附件\n\n2020-3-21 07:53 上传\n\n\n\n\n\n把他们复制到你的项目里\n\n\n\n\n\na.png (8.94 KB, 下载次数: 0)\n\n下载附件\n\n2020-3-21 07:54 上传\n\n\n\n\n\n然后右键属性，把他们的生成操作改成“嵌入的资源”\n然后在引用里添加对7z.dll和newtonsoft.json.dll的引用\n快捷引用的内容，属性\n把复制本地改为false\n然后打开program.cs更新的时候给伟大的谷歌翻译了一下，代码炸了...\n引用命名空间：\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Reflection;</font></font>复制代码这时program.cs应该有以下代码：\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Reflection </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Collections.Generic; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Linq; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Threading.Tasks; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Windows.Forms; </font></font>\n\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">名称空间MCLauncher </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">{ </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    静态类Program </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        /// <summary> </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        ///应用程序的主入口点</font><font style=\"vertical-align: inherit;\">。/// </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        </ summary> </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        [STAThread] </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        static void Main（）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.EnableVisualStyles（）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.SetCompatibleTextRenderingDefault（false）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.Run（新Form1（））; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">}</font></font>复制代码找到程序入口点：\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">静态void Main（）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.EnableVisualStyles（）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.SetCompatibleTextRenderingDefault（false）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.Run（新Form1（））; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        }</font></font>复制代码转变\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">静态无效的Main（）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">{ </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    AppDomain.CurrentDomain.AssemblyResolve + = CurrentDomain_AssemblyResolve; </font></font>\n\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    Application.EnableVisualStyles（）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    Application.SetCompatibleTextRenderingDefault（false）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    Application.Run（新Form1（））; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">}</font></font>复制代码再添加：\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">私有静态程序集CurrentDomain_AssemblyResolve（object sender，ResolveEventArgs args）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">{ </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    字符串resourceName =“ ShadowSuHelper”。</font><font style=\"vertical-align: inherit;\">+新的AssemblyName（args.Name）.Name +“ .dll”; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    使用（var stream = Assembly.GetExecutingAssembly（）。GetManifestResourceStream（resourceName））</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        字节[] assemblyData =新的字节[stream.Length]；</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        stream.Read（assemblyData，0，assemblyData.Length）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        返回Assembly.Load（assemblyData）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">}</font></font>复制代码现在的program.cs应该是这样的：\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用系统；</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Collections.Generic; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Linq; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Reflection; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Threading.Tasks; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">使用System.Windows.Forms; </font></font>\n\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">名称空间MCLauncher </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">{ </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    静态类Program </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        /// <summary> </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        ///应用程序的主入口点</font><font style=\"vertical-align: inherit;\">。/// </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        </ summary> </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        [STAThread] </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        static void Main（）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.EnableVisualStyles（）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.SetCompatibleTextRenderingDefault（false）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            Application.Run（新Form1（））; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        私有静态程序集CurrentDomain_AssemblyResolve（object sender，ResolveEventArgs args）</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            string resourceName =“ ShadowSuHelper”。</font><font style=\"vertical-align: inherit;\">+新的AssemblyName（args.Name）.Name +“ .dll”; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            使用（var stream = Assembly.GetExecutingAssembly（）。GetManifestResourceStream（resourceName））</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            { </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">                字节[] assemblyData =新的字节[stream.Length]；</font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">                stream.Read（assemblyData，0，assemblyData.Length）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">                返回Assembly.Load（assemblyData）; </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">            } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">        } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">    } </font></font>\n<font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">}</font></font>复制代码那么恭喜你，成功嵌入DLL\n\n上一章：Minecraft启动器制作教程-第零章-资源准备                          -点击链接进入\n下一章：Minecraft启动器制作教程-第二章-简单的启动Minecraft-楼主弃坑了吗\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "蜡笔12344",
            "timestamp": 1584759480,
            "txt_content": "加油啊lz  很棒！"
        },
        {
            "author": "网易MC",
            "timestamp": 1584790800,
            "txt_content": " 本帖最后由 网易MC 于 2020-4-12 23:14 编辑 \n\n复制代码"
        },
        {
            "author": "电子爱好者",
            "timestamp": 1584957060,
            "txt_content": "写的很详细，很好呀，支持支持，希望继续更新"
        }
    ]
}