{
    "title": "如何设置config.yml里的a的值(不是你想的那么简单,除大佬)",
    "author": "帅比小樊",
    "replyCount": 20,
    "timestamp": 1491188580,
    "txt_content": "我想储存玩家某个数据到配置文件里\n储存的都弄好了，但是发现只能在插件启动的时候使用下列方法\nconfig.set();\nconfig.addDefault();\n这两个方法我在插件启动上加上就可以设置\n但是一到某个事件里就不行了\n比如玩家加入事件\n我的代码是这样的\n@EventHandler\npublic void s(PlayerJoinEvent e){\n        Player p = e.getPlayer();\n        c.set(\"Atb.SQL.skilsm\"+p.getName(), q-1);\n        c.set(\"Atb.SQL.hphf\", w+1);\n        c.options().copyDefaults(true);\n}复制代码\nw和q均为配置文件里的int值\n但是这样根本就没有办法添加进去\n或者我加上这两个方法也不行\nsaveConfig();\nreloadConfig();\n都是不行的，非常奇怪，一到onEnable里就可以用了\n这是为啥？\n我的onEnable里是这样写的\n                c.addDefault(\"Atb.hphf\", \"s\");\n                c.options().copyDefaults(true);\n                saveConfig();\n        }\n            if (!getDataFolder().exists()) {\n                getDataFolder().mkdir();\n              }\n              if (!file.exists()) {\n                saveDefaultConfig();\n              }\n              reloadConfig();复制代码\n难道说要把下面的也加到加入事件里？\n不会吧,这个问题想了一周了，找了许多办法都不行\n尝试找站内相似插件观摩\n但是好像找不到\n如果有的话，能发给我看看代码也好的\n等待dalao到来解决我的问题\n\n",
    "replies": [
        {
            "author": "Bder.",
            "timestamp": 1491197700,
            "txt_content": "set后加上?.save(File ?);\n例如：\nFile f = new File(getDataFolder(),\"config.yml\");\nFileConfiguration config = YamlConfiguration.loadConfiguration(f);\nconfig.set(\"Default\",\"233\");\ntry{\n    config.save(f);\n} catch (IOException e) {\n    e.printStackTrace();\n}"
        },
        {
            "author": "LazerHy",
            "timestamp": 1491198780,
            "txt_content": "把完整代码给我看看"
        },
        {
            "author": "LazerHy",
            "timestamp": 1491199020,
            "txt_content": " 本帖最后由 LazerHy 于 2017-4-3 14:14 编辑 \n帅比小樊 发表于 2017-4-3 14:11\n见楼上，这些代码只要放入随便一个世界就无法设置配置文件里的值\n一到onEnable里就可以 ...                          c.set(\"Atb.SQL.skilsm\"+p.getName(), q-1);\n                            c.set(\"Atb.SQL.hphf\", w+1);\n                            this.saveConfig();\n                            复制代码\n试试只留这三行"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491199080,
            "txt_content": "LazerHy 发表于 2017-4-3 13:57\n试试只留这三行\n试过，一开始就是这样\n不成功"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491199320,
            "txt_content": "Bder. 发表于 2017-4-3 13:35\nset后加上?.save(File ?);\n例如：\nFile f = new File(getDataFolder(),\"config.yml\");\n依旧不行，但是一写到onEnable里就可以设置\n这是为什么"
        },
        {
            "author": "Bder.",
            "timestamp": 1491199620,
            "txt_content": "帅比小樊 发表于 2017-4-3 14:02\n依旧不行，但是一写到onEnable里就可以设置\n这是为什么\n代码截图。"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491199740,
            "txt_content": "Bder. 发表于 2017-4-3 14:07\n代码截图。\n稍等........................................."
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491199800,
            "txt_content": "Bder. 发表于 2017-4-3 14:07\n代码截图。\nc.set(\"Atb.SQL.skilsm\"+p.getName(), q-1);\n                            c.set(\"Atb.SQL.hphf\", w+1);\n                            this.saveConfig();\n                            try{\n                                    c.save(file);\n                            }catch(IOException es){\n                                    es.printStackTrace();\n                            }\n                            c.options().copyDefaults(true);\n                            \n                            this.reloadConfig();复制代码"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491199860,
            "txt_content": "LazerHy 发表于 2017-4-3 13:53\n把完整代码给我看看\n见楼上，这些代码只要放入随便一个世界就无法设置配置文件里的值\n一到onEnable里就可以"
        },
        {
            "author": "Bder.",
            "timestamp": 1491200280,
            "txt_content": "帅比小樊 发表于 2017-4-3 13:58\n试过，一开始就是这样\n不成功\nq-1加上()\n(q-1)\nw+1加上()\n(w+1)"
        },
        {
            "author": "LazerHy",
            "timestamp": 1491200280,
            "txt_content": "帅比小樊 发表于 2017-4-3 13:58\n试过，一开始就是这样\n不成功\n测试一下这些代码是否被执行"
        },
        {
            "author": "602723113",
            "timestamp": 1491201240,
            "txt_content": "首先你要了解或者知道这些的含义\n如果按照你的 Atb.SQL.skilsm+p.getName() 这个键位来说的话 在Yml中显示的情况则是这样的\n\nAtb:\n  SQL:\n    skilsmNotch: \"q-1\"\n\n另外我看不懂你的代码的含义...\n既然只是在config里面保存为何不直接getConfig()\n\n另外给你看看我是怎么写的：来源于某MayMoney插件=w=\n@EventHandler\n        public void onJoin(PlayerJoinEvent e) {\n                Player player = e.getPlayer();\n                File playerDataPath = new File(Money.getInstance().getMoneyDataFolder().getAbsolutePath() + \"\\\" + player.getName() + \".yml\");\n                if(!playerDataPath.exists()) {\n                        try {\n                                playerDataPath.createNewFile();\n                                FileConfiguration playerdata = loadYml(playerDataPath);\n                                playerdata.set(\"Money\", 0.0);\n                                saveYml(playerdata, playerDataPath);\n                        } catch (IOException ex) {\n                                ex.printStackTrace();\n                        }\n                }\n        }\n\n/**\n         * 保存Yml\n         * @param Filec\n         * @param file\n         */\n        public static void saveYml(FileConfiguration Filec, File file) {\n                try {\n                        Filec.save(file);\n            }catch (IOException e) {\n              System.out.println(\"错误:\" + e.toString());\n            }\n        }\n\n        /**\n         * 读取Yml\n         * @param file\n         * [url=home.php?mod=space&uid=491268]@Return[/url] YML\n         */\n        public static FileConfiguration loadYml(File file) {\n                if (!file.exists()) {\n                        try {\n                                file.createNewFile();\n                        }catch (IOException e) {\n                                System.out.println(\"错误:\" + e.toString());\n                        }\n            }\n            FileConfiguration YML = YamlConfiguration.loadConfiguration(file);\n            DumperOptions yamlOptions = null;\n            try {\n                    Field f = YamlConfiguration.class.getDeclaredField(\"yamlOptions\");\n                    f.setAccessible(true);\n                    yamlOptions = new DumperOptions() {\n                            public void setAllowUnicode(boolean allowUnicode) {\n                                    super.setAllowUnicode(false);\n                            }\n                            public void setLineBreak(DumperOptions.LineBreak lineBreak) {\n                                    super.setLineBreak(DumperOptions.LineBreak.getPlatformLineBreak());\n                            }\n                    };\n                    yamlOptions.setLineBreak(DumperOptions.LineBreak.getPlatformLineBreak());\n                    f.set(YML, yamlOptions);\n            }catch (ReflectiveOperationException ex) {\n              System.out.println(\"错误:\" + ex.toString());\n            }\n            return YML;\n        }\n复制代码\n\n这个过后的结果则是在插件文件夹里新建一个文件夹名为 PlayerData\n比如玩家名为 May_Speed\n那么经过上面的代码就会在这个 PlayerData 文件夹中新建出一个 May_Speed.yml,并且里面的内容为\n\nMay_Speed.yml\nMoney: 0"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491293760,
            "txt_content": "602723113 发表于 2017-4-3 14:34\n首先你要了解或者知道这些的含义\n如果按照你的 Atb.SQL.skilsm+p.getName() 这个键位来说的话 在Yml中显示 ...\nMoney.getInstance()的money表示什么?"
        },
        {
            "author": "602723113",
            "timestamp": 1491297480,
            "txt_content": "帅比小樊 发表于 2017-4-4 16:16\nMoney.getInstance()的money表示什么?\n这个只是我在主类写的一个取主类实例的方法\n\nMoney.getInstance()\n主类   .取实例"
        },
        {
            "author": "帅比小樊",
            "timestamp": 1491300660,
            "txt_content": "602723113 发表于 2017-4-4 17:18\n这个只是我在主类写的一个取主类实例的方法\n\nMoney.getInstance()\n表示我的主类没有这个方法,不知道是不是我的问题\n能把您的插件发给我看看吗？"
        },
        {
            "author": "602723113",
            "timestamp": 1491301320,
            "txt_content": "帅比小樊 发表于 2017-4-4 18:11\n表示我的主类没有这个方法,不知道是不是我的问题\n能把您的插件发给我看看吗？ ...\n。。。\n我只能告诉你 Money.getInstance().getMoneyDataFolder().getAbsolutePath() 返回\nplugins/MayMoney/PlayerData 这个路径\n如果你真要看主类我觉得这个关系你看不懂。。"
        },
        {
            "author": "2571612311",
            "timestamp": 1492785480,
            "txt_content": "还有问题加我上面qq"
        },
        {
            "author": "2571612311",
            "timestamp": 1492785900,
            "txt_content": "楼主，加一下我qq，qq方便说一点，其实你这个问题挺好解决\n1173477724"
        },
        {
            "author": "2571612311",
            "timestamp": 1492786500,
            "txt_content": " 本帖最后由 2571612311 于 2017-4-22 13:56 编辑 \n\n首先，我很无语你那个c是个什么\n如果你是操作默认config\n那么先在主类里添加private static Main main;\n然后在onEnable()里添加   main = this;\n接着在主类里写一个静态方法\npublic static Main getMain() {return main;}\n\n现在就很简单了\n在你需要调用config的类里先写private Main main = Main.getMain();\n调用的时候就 main.getConfig().set(String,Object); main.getConfig().get(String);"
        },
        {
            "author": "弱鸡绿毛怪",
            "timestamp": 1506861540,
            "txt_content": "怀疑你没有注册事件"
        }
    ]
}