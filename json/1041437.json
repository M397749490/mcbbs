{
    "title": "【经验分享】我搬迁的不是网站，是亿条故障信息！",
    "author": "SHEEP_REALMS",
    "replyCount": 22,
    "timestamp": 1588948080,
    "txt_content": " 本帖最后由 SHEEP_REALMS 于 2020-5-8 22:36 编辑 \n\n接上文>>\n\n在那之后，我找到了一个废弃的数据库，我打算直接将数据注入这个数据库。结果发现，数据库限制了单次导入大小，我又没有超级管理员，所以只好把数据库拆开来导入。\n\n当我开始导入一个记录用户对Wiki页面的编辑记录的数据表的时候发现，这个表实在是太大了，所以我进一步拆分了这个表一批一批导入。刚开始没什么问题，突然半当中又被卡住了。二分法排查了一下，有一条编辑记录特别庞大。好小子，有人居然给我咏e，大概590,000个字符！于是我把咏e的数据砍掉之后继续导入，终于把所有数据导入完成了。\n\n然后，我开始搬运网站文件。因为网站后台限制上传大小，所以我把ZIP压缩包拆分成了20个分卷，结果这破后台一次只能上传一个文件，多了就报错 \n\n好不容易上传完了以后，一解压就报错。当时我没搞清楚怎么回事，就去拿了FTP账号，把所有文件都删了然后直接上FTP，一整个压缩包放进去，感受到了前所未有的舒适 \n\n之后回到后台，解压......然后报错......\n\n无意中我突然看到总览面板，发现网站存储空间爆炸了......这时我突然想起站长之前留言说叫我删掉什么东西，我打开一看，是一个500MB的图床。\n\n \n\n图床，R.I.P\n\n然后我就打开了网站的安装面板，结果无响应......\n\n经过一下午的自闭后，我又尝试解压了压缩包，这次成功完成了解压！我看到了希望！ \n\n成功打开安装面板，根据安装指引修改了数据库名字，完成了安装。就在我以为大功告成的时候，我突然发现，编辑页面会发生数据库错误 \n\n然后我又去MediaWiki查找资料，在一次用户反馈中官方人员提到可以在配置文件中打开详细错误报告。我取得错误报告后仔细读了一下：\n\n程序会向数据库提交一串信息，其中第一个参数是空的，也就是ID参数，第二个参数是我提交的编辑内容，第三个参数是页面编码。而出错的数据库是我之前分批次导入的那个数据库，错误原因为不能输入空值。\n\n然后我拿当前的数据库和原来的数据库一对比，发现我忘记设置主键和自动递增了 \n\n至此，所有故障被一一解决。\n\n\n我其实是学计算机专业的，知识现学现用，真就是还没毕业就已经经历过严酷的实战 \n\n哦对了，刚刚成为实习版主，以后我发锭的时候别让我看到乱码恰锭",
    "replies": [
        {
            "author": "暗夜Elen",
            "timestamp": 1588948260,
            "txt_content": "噫 你发的锭越来越少了"
        },
        {
            "author": "可乐菌KeLe",
            "timestamp": 1588948320,
            "txt_content": "大佬不哭~你都成功了"
        },
        {
            "author": "Kiwstop",
            "timestamp": 1588948380,
            "txt_content": "仍然记得没压缩就把整个服务器文件上ftp的经历"
        },
        {
            "author": "mohui666",
            "timestamp": 1588948500,
            "txt_content": "工具羊实锤了"
        },
        {
            "author": "克哈之子",
            "timestamp": 1588948860,
            "txt_content": "谢谢大佬的定"
        },
        {
            "author": "自由李代数",
            "timestamp": 1588948980,
            "txt_content": "给wiki咏过e的还有居仕\n七十多万个，虽然后来自己删了"
        },
        {
            "author": "SHEEP_REALMS",
            "timestamp": 1588949040,
            "txt_content": "自由李代数 发表于 2020-5-8 22:43\n给wiki咏过e的还有居仕\n七十多万个，虽然后来自己删了\n删了没用，数据库照样记着"
        },
        {
            "author": "🐦💕🌸🌸",
            "timestamp": 1588949160,
            "txt_content": "等等，你前几天不是还……啊，实习版主，以后得告诉水怪们绕着走了"
        },
        {
            "author": "凋灵斯拉",
            "timestamp": 1588949160,
            "txt_content": "暗夜Elen 发表于 2020-5-8 22:31\n噫 你发的锭越来越少了\n他快发完了罢"
        },
        {
            "author": "迷灬离",
            "timestamp": 1588949400,
            "txt_content": "当了版主就不要用水怪表情包了："
        },
        {
            "author": "Dk__",
            "timestamp": 1588950840,
            "txt_content": "那么混沌就有理由因为你事太多撤你了？\n"
        },
        {
            "author": "喵露朵露薇",
            "timestamp": 1588952280,
            "txt_content": "绵羊也变成版主了 爷青开\n\n\n\n\n\n@Q(YZ4M%BCBN%A58@}%8X63.jpg\n(34.58 KB, 下载次数: 1)\n\n\n\n\n下载附件\n\n\n2020-5-8 23:37 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        {
            "author": "隔壁小土",
            "timestamp": 1588953240,
            "txt_content": "唔  高血压羊       真是惨呢   （我  今天就算从这跳下去  我也不会乱码恰锭的！！     恰完 ：  真香【bushi】)）"
        },
        {
            "author": "青芦叶",
            "timestamp": 1588957740,
            "txt_content": "草生，咏e无处不在"
        },
        {
            "author": "SR-帽子",
            "timestamp": 1588984740,
            "txt_content": "好像没说不能万用回复，是因为你也这么做过嘛绵羊血压升高系列"
        },
        {
            "author": "上杉夏相",
            "timestamp": 1588984860,
            "txt_content": "啊这。。。乱码党的在线悲伤"
        },
        {
            "author": "北极仙光",
            "timestamp": 1588985100,
            "txt_content": "版主羊"
        },
        {
            "author": "Charmander:D",
            "timestamp": 1588992360,
            "txt_content": "emm 刚被你删了个帖子的卑微萌新路过"
        },
        {
            "author": "武易",
            "timestamp": 1588992420,
            "txt_content": "什么？一个帖子出来了两个版主\n火钳刘明"
        },
        {
            "author": "殆辰羽_",
            "timestamp": 1588992540,
            "txt_content": "你的签名又吓到了我"
        },
        {
            "author": "Charmander:D",
            "timestamp": 1588992660,
            "txt_content": "咦 重复发帖 有的吗？噢那可能是刚刚卡了 不小心点了两下快速回复 没注意 抱歉了qwq 顺带一提 又被删了一条 卑微"
        },
        {
            "author": "ZX夏夜之风",
            "timestamp": 1589193660,
            "txt_content": "一个毫无计算机专业基础的人表示看不懂(滑稽)"
        }
    ]
}