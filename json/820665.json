{
    "title": "如何实现技能冷却",
    "author": "BLank826",
    "replyCount": 11,
    "timestamp": 1537252440,
    "txt_content": "最近在写技能插件，但是遇到一个问题。就是当玩家进入游戏之后，给玩家一个物品，这个物品，玩家左击或者右击，可以实现描述的技能，但是我不知道如何实现这个冷却，球大佬带带我。比如发射一个雪球，我想让玩家的冷却为3秒，怎么来实现。",
    "replies": [
        {
            "author": "闲鱼菌",
            "timestamp": 1537258080,
            "txt_content": "通过取世界时间试试？"
        },
        {
            "author": "清华儒墨",
            "timestamp": 1537265280,
            "txt_content": "当玩家进入游戏之后给玩家物品: PlayerJoinEvent\n玩家左击或者右击: PlayerInteractEvent\n技能冷却: Bukkit.getScheduler()帮到你"
        },
        {
            "author": "粘兽",
            "timestamp": 1537271760,
            "txt_content": "同款问题？\n技能冷却倒计时\nhttp://www.mcbbs.net/thread-807024-1-1.html"
        },
        {
            "author": "1041057958",
            "timestamp": 1537322820,
            "txt_content": "你可以尝试一下解剖插件"
        },
        {
            "author": "18402031232",
            "timestamp": 1537494000,
            "txt_content": "改时间试试？？"
        },
        {
            "author": "宇亓",
            "timestamp": 1552904460,
            "txt_content": "你可以用一个bool变量记录技能是否是冷却的（假设为k）\n使用技能后讲bool将k置为false\n然后定时一段时间后将k置为true"
        },
        {
            "author": "宇亓",
            "timestamp": 1552904580,
            "txt_content": "                        new BukkitRunnable(){\n                                @Override\n                                public void run(){\n                                        //这里的代码会在0.5s之后执行（20tick为1s）\n                                }\n                        }.runTaskLaterAsynchronously(plugin, 10);"
        },
        {
            "author": "宇亓",
            "timestamp": 1552904640,
            "txt_content": "runTaskLaterAsynchronously(plugin, 10);\n这个后面的10代表10tick，也就是0.5s"
        },
        {
            "author": "1850343382",
            "timestamp": 1552987680,
            "txt_content": "这个问题可以被抽象成一个概念: throttle,也就是节流，指一个行为在一定时间内只执行一次，Example:\nclass Throttle(override var wait: Long) {\n\n    private val storeMap = mutableMapOf<UUID, Long>()\n\n    override fun process(uuid: UUID, success: () -> Unit, not: (surplus: Long) -> Unit) {\n        if (storeMap.containsKey(uuid)) {\n            val prevTime = storeMap[uuid]!!\n            val pastTime = System.currentTimeMillis() - prevTime\n            if (pastTime > wait) {\n                success.invoke()\n                storeMap[uuid] = System.currentTimeMillis()\n            } else {\n                not.invoke(wait - pastTime)\n            }\n        } else {\n            success.invoke()\n            storeMap[uuid] = System.currentTimeMillis()\n        }\n    }\n\n}复制代码"
        },
        {
            "author": "梦想的境界",
            "timestamp": 1552996260,
            "txt_content": "版主辛苦了"
        },
        {
            "author": "William_Shi",
            "timestamp": 1553433420,
            "txt_content": "最简单的方法：雪球变成另外的东西（比如鸡蛋）然后名字里面写上冷却时间，再用runtasktimer遍历玩家手中物品读秒，为0的时候改成雪球"
        }
    ]
}