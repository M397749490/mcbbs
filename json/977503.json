{
    "title": "延迟高是Kcauldron服务端的尿性吗？",
    "author": "希尔薇w",
    "replyCount": 15,
    "timestamp": 1583400120,
    "txt_content": "首先我的yml文件全都按照服务器的优化帖子那样子优化了。\n第二我的cpu和内存\n\n\n\n\nQQ图片20200305171512.png (4.92 KB, 下载次数: 0)\n\n下载附件\n\n2020-3-5 17:19 上传\n\n\n\n\ncpu是双核四线程，至少我觉得已经够了。\n也分配了4GB最大内存。\n\n第三我家带宽10mb/s\n\n请问为啥我一个人进服务器都觉得卡，箱子还要卡顿一下才能打开，打怪也是卡的瞬移。\n我现在开始怀疑我用的Kcauldron服务端有问题了，还有什么降低延迟的办法吗\n\n\n\n",
    "replies": [
        {
            "author": "极光creeper",
            "timestamp": 1583400180,
            "txt_content": " 本帖最后由 极光creeper 于 2020-3-5 17:54 编辑 \n\n服务器配置文件？\nKcauldron按照教程优化完等于没优化 (笑\nmod服本来就没什么值得在核心配置文件上下手的地方\n\nJVM？\njvm标志自然也不是主力军，当然，它在插件服里也不是\n它只是用来压低内存使用，同时压低cpu时间，绝不是用来拯救性能的万能药\n\n但是我不得不承认，它的确可以起到一些不错的作用\n所以你考虑一下用https://www.mcbbs.net/thread-839828-1-1.html\n这个是CMS的，我不是很喜欢G1GC、(Shenandoah也另说)\n\n怎么救？\n角度0 你到底怎么优化的\n你有没有100%按照帖子里来，并且保证没有将不同文件内相同key的值搞混淆\n例如max-tick-time在spigot和server.properties都出现过，你有没有使用错误的value值呢？\n单位就不一样(笑，如上面举例的这个限制，这符合你的描述\n\n角度1 硬件；考虑到mod服，我们要求主频\n但是你的主频看起来ok，在人数少的时候带宽10M也够，所以我把焦点放在你的内存\n如上面世予所说，内存，可能是问题，但我并不肯定，4G在插件服可以tps20的情况下带20-30人\n即便是mod服 我也不认为会这么离谱，所以排除ram\n回到cpu和带宽上，这两个的命中率大概分别是50%，我下面跟了一层楼，可能有点分析在那里\n\n角度2 mod；它们注册的大量tile entity等 会在dotick时占用大量的时间\n而你要是skip的话还不安全，这可能变相导致你开箱子卡\n而部分mod我想应该和插件一样，都有检测/更新的频率\n在合理、安全的范围下，对他们进行调整是我一个从来没碰过任何mod的萌新的唯一建议\n\n反过来分析\n开箱子卡，打怪物卡，它们都是会在每tick里获得更新的entity和tile\n所以目前的情况很简单，在你没有timing的情况下\n你只能弄个heapdump看看ram的使用情况\n或者，就没有救了\n\n当然，我认为有很大可能是你改配置文件弄的负优化结果"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583400180,
            "txt_content": "想不通为啥会有这么高延迟"
        },
        {
            "author": "思念化作海",
            "timestamp": 1583400180,
            "txt_content": "4GB可能少 kc是开的模组服吧 分6G\n\n而且你的cpu..."
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583400300,
            "txt_content": "折叠 发表于 2020-3-5 17:23\n4GB可能少 kc是开的模组服吧 分6G\n\n而且你的cpu...\n是的，模组服，就说是cpu的问题咯，但也不至于这么卡吧，一个人进去都要卡死的感觉"
        },
        {
            "author": "虎牙丶北辰",
            "timestamp": 1583400420,
            "txt_content": "网络问题有可能"
        },
        {
            "author": "思念化作海",
            "timestamp": 1583400480,
            "txt_content": "希尔薇w 发表于 2020-3-5 17:25\n是的，模组服，就说是cpu的问题咯，但也不至于这么卡吧，一个人进去都要卡死的感觉 ...\n10m/s我觉得是够的...这不是kc的锅 你的服务器性能不太好\n/gc看看服务器剩余多少内存呢"
        },
        {
            "author": "凉凉丶",
            "timestamp": 1583400600,
            "txt_content": "当然不是= =,你的配置不行= =，我kc单端分2G 80MOD服用的2667v2带了25人没事"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583401200,
            "txt_content": "凉凉丶 发表于 2020-3-5 17:30\n当然不是= =,你的配置不行= =，我kc单端分2G 80MOD服用的2667v2带了25人没事\n你的是租的服务器呢还是自家电脑呢，说到底还是我需要换块cpu咯"
        },
        {
            "author": "凉凉丶",
            "timestamp": 1583401260,
            "txt_content": "希尔薇w 发表于 2020-3-5 17:40\n你的是租的服务器呢还是自家电脑呢，说到底还是我需要换块cpu咯\n我租的...你用i5 4970说不定会好点"
        },
        {
            "author": "极光creeper",
            "timestamp": 1583401980,
            "txt_content": "好 为了不打乱我上面的阵型，我再来开一层楼来水贴\n\n你是怎么开服的，我看你提到了'你自己家'\n使用了什么奇怪的软件了吗，比如开服侠什么的？\n这些穿透软件与开服软件都会干掉你家带宽，变成他们的较低上限\n\n此外，你的测试是自己内网进入？"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583402100,
            "txt_content": "极光creeper 发表于 2020-3-5 17:47\n服务器配置文件？\nKcauldron按照教程优化完等于没优化 (笑\nmod服本来就没什么值得在核心配置文件上下手的地 ...\n天哪，太全面了，那就按照你的这些，一个个去检查吧"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583402220,
            "txt_content": "极光creeper 发表于 2020-3-5 17:53\n好 为了不打乱我上面的阵型，我再来开一层楼来水贴\n\n你是怎么开服的，我看你提到了'你自己家'\n我现在用的是nullcraft开服器，用的是sakura frp内网穿透，这么说的话，就说还是要用bat来开服咯"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583402340,
            "txt_content": "极光creeper 发表于 2020-3-5 17:53\n好 为了不打乱我上面的阵型，我再来开一层楼来水贴\n\n你是怎么开服的，我看你提到了'你自己家'\n就是，自己进自己家电脑的服务器嘛"
        },
        {
            "author": "极光creeper",
            "timestamp": 1583402760,
            "txt_content": "希尔薇w 发表于 2020-3-5 17:57\n我现在用的是nullcraft开服器，用的是sakura frp内网穿透，这么说的话，就说还是要用bat来开服咯 ...\n啊 是的 sakura frp目前似乎是4Mbps(高速流量是8Mbps)\n在带宽上下行这方面的确不是非常适合用来开设mod服了\n\n内网自己进自己服务器的话，我不知道怎么说233\n因为你是和你自己的服务器抢cpu线程了\n这个不一定准确，以及如果你不是用localhost:端口加入服务器的话\n流量会在sakura frp那边跑一圈\n可能导致测试结果比较窒息"
        },
        {
            "author": "希尔薇w",
            "timestamp": 1583406120,
            "txt_content": "极光creeper 发表于 2020-3-5 18:06\n啊 是的 sakura frp目前似乎是4Mbps(高速流量是8Mbps)\n在带宽上下行这方面的确不是非常适合用来开设mod服 ...\n顺带我想问一下KCauldron怎么用bat开服呢，= =好像常规的开服法没用。"
        }
    ]
}