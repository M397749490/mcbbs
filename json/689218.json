{
    "title": "有没有更好的消耗玩家物品的方法？",
    "author": "qianji20000420",
    "replyCount": 5,
    "timestamp": 1493440740,
    "txt_content": "我写了一个遍历背包的办法     判断是能正常判断   但是消耗的话就出问题了   请大佬帮忙看看 \n public static boolean hasItem(Player p, List<ItemStack> im) {\n  boolean flag = true;\n  Outer: for (int i = 0; i < im.size(); i++) {\n   ItemStack it = im.get(i);\n   HashMap<Integer, ? extends ItemStack> itemlist = p.getInventory().all(im.get(i).getType());\n   Collection<? extends ItemStack> value = itemlist.values();\n   p.sendMessage(value.toString());\n   int result = 0;\n   for (ItemStack items : value) {\n    if ((items.getItemMeta().equals(it.getItemMeta())) || (!items.hasItemMeta() && !it.hasItemMeta())) {\n     result += items.getAmount();\n    }\n   }\n   if (result < it.getAmount()) {\n    flag = false;\n    break Outer;\n   }\n  }\n  return flag;\n }\n\n\n public static boolean takeItem(Player p, List<ItemStack> im) {\n  if (!hasItem(p, im)) {\n   return false;\n  }\n  Inventory bag = p.getInventory();\n  for (ItemStack is : im) {\n   HashMap<Integer, ? extends ItemStack> use = bag.all(is.getType());\n   Set<Integer> key = use.keySet();\n   for (int index : key) {\n    if (!use.get(index).getItemMeta().equals(is.getItemMeta())) {\n     key.remove(index);\n     use.remove(index);\n    }\n   }\n   // 遍历背包\n   int remove = is.getAmount();\n   System.out.println(\"要删除的数量\" + remove);\n   for (int index : key) {\n    ItemStack temp = bag.getItem(index);\n    if (temp.getAmount() < remove) {\n     System.out.println(\"temp.getAmount() < remove ---\" + temp);\n     // 如果所获取的背包物品数量少于欲删除的物品数量 那么就清除这个物品堆\n     remove += temp.getAmount();\n     bag.clear(index);\n    } else if (temp.getAmount() == remove) {\n     System.out.println(\"temp.getAmount() == remove ---\" + temp);\n     bag.clear(index);\n     break;\n    } else if (temp.getAmount() > remove) {\n     System.out.println(\"temp.getAmount() > remove ---\" + temp);\n     temp.setAmount(temp.getAmount() - remove);\n     bag.setItem(index, temp);\n     break;\n    }\n   }\n  }\n  return true;\n }\n\n\n",
    "replies": [
        {
            "author": "TimmyOVO",
            "timestamp": 1493461440,
            "txt_content": "https://gist.github.com/SkyStard ... c8c1c4272bb7d2b65ad\n分享一下我以前写的\n判断是否拥有足够物品\n和扣除多种物品的"
        },
        {
            "author": "qianji20000420",
            "timestamp": 1493463000,
            "txt_content": "星燚 发表于 2017-4-29 18:24\nhttps://gist.github.com/SkyStardust/94f0474f55261c8c1c4272bb7d2b65ad\n分享一下我以前写的\n判断是否拥有 ...\n0.0为什么会进不去"
        },
        {
            "author": "qianji20000420",
            "timestamp": 1493463960,
            "txt_content": "星燚 发表于 2017-4-29 18:24\nhttps://gist.github.com/SkyStardust/94f0474f55261c8c1c4272bb7d2b65ad\n分享一下我以前写的\n判断是否拥有 ...\n我刚才进去了   \n  takeItems.forEach(key->{\n+            player.getInventory().removeItem(key);\n+        });\n。。这个是什么？"
        },
        {
            "author": "TimmyOVO",
            "timestamp": 1493466780,
            "txt_content": "qianji20000420 发表于 2017-4-29 19:06\n我刚才进去了   \n  takeItems.forEach(key->{\n+            player.getInventory().removeItem(key);\nlambda啊。\n。。。你去百度查吧\n至于itemstack::clone那也是lambda的一部分叫方法引用"
        },
        {
            "author": "qianji20000420",
            "timestamp": 1493466960,
            "txt_content": "星燚 发表于 2017-4-29 19:53\nlambda啊。\n。。。你去百度查吧\n至于itemstack::clone那也是lambda的一部分叫方法引用 ...\n十分感谢 已经弄好了    其实我一直不知道Inventory有个removeItem的方法 "
        }
    ]
}