{
    "title": "title有毒啊，时间设置没用",
    "author": "RE_OVO",
    "replyCount": 1,
    "timestamp": 1477465140,
    "txt_content": "我写插件的时候，像调用title提示，第一次我采用ProtocolLib发包，但是时间没法设置啊，怎么弄都是这么点时间，于是我又用NMS，结果任然是这样。。。根本无法设置时间。。，。。。。\n\ndalao们如何解决，在学校无法发截图\n[groupid=128]HAYO Studio[/groupid]",
    "replies": [
        {
            "author": "GTA守护使者",
            "timestamp": 1478005740,
            "txt_content": "发送title方法\n\n看代码吧！\n<p>import java.lang.reflect.Constructor;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.ChatColor;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.Listener;\n \n \n\npublic class titleApi implements Listener{</p><p> </p><p>    public static void main(String []ages){\n        Player Player=Bukkit.getPlayer(\"Dream\");\n        sendTitle(Player , 3, 3, 3, \"这是TITIE标题\", \"这是title下方的那个啥了，我不知道叫什么了\");\n    }</p><p> </p><p>    @SuppressWarnings(\"rawtypes\")\n    public static void sendTitle(Player player, Integer fadeIn, Integer stay, Integer fadeOut, String title, String subtitle){\n        try {\n            if (title != null) {\n                title = ChatColor.translateAlternateColorCodes('&', title);\n                title = title.replaceAll(\"%player%\", player.getDisplayName());\n                Object enumTitle = getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0].getField(\"TITLE\").get(null);\n                Object chatTitle = getNMSClass(\"IChatBaseComponent\").getDeclaredClasses()[0].getMethod(\"a\", new Class[] { String.class }).invoke(null, new Object[] {\"{\"text\":\"\" + title + \"\"}\" });\n                Constructor titleConstructor = getNMSClass(\"PacketPlayOutTitle\").getConstructor(new Class[] { getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0], getNMSClass(\"IChatBaseComponent\"), Integer.TYPE, Integer.TYPE, Integer.TYPE });\n                Object titlePacket = titleConstructor.newInstance(new Object[] { enumTitle, chatTitle, fadeIn, stay, fadeOut });\n                sendPacket(player, titlePacket);\n   }</p><p>        if (subtitle != null) {\n            subtitle = ChatColor.translateAlternateColorCodes('&', subtitle);\n            subtitle = subtitle.replaceAll(\"%player%\", player.getDisplayName());\n            Object enumSubtitle = getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0].getField(\"SUBTITLE\").get(null);\n            Object chatSubtitle = getNMSClass(\"IChatBaseComponent\").getDeclaredClasses()[0].getMethod(\"a\", new Class[] { String.class }).invoke(null, new Object[] { \"{\"text\":\"\" + subtitle + \"\"}\" });\n            Constructor subtitleConstructor = getNMSClass(\"PacketPlayOutTitle\").getConstructor(new Class[] { getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0], getNMSClass(\"IChatBaseComponent\"), Integer.TYPE, Integer.TYPE, Integer.TYPE });\n            Object subtitlePacket = subtitleConstructor.newInstance(new Object[] {enumSubtitle, chatSubtitle, fadeIn, stay, fadeOut });\n            sendPacket(player, subtitlePacket);\n       }\n    } catch (Exception e) {\n        e.printStackTrace();\n  }\n }\n \n public static Class<?> getNMSClass(String name) {\n     String version = org.bukkit.Bukkit.getServer().getClass().getPackage().getName().split(\"<a href='file://\\\\.\")[3'>\\\\.\")[3</a>];\n     try {\n         return Class.forName(\"net.minecraft.server.\" + version + \".\" + name);\n     } catch (ClassNotFoundException e) {\n         e.printStackTrace();\n     }\n     return null;\n }\n \n public static void sendPacket(Player player, Object packet) {\n     try {\n         Object handle = player.getClass().getMethod(\"getHandle\", new Class[0]).invoke(player, new Object[0]);\n         Object playerConnection = handle.getClass().getField(\"playerConnection\").get(handle);\n         playerConnection.getClass().getMethod(\"sendPacket\", new Class[] { getNMSClass(\"Packet\") }).invoke(playerConnection, new Object[] { packet });\n     } catch (Exception e) {\n         e.printStackTrace();\n     }\n  }</p><p>}</p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p>复制代码\n"
        }
    ]
}