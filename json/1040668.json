{
    "title": "1.12.2 forge 的ResourceLocation 問題",
    "author": "lycorisrad",
    "replyCount": 3,
    "timestamp": 1588863840,
    "txt_content": " 本帖最后由 lycorisrad 于 2020-5-7 23:13 编辑 \n\n前陣子有發問關於GUI的問題目前正在找辦法解決，最近發現問題點了，此代碼是照抄女僕作者原碼的IMaidTask.Class 其中 ResourceLocation getUid();IMaidTask.Class\npackage com.github.tartaricacid.touhoulittlemaid.api;\n\nimport net.minecraft.entity.EntityLivingBase;\nimport net.minecraft.entity.ai.EntityAIBase;\nimport net.minecraft.item.ItemStack;\nimport net.minecraft.util.ResourceLocation;\nimport net.minecraft.util.SoundEvent;\n\nimport javax.annotation.Nullable;\n\n/**\n * 女仆任务模式接口\n *\n * @author Snownee\n * @date 2019/7/24 02:31\n */\npublic interface IMaidTask {\n    /**\n     * 模式 ID，用于后续模式的判断，也用于本地化的 key\n     *\n     * @return 用 ResourceLocation 类描述的模式 ID\n     */\n    ResourceLocation getUid();\n\n    /**\n     * 该模式的图标\n     *\n     * @return 用 ItemStack 类描述的图标\n     */\n    ItemStack getIcon();\n\n    /**\n     * 该模式的环境音效\n     *\n     * @param maid 女仆对象\n     * @return 对应的环境音效\n     */\n    @Nullable\n    SoundEvent getAmbientSound(AbstractEntityMaid maid);\n\n    /**\n     * 该模式下调用的 AI\n     *\n     * @param maid 女仆对象\n     * @return 如果什么都不做，可以返回 null\n     */\n    @Nullable\n    EntityAIBase createAI(AbstractEntityMaid maid);\n\n    /**\n     * 主要应用于女仆是否会慌乱跑这样的 AI 触发上（我都处于战斗模式了，怎么能怯战呢）\n     *\n     * @return 是否处于战斗状态\n     */\n    default boolean isAttack() {\n        return false;\n    }\n\n    /**\n     * 远程攻击的逻辑\n     *\n     * @param maid           女仆对象\n     * @param target         攻击目标\n     * @param distanceFactor 距离因子，会依据蓄力进行数值传入\n     */\n    default void onRangedAttack(AbstractEntityMaid maid, EntityLivingBase target, float distanceFactor) {\n    }\n\n    /**\n     * 获取当前模式的国际化 key\n     *\n     * @return 国际化 key\n     */\n    default String getTranslationKey() {\n        return \"task.\" + getUid().getNamespace() + \".\" + getUid().getPath();\n    }\n}\n复制代码但問題重點是這段\ndefault String getTranslationKey() {return \"task.\" + getUid().getNamespace() + \".\" + getUid().getPath();}复制代码我照抄的時候使用getUid無法添加.getNamespace()以及.getPath() 我翻了翻ResourceLocation的原碼\nResourceLocation.class\npackage net.minecraft.util;\n\nimport com.google.gson.JsonDeserializationContext;\nimport com.google.gson.JsonDeserializer;\nimport com.google.gson.JsonElement;\nimport com.google.gson.JsonParseException;\nimport com.google.gson.JsonPrimitive;\nimport com.google.gson.JsonSerializationContext;\nimport com.google.gson.JsonSerializer;\nimport java.lang.reflect.Type;\nimport java.util.Locale;\nimport org.apache.commons.lang3.Validate;\n\npublic class ResourceLocation implements Comparable<ResourceLocation>\n{\n    protected final String resourceDomain;\n    protected final String resourcePath;\n\n    protected ResourceLocation(int unused, String... resourceName)\n    {\n        this.resourceDomain = org.apache.commons.lang3.StringUtils.isEmpty(resourceName[0]) ? \"minecraft\" : resourceName[0].toLowerCase(Locale.ROOT);\n        this.resourcePath = resourceName[1].toLowerCase(Locale.ROOT);\n        Validate.notNull(this.resourcePath);\n    }\n\n    public ResourceLocation(String resourceName)\n    {\n        this(0, splitObjectName(resourceName));\n    }\n\n    public ResourceLocation(String resourceDomainIn, String resourcePathIn)\n    {\n        this(0, resourceDomainIn, resourcePathIn);\n    }\n\n    /**\n     * Splits an object name (such as minecraft:apple) into the domain and path parts and returns these as an array of\n     * length 2. If no colon is present in the passed value the returned array will contain {null, toSplit}.\n     */\n    public static String[] splitObjectName(String toSplit)\n    {\n        String[] astring = new String[] {\"minecraft\", toSplit};\n        int i = toSplit.indexOf(58);\n\n        if (i >= 0)\n        {\n            astring[1] = toSplit.substring(i + 1, toSplit.length());\n\n            if (i > 1)\n            {\n                astring[0] = toSplit.substring(0, i);\n            }\n        }\n\n        return astring;\n    }\n\n    public String getResourcePath()\n    {\n        return this.resourcePath;\n    }\n\n    public String getResourceDomain()\n    {\n        return this.resourceDomain;\n    }\n\n    public String toString()\n    {\n        return this.resourceDomain + ':' + this.resourcePath;\n    }\n\n    public boolean equals(Object p_equals_1_)\n    {\n        if (this == p_equals_1_)\n        {\n            return true;\n        }\n        else if (!(p_equals_1_ instanceof ResourceLocation))\n        {\n            return false;\n        }\n        else\n        {\n            ResourceLocation resourcelocation = (ResourceLocation)p_equals_1_;\n            return this.resourceDomain.equals(resourcelocation.resourceDomain) && this.resourcePath.equals(resourcelocation.resourcePath);\n        }\n    }\n\n    public int hashCode()\n    {\n        return 31 * this.resourceDomain.hashCode() + this.resourcePath.hashCode();\n    }\n\n    public int compareTo(ResourceLocation p_compareTo_1_)\n    {\n        int i = this.resourceDomain.compareTo(p_compareTo_1_.resourceDomain);\n\n        if (i == 0)\n        {\n            i = this.resourcePath.compareTo(p_compareTo_1_.resourcePath);\n        }\n\n        return i;\n    }\n\n    public static class Serializer implements JsonDeserializer<ResourceLocation>, JsonSerializer<ResourceLocation>\n        {\n            public ResourceLocation deserialize(JsonElement p_deserialize_1_, Type p_deserialize_2_, JsonDeserializationContext p_deserialize_3_) throws JsonParseException\n            {\n                return new ResourceLocation(JsonUtils.getString(p_deserialize_1_, \"location\"));\n            }\n\n            public JsonElement serialize(ResourceLocation p_serialize_1_, Type p_serialize_2_, JsonSerializationContext p_serialize_3_)\n            {\n                return new JsonPrimitive(p_serialize_1_.toString());\n            }\n        }\n}复制代码請問我要怎麼樣才能使用.getNamespace()以及.getPath() ? \n還是說因為版本的關係所以要改成下面代碼這樣嗎? \ndefault String getTranslationKey() {\n                return \"task.\" + getUid().getResourceDomain() + \".\" + getUid().getResourcePath();\n            }复制代码還是應該變成\n default String getTranslationKey() {\n                return \"task.\" + getUid().splitObjectName(toSplit)+ \".\" + getUid().getResourcePath();\n            }复制代码問題圖片:\n\n\n\n\n未命名.png (156.1 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-7 23:02 上传\n\n\n\n\n\n問題有點冗長很不好意思\n我找了很多外文網站給我的答案是\ndependencies {\n           \n                deobfCompile \"net.ilexiconn:llibrary:1.7.19-1.12.2\"\n                deobfCompile \"net.ilexiconn:llibrary-core:1.0.11-1.12.2\"\n\n}复制代码Figured it out, needed to includecompile \"net.ilexiconn:llibrary:1.7.9-1.12.2:dev\"instead of deobfCompile \"net.ilexiconn:llibrary:1.7.19-1.12.2\"\n\n\n請問這是甚麼東西呢?\n還麻煩各位大大幫忙很不好意思\n\n\n\n\n\nimage.png\n(194.48 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-5-7 23:02 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "3TUSK",
            "timestamp": 1588867740,
            "txt_content": " 本帖最后由 3TUSK 于 2020-5-8 00:12 编辑 \n\n你使用的 MCP 版本太旧了。\n\nSrgsnapshot_20171003stable_39func_110623_agetResourcePathgetPathfunc_110624_bgetResourceDomaingetNamespace\n\n所以\ndefault String getTranslationKey() {\n    return \"task.\" + getUid().getResourceDomain() + \".\" + getUid().getResourcePath();\n}复制代码\n是对的。至少在你的环境里是如此。\n至于那个加 dependencies 的，那个回答完全不沾边。\n\n或者…… 考虑一下升级 mapping？在 build.gradle 里找到\nminecraft {\n    version = \"1.12.2-14.23.5.2836\"\n    runDir = \"run\"\n    mappings = \"stable_39\"\n}复制代码\n把 mappings 一项改成 stable_39。\n\n延伸阅读：https://harbinger.covertdragon.team/chapter-01/mcp.html\n（不好意思是简体的，凑活看吧。）"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588868220,
            "txt_content": " 本帖最后由 lycorisrad 于 2020-5-8 00:18 编辑 \n3TUSK 发表于 2020-5-8 00:09\n你使用的 MCP 版本太旧了。\n不好意思真的太感謝你了，但是如果照你說我的環境是允許我使用getResourceDomain()那我真的挺失望的，因為我改了這個去測試能不能打開GUI就是不行，我可能要再打掉重練一遍，真的很感謝你回答了我兩個問題。"
        },
        {
            "author": "3TUSK",
            "timestamp": 1588868340,
            "txt_content": "去測試能不能打開GUI就是不行\nResourceLocation 和这个问题没有关系。\n打不开 GUI 肯定有别的原因，有 log 的话，贴到 pastebin 上然后发个链接？"
        }
    ]
}