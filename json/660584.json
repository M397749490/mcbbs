{
    "title": "两个问题。一个关于机制，一个关于消耗物品",
    "author": "1402367475",
    "replyCount": 8,
    "timestamp": 1483860540,
    "txt_content": "最近再写一个鉴别插件，打开背包拖拽图鉴至物品上即可鉴定，但是想不到机制，因为卷轴分为劣质，普通，上好！每个品质的鉴宝结果的效果和概率都不一样，但是不知道怎么写，没有思路，所以求dalao指点，或者有什么插件的机制差不多是这样望各位推荐给我见解下！\n\n另一个是关于消耗图鉴的，我也参考了很多插件的消耗，但基本都行不通！\n我是这样想的就是用图鉴拖拽至物品上后，鉴定完成了后就消耗卷轴，应该怎么写！\n就是这两个问题，！！\n@EventHandler\n        public void PlayerClickEvent(InventoryClickEvent e){\n                Player p=(Player)e.getWhoClicked();\n                ItemStack gettj=e.getCursor();\n                ItemStack getwp=e.getCurrentItem();\n                int sl=gettj.getAmount();\n                int getid=getwp.getTypeId();\n                if(gettj.equals(JBItem.lzlqtj()) && getid==267){\n              e.setCancelled(true);\n              AppraisalLore(gettj, getwp, p);\n            }\n        }复制代码\n\n",
    "replies": [
        {
            "author": "602723113",
            "timestamp": 1483875060,
            "txt_content": " 本帖最后由 602723113 于 2017-1-8 19:32 编辑 \n\n嘛...品质的话你可以用lore或者是物品展示名来识别,识别到哪个你就用哪个的，几率的话就取随机数呗不过要限定个范围qwq\n\n消耗图鉴的话，我假设你现在已经完成了检测图鉴和物品的内容，\n你可以先getAmount()判断下图鉴的个数,如果为1你可以设置下Type为AIR，如果大于1的话就用setAmount(getAmount - 1)\n\n希望能帮到你qwq"
        },
        {
            "author": "1402367475",
            "timestamp": 1483969560,
            "txt_content": "行不通。。。        public void wjxhwp(ItemStack gettj){\n                if(gettj.equals(JBItem.lzlqtj())){\n                        int sl = gettj.getAmount();\n                        if(sl==1){\n                                gettj.setType(Material.AIR);\n                        }\n                        else if (sl>1) {\n                                gettj.setAmount(gettj.getAmount()-1);\n                        }\n                }\n        }复制代码"
        },
        {
            "author": "602723113",
            "timestamp": 1483975320,
            "txt_content": "1402367475 发表于 2017-1-9 21:46\n行不通。。。\nqwq我不记得这个setType之后要不要setItemMeta()，但是还是新建个ItemStack air = new ItemStack(Material.AIR);之后再覆盖过去吧qwq"
        },
        {
            "author": "zeng001223",
            "timestamp": 1483977060,
            "txt_content": "编程大佬，先膜拜再看图"
        },
        {
            "author": "1402367475",
            "timestamp": 1484056920,
            "txt_content": "602723113 发表于 2017-1-9 23:22\nqwq我不记得这个setType之后要不要setItemMeta()，但是还是新建个ItemStack air = new ItemStack(Materia ...\n首先先谢谢dalao了，但是我想了想应该不是代码的问题。而是机制的问题，我是这样写的if(gettj.equals(JBItem.lzlqtj()) && getid==267){\n                        p.closeInventory();\n              AppraisalLore(gettj, getwp, getwpname, p);\n              TakeItem(gettj, p);\n            }复制代码\n也就是当图鉴点击铁剑时关闭背包并执行下面的方法，但是这样的话关闭背包的同时，图鉴也会自己丢出去！\n但是如果能解决上述这个问题，那就可以在背包中检查是否有此物品，然后做出消耗，这个是我的想法，但是不知道怎么解决上述的这个问题！"
        },
        {
            "author": "aibai",
            "timestamp": 1484060400,
            "txt_content": "1402367475 发表于 2017-1-10 22:02\n首先先谢谢dalao了，但是我想了想应该不是代码的问题。而是机制的问题，我是这样写的\n也就是当图鉴点击铁 ...\n你...就不能先取消事件 再关闭背包么"
        },
        {
            "author": "言灵乀Poison",
            "timestamp": 1484068200,
            "txt_content": "1402367475 发表于 2017-1-10 22:02\n首先先谢谢dalao了，但是我想了想应该不是代码的问题。而是机制的问题，我是这样写的\n也就是当图鉴点击铁 ...\n关背包之前\nevent.setCursor(null)把图鉴清除就行"
        },
        {
            "author": "1402367475",
            "timestamp": 1484131140,
            "txt_content": "baibai 发表于 2017-1-10 23:00\n你...就不能先取消事件 再关闭背包么\n一开始写的时候就添加了，没用！"
        }
    ]
}