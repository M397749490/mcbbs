{
    "title": "帮忙检查一下源代码......",
    "author": "seesaw_233",
    "replyCount": 2,
    "timestamp": 1444984620,
    "txt_content": " 本帖最后由 seesaw_233 于 2015-10-16 17:21 编辑 \n由于某不科学的原因，本人的电脑暂无法编译插件...... {:10_524:}所以......把源码发一下......帮忙检查一下错误... {:10_526:}\n---\n\n\npackage seesaw.arenam ;\n\nimport java.io.File;            \nimport java.io.IOException;\nimport org.bukkit.Material;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.configuration.file.FileConfiguration;\nimport org.bukkit.configuration.file.YamlConfiguration;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.BlockBreakEvent;\nimport org.bukkit.inventory.ItemStack;\nimport org.bukkit.inventory.meta.ItemMeta;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.event.player.PlayerInteractEvent;\n\n\n\npublic class ArenaM extends JavaPlugin implements Listener\n{\nprivate final File customArenaConfig = new File(getDataFolder(),\"Arena.yml\");\npublic FileConfiguration AConfig = YamlConfiguration.loadConfiguration(customArenaConfig);\nprivate final File customCacheConfig = new File(getDataFolder(),\"Cache.yml\");\npublic FileConfiguration CacheC = YamlConfiguration.loadConfiguration(customCacheConfig);\nString StickName = \"§2 [设置棒棒]\";\n//----------------------------------------------------------------------------// \n\n    @Override\npublic void onEnable()\n{    \n    DataFolder();\n    SetupSooConfig();\n    SetupCacheConfig();\n    getServer().getPluginManager().registerEvents(this,this);      \n    getLogger().info(\"[ArenaM] 插件已启用\");\n}\n\n    @Override\npublic void onDisable()\n{\n    saveArenaConfig();\n    saveCacheConfig();\n    getLogger().info(\"[ArenaM] 插件已停用\");\n}     \n\n@Override\npublic boolean onCommand(CommandSender sender, Command cmd, String label, String[] args ) \n{\n if(cmd.getName().equalsIgnoreCase(\"am\") )\n {\n  if(args.length == 0) \n  {}\n  if(args.length == 1)\n  {\n      if (sender instanceof Player) {} else\n      {\n          Player p = (Player)sender; \n          if(args[0].equalsIgnoreCase(\"getstick\"))\n            {\n            getStick(sender);\n            p.sendMessage(\"已给予你[设置棒棒]\");\n            }     \n      }  \n  }  \nreturn true;\n }\nreturn false;\n}        \n\npublic void getStick(CommandSender sender)\n{\n\nItemStack s = new ItemStack(Material.STICK ,1) ; \n ItemMeta si = s.getItemMeta();\nPlayer gp = (Player)sender;\nsi.setDisplayName(StickName);\ns.setItemMeta(si);\ngp.getInventory().addItem(s);\n\n}\n\n@EventHandler\npublic void IBB(BlockBreakEvent event)    \n{\n Player kp = event.getPlayer();\n org.bukkit.Material type = kp.getItemInHand().getType();\nif(kp.getItemInHand().getItemMeta().getDisplayName().equalsIgnoreCase(StickName) ) \n {  if (type == org.bukkit.Material.STICK) \n     { event.setCancelled(true); }\n }\n}\n\n@EventHandler\npublic void PIE(PlayerInteractEvent event)  \n{\n org.bukkit.event.block.Action TickType = event.getAction();\n Player kp = event.getPlayer();\n  org.bukkit.Material type = kp.getItemInHand().getType();\nif(kp.hasPermission(\"set\") && type == org.bukkit.Material.STICK)\n  {\n     if(kp.getItemInHand().getItemMeta().getDisplayName().equalsIgnoreCase(StickName) ) \n     {\n         if(TickType == org.bukkit.event.block.Action.LEFT_CLICK_BLOCK)\n         {\n             int lx = event.getClickedBlock().getLocation().getBlockX();\n             int lz = event.getClickedBlock().getLocation().getBlockZ();\n             getCacheConfig().set(\"TicktLocation.Frist.x\",lx);\n             getCacheConfig().set(\"TicktLocation.Frist.z\",lz);\n             saveCacheConfig();\n             kp.sendMessage(\" \");\n             kp.sendMessage(\"§1 你已设置第一个点\");\n             kp.sendMessage(\"§1 X坐标:\" + \"§2 \" +lx);\n             kp.sendMessage(\"§1 Z坐标:\" + \"§2 \" +lz);\n             kp.sendMessage(\" \");\n         }\n         if(TickType == org.bukkit.event.block.Action.RIGHT_CLICK_BLOCK)\n         {\n             int rx = event.getClickedBlock().getLocation().getBlockX();\n             int rz = event.getClickedBlock().getLocation().getBlockZ();\n             getCacheConfig().set(\"TicktLocation.Last.x\",rx);\n             getCacheConfig().set(\"TicktLocation.Last.z\",rz);\n             saveCacheConfig();\n             kp.sendMessage(\" \");\n             kp.sendMessage(\"§1 你已设置第二个点\");\n             kp.sendMessage(\"§1 X坐标:\" + \"§2 \" +rx);\n             kp.sendMessage(\"§1 Z坐标:\" + \"§2 \" +rz);\n             kp.sendMessage(\" \");\n         }\n     }\n }\n}\n\npublic YamlConfiguration SetupArenaConfig()\n{\n                if (!(customArenaConfig.exists()))  //假如文件不存在\n                { \n                 try   //尝试保存文件\n                {\n                   customArenaConfig.createNewFile() ;\n                  }\n                 catch(IOException none)   //捕捉异常(保存不成功)\n                   {\n                      getLogger().info(\"文件无法保存\");\n                   }\n                }\n                return YamlConfiguration.loadConfiguration(customArenaConfig);\n\n}\npublic void saveArenaConfig()\n{ \n    if (!(customArenaConfig.exists()))   //假如文件不存在\n     { SetupArenaConfig(); }\n    else \n     {\n        try \n        {\n            getArenaConfig().save(customArenaConfig);\n        } catch (IOException none)       //捕捉异常(保存不成功)\n        {\n          getLogger().info(\"无法保存文件\");\n        }\n     }\n}\npublic FileConfiguration getArenaConfig() \n    {\n     return AConfig; \n    }\n\n\npublic YamlConfiguration SetupCacheConfig()\n{\n                if (!(customCacheConfig.exists()))  //假如文件不存在\n                { \n                 try   //尝试保存文件\n                {\n                   customCacheConfig.createNewFile() ;\n                  }\n                 catch(IOException none)   //捕捉异常(保存不成功)\n                   {\n                      getLogger().info(\"文件无法保存\");\n                   }\n                }\n                return YamlConfiguration.loadConfiguration(customCacheConfig);\n\n}\npublic void saveCacheConfig()\n{ \n    if (!(customCacheConfig.exists()))   //假如文件不存在\n     { SetupCacheConfig(); }\n    else \n     {\n        try \n        {\n            getArenaConfig().save(customCacheConfig);\n        } catch (IOException none) {\n          getLogger().info(\"无法保存文件\");\n        }\n     }\n}\npublic FileConfiguration getCacheConfig() \n    {\n     return  CacheC; \n    }\n\npublic void DataFolder()  \n    {\n      if(!getDataFolder().exists())   // 如果没有工作目录 \n      { getDataFolder().mkdir(); }    // 创建一个新的(与插件同名) \n    }\n}\n\n\n---\n\n有点多哈，如果有错劳烦告知，顺便给点意见~\n{:10_492:} {:10_492:}\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "tdiant",
            "timestamp": 1445095440,
            "txt_content": "getCacheConfig、getArenaConfig方法有啥用途。。。你直接用对应的变量名不就好了嘛。。。\n根本不需要检查配置文件是不是存在。因为saveDefaultConfig()方法会在配置文件不存在或缺损的时候自动修补，不缺损的话就不会修补。\n\n总体我感觉除了一些令人。。。无法理解的问题以外没问题应该。\n\n———\n参考文档：\nhttp://mineplugin.org/Configuration_API_Reference"
        },
        {
            "author": "seesaw_233",
            "timestamp": 1445315220,
            "txt_content": "tdiant 发表于 2015-10-17 23:24\ngetCacheConfig、getArenaConfig方法有啥用途。。。你直接用对应的变量名不就好了嘛。。。\n根本不需要检查 ...\n有“无法理解的问题”是正常的，\n代码依照KitBattle插件源文件改编\n( 歪果仁de黑科技...... )"
        }
    ]
}