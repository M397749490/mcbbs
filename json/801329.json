{
    "title": "[娱乐][开源][PCD]TNTThrow —— 右键TNT原地点燃？不如直接扔出去！[1.8+]",
    "author": "黑",
    "replyCount": 3,
    "timestamp": 1530000300,
    "txt_content": " 本帖最后由 583736449 于 2018-6-26 16:05 编辑 \n\nTNTThrow\n来一场炸弹对决？\n\n\n插件功能\n\n右键扔出TNT！\n允许你自定义粒子特效，抛射力度，抛射距离。\n独立权限控制，小游戏服务器必备！\n\n\n插件截图\n\n\n\n\n\n插件下载\n\n注意！插件需要 TabooLib 4.10 以上的版本\n\n\n\nTNTThrow.jar\n(4.46 KB, 下载次数: 105)\n\n\n\n2018-6-26 16:01 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n插件权限\n\ntntthrow.use —— 允许右键抛射TNT\n\n插件命令\n\n/tntthrow —— 重载配置\n\n插件配置\n\n\n# 插件设置\nSettings:\n  # 燃烧时间\n  FuseTicks: 60\n  # 抛射距离\n  BlockRadius: 20\n  # 抛射力度\n  BlockVelocity: 25\n  # 粒子设定\n  Particle:\n    # 是否启用\n    Enable: true\n    # 粒子类型\n    Type: FLAME\n    # X轴偏移\n    OffsetX: 0\n    # Y轴偏移\n    OffsetY: 0\n    # Z轴偏移\n    OffsetZ: 0\n    # 速度\n    Speed: 0\n    # 数量\n    Amount: 10\n    # 可见距离\n    Radius: 30复制代码\n\n插件源码\n\npackage me.skymc.tntthrow;\n\nimport me.skymc.taboolib.entity.VectorUtils;\nimport me.skymc.taboolib.fileutils.ConfigUtils;\nimport me.skymc.taboolib.particle.EffLib;\nimport org.bukkit.Bukkit;\nimport org.bukkit.Material;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.configuration.file.FileConfiguration;\nimport org.bukkit.entity.EntityType;\nimport org.bukkit.entity.TNTPrimed;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.Action;\nimport org.bukkit.event.player.PlayerInteractEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.scheduler.BukkitRunnable;\nimport org.bukkit.util.BlockIterator;\n\n/**\n * @author sky\n * @Since 2018-06-26 13:42\n */\npublic class TNTThrow extends JavaPlugin implements Listener {\n\n    private int fuseTicks;\n    private int blockRadius;\n    private int blockVelocity;\n    private boolean particleEnable;\n    private EffLib particleType;\n    private float offsetX;\n    private float offsetY;\n    private float offsetZ;\n    private int speed;\n    private int amount;\n    private int radius;\n    private FileConfiguration configuration;\n\n    @Override\n    public void onEnable() {\n        reloadConfig();\n        Bukkit.getPluginManager().registerEvents(this, this);\n    }\n\n    @Override\n    public boolean onCommand(CommandSender sender, Command command, String label, String[] args) {\n        reloadConfig();\n        sender.sendMessage(\"reload successfully\");\n        return true;\n    }\n\n    @Override\n    public void reloadConfig() {\n        configuration = ConfigUtils.saveDefaultConfig(this, \"config.yml\");\n        reloadSettings();\n    }\n\n    @EventHandler\n    public void onClick(PlayerInteractEvent e) {\n        if (e.getAction() == Action.RIGHT_CLICK_BLOCK || e.getAction() == Action.RIGHT_CLICK_AIR || e.getPlayer().hasPermission(\"tntthrow.use\")) {\n            if (e.getPlayer().getItemInHand() != null && e.getPlayer().getItemInHand().getType().equals(Material.TNT)) {\n                e.setCancelled(true);\n\n                if (e.getPlayer().getItemInHand().getAmount() > 1) {\n                    e.getPlayer().getItemInHand().setAmount(e.getPlayer().getItemInHand().getAmount() - 1);\n                } else {\n                    e.getPlayer().setItemInHand(null);\n                }\n\n                TNTPrimed tntPrimed = (TNTPrimed) e.getPlayer().getWorld().spawnEntity(e.getPlayer().getLocation(), EntityType.PRIMED_TNT);\n                tntPrimed.setFuseTicks(fuseTicks);\n\n                BlockIterator blockIterator = new BlockIterator(e.getPlayer());\n                for (int i = 0; i < blockRadius; i++) {\n                    blockIterator.next();\n                }\n\n                VectorUtils.entityPush(tntPrimed, blockIterator.next().getLocation(), blockVelocity);\n\n                new BukkitRunnable() {\n                    @Override\n                    public void run() {\n                        if (tntPrimed == null || tntPrimed.isDead() || tntPrimed.getFuseTicks() == 0) {\n                            cancel();\n                        } else {\n                            particleType.display(offsetX, offsetY, offsetZ, speed, amount, tntPrimed.getLocation(), radius);\n                        }\n                    }\n                }.runTaskTimer(this, 0, 1);\n            }\n        }\n    }\n\n    // *********************************\n    //\n    //        Private Methods\n    //\n    // *********************************\n\n    private void reloadSettings() {\n        fuseTicks = configuration.getInt(\"Settings.FuseTicks\", 60);\n        blockRadius = configuration.getInt(\"Settings.BlockRadius\", 20);\n        blockVelocity = configuration.getInt(\"Settings.BlockVelocity\", 25);\n        particleEnable = configuration.getBoolean(\"Settings.Particle.Enable\");\n        offsetX = (float) configuration.getDouble(\"Settings.Particle.OffsetX\", 0);\n        offsetY = (float) configuration.getDouble(\"Settings.Particle.OffsetY\", 0);\n        offsetZ = (float) configuration.getDouble(\"Settings.Particle.OffsetZ\", 0);\n        speed = configuration.getInt(\"Settings.Particle.Speed\");\n        amount = configuration.getInt(\"Settings.Particle.Amount\");\n        radius = configuration.getInt(\"Settings.Particle.Radius\");\n        try {\n            particleType = EffLib.valueOf(configuration.getString(\"Settings.Particle.Type\", \"FLAME\"));\n        } catch (Exception ignored) {\n        }\n    }\n}复制代码\n\n\n本插件所用所有代码均为原创,不存在借用/抄袭等行为\n\n[groupid=1330]PluginsCDTribe[/groupid]",
    "replies": [
        {
            "author": "WKIL",
            "timestamp": 1530000840,
            "txt_content": "扔出去？可以，这很像手榴弹什么的\n这个可以改变TNT抛掷距离吗"
        },
        {
            "author": "‮rehctaCykS‭",
            "timestamp": 1537278120,
            "txt_content": "if ((e.getAction() == Action.RIGHT_CLICK_BLOCK || e.getAction() == Action.RIGHT_CLICK_AIR || e.getPlayer().hasPermission(\"tntthrow.use\")) && e.getPlayer().getItemInHand() != null && e.getPlayer().getItemInHand().getType().equals((Object)Material.TNT))复制代码\n你好楼主，这段代码的判断逻辑是不是有点问题"
        },
        {
            "author": "徐宇轩",
            "timestamp": 1565611680,
            "txt_content": "WKIL 发表于 2018-6-26 16:14\n扔出去？可以，这很像手榴弹什么的\n这个可以改变TNT抛掷距离吗\n对的，改一下的话就避免会被炸死"
        }
    ]
}