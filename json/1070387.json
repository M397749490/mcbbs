{
    "title": "【已解决】1.12..2如何判断玩家进服后背包里是否有某件东西",
    "author": "GhostSkyV9",
    "replyCount": 18,
    "timestamp": 1593534660,
    "txt_content": " 本帖最后由 sky295 于 2020-7-19 00:15 编辑 \n\nrt。。。。。",
    "replies": [
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593534840,
            "txt_content": "监听PlayerLoginEvent，之后getPlayer#getInventory，遍历物品栏判断"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593536460,
            "txt_content": "疾风暗影 发表于 2020-7-1 00:34\n监听PlayerLoginEvent，之后getPlayer#getInventory，遍历物品栏判断\n@EventHandler\npublic void onPlayerJoinItem(PlayerJoinEvent event){\n    Player player=event.getPlayer();\n    PlayerInventory inventory=player.getInventory();\n    ItemStack item=new ItemStack(Material.WRITTEN_BOOK,1);\n    BookMeta meta=(BookMeta) item.getItemMeta();\n    meta.setTitle(\"新手教程\");\n    meta.setAuthor(\"SKY\");\n    meta.addPage(\"1\");  meta.setPage(1,getConfig().getStringList(\"Content\").get(1));\n    item.setItemMeta(meta);\n    if (!inventory.contains(item)){\n        inventory.addItem(item);\n        player.sendMessage(\"§6获得你一本新手教程\");\n    }\n}\n\n我这个判断是这样写的，玩家进服给一本成书，但是玩家如果再次进服的话还会再给，我只想让它给一次的话，要怎么办"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593536520,
            "txt_content": "sky295 发表于 2020-7-1 01:01\n@EventHandler\npublic void onPlayerJoinItem(PlayerJoinEvent event){\n    Player player=event.getPlay ...\n给你的成书添加lore标记\n\n之后进服先循环遍历inventory，判断有没有某本成书有该lore，有的话直接return"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593536820,
            "txt_content": "疾风暗影 发表于 2020-7-1 01:02\n给你的成书添加lore标记\n\n之后进服先循环遍历inventory，判断有没有某本成书有该lore，有的话直接return ...\n判断lore的话，是怎样的"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593537600,
            "txt_content": "sky295 发表于 2020-7-1 01:07\n判断lore的话，是怎样的\n三步\n获取lore，判断是否为null\n不为null，判断长度\n获取首个，比较string"
        },
        {
            "author": "紫乻？",
            "timestamp": 1593537600,
            "txt_content": "sky295 发表于 2020-7-1 01:07\n判断lore的话，是怎样的        //获得事件玩家\n        Player player = e.getPlayer();\n\n        //获得玩家背包的迭代器\n        ListIterator<ItemStack> it = player.getInventory().iterator();\n        //遍历\n        while (it.hasNext()) {\n            //获取物品 判断是否为空 为空跳过\n            ItemStack item = it.next();\n            if (item == null) continue;\n\n            //检测物品是否存在lore 并且 lore是否存在 “lore信息”\n            ItemMeta im = item.getItemMeta();\n            if (im.hasLore() && im.getLore().contains(\"lore信息\")){\n                //这里就是找到了\n                return;\n            }\n        }复制代码\n这样子"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593567300,
            "txt_content": "紫乻？ 发表于 2020-7-1 01:20\n这样子    @EventHandler\n    public void onPlayerJoinItem(PlayerJoinEvent event){\n        Player player=event.getPlayer();\n        int page=getConfig().getStringList(\"Content\").size();\n        PlayerInventory inventory=player.getInventory();\n        List<String> lores=new ArrayList<String>();\n        ListIterator<ItemStack> it=player.getInventory().iterator();\n        ItemStack item=new ItemStack(Material.WRITTEN_BOOK,1);\n        BookMeta meta=(BookMeta) item.getItemMeta();\n        meta.setTitle(\"新手教程\");\n        meta.setAuthor(\"SKY\");\n        lores.add(\"这是一本新手教程\");\n        meta.setLore(lores);\n        for (int i =1;i<=page;i++){\n            meta.addPage(\"页面\"+i);\n            meta.setPage(i,getConfig().getStringList(\"Content\").get((i-1)));\n        }\n        item.setItemMeta(meta);\n        while (it.hasNext()){\n            ItemStack itemStack=it.next();\n            if (itemStack==null) continue;\n            ItemMeta im=itemStack.getItemMeta();\n            if(im.hasLore()&&im.getLore().contains(\"这是一本新手教程\")){\n                return;\n            }else{\n                inventory.addItem(item);\n                player.sendMessage(\"§6获得你一本新手教程\");\n            }\n        }\n    }复制代码\n\n这样写了之后，哪里出了问题，背包里没有这本带lore的成书玩家进服也不会给"
        },
        {
            "author": "南柯郡守",
            "timestamp": 1593567660,
            "txt_content": "sky295 发表于 2020-7-1 09:35\n这样写了之后，哪里出了问题，背包里没有这本带lore的成书玩家进服也不会给 ...\n添加输出代码逐步输出 看哪里出问题"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593568500,
            "txt_content": " 本帖最后由 sky295 于 2020-7-1 09:56 编辑 \n南柯郡守 发表于 2020-7-1 09:41\n添加输出代码逐步输出 看哪里出问题if (itemStack==null) continue;复制代码\n执行到这里就出问题了\n\n\n\n\n\n\nQQ截图20200701095448.png\n(303.79 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-7-1 09:56 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        {
            "author": "紫乻？",
            "timestamp": 1593568500,
            "txt_content": " 本帖最后由 紫乻？ 于 2020-7-1 10:03 编辑 \nsky295 发表于 2020-7-1 09:35\n这样写了之后，哪里出了问题，背包里没有这本带lore的成书玩家进服也不会给 ...\n你注册了监听器么?"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593568500,
            "txt_content": "紫乻？ 发表于 2020-7-1 09:55\n你注册了监听器么?\n你可以用这种写法\n注册了。。。。"
        },
        {
            "author": "紫乻？",
            "timestamp": 1593568800,
            "txt_content": " 本帖最后由 紫乻？ 于 2020-7-1 10:08 编辑 \nsky295 发表于 2020-7-1 09:55\n注册了。。。。\n你这个逻辑有点问题 你不能在else里面写 那是找到了的情况 没找到应该等循环结束 \n像这样写 \n\n\n\n\n\nF5(U8~)8[JIOVL[%Z$Z(24I.png (102.94 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-1 10:08 上传\n\n\n\n\n\n\n"
        },
        {
            "author": "南柯郡守",
            "timestamp": 1593568860,
            "txt_content": "sky295 发表于 2020-7-1 09:55\n执行到这里就出问题了\n你这个逻辑是  只要玩家背包是空的 就不做任何操作\n\n逻辑应该是\n\nboolean 有书 为 false\nwhile判断\n\nif物品为空 继续循环\nelse 判断是否是这本书 如果是 有书 设为true 同时break出去\n\nwhile循环结束后\n\nif有书 就结束\nelse 给书"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593569820,
            "txt_content": "紫乻？ 发表于 2020-7-1 10:00\n你这个逻辑有点问题 你不能在else里面写 那是找到了的情况 没找到应该等循环结束 \n像这样写 \n可以了，多谢老哥，又get到了新姿势"
        },
        {
            "author": "RT、二哈",
            "timestamp": 1593571500,
            "txt_content": "上网搜一搜 可能会更快"
        },
        {
            "author": "QiuJay",
            "timestamp": 1593572520,
            "txt_content": "我有个疑问，如果当一个玩家进来后获得了书，然后扔了，下次进来不还是一样会获得，但这个时候这玩家并不是新手了，下图是我认为比较优雅的判断逻辑代码\n\n\n\n\n\n\nimage.png\n(158.17 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-7-1 11:01 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        {
            "author": "南柯郡守",
            "timestamp": 1593578160,
            "txt_content": "QiuJay 发表于 2020-7-1 11:02\n我有个疑问，如果当一个玩家进来后获得了书，然后扔了，下次进来不还是一样会获得，但这个时候这玩家并不是 ...\n可以获取玩家的firstPlayTime来判断是否首次进入服务器"
        },
        {
            "author": "lliiooll",
            "timestamp": 1593877920,
            "txt_content": "我记得Player有个isFirst方法吧。。\n你或许可以试试这个"
        }
    ]
}