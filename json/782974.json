{
    "title": "[Bukkit|Spigot][PCD]只有ItemMeta吗？让ItemMeta的子类给你提供无限创意！",
    "author": "白羊羊",
    "replyCount": 13,
    "timestamp": 1519188720,
    "txt_content": "使用ItemMeta的子类—— 实现更多的物品自定义 ——\n其实，除了Bukkit提供的普通ItemMeta外，它还有一些其他的子类，这些子类用于设置一些特殊物品的属性，例如，我想设计一下这个烟花的样式，那么怎么才能进行编辑呢？ItemMeta类没有提供相关方法啊。这时就要用到ItemMeta的子类 FireworkMeta 来进行更加详细的设置。本教程使用Intellij IDEA作为IDESpigotAPI为1.12.2版本使用Maven\n BookMeta - 自定义书\n教程内容：\n自定义书本需要用到BookMeta类，首先我们新建一个插件，填写好相关内容并完成主类后，创建一个新的类，命名为TestBook，这个类我们拿来编辑BookMeta。首先创建类，搞♂一个书ItemStack出来写一个load()方法在开服时调用，对上面的ItemStack对象进行属性修改获取书的ItemMeta这里我们需要用到强制类型转换特别注意：只有Material为BOOK_AND_QUILL或是WRITTEN_BOOK的ItemStack才可以强制转换为BookMeta获取到BookMeta之后，我们就可以进行编辑了首先设置书的作者、书的标题开始写入书内容，这里我们用到了StringBuilder类便于我们快速写入内容\n最后调用addPage(String... string)方法，添加新的一页\n特别注意：每页最多256个字符、最多50页\n\n最后设置书的类型\nGeneration是BookMeta的内部枚举类，不同的枚举对应不同的书类型\nORIGINAL -> 原著COPY_OF_ORIGINAL -> 副本COPY_OF_COPY -> 副本的副本TATTERED -> 破烂不堪\n在这里，我们将这本书设置为原著\n\n最后，将定义好的BookMeta设置为这本书的ItemMeta\n\n我们在主类监听玩家加入事件，在玩家进服时自动给予一本书\n\n使用Maven自动构建，将插件丢进服务端。\n现在进游戏测试看看，我们写的书是什么样子的吧！\n\n\nTestBook代码：public class TestBook{\n\n    //新建一个 ItemStack ，Material为成书\n    static ItemStack book = new ItemStack(Material.WRITTEN_BOOK);\n\n    //对 ItemStack 进行相关操作\n    //在开服时调用，载入物品\n    public static void load(){\n        //将ItemMeta强制类型转换为BookMeta\n        //注意，只有成书和书与笔才可以这样\n        BookMeta bookmeta = (BookMeta) book.getItemMeta();\n\n        //调用  BookMeta 类的方法 setAuthor() 填写作者\n        bookmeta.setAuthor(\"秋风残叶\");\n\n        //调用  BookMeta 类的方法 setTitle() 设置书的标题\n        bookmeta.setTitle(\"残叶的女装史\");\n\n        //使用StringBuilder类快速便捷文本内容\n        StringBuilder text = new StringBuilder();\n        text.append(\"时间：2017-7-1\\n残叶的暑假开始了，门口放着\\n夜幕寄来的女装。\\n\\n\");\n        text.append(\"时间：2017-7-5\\n残叶非常喜欢夜幕送来的女\\n装残叶每天上街都会穿着。\\n\\n\");\n        text.append(\"时间：2017-7-10\\n残叶发现了一个神秘传送门\\n倍感好奇地走了进去。\");\n\n        //将这些内容写入新的一页\n        //注意，每页最多256个字符，每本书最多50页\n        bookmeta.addPage(text.toString());\n\n        //设置书的类型为原著\n        bookmeta.setGeneration(BookMeta.Generation.ORIGINAL);\n\n        //完成BookMeta编写\n        book.setItemMeta(bookmeta);\n    }\n}复制代码 BannerMeta - 自定义旗帜教程内容：对于旗帜，Bukkit同样提供了ItemMeta的子类BannerMeta，这个类可以自定义旗帜的所有属性，包括样式、颜色等。这里我们演示如何弄一个白底绿色麻将标志的旗帜。首先新建一个TestFlag类，new一个旗帜出来，白色旗帜的副ID是15，所以后面的short值填15\n旗帜的样式由Pattern类决定，所以要搞样式就得new一个Pattern对象\n在这里我们使用的构造方法是Pattern(DyeColor, PatternType);\n当然还有一个另外的构造方法，请去SpigotAPI查阅。\n这里要介绍的是DyeColor和PatternType类，这两个类都是枚举类\nDyeColor：图形的颜色，比如我们这里要绿色的麻将图标，就用 GREENPatternType：图形的样式，有多种选择，这里我们选麻将图标，用 MOJANG\n\n定义好了旗帜样式之后，就可以将我们的旗帜设置为这个样式了。\n\n主类和上面的一样，开服时加载物品，玩家进服时给予。\n现在进入游戏吧！\n\n\nTestFlag代码：public class TestFlag {\n\n    //要以白色作为旗帜底色，所以说我们选择了副ID为15的旗帜\n    static ItemStack flag = new ItemStack(Material.BANNER,1,(short)15);\n\n\n    public static void load(){\n        BannerMeta banner = (BannerMeta) flag.getItemMeta();\n\n        //编辑旗帜样式需要用到Pattern类，这个类为旗帜提供提供样式\n        //我们调用Pattern类的Pattern?(DyeColor color, PatternType pattern)构造方法\n        //DyeColor与PatternType都是枚举类\n        //DyeColor提供16种旗帜颜色，PatternType提供多种旗帜样式\n        //这里我们选用绿色+麻将图标\n        Pattern p = new Pattern(DyeColor.GREEN, PatternType.MOJANG);\n\n        // 添加旗帜样式\n        banner.addPattern(p);\n\n        //设置ItemMeta\n        flag.setItemMeta(banner);\n    }\n}复制代码 FireworkEffectMeta & FireworkMeta - 自定义烟花烟火之星教程内容：对于烟花，Bukkit同样提供了可用于自定义的 FireworkEffectMeta 与 FireworkMeta ，它们分别是给烟火之星和烟花准备的。你可以自定义烟花的各种形状、颜色、样式等等。首先来看FireworkEffectMeta自定义烟火之星的样式新建一个TestFirework类获取烟火之星的ItemMeta，强转为FireworkEffectMeta开始自定义我们的FireworkEffectMeta我们需要用到它的内部类BuilderBuilder类里面提供了很多方法用于设置属性withColor()可以为烟花设置颜色，可以传入多种颜色参数withFade()是烟花炸完了之后淡出的颜色，同样可以传入多种颜色参数withFlicker()可以设置烟花为闪烁状withTrail()可以设置烟花在飞行时飘出白色颗粒with()用于设置烟花的形状，传入一个Type类型参数，这个类是FireworkEffect的内部枚举类，这里我们使用小型球状 BALL\n关于Type的所有枚举在 这里 查看\n现在，进入游戏看看吧，我们定义好的烟火之星。把它合成为烟火之星，别跟我说你玩了这么久MC连烟花合成都不会烟花绽放的样子（红黄）烟花淡出的样子（蓝绿）\n烟花教程内容：烟花和烟火之星的设置基本相同不过烟花可以同时使用多种烟花样式当然还有一个setPower()用于设置烟花的飞行时间（烟花这些属性都不知道还好意思说玩过MC？）定义好之后，进游戏测试两种形状都有哦，非常漂亮吧！\n两个类的代码：public class TestFirework {\n    //获取一个烟火之星的ItemStack实例\n    static ItemStack firework = new ItemStack(Material.FIREWORK_CHARGE);\n\n    public static void load(){\n        //强制类型转换为FireworkEffectMeta\n        //注意，这里只能使用烟火之星，请不要使用烟花\n        FireworkEffectMeta effectMeta = (FireworkEffectMeta) firework.getItemMeta();\n\n        //为了自定义烟花样式，我们要使用FireworkEffect.Bulider内部类\n        //使用builder()方法获取内部类FireworkEffect.Bulider\n        //这个类用于链式设置烟花的各种属性\n        //什么是链式？这就是链式\n        FireworkEffect fe =  FireworkEffect.builder()\n                .withColor(Color.RED,Color.YELLOW)\n                .withFade(Color.GREEN,Color.BLUE)\n                .withFlicker()\n                .withTrail()\n                .with(FireworkEffect.Type.BALL)\n                .build();\n\n        //设置烟花样式\n        effectMeta.setEffect(fe);\n\n        //最后设置为我们的Meta\n        firework.setItemMeta(effectMeta);\n    }\n}复制代码public class TestFireworkNew {\n    //实例化烟花的ItemStack\n    static ItemStack fff = new ItemStack(Material.FIREWORK);\n\n    public static void load(){\n        //只有烟花才可以强制类型转换为FireworkMeta\n        FireworkMeta f = (FireworkMeta) fff.getItemMeta();\n\n        //定义两个FireworkEffect\n        FireworkEffect f1 =  FireworkEffect.builder()\n                .withColor(Color.RED,Color.YELLOW)\n                .withFade(Color.GREEN,Color.BLUE)\n                .withFlicker()\n                .withTrail()\n                .with(FireworkEffect.Type.CREEPER)\n                .build();\n        FireworkEffect f2 =  FireworkEffect.builder()\n                .withColor(Color.RED,Color.YELLOW)\n                .withFade(Color.GREEN,Color.BLUE)\n                .withFlicker()\n                .withTrail()\n                .with(FireworkEffect.Type.STAR)\n                .build();\n\n        //为烟花添加Effect\n        //可以使用addEffects()方法添加多个FireworkEffect\n        f.addEffects(f1,f2);\n\n        //设置烟花飞行时间，1就够了\n        f.setPower(1);\n\n        fff.setItemMeta(f);\n    }\n}\n复制代码 KnowledgeBookMeta - 自定义知识之书教程内容：什么？知识之书是什么？你连这个都不知道就来学教程了？来来来，我来帮你科普一下（摘自Minecraft中文Wiki）知识之书\n一本绿色的书。目前只能通过使用/give <玩家名称> knowledge_book命令获得。一本带着Recipes NBT标签的知识之书，包含着物品ID列表，当玩家使用它时就会被消耗并解锁指定物品的配方。\n\n总的说，就是你自定义好的知识之书，玩家右键会立即获得里面所包含的合成配方我们直接来进行自定义教程吧，如果还不知道知识之书有什么用的，看完你就知道了现在进入游戏，使用我们的知识之书手持知识之书，右键即可现在打开工作台的合成表界面吧，已经得到了这个合成配方了\nTestKnowlageBook类代码：public class TestKnowlageBook {\n    //获取知识之书的ItemStack对象\n    static ItemStack book = new ItemStack(Material.KNOWLEDGE_BOOK);\n\n    public static void load(){\n        //强制类型转换为 KnowledgeBookMeta\n        KnowledgeBookMeta k = (KnowledgeBookMeta) book.getItemMeta();\n\n        //NamespacedKey类作为合成配方提供类\n        // 所包含的Key值，这个Key值就是物品minecraft名称，例如：minecraft:chest\n        //我们调用构造方法 NamespacedKey?(String namespace, String key)\n        NamespacedKey n = new NamespacedKey(NamespacedKey.MINECRAFT,\"chest\");\n\n        //添加合成配方，可以多个\n        k.addRecipe(n);\n\n        //设置Meta数据\n        book.setItemMeta(k);\n    }\n}复制代码 LeatherArmorMeta - 自定义皮革类装备颜色教程内容：对于可以染色皮革类装备，Bukkit怎么可能不提供Meta设置呢，我们可以通过 LeatherArmorMeta 来设置皮革类衣服的颜色，任意颜色均可，因为Color对象是可以任意调整RGB值的。下面是详细操作过程：现在上游戏看看我们做好的衣服（女装）吧穿上试试看\nTestLeather类代码：public class TestLeather {\n    //获取皮革衣服的ItemStack对象\n    static ItemStack armor = new ItemStack(Material.LEATHER_CHESTPLATE);\n\n    public static void load(){\n        //强制类型转换为LeatherArmorMeta\n        LeatherArmorMeta la = (LeatherArmorMeta) armor.getItemMeta();\n\n        //获取衣服颜色\n        //我们这里将衣服颜色调整颜色的RGB值为骚粉\n        Color c = la.getColor().setRed(219).setGreen(160).setBlue(160);\n\n        // 设置颜色\n        la.setColor(c);\n\n        armor.setItemMeta(la);\n    }\n}复制代码 PotionMeta - 自定义药水教程内容：药水的设置非常简单，和皮革装备一样，药水也是可以调整颜色的。下面是详细操作过程：现在进游戏看看实际效果吧！\nTestPotion类代码：public class TestPotion {\n    //获取喷溅型药水的ItemStack对象\n    static ItemStack potion  =new ItemStack(Material.SPLASH_POTION);\n\n\n    public static void load(){\n        //强制转换为药水类型\n        PotionMeta pm = (PotionMeta) potion.getItemMeta();\n\n        //Color类可以使用RGB值任意设置颜色\n        Color c = Color.AQUA.setRed(255).setGreen(255).setBlue(0);\n\n        //设置药水颜色\n        pm.setColor(c);\n\n        //设置基本属性PotionData\n        //这个类用于设置药水基础内容，就是创造模式物品栏里面的各种药水属性\n        //仅限于基础属性，凋零、反胃等不能在这里添加\n        PotionData pa = new PotionData(PotionType.WATER, false,false);\n\n        //用于添加额外的药水效果\n        //你可以将overwrite参数设置为true来覆盖原来的效果\n        pm.addCustomEffect(new PotionEffect(PotionEffectType.ABSORPTION,100,1) ,true);\n\n        //最后设置药水基本属性\n        pm.setBasePotionData(pa);\n\n        potion.setItemMeta(pm);\n    }\n}复制代码 SkullMeta - 自定义头颅教程内容：自定义头颅可以让你自定义许多东西，大家熟悉的粘液科技，正是使用了头颅作为新增的物品使用SkullMeta来让你的头颅丰富多彩进游戏看看我们定义好的头颅吧\nTestSkull类代码：public class TestSkull {\n\n    //获取头颅的ItemStack\n    //注意这里的副ID必须是3，因为那才是玩家头\n    static ItemStack skull = new ItemStack(Material.SKULL_ITEM,1,(short)3);\n\n    static void load(){\n        //转换为SkullMeta\n        SkullMeta sm = (SkullMeta) skull.getItemMeta();\n\n        //设置头颅主人\n        //这里我们用的UUID\n        //传入的参数是一个OfflinePlayer对象\n        sm.setOwningPlayer(Bukkit.getOfflinePlayer(UUID.fromString(\"0749524f-e061-3ba8-aa11-31f8d4245848\")));\n\n        //设置头颅数据\n        skull.setItemMeta(sm);\n    }\n}复制代码[groupid=1330]PluginsCDTribe[/groupid]",
    "replies": [
        {
            "author": "Gyzerccc",
            "timestamp": 1519190040,
            "txt_content": "问下。第一格自定义本子如何设置鼠标划过显示子和鼠标点击执行代码？"
        },
        {
            "author": "白羊羊",
            "timestamp": 1519190160,
            "txt_content": "Gyzerccc 发表于 2018-2-21 13:14\n问下。第一格自定义本子如何设置鼠标划过显示子和鼠标点击执行代码？\n那个要用到spigot专用的东西"
        },
        {
            "author": "liuyipeng001",
            "timestamp": 1519202340,
            "txt_content": "Gyzerccc 发表于 2018-2-21 13:14\n问下。第一格自定义本子如何设置鼠标划过显示子和鼠标点击执行代码？val book = ItemStack(Material.WRITTEN_BOOK)\nval meta = book.itemMeta as CraftMetaBook\nval text = ComponentBuilder(\"Hi\").apply {\n        event(ClickEvent(ClickEvent.Action.RUN_COMMAND, \"/say hi!\"))\n        event(HoverEvent(HoverEvent.Action.SHOW_TEXT, arrayOf(TextComponent(\"你好啊!\"))))\n        color(ChatColor.AQUA)\n    }.create()\n text.forEach {\n        meta.pages.add(IChatBaseComponent.ChatSerializer.a(ComponentSerializer.toString(it)))\n}\n book.itemMeta = meta复制代码\n\n\n\n\nmc1.png (264.71 KB, 下载次数: 9)\n\n下载附件\n\n2018-2-21 16:38 上传\n\n\n\n\n\n\n\n\nmc2.png (327.07 KB, 下载次数: 3)\n\n下载附件\n\n2018-2-21 16:38 上传\n\n\n\n\n\n懒得写反射了，要用CraftMetaBook和bungee.api.chat里的那堆东西\n"
        },
        {
            "author": "2280761425",
            "timestamp": 1519793760,
            "txt_content": "园神凛祢 发表于 2018-2-22 11:27\n**** 作者被禁止或删除 内容自动屏蔽 ****\n图片转为点阵显示【滑稽】"
        },
        {
            "author": "纯白剑姬",
            "timestamp": 1540183320,
            "txt_content": "请问 关于头颅需要时间加载皮肤吗？是必须取进过服的玩家的皮肤吗？\n因为我在1.11读取了几个正版皮肤的头颅 经常会加载超时失败呢...."
        },
        {
            "author": "白羊羊",
            "timestamp": 1540183440,
            "txt_content": "纯白剑姬 发表于 2018-10-22 12:42\n请问 关于头颅需要时间加载皮肤吗？是必须取进过服的玩家的皮肤吗？\n因为我在1.11读取了几个正版皮肤的头颅 ...\n这个头颅皮肤要从官方服务器下载的，第一次进游戏缓存好了就没问题了"
        },
        {
            "author": "悠然学院",
            "timestamp": 1540308540,
            "txt_content": "liuyipeng001 发表于 2018-2-21 16:39\n懒得写反射了，要用CraftMetaBook和bungee.api.chat里的那堆东西\n如何是直接弹出书面gui，而没有获取书本呢？"
        },
        {
            "author": "JackMeds",
            "timestamp": 1540538280,
            "txt_content": "不愧是艺术家，太厉害了，这教程很实用"
        },
        {
            "author": "董开和天哥",
            "timestamp": 1560685620,
            "txt_content": "这波教程可以，学到了"
        },
        {
            "author": "Tcaks_NB",
            "timestamp": 1561908180,
            "txt_content": "先搜藏，回头看~"
        },
        {
            "author": "771474491",
            "timestamp": 1580821380,
            "txt_content": "spigot1.8没有setOwningPlayer\n请问有1.8的吗？"
        },
        {
            "author": "5uuwinn",
            "timestamp": 1581655260,
            "txt_content": "作者有没有打算出更多的这类代码示例，如果能有各种各样经常用的代码示例，相比更好（如：自定义粒子效果，弓箭附上药水效果，等等）。"
        },
        {
            "author": "xm6666",
            "timestamp": 1612407840,
            "txt_content": "楼主的图床好像炸了，看不到图片"
        }
    ]
}