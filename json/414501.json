{
    "title": "怎么设置杀死某个NPC后就触发命令方块",
    "author": "死灵S",
    "replyCount": 21,
    "timestamp": 1424752860,
    "txt_content": "求各位大神解答",
    "replies": [
        {
            "author": "平凡的行者",
            "timestamp": 1424752860,
            "txt_content": "死灵S 发表于 2015-2-27 21:58\n好吧，直接说下要在那个栏打什么脚本吧\n\n额，好\n首先这个是根据你的说明，我做出来的假想BOSS场\n\n\n\n\njava 2015-02-28 13-52-38-601.jpg (120.03 KB, 下载次数: 4)\n\n下载附件\n\n2015-2-28 13:54 上传\n\n\n\n\n\n\n上面一圈岩床围住的是战场，右边岩床质的地板是踢出后会传送的位置\n左边是外部的机关(我懒的做计时器，直接一堆中继器串连计时，考虑到红石火把的延迟所以少放一个中继器)\n\nBOSS场内大概是这样：\n\n\n\n\njava 2015-02-28 13-52-19-579.jpg (109.46 KB, 下载次数: 9)\n\n下载附件\n\n2015-2-28 13:54 上传\n\n\n\n\n\n\n\n我在该BOSS上写了一个脚本，内容：(版本1.7.2的我写在Update栏内模拟，1.??7.10以上的可以直接把命令写在Killed栏内)\n\n\n\n\njava 2015-02-28 13-52-05-935.jpg (66.04 KB, 下载次数: 5)\n\n下载附件\n\n2015-2-28 13:54 上传\n\n\n\n\n\n\n概念是，BOSS被杀死后，会启动外部机关将玩家踢出战场\n而我额外设了一个参数，去纪录命令是否已被执行过，否则当BOSS死亡后会一直启动机关(每0.5秒启动一次)\n所以第一个if是把这个参数重置，好让BOSS死亡后第一时间可以启动机关\n第二个if就是本体，当BOSS死后会启动一次机关\n透过放置红石块的方法启动，红石块放置的坐标就是机关要从哪里启动的坐标\n\n再来是外部机关：\n\n\n\n\njava 2015-02-28 13-52-54-019.jpg (135.13 KB, 下载次数: 9)\n\n下载附件\n\n2015-2-28 13:55 上传\n\n\n\n\n\n\n右下角的位置是红石块放置的地方，底下命令方块内的命令是：/setblock ~ ~1 ~ minecraft:air\n用于将放置后的红石块移除，这样红石块才不会一值占着同一个地方而使机关无法启动第二次\n左上角的就是踢人的命令：/tp @a[1417,4,1053,6] 1406 4 1040\n@a后的参数是命令的搜索座标以及半径(x,y,z,半径)\n在这个范围内的玩家都会被传送到(1406,4,1040)这个地方，也就是上图中的岩床质的地板\n\n这样应该可以了吧?\n"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424780760,
            "txt_content": "\n常规设置里似乎没有设定让NPC死亡时可以送出命令...\n我也找不到NPC是否能死亡时触发外部命令方块的方法\n所以就用脚本魔杖执行好了\n\n首先这是1.7.10版本以上的NPC模组\n你用脚本魔杖打开编辑NPC脚本的介面，然后选这栏：Killed 这里的脚本会在NPC死亡时执行\n所以我写了一条简单的脚本进去..(这个NPCmod的版本是1.7.10c)\n\n\n\n\njavaw 2015-02-24 20-18-38-407.jpg (51.57 KB, 下载次数: 7)\n\n下载附件\n\n2015-2-24 20:19 上传\n\n\n\n\n\n\n当NPC死亡时，会执行这里的脚本。我使用npc物件下的executeCommand()方法让NPC执行命令\n\n不过1.7.2版的NPCmod没有Killed这栏，只有前5个而已，如果你的NPCmod是1.7.2版的，\n你可能要使用Update或者Damaged栏的脚本模拟NPC死亡时触发的事件\n"
        },
        {
            "author": "死灵S",
            "timestamp": 1424790720,
            "txt_content": "平凡的行者 发表于 2015-2-24 20:26\n常规设置里似乎没有设定让NPC死亡时可以送出命令...\n我也找不到NPC是否能死亡时触发外部命令方块的方法\n所 ...\n好吧。有延迟执行都可以的是吧"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424861820,
            "txt_content": "死灵S 发表于 2015-2-24 23:12\n好吧。有延迟执行都可以的是吧\n延迟执行?...你是说哪个东西延迟执行?"
        },
        {
            "author": "死灵S",
            "timestamp": 1424872080,
            "txt_content": "平凡的行者 发表于 2015-2-25 18:57\n延迟执行?...你是说哪个东西延迟执行?\n比如我想做个副本什么的，杀了boss（自己做的NPC）然后给你10秒左右捡掉落物和经验，再传送回副本入口（推出副本）。\n还有上面说的那两个文件能吧地址发给我吗？"
        },
        {
            "author": "死灵S",
            "timestamp": 1424872260,
            "txt_content": "我说的您能懂吗？"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424879220,
            "txt_content": "死灵S 发表于 2015-2-25 21:51\n我说的您能懂吗？\n这当然可以，要做到10秒后将玩家踢出的话，有2种做法：一种是用纯脚本，一种是脚本配合命令方块。\n\n纯脚本的话，你可以放一个NPC使用getSurroundEntities()取得周围的所有实体资料，把玩家过滤出来后修改座标之类的。\n计时的方法也可以只用脚本做到，但稍微麻烦些。\n\n脚本配合命令方块的话，你可以设置一个机关：红石中继器接上一个命令方块，该命令方块可以写入tp命令把玩家踢出\n至于如何触发该机关，你可以就在killed那栏写入npc.executeCommand(\"/setblock 座标minecraft:redstone_block\");\n就是让NPC死亡时在机关触发的位置放一个红石块启动它。\n\n然后脚本是1.7.2版以上NPC模组自带的功能..脚本魔杖的外型是一把铲子，用他开启就好\n至于NPCmod的下载地址...我是原帖党的，所以就给原帖的下载地址吧：http://www.kodevelopment.nl/minecraft/customnpcs/downloads/"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424879700,
            "txt_content": "平凡的行者 发表于 2015-2-25 23:47\n这当然可以，要做到10秒后将玩家踢出的话，有2种做法：一种是用纯脚本，一种是脚本配合命令方块。\n\n纯脚 ...\n阿，打错，是getSurroundingEntities() {:10_494:}"
        },
        {
            "author": "死灵S",
            "timestamp": 1424881020,
            "txt_content": "自定义NPC我早下了，不过只能在NPC死亡时在打开命令方块才可以吗？"
        },
        {
            "author": "死灵S",
            "timestamp": 1424915160,
            "txt_content": "平凡的行者 发表于 2015-2-25 23:47\n这当然可以，要做到10秒后将玩家踢出的话，有2种做法：一种是用纯脚本，一种是脚本配合命令方块。\n\n纯脚 ...\n而且1.7.2的自定义NPC脚本好像没有killed这一项啊\n另外把getSurroundingEntities（）发过来行吗？有图文教程什么的更好，行了的加悬赏和人气"
        },
        {
            "author": "死灵S",
            "timestamp": 1424915340,
            "txt_content": "死灵S 发表于 2015-2-26 09:46\n而且1.7.2的自定义NPC脚本好像没有killed这一项啊\n另外把getSurroundingEntities（）发过来行吗？有图文 ...\n算了，没事，我用Damaged来把，也不知行不行"
        },
        {
            "author": "死灵S",
            "timestamp": 1424915880,
            "txt_content": "另外把那条指令拿来把"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424941620,
            "txt_content": "死灵S 发表于 2015-2-26 00:17\n自定义NPC我早下了，不过只能在NPC死亡时在打开命令方块才可以吗？\n\n你给的例子是死亡后10秒踢出玩家，所以我给的范例就是死亡后10秒踢出玩家\n不过也可以给别的条件，像是NPC复活后踢出玩家也行。"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424942160,
            "txt_content": "死灵S 发表于 2015-2-26 09:49\n算了，没事，我用Damaged来把，也不知行不行\n\n虽然说写在Damaged里也行，但建议不要写在里面\n原因就是容易有BUG\n\n就算NPC挂了，如果你对它丢伤害药水之类的，它实际上还是有接收伤害\n因此Damaged里的脚本也会启动，只是这伤害不会再扣到NPC上罢了\n并且你在Damaged栏里使用event.getDamage()取的的伤害值，是只经过NPC本身的减伤设定后的数值\n不包括NPC身上的抗性药水效果，或什至你用nbtedit强制NPC在原本盔甲装备栏的地方穿上盔甲，或者是gokiStats里玩家的近战或远攻伤害加成，都不算进去\n你如果要用这次伤害是否超过NPC的当前血量来模拟Killed脚本的话，就要当心上面几项类似的情况\n\n建议是用update模拟，使用npc.isAlive()判断NPC是否活着，这样比较这样比较贴近真实情况\n\n"
        },
        {
            "author": "sandstorm",
            "timestamp": 1424942520,
            "txt_content": "很简单，在npc脚下压力板，连接非门，命令方块"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424944560,
            "txt_content": "死灵S 发表于 2015-2-26 09:46\n而且1.7.2的自定义NPC脚本好像没有killed这一项啊\n另外把getSurroundingEntities（）发过来行吗？有图文 ...\n首先这里是NPC模组作者提供的脚本API：http://www.kodevelopment.nl/customnpcs/\ngetSurroundingEntities()是ScriptEntity类里的方法，NPC所属的类别有继承它，所以可以使用。\n\n这是函数的说明：\ngetSurroundingEntitiespublic ScriptEntity[] getSurroundingEntities(int range)Parameters:range - The search range for entities around this entityReturns:Array of entities within range\n下面还有一个可以输入判断实体类型的函数，不过那个1.7.2版的没有，所以要过滤玩家物件资料出来还需要再多一些程序\n\n\n你可以写一个for回圏，针对函数回传的阵列里的所有实体进行型态过滤，像这样：\n\n\n\n\n\njavaw 2015-02-26 17-42-02-166.jpg (55.31 KB, 下载次数: 0)\n\n下载附件\n\n2015-2-26 17:43 上传\n\n\n\n\n\n\n\n\njavaw 2015-02-26 17-42-06-690.jpg (105.87 KB, 下载次数: 0)\n\n下载附件\n\n2015-2-26 17:43 上传\n\n\n\n\n\n\n中间友善阵营的NPC是范例，旁边有骷髅、另一个NPC、村民，还有我\n范例里侦测对象是该NPC半径6以内的实体\n玩家物件在脚本里type的值是1。所以对于type是1的物件，NPC会执行if函式里的npc.say()(这个say可以换成你想要的脚本)\n\n\n以你的例子的话，可以先在脚本里计时，时间到后用这个函式逐一踢出玩家\n踢出玩家的方法，你可以修改玩家的坐标，例如用setPosition(double x ,double y ,double z)\n或者也可以用命令，不过要先取得玩家的名子\n例如npc.executeCommand(\"/tp \" + e.getDisplayName() + \" <座标>\");\n\n\n"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424944800,
            "txt_content": "sandstorm 发表于 2015-2-26 17:22\n很简单，在npc脚下压力板，连接非门，命令方块\n这也行，不过你需要有方法能让NPC传送到BOSS战场\n毕竟你要用非门的话，NPC应该是死后立刻复活\n这个复活点总不能在战场里吧?"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424944860,
            "txt_content": "平凡的行者 发表于 2015-2-26 18:00\n这也行，不过你需要有方法能让NPC传送到BOSS战场\n毕竟你要用非门的话，NPC应该是死后立刻复活\n这个复活点 ...\n阿...说错，应该是说要用压力版"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1424944980,
            "txt_content": "平凡的行者 发表于 2015-2-26 18:01\n阿...说错，应该是说要用压力版\n话说为什么要连接非门?"
        },
        {
            "author": "死灵S",
            "timestamp": 1425045480,
            "txt_content": "平凡的行者 发表于 2015-2-26 17:56\n首先这里是NPC模组作者提供的脚本API：http://www.kodevelopment.nl/customnpcs/\ngetSurroundingEntities ...\n好吧，直接说下要在那个栏打什么脚本吧"
        },
        {
            "author": "死灵S",
            "timestamp": 1425377880,
            "txt_content": "平凡的行者 发表于 2015-2-28 14:12\n额，好\n首先这个是根据你的说明，我做出来的假想BOSS场\n终于懂了，谢了大神希望这里的问题你也能帮下\nNBT\n更多生物的刷怪问题"
        }
    ]
}