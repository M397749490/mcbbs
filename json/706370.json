{
    "title": "大家有没有遇到无法发送title的情况？",
    "author": "鸭蛋只吃黄",
    "replyCount": 4,
    "timestamp": 1500027600,
    "txt_content": "                    this.plugin.addPlayer(playerName, resultSet.getString(1));\n                    player.sendTitle(Messages.login_title, Messages.login_sub, 10, 700, 10);\n                    player.sendMessage(\"233\");复制代码代码如上\n玩家确实会收到233这条信息，但是作为Title的信息却大概有40%左右的几率是收不到的，后台没有任何的报错\n版本时1.12，服务端也是1.12的paperspigot，问一下有没有道友遇到同样的问题？\n233是百分之百能收到的，但是Title却不能\n太好了！MCBBS终于换了显示代码插件了",
    "replies": [
        {
            "author": "星",
            "timestamp": 1500039960,
            "txt_content": "不推荐使用Bukkit自带的sendTitle来发送Title\n推荐使用PL发包来发送 如果不会可以看看梨子的教程:\nhttp://www.mcbbs.net/thread-568714-1-1.html"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1500082980,
            "txt_content": "小星啊啊啊 发表于 2017-7-14 21:46\n不推荐使用Bukkit自带的sendTitle来发送Title\n推荐使用PL发包来发送 如果不会可以看看梨子的教程:\nh ...\n算了，我不发Title了。我还是老老实实用普通的吧"
        },
        {
            "author": "SakuraKooi",
            "timestamp": 1500089940,
            "txt_content": "丢你一个我自己用的TitleUtils\nbukkit的发送title的方法我还真没用过\npackage ldcr.Utils;\n\nimport java.lang.reflect.Constructor;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.entity.Player;\n\npublic class TitleUtils\n{\n        private static final String version = org.bukkit.Bukkit.getServer()\n                        .getClass().getPackage().getName().split(\"\\\\.\")[3];\n\n        private static Class<?> getNMSClass(String name)\n        {\n                try\n                {\n                        return Class\n                                        .forName(\"net.minecraft.server.\" + version + \".\" + name);\n                }\n                catch (ClassNotFoundException e)\n                {\n                        e.printStackTrace();\n                }\n                return null;\n        }\n\n        private static void sendPacket(Player player, Object packet) throws Exception\n        {\n                Object handle = player.getClass().getMethod(\"getHandle\", new Class[0])\n                                .invoke(player, new Object[0]);\n                Object playerConnection = handle.getClass()\n                                .getField(\"playerConnection\").get(handle);\n                playerConnection.getClass()\n                                .getMethod(\"sendPacket\", new Class[] { getNMSClass(\"Packet\")\n                                }).invoke(playerConnection, new Object[] { packet\n                                });\n        }\n\n        public static void sendTitle(Player player, String title, String subtitle, int fadeIn, int stay, int fadeOut) \n        {try\n        {\n                Object enumTitle = getNMSClass(\"PacketPlayOutTitle\")\n                                .getDeclaredClasses()[0].getField(\"TITLE\").get(null);\n                Object titleChat = getNMSClass(\"IChatBaseComponent\")\n                                .getDeclaredClasses()[0]\n                                .getMethod(\"a\", new Class[] { String.class\n                                }).invoke(null, new Object[] { \"{\"text\":\"\" + title + \"\"}\"\n                                });\n                Object enumSubtitle = getNMSClass(\"PacketPlayOutTitle\")\n                                .getDeclaredClasses()[0].getField(\"SUBTITLE\").get(null);\n                Object subtitleChat = getNMSClass(\"IChatBaseComponent\")\n                                .getDeclaredClasses()[0]\n                                .getMethod(\"a\", new Class[] { String.class\n                                })\n                                .invoke(null, new Object[] { \"{\"text\":\"\" + subtitle + \"\"}\"\n                                });\n                Constructor<?> titleConstructor = getNMSClass(\"PacketPlayOutTitle\")\n                                .getConstructor(new Class[] {\n                                                getNMSClass(\"PacketPlayOutTitle\").getDeclaredClasses()[0],\n                                                getNMSClass(\"IChatBaseComponent\"),\n                                                Integer.TYPE,\n                                                Integer.TYPE,\n                                                Integer.TYPE\n                                });\n                Object titlePacket = titleConstructor.newInstance(new Object[] {\n                                enumTitle,\n                                titleChat,\n                                Integer.valueOf(fadeIn),\n                                Integer.valueOf(stay),\n                                Integer.valueOf(fadeOut)\n                });\n                Object subtitlePacket = titleConstructor.newInstance(new Object[] {\n                                enumSubtitle,\n                                subtitleChat,\n                                Integer.valueOf(fadeIn),\n                                Integer.valueOf(stay),\n                                Integer.valueOf(fadeOut)\n                });\n                sendPacket(player, titlePacket);\n                sendPacket(player, subtitlePacket);\n                }\n                catch(Exception e)\n                {e.printStackTrace();}\n        }\n\n        public static void boardcastTitle(String title, String subtitle, int fadeIn, int stay, int fadeOut)\n        {\n                for (Player p : Bukkit.getOnlinePlayers())\n                {\n                        try\n                        {\n                                sendTitle(p, title, subtitle, fadeIn, stay, fadeOut);\n                        }\n                        catch (Exception e)\n                        {\n                                e.printStackTrace();\n                        }\n                }\n        }\n}复制代码\n\n\n"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1500096780,
            "txt_content": "wujinze 发表于 2017-7-15 11:39\n丢你一个我自己用的TitleUtils\nbukkit的发送title的方法我还真没用过\n是啊，以前我也这么发，自从用了1.9以后就看见有现成的方法了，再就没用了...= =额...还有你签名档那个好像不大准啊，我是山东人，都给我定黑龙江去了...\n"
        }
    ]
}