{
    "title": "如何确定两个坐标之间有没有方块",
    "author": "轻光233",
    "replyCount": 9,
    "timestamp": 1549168200,
    "txt_content": "如题，求dalao帮助",
    "replies": [
        {
            "author": "RainIFunS",
            "timestamp": 1549255920,
            "txt_content": "最笨的办法： 用for循环一个一个判断"
        },
        {
            "author": "Hanssc",
            "timestamp": 1549539240,
            "txt_content": "1.获取一条线上所有Location\npublic List<Location> getLinePoints(Location start, Location end, int amount) {\n        List<Location> points = new ArrayList();\n        double k = start.getX();\n        double j = start.getY();\n        double n = start.getZ();\n        double l = end.getX() - k;\n        double h = end.getY() - j;\n        double w = end.getZ() - n;\n        double f1 = l / amount;\n        double f2 = h / amount;\n        double f3 = w / amount;\n        for (int i = 0; i < amount; i++) {\n            points.add(new Location(start.getWorld(), k + f1 * i, j + f2 * i, n + f3 * i));\n        }\n        return points;\n    }复制代码\n2.判断所有位置是否均为空气\npublic boolean check(Location start, Location end, int amount) {\n        final List<Location> location = getLinePoints(start, end, amount);\n        for (Location l : location) {\n            if (l.getBlock().getType() != Material.AIR) {\n                return false;\n            }\n        }\n        return true;\n    }复制代码"
        },
        {
            "author": "hnOsmium0001",
            "timestamp": 1549698480,
            "txt_content": "rayTrace, 对比结果坐标"
        },
        {
            "author": "davidmaamoaix",
            "timestamp": 1550132220,
            "txt_content": " 本帖最后由 davidmaamoaix 于 2019-2-14 16:19 编辑 \n\n不用遍历，直接RayTrace"
        },
        {
            "author": "davidmaamoaix",
            "timestamp": 1550137800,
            "txt_content": " 本帖最后由 davidmaamoaix 于 2019-2-14 18:11 编辑 \n\nRayTrace通俗来讲就是从一个点出发画一条线，并检测这条线是否碰到任何方块。比如楼主想判断方块A与方块B之间是否有方块：\n\n\n\n\nRayTrace.png (37.39 KB, 下载次数: 0)\n\n下载附件\n\n2019-2-14 17:46 上传\n\n\n\n\n\n\n判断的方式为从方块A出发向方块B画一条线，可以理解为从方块A向方块B射出一道光。假如方块A和方块B之间没有任何东西阻挡，那么这道光就会射到方块B上。所以我们只用判断这道光是否射到了方块B上；假如射到了方块B上，则两个方块之间没有其他方块；假如没有射到了方块B上，则有其他方块。\n\n\n\n\n\nRayTrace2.png (70.63 KB, 下载次数: 0)\n\n下载附件\n\n2019-2-14 17:50 上传\n\n\n\n\n\n代码实现起来比较简单，如下：// 假如两点之间有方块则返回true。\n// 两点之间没有方块则返回false。\npublic static boolean doesBlockExistsBetween(World world, BlockPos a, BlockPos b) {\n        \n        // 从方块A射出一道光。\n        RayTraceResult rayTraceResult = world.rayTraceBlocks(new Vec3d(a), new Vec3d(b));\n        \n        // 检测“光”是否被射到了方块B上。\n        boolean rayOnBlockB = rayTraceResult.getBlockPos().equals(b);\n        \n        // 返回（注意感叹号，返回的值为“光线射到方块B”的相反值）。\n        // 如果光被射到了方块B上（则两点之间没有方块）则返回false。\n        // 如果光没有被射到了方块B上（则两点之间有方块）则返回true。\n        return !rayOnBlockB;\n}复制代码\nRayTrace相对于直接遍历的优点有：- 速度快（距离越大越明显）- 精确度高\n- 更灵活（稍微改下可以判断实体）\n- 代码简洁"
        },
        {
            "author": "轻光233",
            "timestamp": 1561965540,
            "txt_content": "davidmaamoaix 发表于 2019-2-14 17:50\nRayTrace通俗来讲就是从一个点出发画一条线，并检测这条线是否碰到任何方块。比如楼主想判断方块A与方块B之 ...\n时隔5个月之后再来回复\n这里的World，BlockPos，Vec3d，RayTraceResult是否为nms包里的类\n我并没有在nms包和bukkit api里找到RayTraceResult类\n而且World里只有rayTrace方法，并且返回值是一个类型为MovingObjectPosition的对象\n并且里面除了Object类继承下来的方法之外就只有a()方法，返回值永远和参数里的a一模一样\n本人用的spigot-1.8作为api，请dalao解答下上面的问题，谢谢了"
        },
        {
            "author": "hemp",
            "timestamp": 1561968420,
            "txt_content": "轻光233 发表于 2019-7-1 15:19\n时隔5个月之后再来回复\n这里的World，BlockPos，Vec3d，RayTraceResult是否为nms包里的类\n我并没有在nms ...\n我猜他说的应该是在forge中的实现。\n不过spigot中应该也可以实现。\n相关链接:https://hub.spigotmc.org/javadoc ... function.Predicate-\n\n(来自一个正在电脑前写作业的吃瓜群众的回复)"
        },
        {
            "author": "轻光233",
            "timestamp": 1561968840,
            "txt_content": "hemp 发表于 2019-7-1 16:07\n我猜他说的应该是在forge中的实现。\n不过spigot中应该也可以实现。\n相关链接:https://hub.spigotmc.org/j ...\n写作业可还行2333\nbut，我用的是1.8的api\nWorld里并没有rayTrace方法，RayTraceResult类也没有找到\n还有什么其他的方法吗qwq"
        },
        {
            "author": "hemp",
            "timestamp": 1561969740,
            "txt_content": "轻光233 发表于 2019-7-1 16:14\n写作业可还行2333\nbut，我用的是1.8的api\nWorld里并没有rayTrace方法，RayTraceResult类也没有找到\n旧版本的话,估计只能通过遍历来实现了。"
        }
    ]
}