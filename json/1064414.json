{
    "title": "[NSS][1.7.10][原创]强化附魔等级",
    "author": "517190058",
    "replyCount": 9,
    "timestamp": 1592628540,
    "txt_content": " 本帖最后由 517190058 于 2020-7-5 09:12 编辑 \n\n 白嫖了那么久的mcbbs，今天终于轮到自己出一份力了。。\n 在我还是小白的时候，就总是找不到能够强化附魔等级的插件mod之类的。所以我就特意写了一份能够高度自定义强化附魔等级的脚本。\n\n前置：CustomNPCmod/bukkit服务端\n版本：1.7.10/（1.12.2需要自行补充完善脚本）\n用法：将代码放进npc钩子里就行，更具体的可以去看npc脚本教程\n下面上脚本代码\n/*食用准备：可以通过对话钩子设置player.getHeldItem().setTag(\"itensify\",\"damage\")的方法。\n通过拿着手上的物品右键npc来为你选定的强化石物品进行标记。\nps:除\"damage\"外还有\"durability\"和\"thorns\"两种默认类型;\n  食用方法：可以把该脚本放在对话钩子；然后手拿你要强化的物品，右键npc即可（背包要有标记了的强化石）\n  Time:2020.6.20\n  author:Coolla\n  */\n\nif(player.getHeldItem()!==null){\nvar success =100;//基础成功率设置\nvar maxlvl=200;//最大等级限制\nvar searchitem=player.getInventory();\n\nvar itemid=search(searchitem);\nif(itemid!==-1){\nvar tickets=identify(searchitem[itemid]);//判断强化石类型\nif(tickets!==0){\nvar enchment= Java.type(\"org.bukkit.enchantments.Enchantment\");\nswitch (tickets){//三种附魔类型\ncase 1:var ench=enchment.DAMAGE_ALL;break;\ncase 2:var ench=enchment.DURABILITY;break;\ncase 3:var ench=enchment.THORNS;break;\n};\n\nvar bukkit =Java.type(\"org.bukkit.Bukkit\");\nvar playerName = player.getName();\nvar playerB=bukkit.getPlayer(playerName);\nvar hand=playerB.getItemInHand();\n\nsuccess=matchlvl(hand,ench,maxlvl);//检查附魔的等级\nif(success>0){\nremove(searchitem,itemid);\n\nlevelup(hand,ench,success);//强化附魔\n}else npc.say(\"你已经超过附魔等级限制\")}\n}else npc.say(\"你没有强化石\");\n}else npc.say(\"请把需要强化的东西放在手上\");\n\nfunction search (itemlist){//寻找强化石\nfor(var i=0;i<36;i++){\nif(itemlist[i]!==null){\n         if(itemlist[i].hasTag(\"itensify\")==true)return i;\n}}return -1}\n\n\nfunction identify(matchitem){//鉴别附魔强化石\n         var name=matchitem.getTag(\"itensify\");\nswitch(name){\ncase \"damage\":var id =1;break;\ncase \"durability\":var id =2;break;\ncase \"thorns\":var id =3;break;\n};return id\n}\n\nfunction matchlvl(hand,ench,maxlvl){//检查附魔的等级\nvar lvl=hand.getEnchantmentLevel(ench);\nvar i=0;\nif(lvl>=maxlvl)return 0;\nif(lvl>=0)i=100;\nif(lvl>10)i= 90;\nif(lvl>20)i=80;\nif(lvl>50)i=50;\nif(lvl>100)i=40;//强化几率\nreturn i;\n}\n\nfunction levelup (item,ench,success){//强化方法\nvar random=parseInt(Math.random()*100+1);\nif(random<success){\nvar lvl=1+item.getEnchantmentLevel(ench);\nitem.addUnsafeEnchantment(ench,lvl);\nnpc.say(\"&6恭喜你，强化成功\");}\nelse {npc.say(\"很遗憾，强化失败\");}\n}\n\nfunction remove(matchitem,i)//移除强化石方法\n         {var num=matchitem[i].getStackSize();\n                if(num==1){\nplayer.getMCEntity().field_71071_by.field_70462_a[i]=null;\nplayer.sendMessage(\"&6&l★★已消耗强化石*1★★\");\n}else{\n                num-=1;\n               matchitem[i].setStackSize(num);\n               player.sendMessage(\"&6&l★★已消耗强化石*1★★\");\n               }}\n\n复制代码\n其他东西注释里应该都写得很清楚啦，\n谢谢大家，本新第一次发帖，开心",
    "replies": [
        {
            "author": "Twilight_Two",
            "timestamp": 1593525720,
            "txt_content": "难道这就是插件的末日（幻想"
        },
        {
            "author": "13610508481",
            "timestamp": 1594116660,
            "txt_content": "谢谢楼主的资料"
        },
        {
            "author": "小樱aaa",
            "timestamp": 1594597860,
            "txt_content": "这难道就是我上次玩的坑爹RPG机制么，30几率我强化了20次"
        },
        {
            "author": "qq1355754011",
            "timestamp": 1609756200,
            "txt_content": "谢谢大佬分享的资料"
        },
        {
            "author": "XiyangLi",
            "timestamp": 1610251980,
            "txt_content": " 小小支持一下"
        },
        {
            "author": "kuran2728",
            "timestamp": 1610361180,
            "txt_content": "\n可以说是很用力了！楼主加油~~~"
        },
        {
            "author": "Ai_shen12134",
            "timestamp": 1611227580,
            "txt_content": "\n可以说是很用力了！楼主加油~~~"
        },
        {
            "author": "尖椒炒蛋",
            "timestamp": 1611295020,
            "txt_content": "谢谢大佬分享"
        },
        {
            "author": "秦羽",
            "timestamp": 1611556020,
            "txt_content": "支持一下!!"
        }
    ]
}