{
    "title": "[Tutorial][Bukkit][UD]如何给实体增加NBT数据",
    "author": "602723113",
    "replyCount": 7,
    "timestamp": 1524977700,
    "txt_content": " 本帖最后由 602723113 于 2018-12-15 19:34 编辑 \n\n\n 如何给你的实体增加NBT数据 目录:\n导读代码示例\n\n 导读 本教程使用的是 Spigot1.10.2-R0.1-SNAPSHOT 核心 \n在阅读之前请确保你具有Java基础知识\n\n在上次的NBT教程中，我们是对物品的NBT进行的操作，那么实体可不可以操作它的NBT呢？答案是可以的\n\n跟物品不同的是，你可以直接通过BukkitAPI操作实体的NBT，而不是通过NMS来进行操作\n\n在BukkitAPI中，这个包就是为我们的实体的NBT进行的操作的包\n\norg.bukkit.attribute\n特别感谢ChineseBukkitAPI汉化组\n此包提供了开发者对实体进行的NBT操作，但此包不能用于物品！\n代码示例 既然我们是对一个实体进行修改NBT的操作，那么我们就需要先有一个LivingEntity的实例Player player = (Player) sender;\nZombie zombie = (Zombie) player.getWorld().spawnEntity(player.getLocation(), EntityType.ZOMBIE);\n复制代码在上方的代码中我们生成了一个僵尸，它是LivingEntity的一个子接口，然后我们获取其NBTAttributeInstance healthInstance = zombie.getAttribute(Attribute.GENERIC_MAX_HEALTH);\n复制代码\n在上方的代码中，我们调用了zombie.getAttribute()方法，里面需要填入一个Attribute枚举的示例，这里我们用最大生命值做演示\n之后我们给这个僵尸增加一个AttributeModifier修改它的最大生命值healthInstance.addModifier(new AttributeModifier(\"最大生命值\", 20D, AttributeModifier.Operation.ADD_NUMBER));\n复制代码上面的内容有点多，我们来一一介绍\n我们调用的AttributeInstance类下的一个方法addModifier，里面需要填入的是一个AttributeModifier的示例，那么我们可以通过实例化就可以\n\n之后我们再来看实例化的这些操作\nAttributeModifier有两个构造方法可以供我们使用它们分别是AttributeModifier(String name, double amount, AttributeModifier.Operation operation)\nAttributeModifier(UUID uuid, String name, double amount, AttributeModifier.Operation operation)复制代码我们通过上方的两个构造方法可以发现两者只是一个UUID的不同，我们翻其实现可以发现，\nUUID\n没有UUID的构造方**自动给我们生成一个UUID，这个UUID用于AttributeModifier的区分，既然我们这里只修改了一个属性，所以我们直接使用上者即可name\n这里的name是AttributeModifier只要和其他的AttributeModifier不重复即可amount\namount\n此处的amount是修改的数值\noperation\noperation用于表示当前AttributeModifier的数值是以什么进行作用\nADD_NUMBER (增加数值#会受到正负值的影响)ADD_SCALAR (增加数值#不会受到正负值的影响，表示为标量)MULTIPLY_SCALAR_1 (基值 * (该数值+1))   在将基值加1之后乘以该数值)\n注释: \n基值: 此Attribute的基础值，如最大生命值，默认为20，20就是这里的基值\n\n然后我们通过打印实体的最大血量进行观察\n完整代码:Player player = (Player) sender;\nZombie zombie = (Zombie) player.getWorld().spawnEntity(player.getLocation(), EntityType.ZOMBIE);\nplayer.sendMessage(\"[修改前]生命值: \" + zombie.getMaxHealth());\n\nAttributeInstance healthInstance = zombie.getAttribute(Attribute.GENERIC_MAX_HEALTH);\nhealthInstance.addModifier(new AttributeModifier(\"最大生命值\", 20D, AttributeModifier.Operation.ADD_NUMBER));\nplayer.sendMessage(\"[修改后]生命值: \" + zombie.getMaxHealth());复制代码测试结果：\n\n\n通过上图，我们可以发现，我们已经成功修改了zombie实体的最大生命值\n\n那么这里就会有人说\n呆瓜：为什么不用setMaxHealth()呢？\n\n为什么不用呢？首先这样的操作比较装逼，除此之外我们还可以修改NBT的其他Attribute属性\n你可以在这里找到所有可用(不同版本，此枚举会有些不同)的Attribute\n\nAttribute\n再吹一波ChineseBukkitAPI\n通过查阅上方的doc，我们就可以看到有很多很多的Attribute可以修改\n比如说GENERIC_ARMOR (护甲值) -> 可以不用给实体穿戴护甲而增加其护甲值了GENERIC_ATTACK_DAMAGE (当生物攻击其他人时所造成的伤害) -> 就可以不用给实体穿戴佩剑来增加其伤害了\n诸如此类的操作...这里我就不再多说了\n\n\n\n[groupid=1181]Unknown Domain[/groupid]",
    "replies": [
        {
            "author": "隔壁老吕",
            "timestamp": 1525266900,
            "txt_content": "莫老，有没有获取NBT数据的方法"
        },
        {
            "author": "a1016746326",
            "timestamp": 1533215940,
            "txt_content": "莫老 模组中的一些怪物或者实体,往往会有原版没有的Attribute,这些nbt属性可以通过bukkit修改吗"
        },
        {
            "author": "2280761425",
            "timestamp": 1533305400,
            "txt_content": "很好奇两个AttributeModifier的uuid一样会发生什么，测试是时候是什么都没发生，应该没这么简单吧QWQ"
        },
        {
            "author": "Ariy",
            "timestamp": 1544510640,
            "txt_content": "莫老，这句话似乎有一些问题\nMULTIPLY_SCALAR_1 (在将基值加1之后乘以该数值)\n英文doc里面是这样写的\nMultiply amount by this value, after adding 1 to it.\n实际测试伤害结果是基值*（该数值+1），而不是（基值+1）*该数值"
        },
        {
            "author": "1609089074",
            "timestamp": 1549271280,
            "txt_content": "有点不太理解healthInstance.addModifier这个方法是类似List.add还是说只是修饰符modifier的setter？\n\n比如这里只调用了一次\nhealthInstance.addModifier(new AttributeModifier(\"最大生命值\", 20D, AttributeModifier.Operation.ADD_NUMBER));复制代码\n那如果多次调用\nhealthInstance.addModifier(new AttributeModifier(\"最大生命值\", 20D, AttributeModifier.Operation.ADD_NUMBER));\nhealthInstance.addModifier(new AttributeModifier(\"最大生命值1\", 5D, AttributeModifier.Operation.ADD_NUMBER));\nhealthInstance.addModifier(new AttributeModifier(\"最大生命值2\", 10D, AttributeModifier.Operation.ADD_NUMBER));复制代码\n他是会每次都覆盖掉之前的吗？\n还是每个都代入基值运算(如果是这样的话运算顺序又怎么整)？"
        },
        {
            "author": "chasing6",
            "timestamp": 1584074160,
            "txt_content": "奈何本人没文化一句牛逼走天下奈何本人没文化一句牛逼走天下"
        },
        {
            "author": "1373733703ld",
            "timestamp": 1612864260,
            "txt_content": "111111111111"
        }
    ]
}