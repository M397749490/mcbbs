{
    "title": "[原创]利用mcpe-ping获取mcbe(pe)服务器状态",
    "author": "iVampireSP",
    "replyCount": 3,
    "timestamp": 1561474980,
    "txt_content": " 本帖最后由 iVampireSP 于 2019-6-25 23:18 编辑 \n\n这是来自我本人博客的一篇文章，然后自己转载到mcbbs（因为我博客没啥人气）。不知道位置有没有发对哈。\n纯JSON版\n因*腐竹的请求，所以CodeHz给了个查询MCBE的接口（不知道是不是他做的）。全名叫mcpe-ping GitHub上有个，估计是CodeHz二开的，原项目：mcpe-ping同样，先嫖一台服务器，并用最快的速度部署。我用Ubuntu做演示，Debian的apt里没npm包（可能是我操作失误） ，下面是CodeHz大大给的接口。\n下载地址：点我下载 https://media.sakurapuare.tech/2019/06/1560946758-mping.zip\n第一步，登录到服务器并su，更新软件源（废话） \napt update复制代码\n接着，部署nodejs环境把mping.zip解压到你喜欢的位置，然后cd进去搞事情\napt install nodejs npm -y\nnpm install n -g\nn stable -g\n复制代码然后cd到mping的目录，确保是解压后的，有两个文件，分别是main.js和package.json，使用下面命令安装依赖。\nnpm install --production复制代码然后执行下面命令启动。\nscreen nodejs main.js复制代码然后浏览器输入http://IP:1234/要查看的mcbe服务器ip/端口 如果打不开，请行通1234端口，端口可以到main.js最后一行更改。然而根据我的习惯，在纯服务器系统上，肯定要改成80。但是为了下面步骤，我还是选择了1234\n[backcolor=rgba(255, 255, 255, 0.8)]修改端口\n\n例如lbsg的，我们只要在你的浏览器网址栏输入 http://xxxx:1234/ping/sg.lbsg.net/19132\n然后你会惊喜的发现查出来了但是有个问题，为什么是json格式？因为，，脚本就这样的。你可以使用json阅读器或者把json转成JavaScript对象输出在网页上，或者用酷Q Httpapi插件来显示json。对于这些，，我也不会 \n不过，这里有个 json在线视图查看器 如果你开发出来了显示json对象的工具，别忘开源哈。好东西要分享嘛。一定要告诉我~ \nJSON+明文输出版\n因*腐竹的再次要求，CodeHz重写了一遍代码，不仅保留了json格式，在新加了直接以文本型式输出的功能。注意，需要重新npm install --production !!\nmping第二版：https://media.sakurapuare.tech/2019/06/1561092443-mping-2.zip\n\n\n\n\nimage.png (205.78 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:35 上传\n\n\n\n\n使用方法 name currentPlayers maxPlayers\n\n\n\n\nimage.png (103.85 KB, 下载次数: 1)\n\n下载附件\n\n2019-6-25 22:35 上传\n\n\n\n\n\n[backcolor=rgba(255, 255, 255, 0.8)]如果想要显示json格式，那么只要把网址端口后面的去掉就行。\n\n\n\n\nimage.png (107.63 KB, 下载次数: 1)\n\n下载附件\n\n2019-6-25 22:36 上传\n\n\n\n\n\n不过，这里遇到个问题：如果是https的网页嵌套一个IP，那iframe岂不是会被chrome拦截？如果url自动重写为https那么直接拒绝访问，这咋办呢？这时候，就要看万能的反向代理了，我选则宝塔，因为申请ssl很方便，配置起来也很简单（就是懒，少走弯路）。编译安装nginx（推荐）签发ssl证书，没备案的用dns验证\n\n\n\n\nimage.png (52.96 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:36 上传\n\n\n\n\n\nmping 自带ui+隐藏IP版\n没错，因为*腐竹的再再再次要求，CodeHz大大又又又开发了一个版本，并且开源啦（好像我擅自放源码了），仓库地址：GitHub \n为他Star吧！ \n使用方法：git项目，然后重新npm install 然后再nodejs main.js如果是安装了宝塔的ubuntu18.04的话，你会发现：npm没了！这是为什么呢，因为他和宝塔安装的软件包起冲突了。有libssl啥的，反正我没管它，强制安装！\n (推荐你们不要这么干，就算干了出事也别找我)\n\n[backcolor=rgba(255, 255, 255, 0.8)]上述命令如下\ngit clone https://github.com/codehz/mcpe-ping-dashboard\ncd mcpe-ping-dashboard\napt install npm -y //慎重\nnpm install\n复制代码[backcolor=rgba(255, 255, 255, 0.8)]然后呢？看看效果图\n\n\n\n\n\nimage.png (118.62 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:38 上传\n\n\n\n\n实例效果图（https动态标题可用，只是chrome报不安全而已，http正常，解决方法看下面）\n[backcolor=rgba(255, 255, 255, 0.8)]CodeHz给的教程：[backcolor=rgba(255, 255, 255, 0.8)]配置文件内容大概这样：[\n  {\n    \"src\": \"nether games\",\n    \"logo\": \"https://minecraftpocket-servers.com/server/36864/banner-36864-1492604878.png\",\n    \"host\": \"play.nethergames.org\",\n    \"port\": 19132\n  },\n  {\n    \"src\": \"Hangout\",\n    \"logo\": \"https://minecraftpocket-servers.com/server/82568/banner-82568-1557693365.gif\",\n    \"host\": \"play.hangout.pe\",\n    \"port\": 19132\n  }\n]复制代码CodeHz ?, [2019/6/21 下午8:02]\nsrc其实是标题（\n\nCodeHz ?, [2019/6/21 下午8:02]\n因为有些时候motd不是名字（还有加载失败的情况（\n\nCodeHz ?, [2019/6/21 下午7:59]\n用法\n\nCodeHz ?, [2019/6/21 下午7:59]\n改config/example.json (或者自己新建一个）\n\nCodeHz ?, [2019/6/21 下午7:59]\n然后安装（npm install）运行后，访问 /servers/example\n[backcolor=rgba(255, 255, 255, 0.8)]附加（废话）：logo是图片文件url ， host是服务器IP ， port是服务器端口[backcolor=rgba(255, 255, 255, 0.8)]其实吧，这个不能算真正的隐藏IP，毕竟暴露了查询服务器的IP，除非用cf反向代理下。但是这样总比iframe好。附：用MD或MDUI的卡片写更好看。自动刷新<meta http-equiv=\"refresh\" content=\"5\"> //5是秒数复制代码\n\n\n\n\nimage.png (5.04 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:40 上传\n\n\n\n\n\n解决https报不安全\n到mping目录下的view文件夹里，编辑里面唯一的一个文件，把里面的所有http改成https\napache反向代理\n是的，你没看错，是阿帕奇，不是EngineX。为什么呢？因为我不会EngineX。是这样的，那位腐竹不小心重装了系统，所以又要重新配置了。这次不用宝塔，用apache2\n注意，请确保系统环境是纯净的，否则请不要使用本步骤！\n安装阿帕奇，启用反向代理，ssl模组，启用ssl站点。编辑ssl站点\nsudo apt install apache2 -y\nsudo a2enmod proxy proxy_ajp proxy_balancer proxy_connect proxy_express proxy_fcgi proxy_fdpass proxy_ftp proxy_hcheck proxy_html proxy_http proxy_http2 proxy_scgi proxy_wstunnel ssl\nsudo a2ensite default-ssl.conf\nsudo vim /etc/apache2/site-enabled/default-ssl.conf\n复制代码把[backcolor=rgba(255, 255, 255, 0.8)]<VirtualHost _DEFAULT:443>(好像是这个)中的_DEFALUT改成*，在下面插入这个下面的代码\nServerName 你的域名\n        <Proxy *>\n                Order deny,allow\n                Allow from all\n        </Proxy>\n        <Location />\n          ProxyPass http://localhost:1234/\n          ProxyPassReverse http://localhost:1234/复制代码http://localhost:1234/ 是反向代理的域名和目录。改成你自己的。 \n 接着往下翻，找到类似下面代码，把pem和key目录输入为自己的，例子如下：\nSSLCertificateFile      /home/ssl/123.pem\n            SSLCertificateKeyFile /home/ssl/123.key复制代码[backcolor=rgba(255, 255, 255, 0.8)]最后，重启apache2。\nsystemctl restart apache2复制代码[backcolor=rgba(255, 255, 255, 0.8)]体验吧！\n\n附：哈勃分析\n\n\n\n\n\nimage.png (165.74 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:53 上传\n\n\n\n\n\n\n\n\nimage.png (178.36 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 22:54 上传\n\n\n\n\n\n\n\n\nimage.png (170.56 KB, 下载次数: 0)\n\n下载附件\n\n2019-6-25 23:02 上传\n\n\n\n\n\n\n[backcolor=rgba(255, 255, 255, 0.8)]我的博客：iVampireSPの物语 原文地址：点击进入 自己转载自己的当然还是原创啦~\n\n\n",
    "replies": [
        {
            "author": "貔貅I勿念",
            "timestamp": 1562037000,
            "txt_content": "这样的好东西必须要支持一波"
        },
        {
            "author": "iVampireSP",
            "timestamp": 1562160480,
            "txt_content": "貔貅I勿念 发表于 2019-7-2 11:10\n这样的好东西必须要支持一波\n感谢支持"
        },
        {
            "author": "QAQexe",
            "timestamp": 1565855580,
            "txt_content": "顶一下，支持"
        }
    ]
}