{
    "title": "插件中使用saveConfig后，config.yml内容被转换为unicode码的解决方法",
    "author": "ddyy163",
    "replyCount": 0,
    "timestamp": 1502504580,
    "txt_content": " 本帖最后由 ddyy163 于 2017-10-20 18:03 编辑 \n\n做为一个新手写的东西，果然还是不太靠谱！这里是老方法，新方法在下面 送给各位跟我一样刚开始写插件的新手：\n      大家在往config中配置中文的时候，例如公告内容，前缀名称等等，发现在插件的saveConfig()后，中文的内容往往会变成以\"\\u\"开头的unicode码，例如\"\\u5317\"\n      虽然这实际上不影响插件读取后的正常显示，但是非常的令人不爽是吧？有时候进config想修改一下现有的文本内容，却发现要把整条文本重新修改。\n      废话结束，下面放出转码的代码吧。（大佬看看就好）(这段代码之前有个小bug,会造成文件的开头多出\"null\"字段，现已修复)\n  public void recodingCfg() {\n                File file = new File(plugin.getDataFolder(), \"config.yml\");\n                try {\n                        \n                        //用bufferReader读取config.yml的UTF-8格式的文本内容\n                        InputStreamReader isr = new InputStreamReader(new FileInputStream(\n                                        file), \"UTF-8\");\n                        BufferedReader bufferedReader = new BufferedReader(isr);\n                        String temp;\n                        String s = null;\n                        while ((temp = bufferedReader.readLine()) != null) {\n                                s = s + temp + \"\\r\\n\";\n                        }\n                        isr.close();\n                        bufferedReader.close();\n                        \n                        \n                        //将中文和§符号反转码\n                        if(s.startsWith(\"null\")){\n                                s = s.replaceAll(\"null\", \"\");\n                        }\n                        s = s.replaceAll(\"xa7\", \"§\");\n                        s = StringEscapeUtils.unescapeJava(s);\n                        \n                        //最后将文本重新写入config.yml\n                        OutputStreamWriter osw = new OutputStreamWriter(new FileOutputStream(file),\"GBK\");\n                        BufferedWriter bw = new BufferedWriter(osw);\n                        bw.write(s);\n                        bw.flush();\n                        bw.close();\n                        \n                } catch (IOException e) {\n                        \n                        e.printStackTrace();\n                }\n        }复制代码 新方法：重写bukkit的YamlConfigration，所有版本的配置文件都统一成UTF-8的格式！灵感来自论坛,源码在此\n\n\n\nSUNConfiguration.txt\n(4.54 KB, 下载次数: 13)\n\n\n\n2017-10-20 18:03 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n",
    "replies": []
}