{
    "title": "[进阶]如何编写一个Slimefun附属插件-2",
    "author": "Freeze_Dolphin",
    "replyCount": 8,
    "timestamp": 1582517040,
    "txt_content": " 本帖最后由 Freeze_Dolphin 于 2020-2-24 14:19 编辑 \n\n此文章使用spigot-1.12.2为核心进行开发演示如果你没有基础的话，建议先看此文章：教程1\n阅读本教程可以学会：为自己的物品添加用途不同物品（自定义合金锭、果汁、带有药水效果的装甲）的添加方法\n\n\n正式开始\n添加用途SlimefunItem的注册方法（.register();），是有多个参数的，我们可以在里面增加事件监听这里我们将为教程1中的魔力绿宝石添加“右键给予自己一级经验并消耗”的用途SlimefunItem sfi = new SlimefunItem(\n                                c, \n                                Demo.MAGICAL_EMERALD, \n                                \"MAGICAL_EMERALD\", \n                                RecipeType.ENHANCED_CRAFTING_TABLE, \n                                new ItemStack[] \n                                                {\n                                                Demo.mat(Material.EXP_BOTTLE), Demo.mat(Material.EMERALD), Demo.mat(Material.EXP_BOTTLE), \n                                                Demo.mat(Material.EMERALD), Demo.mat(Material.EXP_BOTTLE), Demo.mat(Material.EMERALD), \n                                                Demo.mat(Material.EXP_BOTTLE), Demo.mat(Material.EMERALD), Demo.mat(Material.EXP_BOTTLE)\n                                                });\n                \n                sfi.register(false);复制代码这是教程1中我们写的魔力绿宝石为其添加ItemInteractionHandler（相当于PlayerInteractEvent）sfi.register(false, new ItemInteractionHandler() \n                {\n\n                        @Override\n                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                // TODO Auto-generated method stub\n                                return false;\n                        }\n                \n                }\n                                );复制代码在里面写我们想要的功能@Override\n                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                if (!SlimefunManager.isItemSimiliar(item, p.getInventory().getItemInMainHand(), true)) return true;\n                                item.setAmount(item.getAmount() - 1);\n                                p.giveExpLevels(1);\n                                return false;\n                        }复制代码（这里返回的boolean值代表这个PlayerInteractEvent是否会被cancelled）\n\n一个SlimefunItem可以拥有多个ItemHandler所有继承了ItemHandler的类都可以在包 \"me.mrCookieSlime.Slimefun.Objects.SlimefunItem.handlers\" 里找到\n可以用英文逗号将多个ItemHandler隔开\n这里为魔力绿宝石使用时添加了粒子效果\nsfi.register(false, new ItemInteractionHandler() \n                {\n\n                        @Override\n                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                if (!SlimefunManager.isItemSimiliar(item, p.getInventory().getItemInMainHand(), true)) return true;\n                                item.setAmount(item.getAmount() - 1);\n                                p.giveExpLevels(1);\n                                return false;\n                        }\n\n                },\n                new ItemInteractionHandler() \n                {\n\n                        @Override\n                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                if (!SlimefunManager.isItemSimiliar(item, p.getInventory().getItemInMainHand(), true)) return true;\n                                try {\n                                        ParticleEffect.SLIME.display(p.getEyeLocation(), 0F, 0F, 0F, 0.8F, 5);\n                                } catch (Exception ex) { ex.printStackTrace(); }\n                                return false;\n                        }\n\n                }\n                                );复制代码也可以使用数组sfi.register(false, new ItemHandler[] {\n                                new ItemInteractionHandler() \n                                {\n\n                                        @Override\n                                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                                if (!SlimefunManager.isItemSimiliar(item, p.getInventory().getItemInMainHand(), true)) return true;\n                                                item.setAmount(item.getAmount() - 1);\n                                                p.giveExpLevels(1);\n                                                return false;\n                                        }\n\n                                },\n                                new ItemInteractionHandler() \n                                {\n\n                                        @Override\n                                        public boolean onRightClick(ItemUseEvent e, Player p, ItemStack item) {\n                                                if (!SlimefunManager.isItemSimiliar(item, p.getInventory().getItemInMainHand(), true)) return true;\n                                                try {\n                                                        ParticleEffect.SLIME.display(p.getEyeLocation(), 0F, 0F, 0F, 0.8F, 5);\n                                                } catch (Exception ex) { ex.printStackTrace(); }\n                                                return false;\n                                        }\n\n                                }\n                }\n                                );复制代码（其实这里用2个ItemInteractionHandler是可以合起来的）（和物品有关的ItemHandler只有2个，BowShootHandler和ItemInteractionHandler）如果你找不到想要的ItemHandler，可以自己额外写一个事件监听，或者自己写一个ItemHandler\n\n合金锭编写和SlimefunItem几乎一模一样，因为合金锭是继承了SlimefunItem的只是合金锭的分类被强制限定在资源里（Categories.RESOURCE）而且合成方法被限定为冶炼厂（RecipeType.SMELTY）\n\n所有的合金锭（合成方法为冶炼厂，而且合成表里有铜粉铝粉等矿粉的金属）都建议使用以下这个方法编写\n先写好物品常量public static final ItemStack MAGICAL_ALUMINUM_INGOT = \n                        new CustomItem(Material.IRON_INGOT, \"&b魔力铝合金锭\", 0);复制代码\n这里不打算为此合金添加研究，我就使用无变量法注册物品(new Alloy(MAGICAL_ALUMINUM_INGOT, \"MAGICAL_ALUMINUM_INGOT\", new ItemStack[] \n                                {\n                                SlimefunItems.ALUMINUM_DUST, SlimefunItems.ALUMINUM_INGOT, MAGICAL_EMERALD,\n                                <font color=\"Red\">null, null, null, \n                                null, null, null</font>\n                                })).register(false);复制代码new Alloy(ItemStack item, String id, ItemStack[] recipe); // item是合金锭的物品堆，id是合金锭的文字id，recipe是在冶炼厂里的合成表，<b><font color=\"Red\">空白的地方一定要写null否则后果自负</font></b>复制代码这样你的合金就会出现在资源分类里了\n果汁（能够放在冰箱里的）同样的，先写物品常量public static ItemStack EMERALD_JUICE = \n                        new CustomPotion(\n                                        \"&a绿宝石药剂\", \n                                        Color.LIME, \n                                        new PotionEffect(PotionEffectType.LUCK, 600, 1), \n                                        new String[] { \n                                                \"\", \n                                                \"&f原来绿宝石也是可以做药水的么!\" \n                                        }\n                                        );复制代码注册（一个魔力绿宝石块在榨汁机里合成为1瓶绿宝石药剂）\n(new Juice(c, EMERALD_JUICE, \"EMERALD_JUICE\", RecipeType.JUICER, new ItemStack[] \n                                {\n                                null, null, null, null, \n                                MAGICAL_EMERALD_BLOCK, \n                                null, null, null, null\n                                })).register(false);复制代码new Juice(Category c, ItemStack item, String id, RecipeType rt, ItemStack[] recipe); // c为分类，item是物品，id是该物品的文字id，rt是合成方式，果汁一般都用RecipeType.JUICER，recipe是合成表，空的地方写null复制代码于是我们终于可以在mc里合成幸运药水了\n\n带药水效果的盔甲编写盔甲物品堆常量\npublic static ItemStack OBSIDIAN_BOOTS = \n                        new CustomArmor(new CustomItem(Material.LEATHER_BOOTS, \"&8黑耀石靴子\", 0, new String[] \n                                        {\n                                        \"\",\n                                        \"&f防止你被火焰烧伤\"\n                                        }), Color.BLACK);复制代码注册物品(new SlimefunArmorPiece(c, OBSIDIAN_BOOTS, \"OBSIDIAN_BOOTS\",\n                                RecipeType.ARMOR_FORGE, new ItemStack[] {\n                                null, null, null,\n                                Demo.mat(Material.OBSIDIAN), null, Demo.mat(Material.OBSIDIAN),\n                                Demo.mat(Material.OBSIDIAN), null, Demo.mat(Material.OBSIDIAN)\n                                }, new PotionEffect[] {\n                                new PotionEffect(PotionEffectType.FIRE_RESISTANCE, 300, 1)\n                                })).register(false);复制代码new SlimefunArmorPiece(Category c, ItemStack item, String id, RecipeType rt, ItemStack[] recipe, PotionEffect[] effect); // c表示分类，item表示物品，id是文字标识，rt是合成方式，recipe是合成表，effect是穿戴后给予穿戴者的药水效果复制代码\n你当然可以用事件监听或者Task来给物品添加更多用途/效果但是对于某些功能来说，用这样的方法的话会更方便只有用Juice创建的药水才能被塞进冰箱\n\n本来还打算写可充电物品的编写教程的\n但是想想还是算了，和以后的教程一起发吧（懒）\n\n\n\n\n\n\n\n\nDemo-第二节-给物品添加功能以及部分特殊物品.zip\n\n\n2020-2-24 14:12 上传\n点击文件名下载附件\n\n\n\n\n3.63 KB, 阅读权限: 30, 下载次数: 7\n\n\nDemo源码\n\n\n",
    "replies": [
        {
            "author": "Freeze_Dolphin",
            "timestamp": 1582520340,
            "txt_content": "忘记打包源码发附件了....等下开电脑发"
        },
        {
            "author": "我是毒素",
            "timestamp": 1584295680,
            "txt_content": "抢一个位置"
        },
        {
            "author": "wordangyou",
            "timestamp": 1584448980,
            "txt_content": "\n谢谢楼主分享"
        },
        {
            "author": "不扰小屈",
            "timestamp": 1584584820,
            "txt_content": "催更，催更"
        },
        {
            "author": "Freeze_Dolphin",
            "timestamp": 1584669540,
            "txt_content": "不扰小屈 发表于 2020-3-19 10:27\n催更，催更\n好，晚上更新qwq"
        },
        {
            "author": "不扰小屈",
            "timestamp": 1587607020,
            "txt_content": "Freeze_Dolphin 发表于 2020-3-20 09:59\n好，晚上更新qwq\nemmm，20多天过去了好像也没更新"
        },
        {
            "author": "many先生",
            "timestamp": 1596523800,
            "txt_content": "顶顶，顺便再催更"
        },
        {
            "author": "1347473112",
            "timestamp": 1607956500,
            "txt_content": "努力学习。。。。。。。。"
        }
    ]
}