{
    "title": "简单插件例子发布",
    "author": "1277832129",
    "replyCount": 10,
    "timestamp": 1402798800,
    "txt_content": "最近不少人在插件里面留后门 ,真是恶心啊···\n好吧 开始了~~~\n首先我用的是netbeans 其实可以用 Eclipse 但是我不喜欢那个界面····你懂的 要开发高级的 还是用 Eclipse吧\n\n\n首先得设置好plugin.yml\n\n\nname: zhiye                   //名字\nmain: zhiye.zhiye            //主类\nversion: 1.0.0              //版本\n\ncommands:\n  zhiye:                             //命令\n      description: 描述\n      permission: zhiye.use //插件的权限复制代码接下来开始写代码\n\n\n\npackage zhiye;\n//创建包\n//导入\nimport java.io.File;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.LinkedList;\nimport java.util.List;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\nimport org.bukkit.Bukkit;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.configuration.file.FileConfiguration;\nimport org.bukkit.configuration.file.YamlConfiguration;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.Listener;\nimport org.bukkit.plugin.java.JavaPlugin;\n//开始写命令\npublic class zhiye extends JavaPlugin\n  implements Listener\n{\n//创建存档\n  private File fileConfig;\n  private FileConfiguration config = getConfig();\n  private FileConfiguration player;\n  private File filePlayer;\n  //下面全是载入或者关闭信息\n  public void onLoad()\n  {\n    System.out.println(\"插件加载成功\");\n  }\n\n  public void onEnable()\n  {\n      if(!getDataFolder().exists())\n{\n\n        getDataFolder().mkdir();\n\n\n}\n\n      if (filePlayer == null) {\n       filePlayer = new File(getDataFolder(), \"player.yml\");\n      }\n      player = YamlConfiguration.loadConfiguration(filePlayer);\n//看存档有没 没有就创建\n    System.out.println(\"==========\");\n    System.out.println(\"==========\");\n    System.out.println(\"==========\");\n    System.out.println(\"==========\");\n    System.out.println(\"插件开启成功\");\n    System.out.println(\"制作者QQ1277832129\")\n    System.out.println(\"==========\");\n    System.out.println(\"==========\");\n  }\n\n  public void onDisable()\n  {\n    System.out.println(\"插件关闭成功\");\n  }\n\n//开始写命令\n  public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args){\n\n      if(cmd.getName().equalsIgnoreCase(\"zhiye\")){\n//注册命令\n          Player p = (Player)sender;\n                if(args[0].equalsIgnoreCase(\"s\")){\n//zhiye s 这个s就是这个\n\n\n\n    InputStream defConfigStream = this.getResource(\"player.yml\");\n    if (defConfigStream != null) {\n        YamlConfiguration defConfig = YamlConfiguration.loadConfiguration(defConfigStream);\n        player.setDefaults(defConfig);\n    }\n//刷新文件\n\n\n    {\n        if (player.getString(p.getName()) != null){\n            if (config.getString(args[1]+\".\"+\"father\")==null){\n                p.sendMessage(\"你不能直接选择这个职业\");\n                return true;\n            //判断玩家是否非法选择职业\n            }\n        }\n\n\n\n    }\n                    //player.yml\n                    //玩家名字:职业名称\n\n                    //config.yml\n                    //职业ID args 0 \n                    //   name 职业名称前缀\n                    //   skill 技能\n                    //   father 父类\n                    //   command 辅助命令\n                    boolean none = false;\n                    boolean father = false;\n\n                    //判断玩家当前有没有职业\n                    if (player.getString(p.getName()) == null){\n                        none = true;\n                    }\n                    //判断玩家选择的职业 是否是以前职业的子类或者说是下一阶\n                    //若为空 也是可以选择的\n                    boolean f = (none==false);\n                    boolean t = false;\n                    boolean xuan = false;\n                    if (config.getString(args[1]+\".\"+\"father\") == null){\n                    t = true;    \n                    }else{\n                    t = ((config.getString(args[1]+\".\"+\"father\")).equals(player.getString(p.getName())));\n                    }\n\n                    if (t&&f){\n                        father = true;\n                    }else {\n                        boolean tt = false;\n                        if (config.getString(args[1]+\".\"+\"father\")==null){\n                            if (player.getString(p.getName())==null){\n                            tt = true;\n                            }\n\n                        }else{\n                            tt = false;\n                        }\n                        boolean ff = none==true;\n                        if(tt&&ff) {\n                        father = true;\n                        }\n                    }\n//上面用了 逻辑与 仔细看就明白了\n\n                    //是否满足条件1？ 没有职业 且 没有father类\n                    if (father){\n                        //run命令\n                        runCommand(p,config.getString(args[1]+\".\"+\"command\"));\n                        //run称号\n                        runCommand2(p,\"manuaddv \"+p.getName()+\" suffix \"+config.getString(args[1]+\".\"+\"name\"));\n                        //run技能\n                        List<String> list = new LinkedList<>();\n                        list = config.getStringList(args[1]+\".\"+\"skill\");\n                        for(int i=0;i<list.size();i++){ \n//遍历技能\n                        String skillname = list.get(i);\n                        runCommand2(p,\"c t \"+p.getName()+\" \"+skillname);\n                        }\n                        player.set(p.getName(), args[1]);\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                           \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c                          \");\n                        p.sendMessage(\"§c恭喜你获得新职业成功\");\n                        p.sendMessage(\"§c恭喜你习得新技能\");\n//不刷屏怎么可以呢 好吧其实可以用 循环来刷屏··\n                        for(int i=0;i<list.size();i++){ \n                            p.sendMessage(list.get(i));\n                        }\n//输出学会的技能\n\n                    }else{\n                        p.sendMessage(\"你无法选择哪个职业\");\n                        return true;\n//判断非法操作\n                    }\n\n\n\n                    try {\n                        //存储\n                        player.save(filePlayer);\n                    } catch (IOException ex) {\n                        Logger.getLogger(zhiye.class.getName()).log(Level.SEVERE, null, ex);\n                    }\n\n                }\n                if(args[0].equalsIgnoreCase(\"remove\")){\n\n                }\n\n                return true;\n\n        }\n        return true; \n    }\n  //load方法\n  public FileConfiguration load(File file)\n  {\n      if(!file.exists())\n        {\n          try {\n              file.createNewFile();\n          } catch (IOException ex) {\n              Logger.getLogger(zhiye.class.getName()).log(Level.SEVERE, null, ex);\n          }\n        }\n      return YamlConfiguration.loadConfiguration(file);\n  }\n\n\n  //运行命令方法\n  public void runCommand(Player p, String cmd) {\n    if (p.isOp()) {\n      p.performCommand(cmd);\n    } else {\n      p.setOp(true);\n      p.performCommand(cmd);\n      p.setOp(false);\n//这里要先设置OP 不然无法运行部分命令 后面再取消\n      Bukkit.dispatchCommand(Bukkit.getConsoleSender(), \"\");\n    }\n  }\n  public void runCommand2(Player p,String str) {\n      Bukkit.dispatchCommand(Bukkit.getConsoleSender(), str);\n  }\n\n//以控制台运行命令\n}\n\n//请不要吐槽上面我用ESS来做后缀{:10_552:}\n\n\n\n",
    "replies": [
        {
            "author": "Notme.",
            "timestamp": 1402798920,
            "txt_content": "楼主你太帅了~"
        },
        {
            "author": "Lucky777777",
            "timestamp": 1408367460,
            "txt_content": "  0.0 围观"
        },
        {
            "author": "虫小哥",
            "timestamp": 1408372380,
            "txt_content": "感谢楼主分享，正好研究研究"
        },
        {
            "author": "ByZYM",
            "timestamp": 1408387620,
            "txt_content": "不推荐设置op那个。。。还不如自己添加玩家聊天event  这样还可以和groupmanager分开"
        },
        {
            "author": "z_199355",
            "timestamp": 1415454420,
            "txt_content": "大大。能发一个Scoreboard的插件示例吗？这一部分不太懂!{:10_512:}"
        },
        {
            "author": "wingrant",
            "timestamp": 1416808620,
            "txt_content": "mark，感谢分享"
        },
        {
            "author": "Pointer",
            "timestamp": 1439106840,
            "txt_content": "没有说清楚，下面的代码放在哪里，我是新手，我不懂"
        },
        {
            "author": "kjkj2173135",
            "timestamp": 1455759480,
            "txt_content": "不知道基础java知识\n完全看不懂"
        },
        {
            "author": "173537740",
            "timestamp": 1455759780,
            "txt_content": "强势围观，目测楼主真他喵辛苦"
        },
        {
            "author": "t9044",
            "timestamp": 1455766980,
            "txt_content": "代码有致命问题,没有在执行命令的地方加上try,如果一旦命令报错玩家就是OP了"
        }
    ]
}