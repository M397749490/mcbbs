{
    "title": "1.14.4服务器卡顿带timings报告！！求大佬帮助！！",
    "author": "aizhuzhu",
    "replyCount": 7,
    "timestamp": 1571324580,
    "txt_content": "服务器用的是vps，配置是 2667v2    4h8g核心是paperspigot\n\n\n\n服务端已经按照站内各种优化教程优化了。\n\n\n后台显示 cpu，内存都没满的情况下\n18人在线 tps只有15\n\n\n\n\n\n而且经常跳动！！！\n\n\n求大佬帮助！！！\n\n\n\nhttps://timings.aikar.co/?id=5c48077da88d47ce91c178a5f61d4a93\n\n\n",
    "replies": [
        {
            "author": "Salt_lovely",
            "timestamp": 1571324580,
            "txt_content": "服务端已经按照站内各种优化教程优化了。\n1.14服务端负优化，站内大部分的教程优化针对的是1.13及以下版本，对于1.14来说，不够用（血的教训qwq），典型情况就是你那样TPS不稳定，除此之外还有内存占用忽高忽低等等\n好了不闹了，讲一下吧：timings里面显示的问题是实体占用资源太多，主要是鱼和怪物。\n（鱼占用资源比怪物还多的插件服，有点厉害）\n\n但是看过你的配置文件之后，我发现你的配置优化没有问题，所以我很好奇：你的四核VPS的CPU主频是多少？2GHz可是带不动的。\n\n\nworld（主世界）占用了大约62%的tick，实体又占用了其中一半...\n所有世界的实体加起来占用了45%的tick...这个占比，我感觉问题不大\n很明显你这是配置不足，检查你的VPS处理器主频是不是有点低\n\n实体占用：\nnms.EntityTropicalFishcount(499972)  total(4.23% 43.822s, 5.44% of tick)\nnms.EntitySkeletoncount(322814)  total(3.90% 40.363s, 5.01% of tick)\nnms.EntitySalmoncount(413569)  total(3.42% 35.404s, 4.39% of tick)\nnms.EntityZombiecount(258850)  total(3.29% 34.098s, 4.23% of tick)\nnms.EntityCreepercount(256558)  total(2.76% 28.576s, 3.55% of tick)\nnms.EntityCodcount(275177)  total(2.37% 24.48s, 3.04% of tick)\nnet.citizensnpcs.nms.v1_14_R1.entity.EntityHumanNPCcount(220455)  total(1.86% 19.209s, 2.38% of tick)\nnms.EntityBatcount(282754)  total(1.65% 17.127s, 2.13% of tick)<<<蝙蝠这么多？\n\n治标不治本的方法：\n针对1.14的渣优化：\nserver.properties：\n加入一行  useSMPAPI:true    *这个方法主要用于心理暗示\n\n针对这几种生物：\nbukkit.yml：\nticks-per下面的monster-spawns调整为2-4   *怪物刷新间隔把蝙蝠（ambient）改成1或者0   *蝙蝠吃那么多资源...把水生生物改成3-4（如果有办法降低章鱼的生成概率就更好了）\nspigot.yml：\n把squid-spawn-range下面的最小值调整为高于50-60之间的值   *哪来的章鱼\n\npaper.yml：\nworldsettings下面的despawn-ranges的hard调整为28-40   *怪物删除距离\n\n除此之外还有掉落物和章鱼这两样占用资源的实体（分别占用tick0.73%和0.66%），请稍微注意一下\n\n治本但是有些难受的方法：换BC（群组）服，将你的world世界独立出来，成为一个子服\n"
        },
        {
            "author": "喵",
            "timestamp": 1571355600,
            "txt_content": "world 世界占用消耗很高的服务器性能\n简单地说就是你的vps配置不够服务器用了\n有2种方法\n1.买配置更高的VPS\n2.买两个VPS，一个单独处理world世界，另一个处理其他世界，用BC将两个服务器连起来\n通常情况下第二种更为方便，不过你服人不多，第一种比较适合"
        },
        {
            "author": "aizhuzhu",
            "timestamp": 1571390220,
            "txt_content": "Salt_lovely 发表于 2019-10-18 16:38\n1.14服务端负优化，站内大部分的教程优化针对的是1.13及以下版本，对于1.14来说，不够用（血的教训qwq）， ...\n好的十分感谢！！！\n\nmonster-spawns我已经设置了1\n这个u还不够嘛，还需要继续升u嘛？"
        },
        {
            "author": "Salt_lovely",
            "timestamp": 1571393760,
            "txt_content": "aizhuzhu 发表于 2019-10-18 17:17\n好的十分感谢！！！\n\nmonster-spawns我已经设置了1\n????3.3GHz带18个人不太可能掉TPS吧？我再去看看你的timings\n\n如果还有掉TPS的情况，请和我讲一下\n\n--------------------------\n\n刚刚又看了一下你的timings，热带鱼占tick很多，是不是有玩家在养热带鱼？（水桶放出来的鱼不会自行刷掉）"
        },
        {
            "author": "aizhuzhu",
            "timestamp": 1571400780,
            "txt_content": "Salt_lovely 发表于 2019-10-18 18:16\n????3.3GHz带18个人不太可能掉TPS吧？我再去看看你的timings\n\n如果还有掉TPS的情况，请和我讲一下\nhttps://timings.aikar.co/?id=94dfb4617247454683cabf0ca6cc852f\n大佬，这是25人时候的timings报告\ntps只有10 \n是不是应该换配置了"
        },
        {
            "author": "Salt_lovely",
            "timestamp": 1571401080,
            "txt_content": "aizhuzhu 发表于 2019-10-18 20:13\nhttps://timings.aikar.co/?id=94dfb4617247454683cabf0ca6cc852f\n大佬，这是25人时候的timings报告\ntps ...\n是的，是该开一个群组服了，你现在估计没法一个核跑这么多世界了\n\n【天空学院】BungeeCord跨服群组搭建标准教程\nhttps://www.mcbbs.net/thread-450015-1-1.html\n(出处: Minecraft(我的世界)中文论坛)"
        },
        {
            "author": "aizhuzhu",
            "timestamp": 1571401320,
            "txt_content": "Salt_lovely 发表于 2019-10-18 20:18\n是的，是该开一个群组服了，你现在估计没法一个核跑这么多世界了\n\n【天空学院】BungeeCord跨服群组搭建标 ...\n好吧！！十分感谢！！！"
        }
    ]
}