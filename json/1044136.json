{
    "title": "红石随机有解迷宫(原理讲解)",
    "author": "1055Lab",
    "replyCount": 11,
    "timestamp": 1589290440,
    "txt_content": " 本帖最后由 1055Lab 于 2020-5-13 09:58 编辑 \n\n这是一个随机有解迷宫，上面是peerless设计的随机数发生器，下面是有解判断器，我设计了一套相对简单的算法判断是否有解。\n\n\n\n\nfile_1589278431000.jpg (126.06 KB, 下载次数: 6)\n\n下载附件\n\n2020-5-12 18:13 上传\n\n\n\n\n\n\n\n\n\nfile_1589290472000.jpg (65.56 KB, 下载次数: 3)\n\n下载附件\n\n2020-5-12 21:34 上传\n\n\n\n\n\n\n这个随机迷宫分为若干房间，房间的4个面有通向其他房间的门，如图所示。\n\n\n\n\n\nfile_1589278822000.jpg (124.65 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-12 18:20 上传\n\n\n\n\n\n\n它可能和一般的迷宫不太一样，但只要稍加分析，你就能发现一般的迷宫也能套用这一模型：迷宫的每个方块相当于1个房间，如果这个方块是墙，那么这个方块的4个方向都是无法进入的，如果这个方块是空气，只要把有路可走的方向对应的“门”打开即可。\n\n\n随机数产生器\n\n我们需要产生随机数来控制某个门是否打开，利用投掷器投掷物品的随机性可以制作随机数发生器，这是peerless制作的随机数发生器。\n\n\n\n\n\nfile_1589279351000.jpg (112.19 KB, 下载次数: 6)\n\n下载附件\n\n2020-5-12 18:29 上传\n\n\n\n\n\n熔炉中放一个64堆叠的物品，用于产生强度为1的红石信号。\n在投掷器内放入若干不同的64堆叠物品和不可堆叠物品。\n拉下拉杆后，红石线激活，漏斗锁定，同时红石线更新到底部的投掷器，投掷器将一个随机物品投入漏斗中。如果这个物品是64堆叠物品，那产生1强度的红石信号会被熔炉产生的红石信号减掉，为0，活塞不推出。反之，若这个物品不可堆叠，则活塞推出，你可以通过控制不可堆叠物品和64堆叠物品占据投掷器物品栏的格数来控制随机数产生的的概率。在关闭拉杆后，漏斗解除锁定，物品自然漏回投掷器中，恢复默认状态。\n\n下面就是重头戏了：迷宫有解判断算法\n\n既然是算法，那就得将迷宫量化，自然地，我们会把房间作为迷宫的基础单位。\n\n如何描述一间房间呢？\n自然地，一个房间有4个门，每一间门都有打开和关闭两种状态。\n\n光有门还不够，即使是一个房间所有的门都打开，这个房间也不一定能进去，所以，我们还需要一个状态描述这个房间能否进入。\n\n接下来，思考一个房间能够进入需要满足什么条件？\n1.这个房间是迷宫的起点。\n2.这个房间不是起点，但是相邻的房间能够进去，且它们之间的门是打开的。\n\n显然，一个迷宫有解的充要条件是终点对应的房间能够进入。\n\n基于这一点，我们可以设计出一个很简单的电路来判断生成的随机迷宫是否有解。\n\n首先，我们需要电路描述门的开关状态，由于上面的电路被随机数生成器占据，所以自然地想到用侦测器加粘性活塞推方块（虽然会比较丑）。\n\n\n\n\n\nimage.png (342.49 KB, 下载次数: 10)\n\n下载附件\n\n2020-5-12 20:47 上传\n\n\n\n\n\n开门时，侦测器收到更新，给活塞短脉冲，关门同理。\n\n接下来，我们需要电路描述一个房间是否能进入。\n这个电路应该具备以下功能：如果相邻房间能进入，且连接的门是打开的话，那判断这个房间能进入；当然还可以是如果当前房间能进入，那么尝试判断它周围的4个门是否打开，如果是打开的，则把对应的房间设置为可以进入。\n这里我采用的是后者。\n\n描述一个房间能否进入，自然想到的是红石电源，如果能进入，就激活电源。\n再看上面的图，聪明的你应该想到接下来怎么办了吧？让这个房间的红石电源发出的信号连接到周围房间的红石电源的激活端，用中继器或比较器充能方块的办法，门打开时，方块被推下去，线路接通，门关闭时，线路断开。\n\n这里给出最佳电路\n\n\n\n\nfile_1589288533000.jpg (143.67 KB, 下载次数: 3)\n\n下载附件\n\n2020-5-12 21:02 上传\n\n\n\n\n\n活塞加炼药锅用来描述一个房间能否进入，如果一个房间能进去，那么活塞会推出，进而比较器产生信号。\n如果门被打开，方块会被推下来，中继器充能方块，如果这个房间能进去，那么红石信号就会激活对应房间的活塞，炼药锅被推上来，把另一个房间设为能够进入的状态，依次类推，当终点的房间能够进去，即炼药锅被推上来，那么这个迷宫就是有解的。\n\n要定义起点，只需要让对应房间的炼药锅保持推上来，或者在中间放置红石块。\n\n这里无需担心会构成信号闭环：即活塞推出后，比较器会持续激活活塞，因为在重置迷宫时，所有的门关闭，方块收回，闭环会断开。但是如果在生成迷宫后修改某一房间的一个门时，该算**出现问题，因为此时信号闭环会一直保持直到该房间的所有门都关闭。\n\n\n\n\n\nfile_1589289105000.jpg (186.8 KB, 下载次数: 3)\n\n下载附件\n\n2020-5-12 21:11 上传\n\n\n\n\n\n如图，将左房间定义为起点，然后将两房间之间的门打开，此时另外一个门的状态就是可以进入的了。\n\n总之，这是一个很简单的迷宫算法，是自己研究的，如有雷同，纯属巧合。\n关于存档：你可以来服务器redstoner.cn输入/p visit Windmill1055查看，如果实在有存档需求请评论，我会放出存档（懒，还要从服务器里导出）。\n其实应该是能把有解电路转移到上面实现无痕的，但是我比较懒，也懒得搞了。\n你可以让电路循环到生成有解迷宫为止，还能通过控制投掷器内的物品数量来控制迷宫难度，如果需要循环电路的教程也请评论，我会在后续放出（懒）。\n\n另外，peerless重新设计了一下，把随机数发生器移到了下面，上面是空缺的，并且把铁门换成了活塞门，最后的效果还是很棒的，同样存档在服务器里。\n\n\n\n\nfile_1589334898000.jpg (122.95 KB, 下载次数: 9)\n\n下载附件\n\n2020-5-13 09:55 上传\n\n\n\n\n\n\n\n\n\nfile_1589334937000.jpg (281.39 KB, 下载次数: 8)\n\n下载附件\n\n2020-5-13 09:55 上传\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "血盟团长",
            "timestamp": 1589335020,
            "txt_content": "看懂原理了，但是如何保证只有一条路通往出口呢？"
        },
        {
            "author": "1055Lab",
            "timestamp": 1589335260,
            "txt_content": "MikeW138 发表于 2020-5-13 09:57\n看懂原理了，但是如何保证只有一条路通往出口呢？\n这套算法注定了无法判断有几条路通往终点，只能通过调整随机数生成的概率控制迷宫生成的难度，如果需要大概率只生成一条通路，只需要让门打开的概率降低，然后多生成几次直到有解为止"
        },
        {
            "author": "徐鲲菜菜子",
            "timestamp": 1589336160,
            "txt_content": "1055Lab 发表于 2020-5-13 10:01\n这套算法注定了无法判断有几条路通往终点，只能通过调整随机数生成的概率控制迷宫生成的难度，如果需要大 ...\n一脸懵逼"
        },
        {
            "author": "lh6666",
            "timestamp": 1589342160,
            "txt_content": "震惊！这个帖子太复杂了"
        },
        {
            "author": "kayn-",
            "timestamp": 1597028400,
            "txt_content": "做游戏地图就可以用上了，舒服"
        },
        {
            "author": "JunYun",
            "timestamp": 1597144800,
            "txt_content": "这个只是讲原理嘛？楼主可以做个详细的教程嘛？"
        },
        {
            "author": "BiebieOoO",
            "timestamp": 1597199400,
            "txt_content": "MC版异次元杀阵？"
        },
        {
            "author": "永爱不忘",
            "timestamp": 1597770660,
            "txt_content": "听了原理还是听不懂   我是不是傻了"
        },
        {
            "author": "不忘吃心",
            "timestamp": 1598079000,
            "txt_content": "嘿嘿嘿   我想到了好东西  基友我来了"
        },
        {
            "author": "夕阳红熊猫",
            "timestamp": 1601889720,
            "txt_content": "有没有人想到国外大大做的一个无尽地牢。我现在终于知道这种随机生成怎么来的了"
        },
        {
            "author": "pigred",
            "timestamp": 1602322740,
            "txt_content": "红石大佬"
        }
    ]
}