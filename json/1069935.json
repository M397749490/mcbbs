{
    "title": "paper端restart指令出现问题！[1.16.1]",
    "author": "熊猫黑小白",
    "replyCount": 5,
    "timestamp": 1593460260,
    "txt_content": " 本帖最后由 熊猫黑小白 于 2020-6-30 03:56 编辑 \n\n目前正在使用paper1.16.1，写了个崩溃重启的脚本也就是stop之后会重新启动。\n现在使用stop指令是正常重启，但是restart指令会有问题：\nrestart之后控制台会出现以下信息：\n[03:49:35 INFO]: Attempting to restart with ./start.sh\n[03:49:35 INFO]: Stopping server (Ignore any thread death message you see! - DO NOT REPORT THREAD DEATH TO PAPER)\n[03:49:35 INFO]: [TimeIsMoney] Disabling TimeIsMoney v1.9.6.14\n[03:49:35 INFO]: [EssentialsChat] Disabling EssentialsChat v2.17.2.130\n[03:49:35 INFO]: [EssentialsProtect] Disabling EssentialsProtect v2.17.2.130\n[03:49:35 INFO]: [Essentials] Disabling Essentials v2.17.2.130\n[03:49:35 INFO]: [Vault] [Vault][Economy] Essentials Economy unhooked.\n[03:49:35 INFO]: [Vault] Disabling Vault v1.7.2-b107\n[03:49:35 INFO]: [ServerlistMOTD] Disabling ServerlistMOTD vX-2020-03-02\n[03:49:35 INFO]: [ServerlistMOTD] Removed duplicates in userdata in 0ms.\n[03:49:35 INFO]: [ServerlistMOTD] Saved userdata into IP_UUID.dat in 1ms.\n[03:49:35 INFO]: [Harbor] Disabling Harbor v1.6.1\n[03:49:35 INFO]: [ProtocolLib] Disabling ProtocolLib v4.5.1\n[03:49:35 INFO]: [AutoRestart] Disabling AutoRestart v4.1.4\n[03:49:35 INFO]: [AutoRestart] Done\n[03:49:35 INFO]: [GSit] Disabling GSit v[2.16.0.0]\n[03:49:35 INFO]: [GSit] The Plugin was successfully disabled.\n[03:49:35 INFO]: [LuckPerms] Disabling LuckPerms v5.1.63\n[03:49:35 INFO]: [LuckPerms] Starting shutdown process...\n[03:49:35 INFO]: [LuckPerms] Closing storage...\n[03:49:35 INFO]: [LuckPerms] Goodbye!\n[03:49:35 INFO]: [CoreProtect] Disabling CoreProtect v19.0\n[03:49:35 INFO]: [CoreProtect] Finishing up data logging. Please wait...\n[03:49:36 INFO]: [CoreProtect] Success! Disabled CoreProtect v19.0\n[03:49:36 INFO]: Saving players\n[03:49:36 INFO]: Saving worlds\n[03:49:36 INFO]: Saving chunks for level 'ServerLevel[world]'/minecraft:overworld\n[03:49:37 INFO]: ThreadedAnvilChunkStorage (world): All chunks are saved\n[03:49:37 INFO]: Saving chunks for level 'ServerLevel[world_nether]'/minecraft:the_nether\n[03:49:37 INFO]: ThreadedAnvilChunkStorage (DIM-1): All chunks are saved\n[03:49:37 INFO]: Saving chunks for level 'ServerLevel[world_the_end]'/minecraft:the_end\n[03:49:38 INFO]: ThreadedAnvilChunkStorage (DIM1): All chunks are saved\n[03:49:38 INFO]: ThreadedAnvilChunkStorage (world): All chunks are saved\n[03:49:38 INFO]: ThreadedAnvilChunkStorage (DIM-1): All chunks are saved\n[03:49:38 INFO]: ThreadedAnvilChunkStorage (DIM1): All chunks are saved\n[03:49:38 INFO]: Saving usercache.json\n[03:49:38 INFO]: Flushing Chunk IO\n[03:49:38 INFO]: Closing Thread Pool\n> [03:49:38 INFO]: Closing Server\nSystem Info: Java 1.8 (OpenJDK 64-Bit Server VM 25.252-b09) Host: Linux 3.10.0-1127.13.1.el7.x86_64 (amd64)\nLoading libraries, please wait...\n[03:49:45 INFO]: Environment: authHost='https://authserver.mojang.com', accountsHost='https://api.mojang.com', sessionHost='https://sessionserver.mojang.com', name='PROD'\n[03:49:46 FATAL]: Failed to start the minecraft server\nnet.minecraft.server.v1_16_R1.SessionLock$ExceptionWorldConflict: /root/OriginMC/./world/session.lock: already locked (possibly by other Minecraft instance?)\n        at net.minecraft.server.v1_16_R1.SessionLock$ExceptionWorldConflict.a(SourceFile:98) ~[patched_1.16.1.jar:git-Paper-24]\n        at net.minecraft.server.v1_16_R1.SessionLock.a(SourceFile:44) ~[patched_1.16.1.jar:git-Paper-24]\n        at net.minecraft.server.v1_16_R1.Convertable$ConversionSession.<init>(Convertable.java:198) ~[patched_1.16.1.jar:git-Paper-24]\n        at net.minecraft.server.v1_16_R1.Convertable.c(Convertable.java:180) ~[patched_1.16.1.jar:git-Paper-24]\n        at net.minecraft.server.v1_16_R1.Main.main(Main.java:97) ~[patched_1.16.1.jar:git-Paper-24]\n        at org.bukkit.craftbukkit.Main.main(Main.java:276) ~[patched_1.16.1.jar:git-Paper-24]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_252]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_252]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_252]\n        at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_252]\n        at io.papermc.paperclip.Paperclip.main(Paperclip.java:54) ~[paper.jar:?]\n\n随后控制台便不能再输入指令，三个世界都同时加了个session.lock文件……奇怪的是，服务器可以正常连接？？？而且杀死进程重新运行脚本便运行正常不会报错，也不需要删除session.lock……请问这是paper端的问题还是我个人没处理好的问题？\n\n\n",
    "replies": [
        {
            "author": "wjwrh",
            "timestamp": 1593460260,
            "txt_content": "restart之后\npaper会新起一个线程调用start.sh 调用java启动服务器\n然后你旧的那个线程服务器停掉以后\n由于你写了个崩溃重启的脚本，又会调用java启动服务器\n相当于你连开了两次服务器。。"
        },
        {
            "author": "熊猫黑小白",
            "timestamp": 1593475980,
            "txt_content": "wjwrh 发表于 2020-6-30 07:41\nrestart之后\npaper会新起一个线程调用start.sh 调用java启动服务器\n然后你旧的那个线程服务器停掉以后\n我擦还有这种事……就是说我要改start.sh不能让它stop后重启了？这跟spigot端不一样呢……"
        },
        {
            "author": "wjwrh",
            "timestamp": 1593476040,
            "txt_content": " 本帖最后由 wjwrh 于 2020-6-30 08:23 编辑 \n熊猫黑小白 发表于 2020-6-30 08:13\n我擦还有这种事……就是说我要改start.sh不能让它stop后重启了？这跟spigot端不一样呢……\n ...\n是的 不对啊\nspigot端也是这么个效果啊"
        },
        {
            "author": "熊猫黑小白",
            "timestamp": 1593476940,
            "txt_content": "wjwrh 发表于 2020-6-30 08:14\n是的 不对啊\nspigot端也是这么个效果啊\n刚刚删掉了stop自动重启，restart之后就显示了关闭。\n服务器restart后可以进，但是我找不到控制台了。用的是CentOS 的 screen 软件。"
        },
        {
            "author": "熊猫黑小白",
            "timestamp": 1593477060,
            "txt_content": "wjwrh 发表于 2020-6-30 08:14\n是的 不对啊\nspigot端也是这么个效果啊\n我懂了，怪不得我用spigot的时候经常崩服……"
        }
    ]
}