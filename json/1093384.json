{
    "title": "[已解决]1.15.2方块和方块实体渲染器共用同一个方块实体",
    "author": "ckg1302",
    "replyCount": 1,
    "timestamp": 1596476640,
    "txt_content": " 本帖最后由 ckg1302 于 2020-8-4 09:28 编辑 \n\n在方块的onBlockActivated方法中(CustomTileEntityType)worldIn.getTileEntity(pos)和方块实体渲染类的render方法中的tileEntityIn(MCP取的名字，不是我起的)好像获得的是不同的实例，即如下两段\n\n@Override\n        public ActionResultType onBlockActivated(BlockState state, World worldIn, BlockPos pos, PlayerEntity player, Hand handIn, BlockRayTraceResult hit) {\n                if(!worldIn.isRemote() && state.getBlock() instanceof BlockClass) {\n                        if(worldIn.getTileEntity(pos) instanceof TileEntityClass) {\n                                TileEntityClass te = (TileEntityClass)worldIn.getTileEntity(pos);复制代码@Override\n        public void render(@Nonnull TileEntityClass tileEntityIn, float partialTicks, MatrixStack matrixStackIn, IRenderTypeBuffer bufferIn, int combinedLightIn, int combinedOverlayIn) {\n                ItemStack stack = tileEntityIn.getInventory().getStackInSlot(0);复制代码中te和tileEntityIn是不同的实例，但两个实例都是同一个方块的方块实体，导致数据无法互通\n所以一个方块是怎么做到同时拥有两个方块实体的……有什么办法能保证这两个对象是同一个对象吗",
    "replies": [
        {
            "author": "3TUSK",
            "timestamp": 1596492900,
            "txt_content": "所以一个方块是怎么做到同时拥有两个方块实体的……\n你看到的分别是逻辑服务器上的 TileEntity 实例和逻辑客户端上的 TileEntity。Minecraft 使用「客户端-服务器」架构，所以这是正常的。\nhttps://mcforge.readthedocs.io/en/1.14.x/concepts/sides/\n\n有什么办法能保证这两个对象是同一个对象吗\nMinecraft 使用「客户端-服务器」架构，所以这必须是两个对象。\n你的问题本质是「怎么同步服务器上的数据到客户端」。\n看你写的这几个名字，我猜你用的是 Minecraft 1.15.2 或更新版本，所以……我个人的建议是用原版 TileEntity 的同步机制。可参考这些文档：\nhttps://mcforge.readthedocs.io/e ... -data-to-the-client\nhttps://harbinger.covertdragon.t ... le-entity-sync.html （注：虽然是中文的但是并非针对 1.15，方法和字段名有差别）"
        }
    ]
}