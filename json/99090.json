{
    "title": "Bukkit插件求救啊",
    "author": "katetem4",
    "replyCount": 6,
    "timestamp": 1363434000,
    "txt_content": "這是我寫的\n\npublic class database\n{\n    final static Logger log = Bukkit.getLogger();\n    static SQLiteConfig config = new SQLiteConfig();\n    static String path = String.format(\"jdbc:sqlite:/\" + licenseBureau.dbPath + \"/LicenseDB.db\");\n    static Connection conn;\n    static Statement sqlite;\n\n    \n    public static void openConnection() {\n    try {\n      Class.forName(\"org.sqlite.JDBC\");\n      conn = null;\n      config.setSharedCache(true);\n      config.enableRecursiveTriggers(true);\n      conn = DriverManager.getConnection(path);\n      sqlite = conn.createStatement();\n      sqlite.setQueryTimeout(30);\n    } \n        catch (Exception e)\n        {\n            log.info(e.getMessage());\n        }\n    }\n\n  public static void closeConnection() {\n    try {\n      sqlite.close();\n    } catch (Exception e) {\n      log.info(e.getMessage());\n    }\n  }\n\n  public static void tableCheck() throws SQLException\n  {\n      log.info(\"lbDB - Checking License Database...\");\n        if (!sqlite.execute(SQL.SQLite.boat))\n        {\n            log.info(\"lbDB - table boat doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.boat_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.bucket))\n        {\n            log.info(\"lbDB - table bucket doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.bucket_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.build))\n        {\n            log.info(\"lbDB - table build doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.build_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.fish))\n        {\n            log.info(\"lbDB - table fish doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.fish_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.mine))\n        {\n            log.info(\"lbDB - table mine doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.mine_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.minecart))\n        {\n            log.info(\"lbDB - table minecart doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.minecart_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.nether))\n        {\n            log.info(\"lbDB - table nether doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.nether_struct);\n            log.info(\"compelete!\");\n        }\n        if (!sqlite.execute(SQL.SQLite.pig))\n        {\n            log.info(\"lbDB - table pig doesn't exist\");\n            log.info(\"creating....\");\n            sqlite.execute(SQL.SQLite.pig_struct);\n            log.info(\"compelete!\");\n      }\n    log.info(\"lbDB - Checking compelete.\");\n  }\n\n  public static String add(String table, String user) throws SQLException\n  {\n    if (checkValid(table, user)) {\n      return ChatColor.    YELLOW + \"User Already Has That License\";\n    }\n    else\n    {\n        sqlite.execute(\"INSERT INTO \" + table + \"(username) VALUES('\" + user + \"');\");\n        return ChatColor.DARK_GREEN + \"License Granted To \" + user + \" (\" + table + \")\";\n    }\n  }\n\n  public static String remove(String table, String user) throws SQLException\n  {\n    if (checkValid(table, user)) {\n      sqlite.execute(\"DELETE FROM \" + table + \" WHERE username='\" + user + \"';\");\n      return ChatColor.DARK_GREEN + \"Revoked \" + user + \"'s License (\" + table + \")\";\n    }\n    return ChatColor.DARK_GREEN + \"User Did Not Hold That License (\" + table + \")\";\n  }\n\n  public static boolean checkValid(String table, String user)\n    throws SQLException\n  {\n    ResultSet result = sqlite.executeQuery(\"SELECT * FROM \" + table + \" WHERE username='\" + user + \"';\");\n    if (result.next())\n    {\n        return true;\n    }\n    result.close();\n    return false;\n  }\n}\n复制代码\n但sqlite的數據庫還是沒建立...\n",
    "replies": [
        {
            "author": "wc123456",
            "timestamp": 1363451820,
            "txt_content": "这个......很麻烦的啦"
        },
        {
            "author": "2B国国主",
            "timestamp": 1363660380,
            "txt_content": "看起来像是SQL数据库失败\n但是你给的信息不太全\n再往上面翻翻看看"
        },
        {
            "author": "2B国国主",
            "timestamp": 1363660440,
            "txt_content": "要具体到是哪个插件报的错才可以分析"
        },
        {
            "author": "katetem4",
            "timestamp": 1363941420,
            "txt_content": "2B国国主 发表于 2013-3-19 10:34 \n要具体到是哪个插件报的错才可以分析\n我自己寫的\n所以我有點恨sqlite(沒有一個中心管理還有很容易壞)"
        },
        {
            "author": "2B国国主",
            "timestamp": 1363941780,
            "txt_content": "katetem4 发表于 2013-3-22 16:37 \n我自己寫的\n所以我有點恨sqlite(沒有一個中心管理還有很容易壞)\n{:10_493:}至少告诉我们你的插件是干什么的"
        },
        {
            "author": "katetem4",
            "timestamp": 1363942320,
            "txt_content": " 本帖最后由 katetem4 于 2013-3-22 16:52 编辑 \n2B国国主 发表于 2013-3-22 16:43 \n至少告诉我们你的插件是干什么的\n就是記錄玩家的授權啊\n不明白看這段虛代碼\nDatabase db = new Database(sqlite);\n@Override\npublic OnAnyEvent(EventTrigger Player,Event OnAction)\n{\nbool vaild = this.db.checkLicense(Player,OnAction.ToString);\nif (vaild)\n{\nOnAction = continue;\n}\nelse\n{\nOnAction = Rollback;\nPlayer.sentmsg(new String(\"Sorry,you don't have {0} license\",OnAction.ToString),CONSOLE);\n}\n}\n复制代码尼瑪如果還看不明白我就會他媽罵你了..."
        }
    ]
}