{
    "title": "【1.13.2】实体跟随效果|宠物效果",
    "author": "Delamer",
    "replyCount": 15,
    "timestamp": 1571813760,
    "txt_content": " 本帖最后由 Delamer 于 2019-10-23 19:30 编辑 \n\n简单的实现了一下实体跟随效果.\n理论上只要一种实体实现了跟随,其他的实体基本都是同理,话不多说,上效果图.\n\n\n\n\n效果1.gif (978.28 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 13:28 上传\n\n\n\n\n\n\n\n\n效果2.gif (561.72 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 13:30 上传\n\n\n\n\n\n\n下面是代码,就两行,我也就不折叠了.execute as @p at @s run summon minecraft:area_effect_cloud ~ ~0.25 ~ {Duration:30,Tags:[\"temp\"]}\nexecute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @e[tag=temp,sort=nearest,limit=1,distance=1.5..]复制代码设计思路上,利用区域效果云(area_effect_cloud,以下简称aec)进行一种拟似的玩家路径存储,然后让盔甲架沿着aec所拟定的路径前进.\n\n\n使用aec的原因有很多,比如,直接使用玩家坐标作为参照时会经常出现这样的遁地现象\n\n\n\n\n效果5.gif (580.13 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 13:53 上传\n\n\n\n\n\n我盔甲架呢?那么大一个盔甲架呢?\n\n为了避免这种情况,我选择在玩家坐标略高一些的位置召唤aec,以避免盔甲架寻路寻到地底去,虽然还是会出现沉底现象,不过明显改善了很多.\nsummon minecraft:area_effect_cloud ^ ^0.25 ^\n注:aec的位置抬的更高可以完全避免,会出现明显漂浮,或许适用于飞行宠物,第二条指令中的distance参数也要适当调高.\n\n另外,使用aec做路径缓冲可以让实体的跟随移动变的更加圆滑,F3+B看一下路径和移动效果\n\n\n\n\n效果3.gif (937.32 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 14:00 上传\n\n\n\n\n\n\n\n\n效果4.gif (799.62 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 13:53 上传\n\n\n\n\n\n\n最后是最重要可能也是最无关紧要的一点,aec可以设置持续时间,不需要象隐形盔甲架一般额外回收,并且大量铺设也不会出现卡顿现象.实乃居家旅行杀人放火之必备良......\n\n下面为萌新附上代码的简单解释.能看懂代码可以自行调整的大佬们,就不用戳开了,因为里头对你们来说都是废话.\n\n\nexecute as @p at @s run summon minecraft:area_effect_cloud ^ ^0.25 ^ {Duration:30,Tags:[\"temp\"]}\n\n@p修改成玩家id或者其他选择器以应对其他情况.\n\n^ ^0.25 ^这 里的数字就是相对玩家位置生成的药水云高度,调高可以进一步避免遁地现象但是会有明显悬浮感.\nDuration 该参数是aec的持续时间,加大会让实体彻底变傻跟随的延迟变长,缩小则是跟的更紧凑,数据按喜好修改.\nTags tag标签是为后续aec的操作添加的名字,可以随意取,但一定要和第二条中后半部分tag保持一致.\n\nexecute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @e[tag=temp,sort=nearest,limit=1,distance=1.5..]\n\n@e[tag=move] 是选中所有标签为move的实体,只要有同样标签的实体都会被选中,可以随意取,如pet啊chongwu啊什么的.\n    添加标签的指令:tag @e[type=armor_stand] add move\n    直接召唤具有该标签的实体:summon armor_stand ~ ~ ~ {Tags:[\"move\"]}\n    其他实体同理,把armor_stand改成你要召唤的生物就好.\n^ ^ ^0.1 这个数字会影响移动速度,自己调整看看效果吧,数字越大跑越快,但是移动轨迹会有一定的撕裂感.\ntag=temp 就不多说了\nsort=nearest 选取最近的目标\nlimit=1 选取数量限制为1,防止复选目标原地抽风\ndistance=1.5..只选取距离大于1.5的目标.这个数据可以调整跟随实体与玩家的距离,数字越大罚站的越远.改小甚至改到0会抽风.\n\n\n\n下面是失败经历,感兴趣的可以瞅瞅.\n\nVer1.0 直接tp\nexecute as @e[type=minecraft:armor_stand] at @s run tp @p复制代码无移动感,全程与盔甲架合体,这一定是替身攻击.\n\nVer1.1 相对位置tp\nexecute as @p at @s run tp @e[type=minecraft:armor_stand] ^ ^0.25 ^-1复制代码无移动感,全程悬浮在身体后上方,这......这次是真的替身攻击.\n\nVer1.2 修改思路,让盔甲架不断看向玩家,并持续向前方移动execute as @e[type=minecraft:armor_stand] at @s run tp @s ~ ~ ~ facing entity @p\nexecute as @e[type=minecraft:armor_stand] at @s run tp @s ^ ^ ^0.5复制代码移动感有了,全程在玩家的身体上进♂进♂出♂出,十分鬼畜.\n\nVer1.3 降低速度,合并上方两条指令,并使用aec来缓存路径,利用aec与玩家的间距来保持距离execute as @p at @s run summon minecraft:area_effect_cloud ^ ^ ^-1 {Duration:50,Tags:[\"temp\"]}复制代码execute as @e[type=minecraft:armor_stand] at @s run tp @s ^ ^ ^0.5 facing entity @p复制代码这里往后不知道为什么两行放一起就炸,只能分开放了\n盔甲架跑到aec的位置后就开始疯狂旋转,并且出现了遁地现象.\n\nVer1.4 抬高aec位置避免土行孙行为,并把选择器改为标签选择,缩短aec持续时长以减少移动延迟\nexecute as @p at @s run summon minecraft:area_effect_cloud ^ ^0.25 ^-1 {Duration:30,Tags:[\"temp\"]}复制代码execute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @p复制代码\n如此设置并没有优化旋转现象,而且实体只能跟随在玩家后方也是个大问题.\n\nVer1.5 添加distance参数,修正aec的位置\nexecute as @p at @s run summon minecraft:area_effect_cloud ^ ^0.25 ^ {Duration:30,Tags:[\"temp\"]}复制代码execute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @e[tag=temp,sort=nearest,limit=1,distance=1..]复制代码\n至此旋转现象也被避免,并且不限于在玩家背后跟随.\n\nVer1.6 将distance参数稍微提高\nexecute as @p at @s run summon minecraft:area_effect_cloud ^ ^0.25 ^ {Duration:30,Tags:[\"temp\"]}复制代码execute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @e[tag=temp,sort=nearest,limit=1,distance=1.5..]复制代码微调跟随效果\n\nVer1.7 经大佬提醒再次优化,将aec生成时的相对位置改为绝对位置\nexecute as @p at @s run summon minecraft:area_effect_cloud ~ ~0.25 ~ {Duration:30,Tags:[\"temp\"]}复制代码execute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @e[tag=temp,sort=nearest,limit=1,distance=1.5..]复制代码进一步避免土行孙现象,并且减少悬浮感\n\n\n特别鸣谢 @雪颜の顾 的提醒\n废话说完了,有需要的就自己取回去测试吧,召唤生物做宠物的时候不要忘了添加{NoAI:1b,Invulnerable:1b}以清除生物AI与设置无敌以防宠物被自己一刀剁死.\n注:创造模式依然可以击杀设置了无敌的生物.\n再注:/gamerule commandBlockOutput false可以关闭命令方块的指令提示,防止tp提示刷屏\n　\n以上,收工.\n\n追加内容,罚站用萝卜钓竿.效果图...萝卜钓竿这东西右键连个反馈都没有,选它做例子真是选错了...\n\n\n\n\n效果6.gif (758.65 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-23 18:30 上传\n\n\n\n\n\n\nscoreboard objectives add temp minecraft.used:minecraft.carrot_on_a_stick复制代码execute as @e[tag=move] at @s if score <span id=\"kM0.6414772735857892\">@p</span> temp matches 1 run tag @s remove move\n复制代码execute as @e[type=armor_stand] at @s if score <span id=\"kM0.9412673277651356\">@p </span>temp matches 2 run tag @s add move复制代码execute as <span id=\"kM0.8484881585310458\">@p</span> at @s if score <span id=\"kM0.3773938759051567\">@p </span>temp matches 2 run scoreboard players reset <span id=\"kM0.8146849168207067\">@p </span>temp 复制代码首先把萝卜钓竿的使用次数添加到计分板[指令1]\n然后高频执行检测\"当玩家使用钓竿时(计分板数据为1时)清除move标签\"[指令2]\n最后在同时高频执行检测\"当玩家再次使用钓竿时(计分板数据为2时)\"重新添加move标签[指令3],并连锁清零萝卜钓竿的使用次数[指令4]\n以上代码可以实现右击萝卜钓竿让跟随实体停止跟随,再次右击恢复跟随的效果.\n有需要的话自行调整代码细节.　\n\n\n再次收工.\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "雪颜の顾",
            "timestamp": 1571819400,
            "txt_content": " 本帖最后由 雪颜の顾 于 2019-10-23 16:33 编辑 \n\n挺棒的作品，不过我之前居然不知道facing能放在tp的后面\n我以前都是先facing再run tp\n还有哇，我提个建议\nsummon minecraft:area_effect_cloud ^ ^0.25 ^\n这条指令中的^ ^ ^改成 ~ ~ ~会更好一些，因为^ ^0.25 ^如果视线平视是没问题的，低头会生成在前面，抬头会生成在后面"
        },
        {
            "author": "wukaka",
            "timestamp": 1571821020,
            "txt_content": "这是什么语言？"
        },
        {
            "author": "Delamer",
            "timestamp": 1571821980,
            "txt_content": "雪颜の顾 发表于 2019-10-23 16:30\n挺棒的作品，不过我之前居然不知道facing能放在tp的后面\n我以前都是先facing再run tp\n还有哇，我提个建议\n有道理!谢谢提醒!"
        },
        {
            "author": "Delamer",
            "timestamp": 1571822160,
            "txt_content": "wukaka 发表于 2019-10-23 16:57\n这是什么语言？\n\n虽然我猜到会有不懂指令的人看不懂帖子但是我是真没料到会有人不懂到这个程度...\n这不是什么语言噢,是mc内的指令代码,可以在聊天窗输入斜杠\"/\"以后使用.\n要实现帖子中的效果,需要使用到两个高频或者一个高频+连锁的命令方块组,亦或是封装成每tick执行的函数[即原版模组]."
        },
        {
            "author": "冬日祭",
            "timestamp": 1571828460,
            "txt_content": "这样的话盔甲架可以用来做恐怖地图"
        },
        {
            "author": "Delamer",
            "timestamp": 1571828760,
            "txt_content": "冬日祭 发表于 2019-10-23 19:01\n这样的话盔甲架可以用来做恐怖地图\n第一时间想到恐怖地图可太灵性了真做出来了请务必带我一个\n结合这个隐藏门还能添加解谜元素\nhttps://www.mcbbs.net/thread-854418-1-1.html"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1571869440,
            "txt_content": "其实让盔甲架检查玩家是否在一定距离之外 再进行tp 就不会进进出出的鬼畜了\n当然 缓存有缓存的好处 比如过墙（"
        },
        {
            "author": "Delamer",
            "timestamp": 1571916000,
            "txt_content": "Jokey_钥匙 发表于 2019-10-24 06:24\n其实让盔甲架检查玩家是否在一定距离之外 再进行tp 就不会进进出出的鬼畜了\n当然 缓存有缓存的好处 比如过 ...\n其实在我知道aec这个东西前都是以玩家为参照物的,但是吧......\n检测玩家脚部的时候很容易遁地,检查头部又会有明显悬浮感...\n尽管用aec缓冲和调整高度还是不能两全其美,但是两种现象都减少了许多.\n当选用其他实体,高度不同时,总是需要对检查点进行微调.\n以玩家为观察对象时,可选的观察点只有两个,有些太僵硬了.\n所以.还是aec好用.\n"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1571955480,
            "txt_content": " 本帖最后由 Jokey_钥匙 于 2019-10-25 06:39 编辑 \nDelamer 发表于 2019-10-24 19:20\n其实在我知道aec这个东西前都是以玩家为参照物的,但是吧......\n检测玩家脚部的时候很容易遁地,检查头部又 ...\n如果宠物不会跳跃 你考虑过在tp前加rotated ~ 0 吗？\n\n有漂浮感？面向头部的完整指令是execute as @e[type=armor_stand,tag=move] at @s anchored eyes facing entity @e[tag=temp] eyes\n看向玩家怎么说都是遁地啊……怎么会有漂浮感……\n综上 我给出的指令是 execute as @e[type=armor_stand,tag=move] at @s if entity @e[tag=temp,distance=1.5..] facing entity @e[tag=temp] feet rotated ~ 0 positioned ^ ^ ^0.25 anchored eyes facing entity @e[tag=temp] eyes run tp @s ~ ~ ~ ~ ~\n手撸 如有错请见谅"
        },
        {
            "author": "Delamer",
            "timestamp": 1571978340,
            "txt_content": "Jokey_钥匙 发表于 2019-10-25 06:18\n如果宠物不会跳跃 你考虑过在tp前加rotated ~ 0 吗？\n\n有漂浮感？面向头部的完整指令是execute as @e[type ...\n这个是我对玩家锁头的时候使用的指令\nexecute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity @p[sort=nearest,limit=1,distance=1.5..] eyes\n效果是介样的......\n\n\n\n\n效果7.gif (930.17 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-25 12:21 上传\n\n\n\n\n\n这个就是我之前说的漂浮感...\n\nexecute as @e[type=armor_stand,tag=move] at @s if entity @e[tag=temp,distance=1.5..] facing entity @e[tag=temp] feet rotated ~ 0 positioned ^ ^ ^0.25 anchored eyes facing entity @e[tag=temp] eyes run tp @s ~ ~ ~ ~ ~\n然后大佬你给出的指令效果是介样的\n\n\n\n\n效果8.gif (938.12 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-25 12:36 上传\n\n\n\n\n\n\n\n\n\n效果9.gif (983.92 KB, 下载次数: 2)\n\n下载附件\n\n2019-10-25 12:35 上传\n\n\n\n\n\n水往低处流,落地不回头\n\n指令中的rotated和anchored我不怎么了解...\n它们起到的作用分别是啥...\n\n"
        },
        {
            "author": "Dowe",
            "timestamp": 1572000540,
            "txt_content": "这也太6了吧，我的天！"
        },
        {
            "author": "凌空的猫",
            "timestamp": 1572003120,
            "txt_content": "我认为可以用旅行商人的nbt定位到玩家，然后盔甲架跟随应该更加符合游戏自身设定一点"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1572010920,
            "txt_content": " 本帖最后由 Jokey_钥匙 于 2019-10-25 21:44 编辑 \nDelamer 发表于 2019-10-25 12:39\n这个是我对玩家锁头的时候使用的指令\nexecute as @e[tag=move] at @s run tp @s ^ ^ ^0.1 facing entity  ...\n首先你要知道^^^（局部坐标）的运作原理\n局部坐标是根据执行点作为基点 以面朝方向建立空间坐标系\n而rotated就是更改执行点的面朝方向(类似tp中最后俩个~ ~)\n而rotated ~ 0就是让执行点的y轴偏转保存原角度 而x轴偏转变为0(即与地面平行)\n这时再加上^ ^ ^0.25可以保证盔甲架只会与地面平行的进行移动\n而anchored是改变局部坐标基准点\n命令默认执行点为实体的脚(feet) 这时facing entity eyes就是用脚看眼睛(你可以拿自己试试 命令应该是execute as @s at @s facing entity @e[type=armor_stand,tag=point,limit=1] eyes run tp @s ~ ~ ~ ~ ~ 你的记忆会非常深刻)\n如果要用眼睛看向眼睛自然就要加上anchored eyes\n顺便说一下 由于盔甲不会抬头 所以用其他生物的话才能做出它一直看着你的效果\n然后为什么 盔甲架会漂浮？ 因为tp后生物的motion不会立刻作用于生物 至少需要1刻反应时间(只有玩家是即时运算)"
        },
        {
            "author": "MC深坑不回头",
            "timestamp": 1572071340,
            "txt_content": "很不错阿!! 先前1.12曾用盔甲座试做过跟随，但效果没有想像中好，看来1.13以上的^真的好用"
        },
        {
            "author": "一般的右手",
            "timestamp": 1580404680,
            "txt_content": "实体好多，看着会卡的压子"
        }
    ]
}