{
    "title": "Grar的原版着色器教程",
    "author": "chyx",
    "replyCount": 7,
    "timestamp": 1461913620,
    "txt_content": " 本帖最后由 chyx 于 2016-10-28 20:21 编辑 \n\n我在mcforum上逛的时候看见了一个貌似不错的教程 感到有趣 于是决定尽我所能翻译它 如有任何错误请指出 谢谢\n希望不会已经有人翻译过了\n有glsl问题不要问我\n这只是一个基础教程 会光影的大神请绕路 \n原文minecraftforum.net/forums/resource-pack-discussion/1255965\n@tsd1 @719220502 @⊙v⊙ @乙烯_中国 @719823597 @pacerrecap @pca006132 \n章节\n着色器导论计算机如何理解颜色向量glsl数据类型和声明变量glsl格式函数例子minecraft着色器文件系统\n\n\n第一节 着色器导论\n在你开始前，你需要对着色器有个概念。着色器是一段在显示器显示前修改3d的对象的代码。着色器有两种，分别是顶点着色器和片元着色器。顶点着色器修改3d对象的几何尺寸，而片元着色器修改画到屏幕的像素。在原版minecraft中，着色器访问不了3d尺寸，所以你完全不用理会顶点着色器。\n这是一个最简单的片元着色器：uniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\ngl_FragColor = texture2D(DiffuseSampler, texCoord);\n}复制代码这两行uniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\n复制代码是着色器的输入。\"DiffuseSampler\"是minecraft游戏的图案，而texCoord是我们正在编辑的像素的位置。为了获得该像素的颜色，你需要使用\"texture2D\"函数。他需要一个图片和一个坐标，并且他返回该图片在该坐标处的位置。\n\"gl_FragColor\"是着色器的输出。它的值就是将要显示的颜色。\n\n第二节 计算机如何理解颜色\n现在，为了让你知道如何编辑颜色，你需要懂得计算机是如何理解颜色的。\n每个屏幕上的像素由三色光组成。分别是红光、绿光和蓝光。\n在着色器里，1代表完全点亮，0表示完全熄灭，0.5表示半亮半灭。\n三个颜色总是按照红绿蓝的顺序排列的。（这就是RGB这个词的来源）\n(1,1,1) 代表白色\n(0,0,0) 代表黑色\n(1,0,0) 代表红色\n(0,1,0) 代表绿色\n(0,0.5,0) 代表深绿色\n在你继续前请确保你熟练掌握RGB。\n\n第三节 向量\n向量是一组数，glsl中的颜色是用向量表示的。对向量做乘法就是把他的各个分量分别乘起来。\n例如：\n(1,2,3) x (1,2,3) = (1,4,9)\n\n你也可以用一个数来乘向量。这就是用向量的各个分量分别乘以这个数。\n(1,2,3) x 4 = (4,8,12)\n\n\n第四节 glsl数据类型和声明变量\nglsl有许多数据类型，包括向量。\n向量可以是各种不同的大小，这是创建他们的方法：\n\nvec2(1.0,1.0)\nvec3(1.0,1.0,1.0)\nvec4(1.0,1.0,1.0,1.0)\n\n通常使用vec4来表示颜色\n每个分量都在0和1之间\n这些数依次代表红绿蓝和透明度。\n透明度是颜色透明的程度。若他是0，颜色是不可见的。若他是0.5，他是半透明的。等等。\n注意：永远要在你用的所有的数后面加上小数位。glsl对待整数和浮点数是不一样的。把它们混在一起会引起BUG。\n\n这是你在glsl中声明一个变量的方法（如果你不知道啥是变量，Google它）。\n[type] [name] = [value];复制代码\n\n你可以用的type包括向量：\"vec2\"，\"vec3\"，\"vec4\"\n还有数：\"float\"，\"int\" （除非你知道你在干什么，不要用int)\n例如：\nvec4 myColor = vec4(1.0,1.0,1.0,1.0);\nfloat myNumber = 3.0;复制代码\n注意：每个操作后面都要有一个分号：\";\"\n\n\n第五节 glsl格式\n让我们回到我们最初的例子\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\ngl_FragColor = texture2D(DiffuseSampler, texCoord);\n}复制代码\n\n我们将像素点的颜色存储到变量中。\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\ngl_FragColor = color;\n}复制代码\n\nglsl拥有这些运算\n加: +\n减: -\n乘: *\n除: /\n我们用*将这颜色乘以一个系数\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\ngl_FragColor = color*1.5;\n}复制代码\n\n如果我们只想将图中红色分量放大呢？\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\ngl_FragColor = color*vec4(1.5,1.0,1.0,1.0);\n}复制代码\n\n\n你可以像这样获得 color 的各个分量\ncolor.r\ncolor.g\ncolor.b\ncolor.a\n下面是你在黑白着色器中使用它的方法：\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\nvec4 average = (color.r+color.g+color.b)/3.0;\ngl_FragColor = vec4(average,average,average,1.0);\n}复制代码\n译注 原文如此  中间的vec4 average那里似乎是float average\n(notice how you can use parentheses)\n\n你也可使用xyzw获得向量的分量\n如果一个向量代表坐标 你就可以这样获得x坐标\nvector.x;\n你也可以用这个输出多个量 比如说 这个着色器对换红色和蓝色通道\n\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\ngl_FragColor = color.bgra;\n}复制代码\n\n\nglsl也可以使用条件语句\n\n\nif(color<3){\n\n}else{\n\n}复制代码\n\n还有循环 （大括号中所有语句会执行5次）\n\n\nfloat i;\nfor (i = 0; i < 5.0; i++){\n\n}复制代码\n\n\n\n第六节 函数\n你能够让一些代码重复使用（通常称为函数或子程序）\nvec4 brighten( vec4 input )\n{\n        vec4 output  =  input*1.5;\n        return output;\n}复制代码\n\n接下来 你就可以任意使用它了 像这样\nvec4 newColor = brighten(color);复制代码\n\n这里有一些有用的程序\n\n\nvec4 RGBtoHSL( vec4 col )\n{\n        float red   = col.r;\n        float green = col.g;\n        float blue  = col.b;\n        float minc  = min(min( col.r, col.g),col.B) ;\n        float maxc  = max(max( col.r, col.g),col.B);\n        float delta = maxc - minc;\n        float lum = (minc + maxc) * 0.5;\n        float sat = 0.0;\n        float hue = 0.0;\n        if (lum > 0.0 &amp;amp;&amp;amp; lum < 1.0) {\n                float mul = (lum < 0.5)  ?  (lum)  :  (1.0-lum);\n                sat = delta / (mul * 2.0);\n        }\n        vec3 masks = vec3(\n                (maxc == red   &amp;amp;&amp;amp; maxc != green) ? 1.0 : 0.0,\n                (maxc == green &amp;amp;&amp;amp; maxc != blue)  ? 1.0 : 0.0,\n                (maxc == blue  &amp;amp;&amp;amp; maxc != red)   ? 1.0 : 0.0\n        );\n        vec3 adds = vec3(\n                          ((green - blue ) / delta),\n                2.0 + ((blue  - red  ) / delta),\n                4.0 + ((red   - green) / delta)\n        );\n        float deltaGtz = (delta > 0.0) ? 1.0 : 0.0;\n        hue += dot( adds, masks );\n        hue *= deltaGtz;\n        hue /= 6.0;\n        if (hue < 0.0)\n                hue += 1.0;\n        return vec4( hue, sat, lum, col.a );\n}复制代码译注 原文如此  中间的amp那里似乎是逻辑与&&\n\n\n\nvec4 HSLtoRGB( vec4 col )\n{\n    const float onethird = 1.0 / 3.0;\n    const float twothird = 2.0 / 3.0;\n    const float rcpsixth = 6.0;\n\n    float hue = col.x;\n    float sat = col.y;\n    float lum = col.z;\n\n    vec3 xt = vec3(\n        rcpsixth * (hue - twothird),\n        0.0,\n        rcpsixth * (1.0 - hue)\n    );\n\n    if (hue < twothird) {\n        xt.r = 0.0;\n        xt.g = rcpsixth * (twothird - hue);\n        xt.b = rcpsixth * (hue      - onethird);\n    } \n\n    if (hue < onethird) {\n        xt.r = rcpsixth * (onethird - hue);\n        xt.g = rcpsixth * hue;\n        xt.b = 0.0;\n    }\n\n    xt = min( xt, 1.0 );\n\n    float sat2   =  2.0 * sat;\n    float satinv =  1.0 - sat;\n    float luminv =  1.0 - lum;\n    float lum2m1 = (2.0 * lum) - 1.0;\n    vec3  ct     = (sat2 * xt) + satinv;\n\n    vec3 rgb;\n    if (lum >= 0.5)\n         rgb = (luminv * ct) + lum2m1;\n    else rgb =  lum    * ct;\n\n    return vec4( rgb, col.a );\n}复制代码\n\n第七节 例子\n一个简单的爆炸着色器\n\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\n\n\n//width of steps (higher numbers make quality worse)\nconst float blurWidth=0.001;\n\n//number of steps (higher numbers cause more lag)\nconst float blurSteps=8.0;\n\n//bloom brightness\nconst float amount=1.0;\n\nvoid main() {\n    vec4 color=texture2D(DiffuseSampler, texCoord);\n    float brightness=(color.r+color.g+color.b)/3.0;\n\n    vec4 sum = vec4(0);\n    float j;\n    float i;\n    const float foo = 10.0/(   ((blurSteps*2.0)+1.0)*((blurSteps*2.0)+1.0)   );\n\n\n    for( i= -blurSteps ;i < blurSteps; i++){\n        for (j = -blurSteps; j < blurSteps; j++){\n            sum += texture2D(DiffuseSampler, texCoord + vec2(j, i)*blurWidth);\n        }\n    }\n\n    sum*=foo;\n    vec4 modifier = sum*sum*(0.015-(brightness*0.01));\n    vec4 outputColor = modifier*amount + color;\n\n    gl_FragColor = outputColor;\n}复制代码\n\n\n原版着色器可以放在资源包里\n这里有一个你能够魔改的范例着色器材质\nhttp://pack.maloweb.com/willpackshaders.zip\n\n\n\n\n\n\n\n\n\n未完待续。。。",
    "replies": [
        {
            "author": "603632466",
            "timestamp": 1461913800,
            "txt_content": "水个贴...................."
        },
        {
            "author": "爱心魔王FHC",
            "timestamp": 1461937200,
            "txt_content": "开头文字点不进去啊？\n然后你在写什么……为什么要叫我来看"
        },
        {
            "author": "chyx",
            "timestamp": 1474993260,
            "txt_content": " 本帖最后由 chyx 于 2016-9-28 02:07 编辑 \n\n@tsd1 @719220502 @pca006132 @andylizi @yushijinhun @hhttll @chyx @siiftun1857 @Zero_Exact \n又翻译了一大段 啊~\n\n这个帖子可否搬至材质板块？\n\n而且文中这一段我有一个问题\nuniform sampler2D DiffuseSampler;\nvarying vec2 texCoord;\nvoid main() {\nvec4 color = texture2D(DiffuseSampler, texCoord);\nvec4 average = (color.r+color.g+color.b)/3.0;\ngl_FragColor = vec4(average,average,average,1.0);\n}\n这里为何用vec4？\n\n"
        },
        {
            "author": "土球球",
            "timestamp": 1475051100,
            "txt_content": " 本帖最后由 ustc_zzzz 于 2016-9-28 19:35 编辑 \n对向量做内积就是把他的各个分量分别乘起来。\n这句话好像是错的= =因为对向量做内积是把它的各个分量分别乘起来并加在一起= =\n楼主已经改掉了\n\n此外我感觉\nvec4 average = (color.r+color.g+color.b)/3.0;\n这块就是写错了= =\n\n========\n\nshader这种东西。。。扔进编程开发版是不是更合适= ="
        },
        {
            "author": "jtki",
            "timestamp": 1483316940,
            "txt_content": "这个有什么用处吗\n。。。。。。。。"
        },
        {
            "author": "青木源",
            "timestamp": 1495246260,
            "txt_content": "居然有这种骚操作，我一直都不知道"
        },
        {
            "author": "q221172839",
            "timestamp": 1495445640,
            "txt_content": "这个有什么用处吗"
        }
    ]
}