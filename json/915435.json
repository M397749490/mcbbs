{
    "title": "[已解决]如何在mc启动时加载动态资源包",
    "author": "云闪",
    "replyCount": 5,
    "timestamp": 1569302640,
    "txt_content": " 本帖最后由 云闪 于 2019-9-24 14:51 编辑 \n\n我目前是在FMLPreInitializationEvent里面执行如下代码\n\nList<IResourcePack> defaultResourcePacks = ReflectionHelper.getPrivateValue(Minecraft.class, Minecraft.getMinecraft(), \"defaultResourcePacks\", \"field_110449_ao\");\ndefaultResourcePacks.add(this.dynamicResourcePack);\n复制代码\n但是问题是FMLPreInitializationEvent是在加载资源包之后才触发的，我得进去之后F3+T重载一次资源包才能看到我动态生成的材质\n所以问题就是如何在它加载资源包之前就把自己的动态资源包强插进去\n\n解决方案：\n使用Coremod(要注意这时候Minecraft还没有实例化)，参考教程：https://www.mcbbs.net/thread-850737-1-1.html",
    "replies": [
        {
            "author": "森林蝙蝠",
            "timestamp": 1569307020,
            "txt_content": " 本帖最后由 森林蝙蝠 于 2019-9-24 14:45 编辑 \n\n你这么做的目的是什么？为了确保自己的资源包一定在上面？\n方法1：监听FMLConstructionEvent，event.getModClassLoader.mainClassLoader（这个字段是private的，需要用AT弄开），获取Minecraft.class，再用ReflectionHelper，或者不搞这些弯弯绕直接监听后，使用ReflectionHelper。\n方法2：写一个IClassTransformer，new一个ClassWriter，以这个ClassWriter新建一个ClassVisitor，再以ClassReader.accept这个CV，最后cw.visitField(access, name, String desc, signature, value),value就是你要初始化的资源包和其list。"
        },
        {
            "author": "云闪",
            "timestamp": 1569307620,
            "txt_content": "森林蝙蝠 发表于 2019-9-24 14:37\n你这么做的目的是什么？为了确保自己的资源包一定在上面？\n方法1：监听FMLConstructionEvent，event.getMod ...\n材质是动态生成的(联网获取)，目的是使资源包生效\n找了找应该使用coremod实现"
        },
        {
            "author": "1257375501",
            "timestamp": 1569464820,
            "txt_content": "云闪 发表于 2019-9-24 14:47\n材质是动态生成的(联网获取)，目的是使资源包生效\n找了找应该使用coremod实现 ...\nMinecraft.getMinecraft().refreshResources();\n另外我想问下楼主，从网上获取的资源包文件？\n是在启动客户端的时候下载到材质包文件夹么？\n这样为防止盗用是么？\n如果是为了防止盗用建议加给材质包加密码，然后加载时用zip4j打开直接用mod读取材质包内部文件"
        },
        {
            "author": "1257375501",
            "timestamp": 1569465300,
            "txt_content": "解决了啊，刚才没注意………"
        },
        {
            "author": "云闪",
            "timestamp": 1569473100,
            "txt_content": "1257375501 发表于 2019-9-26 10:27\nMinecraft.getMinecraft().refreshResources();\n另外我想问下楼主，从网上获取的资源包文件？\n是在启动客 ...\n多刷新一次会使启动变慢，所以选择了coremod\n材质已经不是zip格式了emmm加载方式是自己写的"
        }
    ]
}