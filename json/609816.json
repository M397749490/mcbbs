{
    "title": "其他配置文件（非config的配置文件）",
    "author": "lyyxy",
    "replyCount": 11,
    "timestamp": 1469495040,
    "txt_content": " 本帖最后由 lyyxy 于 2016-7-27 09:48 编辑 \n简单说一下，我在论坛上看教程的时候发现了一个问题，这些教程上要么没有讲创建其他的配置文件，要么虽然讲了但是很难看懂（至少我是看不懂），于是闲的蛋疼的我就发了这个教程，本教程教大家如何读取非config的配置文件，并且能让非config的配置文件做到config的功能\n首先先写两个成员变量\n\nprivate PluginLogger logger = null;\nprivate FileConfiguration newxxx = null;复制代码注：如果你不需要运用reload，save等就不需要写（后面会讲）\n还有第二行的代码newxxx的xxx最好写成你的配置文件的名字\n如newnumber，newplugin\n之后的只要是有xxx的地方你可以写成你的配置文件的名字\n如pluginFile，plugin.yml\n注意：必须改xxx.yml\n\n\n\n然后再写这个\nFile xxxFile = new File(getDataFolder(), \"xxx.yml\");复制代码注：这个十分重要，写配置文件必须要用到（除非你不准备对配置文件做什么）\n\n\n启动配置文件的方法\n\n<blockquote>if(!getDataFolder().exists()) {\n//判断插件文件夹是否插件\n        getDataFolder().mkdir();\n//不存在创建\n}\nif (!(xxxFile.exists())){\n//判断插件的配置文件是否存在\n        saveDefaultConfig();\n//不存在把配置文件从插件中脱出然后放在文件夹中\n}\nreloadxxx();\n//重新加载复制代码此时可能出现两个错误：\n第一你没有改xxx\n第二saveDefaultxxx()方法还没有写\n\n\n前期的准备就完了现在开始讲save，reload等方法\n\n\n\n\n第一save方法\n\n作用：对已做的修改进行保存\n例：\ngetxxx().set(\"xx.xxx\",100);\n//把配置文件的xx.xxx修改为100\nsavexxx();\n//保存复制代码\n代码：\n\npublic void savexxx(){\n        try {\n                getxxx().save(this.xxxFile);\n        } catch (IOException ex) {\n                this.logger.log(Level.SEVERE, \"Could not save config to \" + this.xxxFile, ex);\n        }\n}\n/**可能出现的问题\n*1.没有修改xxx\n*2.getxxx方法没有写\n*3.private PluginLogger logger = null;应该是成员变量\n*/复制代码\n其实有两种方法只不过第二种不怎么实用使用我就不写了只说一下原理\n其实和上面的十分类似就是把上面的错误检测去掉\n然后声明错误然后在使用时在进行错误的处理\n\n第二get方法\n\n代码：\npublic FileConfiguration getxxx(){\n        if (this.newxxx == null) {                                                                                                                                                                、\n                reloadxxx();\n        }\n        return this.newxxx;\n}\n//这个就不解释了\n//自己理解吧复制代码\n使用方法：\ngetxxx().set(\"路径\".\"内容\");\n//作用对配置文件进行修改\ngetxxx().get(\"路径\");\n//作用读取配置文件\n//反正和getConfig作用相同\n//只不过getConfig是用来弄config\n/**可能出现的问题：\n*1.xxx没有改\n*2.private FileConfiguration newxxx = null;应该写成成员变量\n*3.reloadxxx();方法还没有写\n*/复制代码\n\n第三saveDefaultxxx方法\n\n作用：把配置文件从插件中脱出放在插件文件夹中\n代码：\npublic void saveDefaultxxx(){\n        if (!this.xxxFile.exists())\n//先判断插件配置文件是否存在\n        saveResource(\"xxx.yml\", false);\n//不存在的话创建名字为xxx.yml的配置文件\n//第二个我也不是很清楚\n}\n/**可能出现的问题：\n*1.xxx没有改\n*/复制代码使用方法：if (!(xxxFile.exists())){\n        saveDefaultxxx();\n}\n//先判断配置文件xxx是否存在\n//如果不存在则把配置文件从插件中脱出放在文件夹中复制代码\n\n\n\n\n第四reload方法\n对于这两个代码我只能有空的时候慢慢研究\n毕竟太多了我根本无法一下写完\n当然如果你知道了具体的原理\n请回复有奖励\n作用：重载配置文件\n代码：两个都写\n第一个代码：\nprivate boolean isStrictlyUTF8() {\n        return getDescription().getAwareness().contains(PluginAwareness.Flags.UTF8);\n        }复制代码第二个代码：\npublic void reloadxxx(){\n          this.newxxx = YamlConfiguration.loadConfiguration(this.xxxFile);\n          InputStream defConfigStream = getResource(\"config.yml\");\n          if (defConfigStream == null)\n                     return;\n          YamlConfiguration defConfig;\n          byte[] contents;\n          if ((isStrictlyUTF8()) || (FileConfiguration.UTF8_OVERRIDE)) {\n                    defConfig = YamlConfiguration.loadConfiguration(new InputStreamReader(defConfigStream, Charsets.UTF_8));                                             }else{\n                   defConfig = new YamlConfiguration();\n                   try {\n                             contents = ByteStreams.toByteArray(defConfigStream);\n                   }catch (IOException e){\n                             getLogger().log(Level.SEVERE, \"Unexpected failure reading config.yml\", e);\n                             return;\n                   }\n                   String text = new String(contents, Charset.defaultCharset());\n                   if (!text.equals(new String(contents, Charsets.UTF_8))) {\n                            getLogger().warning(\"Default system encoding may have misread config.yml from plugin jar\");\n                   }\n                    try{\n                             defConfig.loadFromString(text);\n                    }catch (InvalidConfigurationException e){\n                             getLogger().log(Level.SEVERE, \"Cannot load configuration from jar\", e);\n                    }\n          }\n          this.newxxx.setDefaults(defConfig);\n          }\nprivate boolean isStrictlyUTF8() {\n          return getDescription().getAwareness().contains(PluginAwareness.Flags.UTF8);}\n复制代码具体我就不说了\n因为我也不怎么懂\n使用方法：\nif(args[0].equalsIgnoreCase(\"xxxx\")){\n//如果args[0]等于xxxx\n        reloadxxx();\n        //重载配置文件\n} 复制代码\n\n最后再来一个例子：\n\n其实这就是我没事的时候瞎写的也没有什么利用价值\n我就不解释了\n注意导入的东西\n\npackage org.xxx.yyxy;\n/**\n*注意导入的东西\n*注意导入的东西\n*注意导入的东西\n*重要的事说三遍\n*/\nimport java.io.File;\n\nimport org.bukkit.configuration.file.FileConfiguration;\nimport org.bukkit.plugin.java.JavaPlugin;\n\nimport com.google.common.base.Charsets;\nimport com.google.common.io.ByteStreams;\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.nio.charset.Charset;\nimport java.util.logging.Level;\n\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.configuration.InvalidConfigurationException;\nimport org.bukkit.configuration.file.YamlConfiguration;\nimport org.bukkit.plugin.PluginAwareness;\nimport org.bukkit.plugin.PluginLogger;\n\npublic class Xxx extends JavaPlugin{\n        private PluginLogger logger = null;\n        private FileConfiguration newxxx = null;\n        File xxxFile = new File(getDataFolder(), \"xxx.yml\");\n        @Override\n        public void onEnable() {//加载后做的事\n                if(!getDataFolder().exists()) {\n                        getDataFolder().mkdir();\n                }\n                if (!(xxxFile.exists())){\n                        saveDefaultxxx();\n                }\n                reloadxxx();\n                getLogger().info(\"xxx插件已加载\");\n                getLogger().info(\"作者yyxy\");\n        }\n        public boolean onCommand(CommandSender sender, Command command, String label, String[] args){\n                if(label.equalsIgnoreCase(\"xxx\")||label.equalsIgnoreCase(\"xx\")||label.equalsIgnoreCase(\"x\")){\n                        if(args[0].equalsIgnoreCase(\"x\")){\n                                if(getxxx().getInt(\"xx.xxx\")==1){\n                                        sender.sendMessage(\"111\");\n                                }\n                                if(getxxx().getInt(\"xx.xxx\")==2){\n                                        sender.sendMessage(\"222\");\n                                }\n                                if(getxxx().getInt(\"xx.xxx\")==3){\n                                        sender.sendMessage(\"333\");\n                                }\n                        }\n                        if(args[0].equalsIgnoreCase(\"xx\")){\n                                String xxxx=getxxx().getString(\"xx.xxxx\");\n                                sender.sendMessage(xxxx);\n                        }\n                        if(args[0].equalsIgnoreCase(\"xxx\")){\n                                boolean xxxxx=getxxx().getBoolean(\"xx.xxxx\");\n                                if(xxxxx){\n                                        sender.sendMessage(\"打开\");\n                                }else{\n                                        sender.sendMessage(\"关闭\");\n                                }\n                        }\n                        if(args[0].equalsIgnoreCase(\"xxxx\")){\n                                reloadxxx();\n                        }\n                        if(args[0].equalsIgnoreCase(\"xxxxx\")){\n                                if(args[1].equalsIgnoreCase(\"xxx\")){\n                                        getxxx().set(\"xx.xxx\",args[2]);\n                                        savexxx();\n                                }\n                                if(args[1].equalsIgnoreCase(\"xxxx\")){\n                                        getxxx().set(\"xx.xxxx\",args[2]);\n                                        savexxx();\n                                }\n                                if(args[1].equalsIgnoreCase(\"xxxxx\")){\n                                        getxxx().set(\"xx.xxxxx\",args[2]);\n                                        savexxx();\n                                }\n                        }\n                }\n            return false;\n        }\n        public void saveDefaultxxx(){\n            if (!this.xxxFile.exists())\n            saveResource(\"xxx.yml\", false);\n        }\n        public FileConfiguration getxxx(){\n            if (this.newxxx == null) {\n              reloadxxx();\n            }\n            return this.newxxx;\n        }\n        public void reloadxxx(){\n                this.newxxx = YamlConfiguration.loadConfiguration(this.xxxFile);\n                InputStream defConfigStream = getResource(\"config.yml\");\n                if (defConfigStream == null)\n                        return;\n                YamlConfiguration defConfig;\n                byte[] contents;\n                if ((isStrictlyUTF8()) || (FileConfiguration.UTF8_OVERRIDE)) {\n                        defConfig = YamlConfiguration.loadConfiguration(new InputStreamReader(defConfigStream, Charsets.UTF_8));\n                }else{\n                        defConfig = new YamlConfiguration();\n                        try {\n                                contents = ByteStreams.toByteArray(defConfigStream);\n                                }catch (IOException e){\n                                        getLogger().log(Level.SEVERE, \"Unexpected failure reading config.yml\", e);\n                                        return;\n                                }\n                        String text = new String(contents, Charset.defaultCharset());\n                        if (!text.equals(new String(contents, Charsets.UTF_8))) {\n                                getLogger().warning(\"Default system encoding may have misread config.yml from plugin jar\");\n                        }\n                        try{\n                                defConfig.loadFromString(text);\n                                }catch (InvalidConfigurationException e){\n                                        getLogger().log(Level.SEVERE, \"Cannot load configuration from jar\", e);\n                                }\n                        }\n                this.newxxx.setDefaults(defConfig);\n                }\n        private boolean isStrictlyUTF8() {\n                return getDescription().getAwareness().contains(PluginAwareness.Flags.UTF8);\n        }\n        public void savexxx(){\n                try {\n                        getxxx().save(this.xxxFile);\n                } catch (IOException ex) {\n                        this.logger.log(Level.SEVERE, \"Could not save config to \" + this.xxxFile, ex);\n            }\n        }\n}复制代码\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "q513902026",
            "timestamp": 1469506200,
            "txt_content": "private File xxfile;\nYamlConfiguration xxyaml = YamlConfiguration.loadConfiguration((xxfile = new File(getDataFolder(),\"xxx.yml\")));\nxxyaml.save(xxfile)\nxxyaml.load(xxfile)"
        },
        {
            "author": "lyyxy",
            "timestamp": 1469507220,
            "txt_content": "q513902026 发表于 2016-7-26 12:10\nprivate File xxfile;\nYamlConfiguration xxyaml = YamlConfiguration.loadConfiguration((xxfile = new Fi ...\n我只想说\n什么意思"
        },
        {
            "author": "黄总",
            "timestamp": 1469541000,
            "txt_content": "希望LZ能在代码里加上注解，这样不用对着下面的字看得那么累。\n直接在代码里写注析，我们也少问你是吧~{:10_512:}"
        },
        {
            "author": "lyyxy",
            "timestamp": 1469580120,
            "txt_content": "黄总 发表于 2016-7-26 21:50\n希望LZ能在代码里加上注解，这样不用对着下面的字看得那么累。\n直接在代码里写注析，我们也少问你是吧~{:10 ...\n好吧，只不过有些还得自己理解，毕竟我也不一定会"
        },
        {
            "author": "Jack112233",
            "timestamp": 1469961060,
            "txt_content": "set方法向文件写入数据会覆盖原有数据，想追加加入怎么办？"
        },
        {
            "author": "lyyxy",
            "timestamp": 1469962860,
            "txt_content": "Jack112233 发表于 2016-7-31 18:31\nset方法向文件写入数据会覆盖原有数据，想追加加入怎么办？想追加加入怎么办？什么意思"
        },
        {
            "author": "lyyxy",
            "timestamp": 1469964120,
            "txt_content": "Jack112233 发表于 2016-7-31 18:31\nset方法向文件写入数据会覆盖原有数据，想追加加入怎么办？\n懂了\n比如有这样一个配置文件是这样\nxxx：\n  xxxx: 0\n  xxxxx: '污污污'复制代码\n现在要在xxx加入一个xxxxxx和xxxxxxx的话\n先定义一个变量\n应该是\nList<String> xxxx = Arrays.asList(\"xxxxxx\",\"xxxxxxx\");复制代码\n然后在\ngetxxx().set(\"xxx\",xxxx)\n//在路径xxx上加入变量xxxx复制代码\n应该是毕竟我也没有测试过{:10_492:}\n\n"
        },
        {
            "author": "q513902026",
            "timestamp": 1470119700,
            "txt_content": "lyyxy 发表于 2016-7-31 19:22\n懂了\n比如有这样一个配置文件是这样\nprivate ConfigurationSection temp;\nif((temp = getxxx().getConfigurationSection(\"xxx\")) ==null)\n{\n         temp = getxxx().createSection(\"xxx\");\n\n}\n temp.set(\"xxxx\",0);\n temp.set(\"xxxxx\",\"污污污\");"
        },
        {
            "author": "a78116753",
            "timestamp": 1483951800,
            "txt_content": "q513902026 发表于 2016-7-26 12:10\nprivate File xxfile;\nYamlConfiguration xxyaml = YamlConfiguration.loadConfiguration((xxfile = new Fi ...\n大哥 还是你厉害 \n我一看 弄一下就好了"
        },
        {
            "author": "g2535592206",
            "timestamp": 1483952520,
            "txt_content": "枪械mod里面的材料怎么办？"
        },
        {
            "author": "冠标电商",
            "timestamp": 1483953180,
            "txt_content": "lyyxy 发表于 2016-7-27 08:42\n好吧，只不过有些还得自己理解，毕竟我也不一定会\n666666666666666"
        }
    ]
}