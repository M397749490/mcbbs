{
    "title": "自定义Npc脚本问题X2",
    "author": "很咸的咸鱼",
    "replyCount": 3,
    "timestamp": 1594902360,
    "txt_content": " 本帖最后由 很咸的咸鱼 于 2020-7-17 10:19 编辑 \n\n版本1.12.2\n脚本设置为\n低于百分之40血量 例如1k血 就400触发传送到最近的玩家身边造成一次爆炸伤害伤害为22\n低于百分之10血量 自身爆炸 爆炸范围为2格 也是22aoe伤\n\n金粒可以加  金粒可以加 金粒可以加 \n\n\n\n\n",
    "replies": [
        {
            "author": "红菜头糕",
            "timestamp": 1594902360,
            "txt_content": "function damaged(e) {\n    var n = e.npc;\n    var damage = e.damage;\n    var max = n.getMaxHealth();\n    var hp = n.getHealth();\n    var type = n.getAi().getDoorInteract();\n    if (hp - damage < max * 0.4 && type == 2) {\n        var w = n.getWorld();\n        var p = w.getClosestEntity(n.getPos(), 10, 1);\n        if (p != null) {\n            n.getAi().setDoorInteract(1)\n            n.setPos(p.getPos());\n            w.explode(p.getX(), p.getY(), p.getZ(), 2, false, false);\n            p.setHealth(p.getHealth() - 2);\n            p.message(\"受到爆炸伤害\");\n        }\n    }\n    if (hp - damage < max * 0.1) {\n        if (n.isAlive()) {\n            var w = n.getWorld();\n            w.explode(n.getX(), n.getY(), n.getZ(), 2, false, false);\n            n.setHealth(0);\n        }\n    }\n}\n\nfunction init(e) {\n    e.npc.getAi().setDoorInteract(2);\n}\n\n效果是NPC的血量低于40%时会瞬移到10格内最近的玩家，爆炸并且对其扣血\np.setHealth()是直接设置血量，所以是固伤，你也可以不要\n然后NPC默认与门交互是关闭的，如果触发40%的爆炸以后会把这一项改成开启\n这个会跟血量一起当成条件判断\n也就是这个技能只会触发一次\n\n低于10%的那个我就当你NPC自爆好了，爆炸以后NPC直接会死亡\n不过掉落物可能会被炸没("
        },
        {
            "author": "很咸的咸鱼",
            "timestamp": 1594961280,
            "txt_content": "SS菜鸟君 发表于 2020-7-17 11:59\nfunction damaged(e) {\n    var n = e.npc;\n    var damage = e.damage;\n啊？  掉落物会炸没 那可以让他不蹦没吗.. 我还有个提问帖 哥你看看？ \nhttps://www.mcbbs.net/forum.php? ... ;page=1#pid18982255\n金粒低我可以在加的"
        },
        {
            "author": "红菜头糕",
            "timestamp": 1594963380,
            "txt_content": "很咸的咸鱼 发表于 2020-7-17 12:48\n啊？  掉落物会炸没 那可以让他不蹦没吗.. 我还有个提问帖 哥你看看？ \nhttps://www.mcbbs.net/forum.php ...\n你可以换成指令给予的方式\n比如rpgitem可以用rpgitem 物品 give 玩家来指令给予物品\n然后NPC死的时候执行指令就行\n另外上面那个自爆的那一段忘记给你加AOE伤害了\n把这段加上\nvar ps = w.getNearbyEntities(n.getPos(), 10, 1);\n            for (var i = 0; i < ps.length; i++) {\n                ps.setHealth(ps.getHealth() - 22);\n            }\n放到10%那一段if里面"
        }
    ]
}