{
    "title": "[Tutorial][Bukkit][UD|PCD]如何利用Maven来管理你的插件",
    "author": "602723113",
    "replyCount": 9,
    "timestamp": 1501131960,
    "txt_content": " 本帖最后由 602723113 于 2017-10-7 19:52 编辑 \n\n 《如何利用Maven来管理你的插件》  目录:\n导读Maven概述创建你的Maven项目编写你的Maven项目构建你的Maven项目\n\n(蜜汁工整233)\n\n\n Maven概述什么是Maven?\nMaven项目对象模型(POM)，可以通过一小段描述信息来管理项目的构建，报告和文档的软件项目管理工具。 —— 来源于百度百科\n\n为什么要使用Maven?\n在一个长期的开发过程中，使用构建系统会大大简化你和想要参与协助开发的其他人的开发流程。 —— 来源于Sponge#构建系统\n\n 导读在阅读本教程之前请确保你已有Maven的相关知识与BukkitAPI相关的内容,还有Java基础知识\n\n本教程使用的Maven版本为3.5版本,IDE为Eclipse - Oxygen,JDK版本为1.8.0_77,使用的核心为SpigotAPI 1.12-R0.1-SNAPSHOT...\n[emmm现在国内也没多少服务器是craftbukkit的吧所以就选择用spigotapi了2333(spigotapi内含bukkitapi)]\n\nMaven的环境配置本教程不做相关讲解(谁叫网上有这么多教程呢233)\n\n这里给出Maven的下载地址: http://maven.apache.org/download.cgi\n\n\n\n 创建你的Maven项目  在开始编写代码之前你需要创建你的Maven项目\n那么我们需要点击Eclipse上的\n  File(文件) ---> New(新建) ---> Others(其他)\n\n\n之后我们选择其中的Maven下的Maven Project(Maven项目)\n\n\n之后呢在这里我们需要把Create a simple project给打上勾\n\n\n\n之后下一步界面是设定你的Maven项目的相关信息\nArtifact >\nGroupId -> 你在Maven的GroupId,不过一般是选择自己的域名或包名什么的ArtifactId -> 填写你插件的英文名称(也就是插件名)Version -> 你项目的版本(这个自己看吧=w=)Packaging -> 打包成什么格式(默认为jar即可)\n之后点击Fininsh(完成)\n\n\n创建好Maven项目后你就会发现是这样的\n\n来解释一下这些意思吧\n  src/main/java                  用于存放Java程序的代码\n  src/main/resources          用于存放非程序代码,如配置文件\n  src/test/java[resources]   用于存放测试用例\n  JRE Sysem Library           这个就别解释了吧=w=\n  src                                 所有源代码的根目录\n  target                             用于存放构建完成后的插件\n  pom.xml                         emmm...Maven基础=w=\n\n之后我们点开pom.xml, 之后点击pom.xml\n\n为其进行配置所引用的jar包\n在 <version>xxx</version> 下方另起一行 写入以下内容\n<repositories>\n  <repository>\n   <id>spigot-repo</id>\n  <url>https://hub.spigotmc.org/nexus/content/repositories/snapshots/</url>\n  </repository>\n </repositories>\n <dependencies>\n  <!--SpigotAPI -->\n  <dependency>\n   <groupId>org.spigotmc</groupId>\n   <artifactId>spigot-api</artifactId>\n   <version>1.12-R0.1-SNAPSHOT</version>\n   <scope>provided</scope>\n  </dependency>\n</dependencies>\n之后我们保存一下,然后Maven就会开始为我们下载所需jar包了\n\n 编写你的Maven项目  那么我们创建好了我们的Maven项目之后就要开始往里面写东西了\n和往常不同的是我们需要在\n  \"src/main/java\" 里面创建我们的包还有类\n\n\n  \"src/main/resource\" 里面存放我们的配置文件如plugin.yml或者config.yml\n\n\n剩下的我就不用多说了吧你们懂的=w=\n\n 构建你的Maven项目  那么我们已经写好了代码就应该开始构建我们的Maven项目了\n先在Eclipse左边的Package Explorer(包资源管理器)选中我们的项目\n\n\n之后点击运行按钮旁边的倒三角,然后我们选中其中的Maven Install之后Maven就会为我们开始构建了\n第一次构建可能会需要些时间请耐心等待(因为它要下那些构建jar包的东西)\n那么构建好之后控制台提示了 BUILD SUCCESS 是则构建成功!\n那么我们看target的时候有可能旁边没有一个箭头符号,不过不要紧我们只需要刷新该项目即可!\n刷新之后我们就可以看到构建好之后的jar包了\n\n之后我们丢入服务器看看效果:\n\n 结束 一些资源: \nSpigot的Nexus仓库Sponge的Maven配置\n\n那么教程就到这里结束了,如果有发现教程内有纰漏欢迎指出\n下面置顶帖有相关补充欢迎查看\n\n我要去看好康的了\n本教程完工于2017/7/27如需转载请站内PM\n\n",
    "replies": [
        {
            "author": "leavessoft",
            "timestamp": 1501132260,
            "txt_content": "hhh，从头到尾看了一遍，表示Java萌新不知道什么是Maven……"
        },
        {
            "author": "海螺螺",
            "timestamp": 1501132860,
            "txt_content": " 本帖最后由 754503921 于 2017-7-30 19:18 编辑 \n暴力续：1楼教程应一楼之意排的版\n为什么要使用 Maven 呢？\n因为如果你跟别人共享项目后，你 Pull 之后，另一个合作伙伴同步后必须全部更改所有的构建路径，除非你们两个的第三方 JAR 全部放在同一个路径，否则就全部是红线。（虽然可以写 .gitignore）\n因为如果你导入了什么第三方包，你的队友没有导入，可能他就会一脸懵逼，而使用 Maven 就可以自动下载。\n\n\n从普通项目转换到 Maven 项目或许有人看了莫老的教程，就要想了：我的项目开发这么久了，怎么还要新建项目，还要复制一遍源码，好麻烦，ETC。其实不用，你只需要使用“转换至 Maven 项目”功能即可！我拿这个废弃的项目作为例子：这是一个用 Eclipse 创建的中规中矩的 Java项目，没有 Maven。我们可以这样转换：然后会弹出这个界面：那么，按照一般的情况Group ID 写你的包名Artifact ID 写你的主类名Version 写的骚一点Name 随便写Description 可以学我\n当然其实这些东西可以乱写，因为构建编译的路径跟这些一点关系都没有。然后点击完成，就会弹出一些东西，你可能看不懂，但是不要惊慌，因为看得懂就不用我教了，而且我也看不懂。你的项目文件夹下应该出现了一个 pom.xml ，这个文件管理着你使用 Maven 的所有设置，你需要使用文本编辑器打开（而不是我也看不懂的 POM 编辑器）然后是一些不重要的项目配置设置，你不看说不定不能用 Maven1. 设置编码和编译器版本（重要）大部分的天朝系统的Eclipse会自动将编码设置为 GBK，所以你需要设置 encoding 项为 GBK（你也可以把你的项目设置为 UTF-8）有时你可能希望你的插件可以在 Java7 上使用，你需要将 target 和 source 更改为 1.72. 设置需要打包的文件你如果打包的话，你会发现你的 JAR 里没有 plugin.yml 这些东西所以我推荐你像这样添加几行，而不是自己手动往 JAR 里添加<resources>\n                <resource>\n                        <targetPath>.</targetPath>  <!-- 输出到 Jar 文件的地址 -->\n                        <directory>${basedir}/resource/</directory>  <!-- 资源文件的文件夹 -->\n                </resource>\n        </resources>复制代码\n\n\n导入 Dependency先看一楼，结构大概是这样的\n\n插入新的 Repository 和新的 Dependency，只需要在\n<repositories>\n</repositories>复制代码和\n<dependencies>\n</dependencies>复制代码中间添加即可。\n点击保存全部，等待 Eclipse 下载所需的库（很慢的，看网，要耐心）\n我在这里提供一些常用的导入\n\nSpigot / CraftBukkit 各个版本\n<repository>\n                        <id>spigot-repo</id>\n                        <url>https://hub.spigotmc.org/nexus/content/groups/public/</url>\n                </repository>复制代码<!--Spigot API-->\n                <dependency>\n                        <groupId>org.spigotmc</groupId>\n                        <artifactId>spigot-api</artifactId>\n                        <version>1.8.8-R0.1-SNAPSHOT</version>\n                </dependency>\n                <!--Bukkit API-->\n                <dependency>\n                        <groupId>org.bukkit</groupId>\n                        <artifactId>bukkit</artifactId>\n                        <version>1.8.8-R0.1-SNAPSHOT</version>\n                </dependency>复制代码Vault\n        <repository>\n                <id>vault-repo</id>\n                <url>http://nexus.hc.to/content/repositories/pub_releases</url>\n        </repository>复制代码  <!--Vault API-->\n        <dependency>\n            <groupId>net.milkbowl.vault</groupId>\n            <artifactId>VaultAPI</artifactId>\n            <version>1.6</version>\n            <scope>provided</scope>\n        </dependency>复制代码PlayerPoints API\n  <repository>\n                        <id>dakani</id>\n                        <name>Dakani Nexus Repo</name>\n                        <url>https://repo.dakanilabs.com/repository/public/</url>\n                </repository>复制代码  <!--PlayerPoints API-->\n                <dependency>\n                        <groupId>org.black_ixx</groupId>\n                        <artifactId>PlayerPoints</artifactId>\n                        <version>2.1.3</version>\n                </dependency>复制代码BungeeCord API\n        <repository>\n            <id>bungeecord-repo</id>\n            <url>https://oss.sonatype.org/content/repositories/snapshots</url>\n        </repository>复制代码        <dependency>\n            <groupId>net.md-5</groupId>\n            <artifactId>bungeecord-api</artifactId>\n            <version>1.7-SNAPSHOT</version>\n            <type>jar</type>\n            <scope>provided</scope>\n        </dependency>复制代码\n\n\n构建你的 JAR 文件你可以学习1楼的做法，但你也可以前往项目的目录，使用这个命令：\nmvn clean install package复制代码然后去 target 文件夹翻找。\n至于为啥你不能用 mvn 命令，百度呗\n\n\nMaven Shade 插件如果你使用了第三方包，发现打包完了这些包也丢了，是不是很气。\n所以你需要 Maven shade 插件\n我们假设你使用了 lombok 和 asm，你需要添加导入（自己百度去）\n然后在你的 pom.xml 的 plugins 块添加以下信息\n<plugin>\n<groupId>org.apache.maven.plugins</groupId>\n<artifactId>maven-shade-plugin</artifactId>\n<version>3.0.0</version>\n<executions>\n<execution>\n<phase>package</phase>\n<goals>\n<goal>shade</goal>\n</goals>\n<configuration>\n<artifactSet>\n<includes>\n<include>org.projectlombok</include>\n</includes>\n</artifactSet>\n<createDependencyReducedPom>false</createDependencyReducedPom>\n</configuration>\n</execution>\n</executions>\n</plugin>复制代码仔细观察，你会发现里面的\n<artifactSet>\n<includes>\n<include>org.projectlombok</include>\n</includes>\n</artifactSet>复制代码而这个 org.projectlombok 就是 lombok 的 groupID\n并且 shade 插件会自动打包这个的前置 dependency，因为 lombok 是基于 ASM 的，所以这样做也会将 ASM 一同打包。\n但是这样子打包会很大一个 JAR 就是了（Class50 是 lombok 的一个包）\n\n\n\n添加本地 Repository因为从Maven获得的BukkitAPI是没有 NMS 的，所以你需要添加一个本地的仓库。\n<dependency>\n      <groupId>org.bukkit</groupId>\n      <artifactId>bukkit</artifactId>\n      <version>1.0</version>\n      <scope>system</scope>\n      <systemPath>${project.basedir}/lib/bukkit.jar</systemPath>\n    </dependency>复制代码"
        },
        {
            "author": "936796603",
            "timestamp": 1502116440,
            "txt_content": "很毒瘤的教程嘛"
        },
        {
            "author": "筱柒儿",
            "timestamp": 1547505540,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "Tcaks_NB",
            "timestamp": 1561908120,
            "txt_content": "感到中国，这个是真的有用。"
        },
        {
            "author": "1313啊啊啊",
            "timestamp": 1561913580,
            "txt_content": "什么?_?东东老子学了一年Java了居然一个字也看不懂"
        },
        {
            "author": "mcpanglei",
            "timestamp": 1562000640,
            "txt_content": "马文，自己写插件是不是就算了"
        },
        {
            "author": "15251827082",
            "timestamp": 1574152920,
            "txt_content": "可以的谢谢"
        },
        {
            "author": "肆火",
            "timestamp": 1585439340,
            "txt_content": "mcpanglei 发表于 2019-7-2 01:04\n马文，自己写插件是不是就算了\n你要是开源插件的话，用上更好一些。"
        }
    ]
}