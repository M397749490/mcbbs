{
    "title": "如何判断玩家是否可以放置某个方块",
    "author": "SuperHaopp",
    "replyCount": 7,
    "timestamp": 1585904700,
    "txt_content": "如题，我希望在玩家点击某个方块的时候 在该点生成一个小建筑（可以理解为N个方块）\n但是我害怕这n个方块在别人的领地或者别人的地皮内 （参考res和plotme插件）\n那么 怎么判断玩家在某个Location上有权限放置方块呢\n\n\n求助！\n\n",
    "replies": [
        {
            "author": "GiNYAi",
            "timestamp": 1585907160,
            "txt_content": "你可以创建放置方块的事件 然后检查事件 提交之后是否被取消"
        },
        {
            "author": "EmptyIrony",
            "timestamp": 1586011140,
            "txt_content": "如果这个生成建筑插件是你自己写的，你可以尝试生成建筑的监听器的EventHandler注解中加入ignoreCancelled = true，并且适当提高监听器优先级别，例如priority = EventPriority.HIGHEST\n这样可以判断如果放方块事件被领地之类的插件取消后不再调用这个生成建筑的监听方法\n注解类似这样\n@EventHandler(priority = EventPriority.HIGHEST,ignoreCancelled = true)复制代码"
        },
        {
            "author": "EmptyIrony",
            "timestamp": 1586011200,
            "txt_content": "如果这个生成建筑插件是你自己写的，你可以尝试生成建筑的监听器的EventHandler注解中加入ignoreCancelled = true，并且适当提高监听器优先级别，例如priority = EventPriority.HIGHEST\n这样可以判断如果放方块事件被领地之类的插件取消后不再调用这个生成建筑的监听方法\n注解类似这样\n@EventHandler(priority = EventPriority.HIGHEST,ignoreCancelled = true)复制代码"
        },
        {
            "author": "SuperHaopp",
            "timestamp": 1586017260,
            "txt_content": "EmptyIrony 发表于 2020-4-4 22:40\n如果这个生成建筑插件是你自己写的，你可以尝试生成建筑的监听器的EventHandler注解中加入ignoreCancelled  ...\n可我想的是 生成这一片建筑 跟放置的位置是不同的Location\n\n如果他在别人领地的旁边放 正好这个建筑足够大 然后进入到了别人的领地 \n这是我担心的一个问题"
        },
        {
            "author": "EmptyIrony",
            "timestamp": 1586056080,
            "txt_content": "SuperHaopp 发表于 2020-4-5 00:21\n可我想的是 生成这一片建筑 跟放置的位置是不同的Location\n\n如果他在别人领地的旁边放 正好这个建筑足够 ...\n如果事件被取消了，并且生成建筑的函数加了ignoreCancelled，那就不会走生成建筑的那个函数，自然也不会生成"
        },
        {
            "author": "SuperHaopp",
            "timestamp": 1586065320,
            "txt_content": "EmptyIrony 发表于 2020-4-5 11:08\n如果事件被取消了，并且生成建筑的函数加了ignoreCancelled，那就不会走生成建筑的那个函数，自然也不会 ...\n我不太懂您的意思\n我的意思是有可能没有被取消 但是生成的建筑过大以至于进入别人的领地\n\n如图\n\n\n"
        },
        {
            "author": "EmptyIrony",
            "timestamp": 1586134560,
            "txt_content": "SuperHaopp 发表于 2020-4-5 13:42\n我不太懂您的意思\n我的意思是有可能没有被取消 但是生成的建筑过大以至于进入别人的领地\n这样子的话可能需要hook相关插件来进行判断了\n例如WorldGuard:\nWGUtils.worldGuard.canBuild(p, location);复制代码\n\n或者如沙发所说，去创建一个BlockPlaceEvent，并call。然后看这个事件是否被取消，不过这样的话我也不确定会不会出什么问题\n如果不嫌麻烦的话还是去hook好一点"
        }
    ]
}