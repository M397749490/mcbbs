{
    "title": "教你如何搭建一个自己的正版验证服务器",
    "author": "xenoxue",
    "replyCount": 16,
    "timestamp": 1391527740,
    "txt_content": " 本帖最后由 xenoxue 于 2014-2-4 23:30 编辑 \n\n本人技术基本为0。。 各位高手少喷。\n\n提示：本教材仅限1.7以下版本。因为1.7以上版本采用了新的验证机制。所以破解难度也比较高。目前本人还在慢慢研究中。\n\n最近本人正在研究如何搭建一个反作弊服务器。。到后来觉得可以利用minecraft自带的正版验证机制来判断用户是否正在使用指定的客户端。\n\n然后就发现在不知不觉中1.7以下的正版验证机制已经可以被我利用了。。\n\n首先这里提供一个可行的反作弊验证思路：http://www.mcbbs.net/thread-220983-1-1.html\n\n简单的说就是自己做一个启动器，然后建立文件白名单/黑名单，每次启动前验证一下文件，如果发现有可以作弊的文件就删除/无法启动。 比如透明材质，寻矿mod等等。\n\n然后在这里我教你们怎么搭建一个自己的正版验证服务器。。\n\n1、修改服务器上的hosts文件(请百度如何修改)将以下2个域名指向到本地127.0.0.1\nlogin.minecraft.net\nsession.minecraft.net\n2、在本地架设一个jsp的http+https网页服务（具体方法请百度）。本人建议使用tomcat。简单易用，tomcat的https开启方法也比较简单，还是自行百度吧。\n3、建立3个文件分别在 ./index.jsp，./game/joinserver.jsp和，./game/checkserver.jsp\n4、当有用户登录服务器的时候他们的客户端会访问index.jsp文件。该文件会反馈回来的参数格式为：未知用途的数字:deprecated:用户名:accessToken:uuid复制代码而服务器端会访问其余2个文件。\n当./game/joinserver.jsp返回OK复制代码的时候表示用户成功加入服务器。\n./game/checkserver.jsp则会返回YES复制代码那么我们只要将那3个文件都设置成以上数据，那么所有用户就都可以通过验证了。\n\n是不是觉得非常简单啊？那就赶紧先试试吧！随便开一个1.5.2的服务器，开启正版验证，然后再按照上面3个步骤，你就会发现已经可以随意登录这个服务器了。\n\n不对啊。如果按照上面几个步骤，直接关闭正版验证不就行了嘛。没有任何区别啊。。\n呵呵。上面只是基础，下面才是进阶操作。\n\n第一步我们先来做个简单的验证，我们把joinserver.jsp的内容改为：（使用ANSI编码）<% request.setCharacterEncoding(\"utf8\");\nString user = request.getParameter(\"user\");\nif(user.equals(\"111\") )\n{\nout.println(\"OK\");\n}\nelse\n{\nout.println(\"不是正版无法登录哦！\");\n}%>复制代码然后再登录服务器。 你会发现只有ID为：111 的人才可以通过正版验证了。\n\n根据上面的实验表明，其实整个验证过程基本上都是在joinserver.jsp这里来完成的。\n那么我们来看看每次服务器发送了哪些信息到这个页面。http://session.minecraft.net/game/joinserver.jsp?user=用户名ID&sessionId=验证码&serverId=1复制代码看到上面这段我们就很轻易的明白，joinserver.jsp的全部用处了。。\n服务器会根据用户的信息，发送用户的ID和验证码还有服务器ID到这个页面。然后由这个页面的java脚本进行判断。如果合法则返回OK。如果非法则返回错误信息。\n用户ID 这个很简单，就是玩家使用的ID， 验证码 其实就是一个很神奇的东西了。有自己写过启动器的朋友估计都知道那里有一个参数叫做auth_session。 这个就是所谓的验证码了。事实上服务器也只验证这2个参数，如果符合就代表验证通过了。 最后的服务器ID比较复杂些，个人是觉得基本也用不到，就不细说了。\n\n好了。到现在我们已经完整的了解了整个验证过程，懂java的朋友应该可以很轻易的搞定接下来的步骤了把！\n那么为了避免一些误会，完整的验证代码我就不写出来了。大家自己搞定吧！\n\n最后附上1.7的验证机制简介：\n \n实际上1.7的验证机制还是差不多，只是传递参数的方法从明文改为 json文件了。本质上是没有任何区别了。\n唯一的难度就是需要写一段分析json的代码。不巧本人不是太熟悉这些玩意儿，所以就没什么进展了。如果有兴趣的朋友可以站内短信我。\n我会分享自己的发现，也希望有朋友可以来帮助我破解掉1.7的验证机制。\n",
    "replies": [
        {
            "author": "我被盗号了",
            "timestamp": 1391527920,
            "txt_content": "好评，等我回家去慢慢实验，mark一下"
        },
        {
            "author": "阿恰哟，",
            "timestamp": 1391527980,
            "txt_content": "{:10_514:}看到这么多的字体我就头晕宁可不开了- -"
        },
        {
            "author": "额无语",
            "timestamp": 1391528040,
            "txt_content": "服务器正版验证？直接弄server.properties里的online-mode=true不就行了吗？"
        },
        {
            "author": "脑残xx",
            "timestamp": 1391528220,
            "txt_content": "完全看不懂"
        },
        {
            "author": "xenoxue",
            "timestamp": 1391528400,
            "txt_content": "额无语 发表于 2014-2-4 23:34\n服务器正版验证？直接弄server.properties里的online-mode=true不就行了吗？\n不一样哦。。 你那个是关闭正版验证。。\n我这个是开启正版验证的。。\n只是说把正版验证的服务器改成自己的。 然后只有在你这里注册的人才可以进入游戏。\n比如和自己的论坛绑定，注册论坛的人才可以登录服务器。\n相比来说比那些利用启动器验证的服务器来说更加安全。。"
        },
        {
            "author": "额无语",
            "timestamp": 1391528520,
            "txt_content": "xenoxue 发表于 2014-2-4 23:40\n不一样哦。。 你那个是关闭正版验证。。\n我这个是开启正版验证的。。\n只是说把正版验证的服务器改成自己 ...\n知道了，但是教程一点都不懂......"
        },
        {
            "author": "xenoxue",
            "timestamp": 1391529120,
            "txt_content": "额无语 发表于 2014-2-4 23:42\n知道了，但是教程一点都不懂......\n需要一定的网站建设基础嘛。。\n其实还是很简单的。。百度一下。问朋友一下就搞定了。"
        },
        {
            "author": "小浚jim",
            "timestamp": 1391529240,
            "txt_content": "好复杂呀= ="
        },
        {
            "author": "619405934",
            "timestamp": 1391578080,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "吾是新手渣渣",
            "timestamp": 1391584440,
            "txt_content": "慢慢实验ing"
        },
        {
            "author": "xenoxue",
            "timestamp": 1391612640,
            "txt_content": "就没人考虑给我加个分什么的嘛。。。\n我想找点Lv6啊。。。"
        },
        {
            "author": "l26107",
            "timestamp": 1392297000,
            "txt_content": "xenoxue 发表于 2014-2-5 23:04\n就没人考虑给我加个分什么的嘛。。。\n我想找点Lv6啊。。。\n表示很感兴趣,是否可以取得完整代码呢?可私信我..."
        },
        {
            "author": "officeyutong",
            "timestamp": 1392345780,
            "txt_content": "xenoxue 发表于 2014-2-4 23:52\n需要一定的网站建设基础嘛。。\n其实还是很简单的。。百度一下。问朋友一下就搞定了。 ...\n楼主可否发一下完整代码？"
        },
        {
            "author": "ObscurePanda",
            "timestamp": 1392972840,
            "txt_content": "很有想法.通过jsp实现插件的功能."
        },
        {
            "author": "DummyC0m",
            "timestamp": 1394701080,
            "txt_content": "可能挖坟了，但是还是赞一个！非常好的想法，支持楼主接下来的开发。"
        },
        {
            "author": "xpesir",
            "timestamp": 1434907920,
            "txt_content": "{:10_499:}挖坟。客户端的也要改！另外告诉你下整个系统我已经搭建好了就一直卡在客户端一个文件上 简直头疼"
        }
    ]
}