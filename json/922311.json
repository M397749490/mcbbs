{
    "title": "【bukkit】如何检测刷石机刷石？",
    "author": "mc能吃吗",
    "replyCount": 2,
    "timestamp": 1572056760,
    "txt_content": "如题。试过BlockFormEvent 但是完全没用 就是连事件都不触发\n版本Paper-209 1.14\n我看过其他插件 用的都是BlockFormToEvent 但是看不懂具体怎么操作\n能解释一下嘛。。。\n这里提供插件源码\npackage qq2159116373;\n\n\nimport java.io.File;\n\nimport org.bukkit.Material;\nimport org.bukkit.block.Block;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.BlockFormEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class SK extends JavaPlugin implements Listener {\n\n    @Override\n    public void onEnable() {\n        super.onEnable();\n        \n        if(!getDataFolder().exists()) \n        {\n        getDataFolder().mkdir();\n        }\n        File file=new File(getDataFolder(),\"config.yml\");\n        if (!(file.exists())) {saveDefaultConfig();}\n        reloadConfig();\n        getLogger().info(\"插件已加载，by mo_java30433\");\n        getLogger().info(\"当前版本0.0.1\");\n        getServer().getPluginManager().registerEvents(this, this);\n        if (true == this.getConfig().getBoolean(\"debug\")) {\n            getLogger().info(\"debug状态:开启\");\n        }\n\n    }\n\n    @Override\n    public void onDisable() {\n        getLogger().info(\"插件已关闭，by mo_java30433\");\n    }\n\n    @EventHandler()\n    public void mo(BlockFormEvent e) {\n        if (true == this.getConfig().getBoolean(\"debug\")) {\n            getLogger().info(\"成功触发事件\");\n        }\n        Block b = e.getBlock();\n        Material bm = b.getType();\n        \n        if (bm == Material.COBBLESTONE || bm == Material.STONE) {\n            \n            if (true == this.getConfig().getBoolean(\"debug\")) {\n                getLogger().info(\"成功判断方块\");\n            }\n            \n            \n            if (e.getBlock().getLocation().getWorld().getName().equalsIgnoreCase(\"bskyblock_world\")) {\n                if (true == this.getConfig().getBoolean(\"debug\")) {\n                    getLogger().info(\"正确的世界\");\n                }\n                double r = (double)(1.0+Math.random()*(100.0-1+1));\n                //1\n                if (r <= 12.0 && r > 0.0) {\n                    b.setType(Material.COAL_ORE);\n                    return;\n                }\n                //2\n                if (r <= 12.5 && r > 12.0) {\n                    b.setType(Material.DIAMOND_ORE);\n                    return;\n                }\n                //3\n                if (r <= 13.0 && r > 12.5) {\n                    b.setType(Material.EMERALD_ORE);\n                    return;\n                }\n                //4\n                if (r <= 15.0 && r > 13.0) {\n                    b.setType(Material.GOLD_ORE);\n                    return;\n                }\n                //5\n                if (r <= 23.0 && r > 15.0) {\n                    b.setType(Material.IRON_ORE);\n                    return;\n                }\n                //6\n                if (r <= 24.0 && r > 23.0) {\n                    b.setType(Material.LAPIS_ORE);\n                    return;\n                }\n                //7\n                if (r <= 25.0 && r > 24.0) {\n                    b.setType(Material.REDSTONE_ORE);\n                    return;\n                }\n                //8\n                if (r <= 25.1 && r > 25.0) {\n                    b.setType(Material.OBSIDIAN);\n                    return;\n                }\n                //end\n                if (r <= 100 && r > 25.1) {\n                    return;\n                }\n                \n            }\n            \n            if (e.getBlock().getLocation().getWorld().getName().equalsIgnoreCase(\"bskyblock_world_nether\")) {\n                \n                if (true == this.getConfig().getBoolean(\"debug\")) {\n                    getLogger().info(\"正确的世界\");\n                }\n                \n                double r = (double)(1.0+Math.random()*(100.0-1+1));\n                //1\n                if (r <= 3.0 && r > 0.0) {\n                    b.setType(Material.QUARTZ_ORE);\n                    return;\n                }\n                //2\n                if (r <= 6.0 && r > 3.0) {\n                    b.setType(Material.GLOWSTONE);\n                    return;\n                }\n                //3\n                if (r <= 7.0 && r > 6.0) {\n                    b.setType(Material.SOUL_SAND);\n                    return;\n                }\n                //4\n                if (r <= 100.0 && r > 7.0) {\n                    b.setType(Material.NETHERRACK);\n                    return;\n                }\n                \n            }\n            \n            if (e.getBlock().getLocation().getWorld().getName().equalsIgnoreCase(\"bskyblock_world_the_end\")) {\n                \n                if (true == this.getConfig().getBoolean(\"debug\")) {\n                    getLogger().info(\"正确的世界\");\n                }\n        \n                b.setType(Material.QUARTZ_ORE);\n                return;\n            }\n        }\n    }\n}\n\n\n复制代码\n\n",
    "replies": [
        {
            "author": "1378495772",
            "timestamp": 1572060480,
            "txt_content": " 本帖最后由 1378495772 于 2019-10-26 11:30 编辑 \n@EventHandler\npublic void onFromTo(BlockFromToEvent event)\n{\n    int id = event.getBlock().getTypeId();\n    if(id >= 8 && id <= 11)\n    {\n        Block b = event.getToBlock();\n        int toid = b.getTypeId();\n        if(toid == 0)\n        {\n            if(generatesCobble(id, b))\n            {\n                event.setCancelled(true);\n            }\n        }\n    }\n}\n \nprivate final BlockFace[] faces = new BlockFace[]\n    {\n        BlockFace.SELF,\n        BlockFace.UP,\n        BlockFace.DOWN,\n        BlockFace.NORTH,\n        BlockFace.EAST,\n        BlockFace.SOUTH,\n        BlockFace.WEST\n    };\n \npublic boolean generatesCobble(int id, Block b)\n{\n    int mirrorID1 = (id == 8 || id == 9 ? 10 : 8);\n    int mirrorID2 = (id == 8 || id == 9 ? 11 : 9);\n    for(BlockFace face : faces)\n    {\n        Block r = b.getRelative(face, 1);\n        if(r.getTypeId() == mirrorID1 || r.getTypeId() == mirrorID2)\n        {\n            return true;\n        }\n    }\n    return false;\n}复制代码以上代码来源于： https://bukkit.org/threads/blocking-cobblestone-generators.120924/#post-1490274\n\n你可以参考本插件源码：\nhttps://www.spigotmc.org/resources/customoregen.9532/\n\n\n\n\nimage.png (71.07 KB, 下载次数: 0)\n\n下载附件\n\n2019-10-26 11:28 上传\n\n\n\n\n\n"
        },
        {
            "author": "mc能吃吗",
            "timestamp": 1572063120,
            "txt_content": "1378495772 发表于 2019-10-26 11:28\n以上代码来源于： https://bukkit.org/threads/blocking-cobblestone-generators.120924/#post-1490274\n\n你 ...\n谢谢，已经自行解决了"
        }
    ]
}