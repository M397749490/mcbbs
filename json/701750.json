{
    "title": "[PCD]教你尽可能还原Allatori混淆的插件",
    "author": "弱鸡绿毛怪",
    "replyCount": 2,
    "timestamp": 1498807920,
    "txt_content": " 本帖最后由 MagicLocyDragon 于 2017-6-30 15:34 编辑 \n嘛上次发了个Allatori的混淆教程，这次就发一个反混淆Allatori混淆过的插件，注意是插件哈，并不是mod~顺便说一句，以下都是我自己研究出来的结果，希望大家不要喷蛤~\n准备工具:\n1.学过反射\n2.FernFlower (下面会给出下载地址)\n3.一只滑稽\n\n\n一、反代码混淆\n\n\n首先拿我以前做过的一个某的插件开刀吧，用Jdgui反编译那个插件\n\n\n\n\n\n1.png (20.67 KB, 下载次数: 14)\n\n下载附件\n\n2017-6-30 15:12 上传\n\n\n\n\n\n\n可见混淆得非常糟糕，这就是我这次不用jdgui的原因，我们需要用FernFlower来反编译:\n下载地址:\n\n\n\n\nfernflower.jar\n(239.62 KB, 下载次数: 235)\n\n\n\n2017-6-30 15:13 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\n然后把cmd打开，假设我把插件和FernFlower都放在了C盘底下就在cmd里面输入如下指令:\njava -jar C://fernflower.jar C://你的插件名.jar C://输出绝对路径\n按下回车键开始反编译jar，之后再找到输出在你输出路径文件夹里面的那个jar，用zip打开，可以看见后缀.class的文件已经全部反编译成后缀名为.java的文件了，取出来，再把里面的代码全部复制进你的IDE里面，进行第二次修改\n\n\n找到onEnable里面注册事件的地方(registerEvents)，可能是这样子的:\nBukkit.getPluginManager().registerEvents(a, a);\n这个a肯定得报错，说明a就是主类咯，把这里的a全部换成this，把代码中的所有a.全部去掉，比如说  a.reloadConfig(); 改成 reloadConfig(); 特殊情况看情况来改\n\n你的类里面可能会出现ALLATORIxDEMO，是混淆一些字符的，先把名字为这种的方法全部删掉，目前我还没有找到能更好地破解这个混淆的办法，只能通过反射\n\n\n二、反字符串混淆\n比如说代码里面出现了这种 \nTransApi.ALLATORIxDEMO(\"旯沱扱剔l\u000ba\u0002f\u0003!\u001db\\b#欇圧剿廵\")\n那么就把你要反混淆的插件先放在服务器的plugins里面等待加载，然后再另外写一个类来反射这个方法比如说:import java.lang.reflect.InvocationTargetException;import java.lang.reflect.Method;\nimport org.bukkit.event.Listener;import org.bukkit.plugin.java.JavaPlugin;\nimport com.baidu.translate.demo.TransApi;\npublic class Main extends JavaPlugin implements Listener{@Overridepublic void onEnable(){        Thread t = new Thread(new Runnable(){                @Override                public void run(){                        try {                                Thread.sleep(10000);                        } catch (InterruptedException e1) {                                // TODO 自动生成的 catch 块                                e1.printStackTrace();                        }        try {                System.out.println(\"[Car]\"+ALLATORIxDEMO(\"旯沱扱剔l\u000ba\u0002f\u0003!\u001db\\b#欇圧剿廵\"));        } catch (ClassNotFoundException e) {                // TODO 自动生成的 catch 块                e.printStackTrace();        } catch (IllegalAccessException e) {                // TODO 自动生成的 catch 块                e.printStackTrace();        } catch (IllegalArgumentException e) {                // TODO 自动生成的 catch 块                e.printStackTrace();        } catch (InvocationTargetException e) {                // TODO 自动生成的 catch 块                e.printStackTrace();        } catch (InstantiationException e) {                // TODO 自动生成的 catch 块                e.printStackTrace();        }                }        });        t.start();}public static String ALLATORIxDEMO(String a) throws ClassNotFoundException, IllegalAccessException, IllegalArgumentException, InvocationTargetException, InstantiationException {    Class<?>  c = Class.forName(\"com.baidu.translate.demo.TransApi\");       Method[] m2 = c.getDeclaredMethods();    for(Method m : m2){    if(m.getName().equalsIgnoreCase(\"ALLATORIxDEMO\")){    m.setAccessible(true);    return (String) m.invoke(new TransApi(null,null),a);    }    }    return null;           }}\n然后放在服务器里面与你要反混淆的插件一并加载，就可以看到:\n\n\n\n\n\n1.png (924 Bytes, 下载次数: 8)\n\n下载附件\n\n2017-6-30 15:31 上传\n\n\n\n\n，原来\"旯沱扱剔l\u000ba\u0002f\u0003!\u001db\\b#欇圧剿廵\"的意思就是\"无法找到config.yml正在创建\" 成功地反混淆了字符串\n\n\n以上方法略渣，纯属自己研究出来的，只是想和大家分享一下而已233，如果有更好的方法欢迎在下面提出来，顺便我也学习学习\n\n\n[groupid=1330]PluginsCDTribe[/groupid]",
    "replies": [
        {
            "author": "780121zm",
            "timestamp": 1577174160,
            "txt_content": "内个，mod可以吗"
        },
        {
            "author": "mih9999",
            "timestamp": 1577324580,
            "txt_content": "用deobfuscator反混淆更舒服。虽然也需要自行修改多出来的一些注释。值得一提的是，这个在反编译的时候会输出那些被加密的字符，需要用BAT写一个输出，把字符输出到目录里。"
        }
    ]
}