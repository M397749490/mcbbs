{
    "title": "1.12 catserver用spawnarrow产生的箭的朝向乱七八糟的怎么办，如何检测玩家拉弓时长？",
    "author": "aa0307bb",
    "replyCount": 7,
    "timestamp": 1593961380,
    "txt_content": " 本帖最后由 aa0307bb 于 2020-7-5 23:47 编辑 \n\n①\nArrow arrow = loc.getWorld().spawnArrow(loc.add(dir.multiply(0.8)) , dir, 0.6F , 120);复制代码其中loc是玩家的位置射出来的箭朝向以及速度是乱的\n如果用arrow.setVelocity()，它虽然速度对了，但是箭头朝向还是错的\n②\n试过用PlayerInteractEvent（是拉弓只能触发一次）以及EntityShootEvent（弓射出去才能触发）\n而且查过似乎没有API能检测玩家是否正在拉弓，只有射弓的时候才会有\n",
    "replies": [
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593967320,
            "txt_content": "1. 尝试采用\nPlayer#launchProjectile​复制代码\n\nspawnArrow产生的arrow会计算碰撞导致方向偏差\nlaunchProjectile的arrow会忽略执行player的碰撞箱\n\n2. PlayerItemHeldEvent"
        },
        {
            "author": "aa0307bb",
            "timestamp": 1593971820,
            "txt_content": "疾风暗影 发表于 2020-7-6 00:42\n1. 尝试采用\n1.spawnArrow产生的arrow会计算碰撞\n谢谢，成功了\n问一下，为什么会“碰撞”（我的箭在发出去的那个瞬间并没有碰到任何东西呀？）\n\n2.\n我测试了一下，PlayerItemHeldEvent似乎只能监听玩家快捷栏切换，不能监听玩家拉弓拉了多久"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593972180,
            "txt_content": "aa0307bb 发表于 2020-7-6 01:57\n1.\n谢谢，成功了\n问一下，为什么会“碰撞”（我的箭在发出去的那个瞬间并没有碰到任何东西呀？）\n1. 老历史遗留\n箭头会不断跟自己碰撞，所以射出的箭在水中有气泡柱\n跟放箭时切换掠夺会触发效果类似\n\n2. https://bukkit.org/threads/cheat ... drawing-bow.328762/"
        },
        {
            "author": "aa0307bb",
            "timestamp": 1593973320,
            "txt_content": "疾风暗影 发表于 2020-7-6 02:03\n1. 老历史遗留\n箭头会不断跟自己碰撞，所以射出的箭在水中有气泡柱\n跟放箭时切换掠夺会触发效果类似\nhttps://bukkit.org/threads/cheat ... drawing-bow.328762/\n看到眼花了，那个楼主写的东西又被楼下的反驳了..\n要看哪层楼，大致原理都没看懂……"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593973440,
            "txt_content": "aa0307bb 发表于 2020-7-6 02:22\nhttps://bukkit.org/threads/cheat ... drawing-bow.328762/\n看到眼花了，那个楼主写的东西又被楼下的反 ...\n看 思 路\n\n楼下的争论只是要用uuid以及用Map代替List"
        },
        {
            "author": "aa0307bb",
            "timestamp": 1593974700,
            "txt_content": "疾风暗影 发表于 2020-7-6 02:24\n看 思 路\n\n楼下的争论只是要用uuid以及用Map代替List\n行吧，看起来就是\n如果玩家右键了弓，那就名字放进Set\n如果玩家射出了弓或者更改了物品栏，那就名字移出Set\n然后封装成一个isDrawing()函数就可以知道某个时刻要知道玩家在不在拉弓（就看Set里面有没有玩家名字就行了）\n然后再搭配一个1tick每秒的线程去检查玩家是否在拉弓，就可以检测玩家拉弓拉了多久"
        },
        {
            "author": "aa0307bb",
            "timestamp": 1594045440,
            "txt_content": "疾风暗影 发表于 2020-7-6 02:03\n1. 老历史遗留\n箭头会不断跟自己碰撞，所以射出的箭在水中有气泡柱\n跟放箭时切换掠夺会触发效果类似\n但是= =如果玩家只是点一下弓就不拉了，这样还是会视作他在拉弓啊\n甚至现在不知道什么原因，就算一直点着右键不松开，拉弓的动画都不显示了（？"
        }
    ]
}