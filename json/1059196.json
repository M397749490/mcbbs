{
    "title": "反编译模组的一点经验分享",
    "author": "Eric12324",
    "replyCount": 6,
    "timestamp": 1591702140,
    "txt_content": "最近碰到一个附属模组跟主模组的最新版本不兼容的问题，但是附属作者模组并没有公开源码并且已经差不多两年没更新过了，因此决定自己反编译附属模组然后改改代码来实现兼容。在论坛也看到有人在问类似的问题，就分享一下自己使用的方法，不一定是最好的，但至少对我来说是管用的，大佬勿喷。\n1. 使用 BON2 进行反混淆 \n\n如果直接使用反编译工具，你会发现部分method和field的名称是这样的：\n\n\n\n\n\n1.png (13.1 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-9 18:13 上传\n\n\n\n\n\n\n\n所以第一步是反混淆，这里已经有大佬开发了现成的工具，直接使用就可\n先下载BON2 \n双击运行下载下来的 BON-2.4.0.15-all.jar\n\n\n\n\n\n2.png (21.76 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-9 18:55 上传\n\n\n\n\n\n\n\n对于1.12.2的模组，你只需要在Input JAR 那里用browse按钮选择好你要反混淆的JAR文件，然后点Go就可\n运行完成后，如果你没有手动改Output Jar，你会在反混淆的那个Jar文件的目录下找到 模组名称-deobf.jar这样一个Jar文件\n这个Jar文件已经经过了反混淆，但是还没有经过反编译\n\n2. 反编译\n\n反编译的工具很多，你可以自行选择，我这里使用Intellij自带的Java-decompiler来进行操作，但它其实是基于fernflower的，具体细节大家可以自己搜一下\n\n\n如果你安装了Intellij，你可在在这里找到这个Jar文件\nC:\\Program Files\\JetBrains\\IntelliJ IDEA 2019.3.1\\plugins\\java-decompiler\\lib\n\n该文件夹下面有一个java-decompiler.jar，复制一份将其和刚刚反混淆好的模组文件放在一个单独的文件夹\n\n\n\n\n3.png (15.71 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-9 19:08 上传\n\n\n\n\n\n\nCMD到这个文件夹，执行指令\njava -cp java-decompiler.jar \"org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler\" -dgs=true test-deobf.jar data\n\n\n然后打开data文件夹，这里会有一个Jar文件，这个时候你就可以用解压软件打开打，里面已经全部是反编译并且反混淆好的java文件了\n\n\n\n\n4.png (15.88 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-9 19:13 上传\n\n\n\n\n\n\n\n\n3. 重新编译\n\n要重新编译的话，你需要注意以下几点：\n\n- 作者当时编译所使用的forge版本，例如18年的forge跟现在的forge，有个别方法是有改动的，在编译不成功时，你应当检查自己是否使用了比原作者编译时更新或更老的forge版本\n\n- 配置依赖，你需要注意作者使用了那些依赖，对于附属模组，如果是为了兼容新版本主模组，那就要用新版本的主模组做依赖，同时最重要的一点是，在使用本地jar文件做依赖时，一定要使用dev版本的（比如工业2的编译还会有一个dev版本），你不能直接使用放在游戏里那个jar文件，因为那个jar文件里的方法名也是混淆过的，一定是编译不出来的\n\n\n\n\n5.png (28.12 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-9 19:22 上传\n\n\n\n\n\n\n\n- 把代码放到forge的mdk包里去编译的时候，要记得改build.gradle和其他文件里面的组名，modid等等，如果不改，对不上的话编译出来也无法正常用\n\n暂时就想到这么多，如果有不对的地方欢迎大家指正，另外反编译的时候请大家留意模组的LICENSE，没有得到许可的情况不要随意发布\n[groupid=1680]Power of Spongie[/groupid]",
    "replies": [
        {
            "author": "Hueihuea",
            "timestamp": 1591703160,
            "txt_content": "推荐俩个玩意\nhttps://github.com/octarine-noise/simpledeobf 一个简单好用的命令行反混淆器\nhttps://github.com/KevinPriv/Luyten4Forge 一个自带反混淆的反编译器"
        },
        {
            "author": "Eric12324",
            "timestamp": 1591704060,
            "txt_content": "Hueihuea 发表于 2020-6-9 19:46\n推荐俩个玩意\nhttps://github.com/octarine-noise/simpledeobf 一个简单好用的命令行反混淆器\nhttps://gith ...\n第一个我试过，反编译结果不对，我从作者原贴下2019年更新的版本的，不知道是什么问题，他替换之后的方法名只换了半截"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1591704600,
            "txt_content": "还有反混淆工具？\n我第一次知道，长知识。\n该膜了。"
        },
        {
            "author": "Hueihuea",
            "timestamp": 1591705920,
            "txt_content": "Eric12324 发表于 2020-6-9 20:01\n第一个我试过，反编译结果不对，我从作者原贴下2019年更新的版本的，不知道是什么问题，他替换之后的方法 ...\n参数没写对 最好使用ref参数"
        },
        {
            "author": "T_irpitz",
            "timestamp": 1591740600,
            "txt_content": "十分感谢"
        },
        {
            "author": "3TUSK",
            "timestamp": 1591837920,
            "txt_content": "但是附属作者模组并没有公开源码并且已经差不多两年没更新过了，因此决定自己反编译附属模组然后改改代码来实现兼容。\n\n出于潜在的法律问题风险，不建议这么做。\n如果确实需要改代码，建议写一个 Coremod。"
        }
    ]
}