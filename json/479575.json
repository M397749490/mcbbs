{
    "title": "初级插件制作之我有特殊的点金技巧",
    "author": "181133567",
    "replyCount": 3,
    "timestamp": 1438496460,
    "txt_content": " 本帖最后由 181133567 于 2015-8-2 16:27 编辑 \n\n又是一个周末时~\n废话就不多说了 直接进入主题 \n先上效果图：\n\n\n\n\n\n\n先拿出我们珍藏的小木棍  然后对准一个方块 之后鼠标左键\n\n\n\n\n然后我们选中的方块就变成金砖了！\n\n\n实现：\n现在来回想一下这个神奇的法术：\n      1.小木棍  2.左键点击  3.施法成功！\n不难想到，既然有点击那么就一定有玩家点击事件，所以就会有 @EventHandler：\n        @EventHandler\n        public void onPlayerInteractBlock(PlayerInteractEvent evt){\n\n        }复制代码既然施法道具小木棍，那么就会有一个判断：\nif(evt.getPlayer().getItemInHand().getType() == Material.STICK){\n\n}复制代码evt着这里是这个点击事件  evt.getPlayer()就是触发这个事件的玩家  evt.getPlayer().getItemInHand()则是触发这个事件的玩家手上的物品\nevt.getPlayer().getItemInHand().getType()就是触发这个事件的玩家手上的物品的类型了~  \nMaterial是所有材料的类 所以这段code的意思就是【如果玩家手上的物品是小木棍 那么便执行接下来的code】\n\n\n仔细思考一下刚才的施法过程 好像还有一个左键点击 也就是说要进行像  ↑↑↑上面↑↑↑  那样进行判断咯：\nif(evt.getAction() == Action.LEFT_CLICK_BLOCK){\n\n}复制代码同理，获得时间的具体行为 判断是否是 左键单击砖块 如果是 执行接下来的code。\nBlock block = (Block) evt.getPlayer().getTargetBlock(null, 4);\nblock.setType(Material.GOLD_BLOCK);复制代码这里就是获得一个Block实例并取名叫block。\n使block 等于 玩家的目标砖块 施法距离为4格\n获得目标砖块之后再用setType()来改变目标砖块的类型就好了~\n\n\n应为一开始我们用到了@EventHandler 要使用它的话必须先对事件进行注册，而祖册一般都是在最早的时候执行的，所以注册事件的code就应该放在\nonEnable()里咯  \n     @Override\n        public void onEnable() {\n                getLogger().info(getName()+\"已启动\");\n                getServer().getPluginManager().registerEvents(this, this);//注册事件\n                super.onEnable();\n        }复制代码\n\n既然有注册 那么对应的就有注销：\n        @Override\n        public void onDisable() {\n                \n                HandlerList.unregisterAll();//注销所有事件\n                getLogger().info(getName()+\"已关闭\");\n                super.onDisable();\n        }复制代码之后只需要简单的配置一下yml文件就好~（这里就不在赘述了= =。）\n附上源码一份：\npackage theGoldenTouch;\n\nimport org.bukkit.Material;\nimport org.bukkit.block.Block;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.HandlerList;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.Action;\nimport org.bukkit.event.player.PlayerInteractEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class main extends JavaPlugin implements Listener{\n        \n        @Override\n        public void onEnable() {\n                getLogger().info(getName()+\"已启动\");\n                getServer().getPluginManager().registerEvents(this, this);//注册事件\n                super.onEnable();\n        }\n        \n        @EventHandler\n        public void onPlayerInteractBlock(PlayerInteractEvent evt){\n                if(evt.getPlayer().getItemInHand().getType() == Material.STICK){\n                          if(evt.getAction() == Action.LEFT_CLICK_BLOCK){\n                                  Block block = evt.getPlayer().getTargetBlock(null, 4);\n                                  block.setType(Material.GOLD_BLOCK);\n                          }\n                        \n                }\n        }\n        \n        \n        \n        @Override\n        public void onDisable() {\n                \n                HandlerList.unregisterAll();//注销所有事件\n                getLogger().info(getName()+\"已关闭\");\n                super.onDisable();\n        }\n\n}\n复制代码\n\n\n\n\n*******************************************华丽丽的分割线*******************************************\n渴望力量的我们是不会满足于小小的点金术上的！！！\n我们想要的是更强大的力量！！\n\n\n\n\n\n\n\n\n\n\n怎么做的前文都有说过，这里直接附上核心code：\n@EventHandler\n        public void onPlayerInteractBlock(PlayerInteractEvent evt){\n                if(evt.getPlayer().getItemInHand().getType() == Material.STICK){\n                        Block block = evt.getPlayer().getTargetBlock(null, 4);\n                          if(evt.getAction() == Action.LEFT_CLICK_BLOCK){\n                                  if(stored_block == null){\n                                          block.setType(Material.GOLD_BLOCK);\n                                  }else{\n                                          block.setType(stored_block);\n                                  }\n                          }\n                          if(evt.getAction() == Action.RIGHT_CLICK_BLOCK){\n                                  stored_block = evt.getPlayer().getTargetBlock(null, 4).getType();\n                                  evt.getPlayer().sendMessage(\"成功获取当前的方块。\");\n                          }\n                        \n                }\n        }复制代码这里要注意的是stored_block这个变量。 在一开始创建一个私有变量 private Material stored_block ;\n以供在onPlayerInteractBlock(PlayerInteractEvent evt)中使用\n【虽然这样破坏了函数良好的封装性= =。。不过无所谓了  我们可是大法师！】\n\n\n最后：\n      之后的加强法术我没有仔细说明 不过原理前文都有提到过  大家可以自己独立思考一下  毕竟强大的力量总是要付出些什么不是么~",
    "replies": [
        {
            "author": "181133567",
            "timestamp": 1438496820,
            "txt_content": "抱歉····粘代码的时候落了几个 }  各位亲们就将就一下吧 = =。。。。"
        },
        {
            "author": "caifuniao",
            "timestamp": 1438531020,
            "txt_content": "{:10_508:}又见到楼主发帖了.\n有机会交流下插件开发呀{:10_512:}"
        },
        {
            "author": "181133567",
            "timestamp": 1438532040,
            "txt_content": "caifuniao 发表于 2015-8-2 23:57\n又见到楼主发帖了.\n有机会交流下插件开发呀\n好的好的~加一下q呗  【我ID就是号····】"
        }
    ]
}