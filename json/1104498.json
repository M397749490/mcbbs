{
    "title": "「教练，我想写mod！」[开发中_][1.16.2][Hearthstone——炉石]Fabric传送模组",
    "author": "jingshen",
    "replyCount": 8,
    "timestamp": 1597682580,
    "txt_content": " 本帖最后由 jingshen 于 2020-8-23 19:29 编辑 \n\n（顺便参加个活动，主元素：装备工具，魔兽世界应该挺幻想和超越现实的）最后更新：2020.8.22\n模组背景\n玩过wow的朋友们都知道，搓炉石可以将你传送回绑定的酒馆，冷却时间为20min。此外，达拉然炉石、祖达萨炉石等还可以传送到特定的区域，并且特殊炉石的CD和普通炉石的CD是分开计算的。\n\n同类模组调查\n目前从curseforge上可以查到同题材（以hearthstone为关键词）的模组约4~5个，还在更新的有2个（hearthstones和hearthstones mod，以下简称HS和HSM），均是1.15或更低版本基于forge的模组。其中HS未开源，加入了多种不同特性的炉石，炉石需要绑定MOD方块作为传送点。HSM是开源的，只有一种炉石，以床等原版方块作为传送点，从开源的代码中可以看出一些缺陷：1、玩家传送点数据的存储在ItemStack的NBT中，如果丢失炉石则无法传送；2、炉石的冷却时间也储存在ItemStack的NBT中，如果做很多颗炉石交替使用，则实际冷却时间会大大缩短。\n\n模组内容\n炉石：shift+右键记录传送点，该传送点与玩家绑定，不会因为更换炉石、死亡等重置。右键开始施法，数秒后传送，传送过程中受伤或移动则打断施法。传送后有20分钟冷却时间，该时间同样与玩家绑定，更换其他炉石不会改变这一时间。\n不同功能炉石：1、只能在某一维度传送的炉石，自然炉石（主世界）、地狱炉石（下届）、达拉然炉石（紫色和末地很像不是吗）。2、传送距离有限的炉石，超出距离后破碎。3、自动记录玩家下矿前位置的炉石，挖矿后快速回地表。4、玩家互相tp的炉石。5、欢迎各位把自己的脑洞写在评论区。\n\n技术信息\n模组将在MC1.16.2（以及之后的最新稳定版）上基于Fabric Loader和Fabric API开发。使用轻量级的SQL数据库实现玩家数据的离线储存，目前暂定为H2 Database。\n\n模组开发进度（详见Github）\n1、数据离线储存\n· 实现基于JDBC的SQL数据库访问接口\n· 构造合适的数据库表结构\n· 玩家数据和数据库transaction的序列化和反序列化\n· 各种玩家数据的储存（实现中，预计时间：视其他进度而定）\n2、数据在线管理\n· 实现玩家传送点信息类PositionData（包含维度、xyz、yaw、pitch）\n· 包装玩家UUID、炉石类型和PositionData的字典\n· 包装玩家UUID、炉石类型和炉石冷却时间CooldownData的字典\n3、玩家的传送功能\n· 实现基于PositionData的跨维度传送\n4、炉石的基本功能\n· shift+右键储存当前地点为传送点\n· tooltip中显示剩余冷却时间\n· 施法进度：右键使用后延时数秒传送（实现中，1月内）\n5、多种不同功能特性的炉石（实现中，预计时间：2月内）\n\n· 实现只能同世界传送、有距离限制的炉石\n· 实现只能同世界传送、无距离限制的炉石\n· 实现记录最后一次在天空下位置的矿工炉石\n6、炉石材质模型、合成表（实现中，预计时间：视其他进度而定）\n更多，待添加。\n\n预览图片\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "杜思政",
            "timestamp": 1597724220,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "道家深湖",
            "timestamp": 1597729380,
            "txt_content": "看标题我以为是打牌模组23333"
        },
        {
            "author": "jingshen",
            "timestamp": 1597735080,
            "txt_content": "道家深湖 发表于 2020-8-18 13:43\n看标题我以为是打牌模组23333\n哈哈哈哈 炉石的热度确实比wow高多了"
        },
        {
            "author": "往日残响",
            "timestamp": 1597799880,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "水映天虹",
            "timestamp": 1598031000,
            "txt_content": "请务必火速做出来 最好兼容服务端"
        },
        {
            "author": "清晨w",
            "timestamp": 1598162820,
            "txt_content": "炉石\n酒馆老板呐\n和酒馆老板交谈之后设定传送点\n=====================\n另外刚看到数据储存用sql我就在想要用能力系统啊\n然后突然想起来这是fabric (逃\n总之支持!"
        },
        {
            "author": "匿名",
            "timestamp": 1598166960,
            "txt_content": " 本帖最后由 匿名 于 2020-8-23 15:33 编辑 \n\n玩家传送点数据的存储在ItemStack的NBT中，如果丢失炉石则无法传送\n那你存在玩家身上呗，用数据库干嘛，嫌速度太快？\n玩家NBT里写个标签Persisted： {xxxx}\n或者用Capability （这个不知道Fabric有没有）\n或者用Mixin加个Field进去\n   你写插件写多了吧\n\n至于冷却时间，希望你记得（不知道1.16有没有） EntityPlayer.getCooldownTracker().setCooldown(Item, int)\n这让我想起了另一个mod，Lootr，也是像你这种做法\n我在1.12.2复制出来了，就加了一个方块一个TE，而1.15的它用了ASM\n实在搞不懂，我就是监听三个事件, PlaceBlock, PlayerInteract, EntityJoinWorld\n检测附近或者目标位置的战利品箱子替换成自己的，对方使用了ASM去做这些... 有这个必要吗？Fabric没有事件系统吗？\n\n小题大做\n\n\n学校有作业？ \n\n\n\n\n1.jpg (409 Bytes, 下载次数: 3)\n\n下载附件\n\n2020-8-23 15:31 上传\n\n\n\n\nHashMap还好，但是会用到PositionData的地方估计都有Player做参数\n不过这到是没什么问题了。。。\n\n\n"
        },
        {
            "author": "jingshen",
            "timestamp": 1598167560,
            "txt_content": " 本帖最后由 jingshen 于 2020-8-23 15:31 编辑 \n匿名者 发表于 2020-8-23 15:16\n玩家传送点数据的存储在ItemStack的NBT中，如果丢失炉石则无法传送\n那你存在玩家身上呗，用数据库干嘛，嫌 ...\n\n确实，我知道sql的实现是完全没必要的，fabric虽然没有capacity系统，但用mixin、改nbt都行。只是因为学校有作业要用，我才加进来的。cooldown也是，mc本身就有cooldownmanager可以用。\n另外，数据库是负责离线储存的，游戏中是用hashmap在线储存的，所以速度倒不是问题。"
        }
    ]
}