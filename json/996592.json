{
    "title": "[已解决]多配置文件的保存问题",
    "author": "SmallL_U",
    "replyCount": 8,
    "timestamp": 1585108740,
    "txt_content": " 本帖最后由 SmallL_U 于 2020-3-25 20:22 编辑 \n\n萌新求助~\n如题emm 就是插件对文件进行操作之后进行保存问题~~~\n<pre style=\"background-color:#282a36;color:#f8f8f2;font-family:'Consolas';font-size:9.8pt;\"><span style=\"color:#ff79c6;\">if </span>(<span style=\"color:#ff79c6;\">!</span>load_player) {\n    <span style=\"font-style:italic;\">data</span>.<span style=\"color:#50fa78;\">createSection</span>(<span style=\"color:#f1fa8c;\">\"Data.\"</span><span style=\"color:#ff79c6;\">+</span>name);\n    <span style=\"font-style:italic;\">data</span>.<span style=\"color:#50fa78;\">createSection</span>(<span style=\"color:#f1fa8c;\">\"Data.\"</span><span style=\"color:#ff79c6;\">+</span>name<span style=\"color:#ff79c6;\">+</span><span style=\"color:#f1fa8c;\">\".Kill\"</span>);\n    <span style=\"font-style:italic;\">data</span>.<span style=\"color:#50fa78;\">createSection</span>(<span style=\"color:#f1fa8c;\">\"Data.\"</span><span style=\"color:#ff79c6;\">+</span>name<span style=\"color:#ff79c6;\">+</span><span style=\"color:#f1fa8c;\">\".Death\"</span>);\n    <span style=\"font-style:italic;\">data</span>.<span style=\"color:#50fa78;\">createSection</span>(<span style=\"color:#f1fa8c;\">\"Data.\"</span><span style=\"color:#ff79c6;\">+</span>name<span style=\"color:#ff79c6;\">+</span><span style=\"color:#f1fa8c;\">\".KD\"</span>);\n}</pre>复制代码DataLoader<pre style=\"background-color:#282a36;color:#f8f8f2;font-family:'Consolas';font-size:9.8pt;\"><span style=\"color:#ff79c6;\">public class </span><span style=\"color:#78dce8;\">DataLoader </span>{\n    <span style=\"color:#ff79c6;\">private static </span><span style=\"color:#78dce8;\">YamlConfiguration </span><span style=\"font-style:italic;\">data</span>;\n    <span style=\"color:#ff79c6;\">private static </span><span style=\"color:#78dce8;\">YamlConfiguration </span><span style=\"font-style:italic;\">message</span>;\n    <span style=\"color:#ff79c6;\">public static void </span><span style=\"color:#50fa7b;\">loadData</span>() {\n        <span style=\"color:#78dce8;\">File </span>file <span style=\"color:#ff79c6;\">= new </span><span style=\"color:#8be9fd;\">File</span>(<span style=\"color:#78dce8;\">Main</span>.<span style=\"font-style:italic;\">plugin</span>.<span style=\"color:#50fa78;\">getDataFolder</span>(),<span style=\"color:#f1fa8c;\">\"data.yml\"</span>);\n        <span style=\"color:#78dce8;\">File </span>file2 <span style=\"color:#ff79c6;\">= new </span><span style=\"color:#8be9fd;\">File</span>(<span style=\"color:#78dce8;\">Main</span>.<span style=\"font-style:italic;\">plugin</span>.<span style=\"color:#50fa78;\">getDataFolder</span>(),<span style=\"color:#f1fa8c;\">\"message.yml\"</span>);\n        <span style=\"color:#ff79c6;\">if </span>(<span style=\"color:#ff79c6;\">!</span>file.<span style=\"color:#50fa78;\">exists</span>()) {\n            <span style=\"color:#78dce8;\">Main</span>.<span style=\"font-style:italic;\">plugin</span>.<span style=\"color:#50fa78;\">saveResource</span>(<span style=\"color:#f1fa8c;\">\"data.yml\"</span>,<span style=\"color:#bd93f9;\">false</span>);\n        }\n        <span style=\"color:#ff79c6;\">if </span>(<span style=\"color:#ff79c6;\">!</span>file2.<span style=\"color:#50fa78;\">exists</span>()) {\n            <span style=\"color:#78dce8;\">Main</span>.<span style=\"font-style:italic;\">plugin</span>.<span style=\"color:#50fa78;\">saveResource</span>(<span style=\"color:#f1fa8c;\">\"message.yml\"</span>,<span style=\"color:#bd93f9;\">false</span>);\n        }\n        <span style=\"font-style:italic;\">data </span><span style=\"color:#ff79c6;\">= </span><span style=\"color:#78dce8;\">YamlConfiguration</span>.<span style=\"color:#50fa78;font-style:italic;\">loadConfiguration</span>(file);\n        <span style=\"font-style:italic;\">message </span><span style=\"color:#ff79c6;\">= </span><span style=\"color:#78dce8;\">YamlConfiguration</span>.<span style=\"color:#50fa78;font-style:italic;\">loadConfiguration</span>(file2);\n    }\n\n\n\n    <span style=\"color:#ff79c6;\">public static </span><span style=\"color:#78dce8;\">YamlConfiguration </span><span style=\"color:#50fa7b;\">getMessage</span>() { <span style=\"color:#ff79c6;\">return </span><span style=\"font-style:italic;\">message</span>; }\n    <span style=\"color:#ff79c6;\">public static </span><span style=\"color:#78dce8;\">YamlConfiguration </span><span style=\"color:#50fa7b;\">getData</span>() { <span style=\"color:#ff79c6;\">return </span><span style=\"font-style:italic;\">data</span>; }\n\n    <span style=\"color:#ff79c6;\">public static void </span><span style=\"color:#50fa7b;\">reloadData</span>() {\n        <span style=\"color:#50fa78;font-style:italic;\">loadData</span>();\n    }\n\n}\n</pre>复制代码\n\n",
    "replies": [
        {
            "author": "SmallL_U",
            "timestamp": 1585108800,
            "txt_content": "尴尬...\n    if (!load_player) {\n        data.createSection(\"Data.\"+name);\n        data.createSection(\"Data.\"+name+\".Kill\");\n        data.createSection(\"Data.\"+name+\".Death\");\n        data.createSection(\"Data.\"+name+\".KD\");\n    }复制代码\nDataLoader \npublic class DataLoader {\n    private static YamlConfiguration data;\n    private static YamlConfiguration message;\n    public static void loadData() {\n        File file = new File(Main.plugin.getDataFolder(),\"data.yml\");\n        File file2 = new File(Main.plugin.getDataFolder(),\"message.yml\");\n        if (!file.exists()) {\n            Main.plugin.saveResource(\"data.yml\",false);\n        }\n        if (!file2.exists()) {\n            Main.plugin.saveResource(\"message.yml\",false);\n        }\n        data = YamlConfiguration.loadConfiguration(file);\n        message = YamlConfiguration.loadConfiguration(file2);\n    }\n\n\n\n    public static YamlConfiguration getMessage() { return message; }\n    public static YamlConfiguration getData() { return data; }\n\n    public static void reloadData() {\n        loadData();\n    }\n\n}\n复制代码"
        },
        {
            "author": "2505073177",
            "timestamp": 1585132440,
            "txt_content": "if (!load_player) {\n        data.createSection(\"Data.\"+name);\n        data.createSection(\"Data.\"+name+\".Kill\");\n        data.createSection(\"Data.\"+name+\".Death\");\n        data.createSection(\"Data.\"+name+\".KD\");\n        try {\n                data.save(file);\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n    }复制代码"
        },
        {
            "author": "William_Shi",
            "timestamp": 1585132560,
            "txt_content": " 本帖最后由 William_Shi 于 2020-3-25 18:38 编辑 \nSmallL_U 发表于 2020-3-25 12:00\n尴尬...\n\nDataLoader\n你的第一段程序，data是哪里声明的？我猜是先实例化了DataLoader\n（但是不清楚你的dataloader是不是单例\n然后getData\n所以，\n代码贴全，谢谢\n然后你这里的代码\n根本没有与你的问题，\n操作过后如何保存\n这一问题相关的\n你贴了用处并不大\n\n看这个\nhttps://www.acgxt.com/418.html\n应该可以解决你的问题\n"
        },
        {
            "author": "SmallL_U",
            "timestamp": 1585137420,
            "txt_content": "William_Shi 发表于 2020-3-25 18:36\n你的第一段程序，data是哪里声明的？我猜是先实例化了DataLoader\n（但是不清楚你的dataloader是不是单例\n ...\n谢谢大佬~~~ awa第一次发 有点儿懵~~"
        },
        {
            "author": "SmallL_U",
            "timestamp": 1585137420,
            "txt_content": "2505073177 发表于 2020-3-25 18:34\n不是在同一个类里面~"
        },
        {
            "author": "2505073177",
            "timestamp": 1585137780,
            "txt_content": "SmallL_U 发表于 2020-3-25 19:57\n不是在同一个类里面~\n不在的话那就最好像3楼说的那样，把代码贴完整"
        },
        {
            "author": "SmallL_U",
            "timestamp": 1585138260,
            "txt_content": "2505073177 发表于 2020-3-25 20:03\n不在的话那就最好像3楼说的那样，把代码贴完整\n代码删了emm 现在在重写 换一个思路emm 还是谢谢大佬了~~"
        },
        {
            "author": "SmallL_U",
            "timestamp": 1585138920,
            "txt_content": "我发现问题了233\n原因是我一天都在犯抽的创建n多对象 然后没有作用23333"
        }
    ]
}