{
    "title": "想写一段JAVA读取storage",
    "author": "晴路卡",
    "replyCount": 3,
    "timestamp": 1586506920,
    "txt_content": "版本1.15+（废话）\n试着找了些解压Gzip的代码拼凑了以下\n可是生成的输出文件里没有得到数据，只有标签的名称和乱码- -\n\n\n\n所以想问下用读命令存储数据的正确姿势是什么(最好是JAVA代码吧\n顺便这是实际的storage：\n\n\n",
    "replies": [
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1586506920,
            "txt_content": "标题: ljyys就是好用（指命名 本帖最后由 阴阳师元素祭祀 于 2020-4-10 18:23 编辑 \n\n为了提醒楼主 就在恢复了一次\ndat是加密了的 我相信楼主会解密\n解密之后\n按照wiki提示读即可\n\n\n    private static String getYYS(int depth) {\n        StringBuilder sb = new StringBuilder();\n        for (int i = 0; i < depth; ++i) {\n            sb.append(\"    \");\n        }\n        return sb.toString();\n    }\n\n    private static void read(DataInputStream in, int depth) throws IOException {\n        boolean next = true;\n        while (next) {\n            byte tag = in.readByte();\n            next = tag != 0;\n            if (next) {\n                short nameLength = in.readShort();\n                if (nameLength != 0) {\n                    byte[] name = new byte[nameLength];\n                    if (in.read(name) != name.length) {\n                        throw new IOException(\"ljyys for name error\");\n                    }\n                    String tagName = new String(name);\n                    System.out.println(getYYS(depth) + tagName + \" {\");\n                } else {\n                    System.out.println(getYYS(depth) + \"{\");\n                }\n                switch (tag) {\n                    case 0x3: {\n                        System.out.println(getYYS(depth + 1) + in.readInt());\n                        System.out.println(getYYS(depth) + \"}\");\n                        break;\n                    }\n                    case 0xA: {\n                        read(in, depth + 1);\n                        next = in.available() > 0;\n                        break;\n                    }\n                    default: {\n                        System.out.println(\"data left: \" + in.available());\n                        throw new IOException(\"ljyys for tag:\" + tag);\n                    }\n                }\n            }\n        }\n        System.out.println(getYYS(depth) + \"}\");\n    }\n\n\n    public static void main(String[] args) throws Throwable {\n        DataInputStream in = new DataInputStream(Files.newInputStream(Paths.get(\"command_storage_minecraft\")));\n\n        read(in, 0);\n    }\n复制代码\n很简陋\n输出是\n\n{\n    data {\n        contents {\n            ljyys {\n                ljyys {\n                    9\n                }\n                中文 {\n                    16\n                }\n                }\n            }\n        }\n    DataVersion {\n        2230\n    }\n    }\n}\n复制代码\n\n对 我懒得找bug了\n\n测试用的文件是 (因为不会发附件 所以发字节了)\n10 0 0 10 0 4 100 97 116 97 10 0 8 99 111 110 116 101 110 116 115 10 0 5 108 106 121 121 115 3 0 5 108 106 121 121 115 0 0 0 9 3 0 6 -28 -72 -83 -26 -106 -121 0 0 0 16 0 0 0 3 0 11 68 97 116 97 86 101 114 115 105 111 110 0 0 8 -74 0 \n命令输出\n>>>data get storage ljyys\n[17:34:54] [Server thread/INFO]: Storage minecraft:ljyys has the following contents: {\"中文\": 16, ljyys: 9}\n\nQ: 为什么不包装成类 库 或者 缩进优化 代码优化 强制指定编码保证不出错\nA: 能跑就行 性能丢掉莉.yys 其他人环境也丢掉莉\nIt works on my machine!\n\n\n"
        },
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1586507520,
            "txt_content": "标题: 问下这个文件在哪个目录 我去看看（小声 本帖最后由 阴阳师元素祭祀 于 2020-4-10 16:34 编辑 \n\n我翻了半天文件也找不到storage.nbt或者可能的文件\njava有个类\n是DataInputStream\n从mojang给出的nbt一些值后缀来看\n是按照类型直接存相关字节的\n\n比如那个number\n似乎是int\n那么\nDataInputStream#.readInt()\n即可将接下来的文件4个字节 读成intjx\n字符前面应该有标志 用来告诉接下来有几个字符\n可是我真的找不到文件\n\n可以参看这个\n\nhttps://wiki.biligame.com/mc/NBT%E6%A0%BC%E5%BC%8F\n另如果是UTF8\n可以直接试试DataInputStream#readUTF()来读字符"
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1586513400,
            "txt_content": "阴阳师元素祭祀 发表于 2020-4-10 17:20\n为了提醒楼主 就在恢复了一次\ndat是加密了的 我相信楼主会解密\n解密之后\n学习了\n请问大佬知道mca文件怎么解密吗"
        }
    ]
}