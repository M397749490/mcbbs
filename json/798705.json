{
    "title": "[安全][HAYO]ServerCrasherFixer —— 修复部分作弊客户端的崩服功能 [1.8-1.9]",
    "author": "黑",
    "replyCount": 11,
    "timestamp": 1528729440,
    "txt_content": " 本帖最后由 583736449 于 2018-6-11 23:21 编辑 \n\nServerCracherFixer\n修复部分作弊客户端的崩服功能（仅限1.8）\n\n\n前言\n\n前段时间给别人做小游戏服，遇见个开 JIGSAW 的杂`种。\n进服就是一顿卡服导致玩家掉线，然后自己也掉线...\n然后经过短暂的测试发现是通过发送 PacketPlayInCustomPayload 导致服务器崩溃。\n并且可以绕过 AAC 以及 ViaVersion 的检测。。。\n我在站内没有搜到关于这个漏洞的解决插件，然后就自己写了个。\n这个问题在 1.9+ 的版本已经修复了刚刚测试 1.9.4 单端也会崩 hhhh。\n\n\n截图\n\n\n\n\n下载\n\n本插件需要 PacketListenerAPI 作为前置\n\n\n\nServerCrasherFixer.jar\n(4.28 KB, 下载次数: 178)\n\n\n\n2018-6-11 23:02 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n配置\n\n# 数据包长度阈值\nthreshold-per-packet: 30000\n# 踢出信息\nkick-message: '&4非法操作 &c(InvalidPacket)'复制代码\n\n\n开源\npackage me.skymc.servercrasherfixer;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.entity.Player;\nimport org.bukkit.scheduler.BukkitRunnable;\nimport org.inventivetalent.packetlistener.handler.PacketHandler;\nimport org.inventivetalent.packetlistener.handler.ReceivedPacket;\nimport org.inventivetalent.packetlistener.handler.SentPacket;\n\n/**\n * @author sky\n * @Since 2018-06-11 22:00\n */\npublic class Packet extends PacketHandler {\n\n    @Override\n    public void onSend(SentPacket packet) {\n\n    }\n\n    @Override\n    public void onReceive(ReceivedPacket packet) {\n        if (packet.getPacketName().equals(\"PacketPlayInCustomPayload\")) {\n            Object packetDataSerializer = packet.getPacketValue(\"b\");\n            try {\n                int size = (int) packetDataSerializer.getClass().getMethod(\"readableBytes\").invoke(packetDataSerializer);\n                if (size > Main.getInst().getConfig().getInt(\"threshold-per-packet\")) {\n                    packet.setCancelled(true);\n\n                    // 在我服会被 AAC 提前踢走，保险起见写上这个。\n                    Player player = Bukkit.getPlayerExact(packet.getPlayername());\n                    if (player != null) {\n                        new BukkitRunnable() {\n                            @Override\n                            public void run() {\n                                player.getWorld().strikeLightningEffect(player.getLocation());\n                                player.kickPlayer(Main.getInst().getConfig().getString(\"kick-message\").replace(\"&\", \"§\"));\n                            }\n                        }.runTask(Main.getInst());\n                    }\n                }\n            } catch (Exception ignored) {\n            }\n        }\n    }\n}复制代码[groupid=128]HAYO Studio[/groupid]",
    "replies": [
        {
            "author": "Saukiya",
            "timestamp": 1528730100,
            "txt_content": "排版优良！开源点赞！沙发坐定！"
        },
        {
            "author": "nuo13260",
            "timestamp": 1528732560,
            "txt_content": "MCBBS有你更精彩!板凳坐定!"
        },
        {
            "author": "海贼王#",
            "timestamp": 1528756620,
            "txt_content": "前排，支持原创"
        },
        {
            "author": "cp666",
            "timestamp": 1530183600,
            "txt_content": "支持1.7.10就好了"
        },
        {
            "author": "cp666",
            "timestamp": 1530183720,
            "txt_content": "cp666 发表于 2018-6-28 19:00\n支持1.7.10就好了\n有点尴尬"
        },
        {
            "author": "大海Sea",
            "timestamp": 1530780120,
            "txt_content": "站内没有前置吗？点进去一直Loading Download..."
        },
        {
            "author": "2544673738",
            "timestamp": 1534696080,
            "txt_content": "太棒了，服务器刚被弱 智用j端崩，终于找到插件了！！！"
        },
        {
            "author": "40SiShi",
            "timestamp": 1534746240,
            "txt_content": "2544673738 发表于 2018-8-20 00:28\n太棒了，服务器刚被弱 智用j端崩，终于找到插件了！！！\n找到你了awa"
        },
        {
            "author": "Brave_boy",
            "timestamp": 1535030280,
            "txt_content": "972063175 发表于 2018-7-5 16:42\n站内没有前置吗？点进去一直Loading Download...\nhttps://github.com/Inventivetale ... /tag/3.7.0-SNAPSHOT\n使用这个网址下载"
        },
        {
            "author": "凉菀彡",
            "timestamp": 1585722600,
            "txt_content": "  这个插件很好~服务器刚好用得上"
        },
        {
            "author": "asdp000333",
            "timestamp": 1585726440,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽\n"
        }
    ]
}