{
    "title": "【AuthMe】关于和MySQL连接的问题",
    "author": "极光酋长",
    "replyCount": 1,
    "timestamp": 1463839860,
    "txt_content": "\n数据库连接时出了问题，加载好后服务端关闭\n             AuthMe版本：5.2-BATE2\n             MySQL版本：5.5.19 ，3306端口已解除防火墙，登录主机 ：@%；@localhost；均无效（可以用来网页登录）\n\n【.log文本】\n[22:04:11] [Server thread/INFO]: [AuthMe] Enabling AuthMe v5.2-BETA2-b969\n[22:04:11] [Server thread/INFO]: [AuthMe] Connection arguments loaded, Hikari ConnectionPool ready!\n[22:04:11] [Server thread/WARN]: [Server thread] INFO fr.xephi.authme.libs.hikari.HikariDataSource - AuthMeMYSQLPool - Started.\n[22:04:33] [Server thread/WARN]: [Server thread] INFO fr.xephi.authme.libs.hikari.pool.HikariPool - AuthMeMYSQLPool - Close initiated...\n[22:04:33] [Server thread/WARN]: [Server thread] INFO fr.xephi.authme.libs.hikari.pool.HikariPool - AuthMeMYSQLPool - Closed.\n[22:04:33] [Server thread/WARN]: [AuthMe] Fatal error occurred during database connection! Authme initialization aborted! [PoolInitializationException]: Failed to initialize pool: Communications link failure\n\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.\n[22:04:33] [Server thread/WARN]: [AuthMe] THE SERVER IS GOING TO SHUT DOWN AS DEFINED IN THE CONFIGURATION!\n[22:04:33] 然后就关闭啦复制代码\n\n【authme.log】\n[05-21 22:04:11]: Connection arguments loaded, Hikari ConnectionPool ready!\n[05-21 22:04:33]: ERROR: Fatal error occurred during database connection! Authme initialization aborted! [PoolInitializationException]: Failed to initialize pool: Communications link failure\n\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.\n[05-21 22:04:33]: fr.xephi.authme.libs.hikari.pool.HikariPool$PoolInitializationException: Failed to initialize pool: Communications link failure\n\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.\n        at fr.xephi.authme.libs.hikari.pool.HikariPool.checkFailFast(HikariPool.java:528)\n        at fr.xephi.authme.libs.hikari.pool.HikariPool.<init>(HikariPool.java:118)\n        at fr.xephi.authme.libs.hikari.HikariDataSource.getConnection(HikariDataSource.java:94)\n        at fr.xephi.authme.datasource.MySQL.getConnection(MySQL.java:144)\n        at fr.xephi.authme.datasource.MySQL.setupConnection(MySQL.java:148)\n        at fr.xephi.authme.datasource.MySQL.<init>(MySQL.java:82)\n        at fr.xephi.authme.AuthMe.setupDatabase(AuthMe.java:595)\n        at fr.xephi.authme.AuthMe.onEnable(AuthMe.java:247)\n        at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:292)\n        at org.bukkit.plugin.java.JavaPluginLoader.enablePlugin(JavaPluginLoader.java:340)\n        at org.bukkit.plugin.SimplePluginManager.enablePlugin(SimplePluginManager.java:405)\n        at org.bukkit.craftbukkit.v1_9_R1.CraftServer.loadPlugin(CraftServer.java:361)\n        at org.bukkit.craftbukkit.v1_9_R1.CraftServer.enablePlugins(CraftServer.java:321)\n        at net.minecraft.server.v1_9_R1.MinecraftServer.t(MinecraftServer.java:411)\n        at net.minecraft.server.v1_9_R1.MinecraftServer.l(MinecraftServer.java:376)\n        at net.minecraft.server.v1_9_R1.MinecraftServer.a(MinecraftServer.java:331)\n        at net.minecraft.server.v1_9_R1.DedicatedServer.init(DedicatedServer.java:269)\n        at net.minecraft.server.v1_9_R1.MinecraftServer.run(MinecraftServer.java:527)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:404)\n        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:983)\n        at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:339)\n        at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2252)\n        at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2285)\n        at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2084)\n        at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:795)\n        at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:44)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:404)\n        at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:400)\n        at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:327)\n        at fr.xephi.authme.libs.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:95)\n        at fr.xephi.authme.libs.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:101)\n        at fr.xephi.authme.libs.hikari.pool.PoolBase.newConnection(PoolBase.java:316)\n        at fr.xephi.authme.libs.hikari.pool.HikariPool.checkFailFast(HikariPool.java:518)\n        ... 18 more\nCaused by: java.net.ConnectException: Connection timed out: connect\n        at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method)\n        at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:85)\n        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)\n        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)\n        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)\n        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)\n        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n        at java.net.Socket.connect(Socket.java:589)\n        at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:214)\n        at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:298)\n        ... 34 more\n\n[05-21 22:04:33]: ERROR: THE SERVER IS GOING TO SHUT DOWN AS DEFINED IN THE CONFIGURATION!\n[05-21 22:04:33]: AuthMe 5.2-BETA2-b969 disabled!\n[05-21 22:04:33]: Waiting for 0 tasks to finish\n复制代码\n",
    "replies": [
        {
            "author": "lichi2050",
            "timestamp": 1463851500,
            "txt_content": "你这个问题其实很简单，连接池保留了连接，但是MySQL数据库已经回收了连接\n你需要修改MySQL的my.ini?（配置文件），你需要在配置文件内添加一行wait_timeout=设置为2147483\n或者已经有这项设置你只需要改下数据然后重启MySQL"
        }
    ]
}