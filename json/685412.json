{
    "title": "Pex with MySQL",
    "author": "Allen-zhang",
    "replyCount": 11,
    "timestamp": 1491633480,
    "txt_content": " 本帖最后由 Allen-zhang 于 2017-4-8 14:39 编辑 \n\n本人刚学会MySQL的基本架设和连接,但是因为服务器某个**管理想弄支持php的就乱弄,导致本来好好的MySQL出现无法连接的情况,PermissionEX只是其中的一个,全体MySQL集体崩盘,不知道为何。本人仔细检查了数据库的各项,结果还是暴毙,网上的各个方法都不适用于我 = =\n后台报告->\n[PermissionsEx] \n========== UNABLE TO LOAD PERMISSIONS BACKEND =========\nYour configuration must be fixed before PEX will enable\nDetails: Unable to connect to SQL database\n=======================================================\nru.tehkode.permissions.exceptions.PermissionBackendException: Unable to connect to SQL database\n        at ru.tehkode.permissions.backends.sql.SQLBackend.<init>(SQLBackend.java:118) ~[PermissionsEx.jar:?]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_121]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at ru.tehkode.permissions.backends.PermissionBackend.getBackend(PermissionBackend.java:392) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.backends.PermissionBackend.getBackend(PermissionBackend.java:367) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.PermissionManager.createBackend(PermissionManager.java:624) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.PermissionManager.setBackend(PermissionManager.java:606) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.PermissionManager.initBackend(PermissionManager.java:693) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.PermissionManager.<init>(PermissionManager.java:67) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.bukkit.PermissionsEx.onEnable(PermissionsEx.java:175) [PermissionsEx.jar:?]\n        at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:321) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at org.bukkit.plugin.java.JavaPluginLoader.enablePlugin(JavaPluginLoader.java:340) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at org.bukkit.plugin.SimplePluginManager.enablePlugin(SimplePluginManager.java:405) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at org.bukkit.craftbukkit.v1_8_R3.CraftServer.loadPlugin(CraftServer.java:357) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at org.bukkit.craftbukkit.v1_8_R3.CraftServer.enablePlugins(CraftServer.java:317) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at net.minecraft.server.v1_8_R3.MinecraftServer.s(MinecraftServer.java:414) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at net.minecraft.server.v1_8_R3.MinecraftServer.k(MinecraftServer.java:378) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at net.minecraft.server.v1_8_R3.MinecraftServer.a(MinecraftServer.java:333) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at net.minecraft.server.v1_8_R3.DedicatedServer.init(DedicatedServer.java:263) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at net.minecraft.server.v1_8_R3.MinecraftServer.run(MinecraftServer.java:525) [spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at java.lang.Thread.run(Unknown Source) [?:1.8.0_121]\nCaused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_121]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:407) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.MysqlIO.readPacket(MysqlIO.java:687) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1090) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2338) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2371) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2163) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:794) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_121]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:407) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:378) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at ru.tehkode.libs.org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.validateConnectionFactory(BasicDataSource.java:1556) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1545) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.backends.sql.SQLBackend.getSQL(SQLBackend.java:245) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.backends.sql.SQLBackend.<init>(SQLBackend.java:112) ~[PermissionsEx.jar:?]\n        ... 22 more\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\n        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2529) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.MysqlIO.readPacket(MysqlIO.java:611) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1090) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2338) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2371) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2163) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:794) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_121]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_121]\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:407) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:378) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305) ~[spigot-1.8.8.jar:git-Spigot-db6de12-18fbb24]\n        at ru.tehkode.libs.org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.validateConnectionFactory(BasicDataSource.java:1556) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1545) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388) ~[PermissionsEx.jar:?]\n        at ru.tehkode.libs.org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.backends.sql.SQLBackend.getSQL(SQLBackend.java:245) ~[PermissionsEx.jar:?]\n        at ru.tehkode.permissions.backends.sql.SQLBackend.<init>(SQLBackend.java:112) ~[PermissionsEx.jar:?]\n        ... 22 more\n[14:34:08] [Server thread/INFO]: [PermissionsEx] Disabling PermissionsEx v1.23.4Pex Config->\nmultiserver:\n  use-netevents: true\npermissions:\n  debug: false\n  allowOps: true\n  user-add-groups-last: false\n  log-players: false\n  createUserRecords: false\n  backend: sql\n  informplayers:\n    changes: false\n  basedir: plugins/PermissionsEx\n  backends:\n    sql:\n      uri: mysql://localhost/permissions\n      user: root\n      password: MYSQL\n      type: sql\n    file:\n      type: file\n      file: permissions.yml\nupdater: true\nalwaysUpdate: false\n\n",
    "replies": [
        {
            "author": "超級寶寶",
            "timestamp": 1491650340,
            "txt_content": "MYSQL有正常運作嗎?\n使用者那些都 在嘛\n數據庫有在嘛\n如果都正常 那就全部的數據庫備份後 刪除重創"
        },
        {
            "author": "langyo_v3",
            "timestamp": 1491654960,
            "txt_content": "我无法确定你的错误在哪,但我感觉是配置出错了\n不仅仅指配置文件需要两个之间互相连接,PHP等这种东西也需要设置环境变量"
        },
        {
            "author": "Allen-zhang",
            "timestamp": 1491834720,
            "txt_content": "我并没有弄PHP，是一个管理在yy然后自己瞎弄，最后成了这样，一开始都是可以正常连接的，他yy完了就无法连接了，数据库一切正常！"
        },
        {
            "author": "UltraPanda",
            "timestamp": 1492080600,
            "txt_content": "Your configuration must be fixed before PEX will enable\nDetails: Unable to connect to SQL database\n\n我认为，你在Pex的config.yml配置错误，您方便把config.yml内容发一下吗？"
        },
        {
            "author": "Allen-zhang",
            "timestamp": 1492161780,
            "txt_content": "407 发表于 2017-4-13 18:50\n我认为，你在Pex的config.yml配置错误，您方便把config.yml内容发一下吗？\n好的OKKKKKKKKKKKKKKKKKKKKK"
        },
        {
            "author": "Allen-zhang",
            "timestamp": 1492161900,
            "txt_content": "multiserver:\n  use-netevents: true\npermissions:\n  debug: false\n  allowOps: true\n  user-add-groups-last: false\n  log-players: false\n  createUserRecords: false\n  backend: basedir\n  informplayers:\n    changes: false\n  basedir: plugins/PermissionsEx\n  backends:\n    sql:\n      uri: mysql://localhost/permissions\n      user: root\n      password: MySqlPassWord\n      type: sql\n    basedir:\n      type: basedir\n      file: permissions.yml\nupdater: false\nalwaysUpdate: false"
        },
        {
            "author": "wyf65432123",
            "timestamp": 1492162380,
            "txt_content": "2333333333333333333333"
        },
        {
            "author": "UltraPanda",
            "timestamp": 1492162860,
            "txt_content": "Allen-zhang 发表于 2017-4-14 17:25\nmultiserver:\n  use-netevents: true\npermissions:\n    sql:\n      uri: mysql://localhost/permissions\n      user: root\n      password: MySqlPassWord\n      type: sql\n\n这个MysqlPassWord看起来像一个默认的密码，你确定一下\n backend: basedir\n这个 改成\n backend: sql\n"
        },
        {
            "author": "Allen-zhang",
            "timestamp": 1492164060,
            "txt_content": "407 发表于 2017-4-14 17:41\nsql:\n      uri: mysql://localhost/permissions\n      user: root\n不是,这是我为了方便在上面改的,我后台里面写的是MySql的密码,经核对并无错误"
        },
        {
            "author": "UltraPanda",
            "timestamp": 1492164720,
            "txt_content": "Allen-zhang 发表于 2017-4-14 18:01\n不是,这是我为了方便在上面改的,我后台里面写的是MySql的密码,经核对并无错误 ...\nbackend: basedir\n这个 改成\nbackend: sql"
        },
        {
            "author": "Allen-zhang",
            "timestamp": 1492171140,
            "txt_content": "407 发表于 2017-4-14 18:12\nbackend: basedir\n这个 改成\nbackend: sql\n已修改，还是不行"
        }
    ]
}