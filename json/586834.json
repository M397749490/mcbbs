{
    "title": "[娱乐]EatDirtForMoney —— 吃土以致富![1.7-1.8]",
    "author": "kilpikonna",
    "replyCount": 9,
    "timestamp": 1464136980,
    "txt_content": " 本帖最后由 kilpikonna 于 2016-5-24 20:47 编辑 \n\n这是一个很有趣的吃土插件\n它可以让玩家吃土, 吃了土还能得到钱\n也可以在配置文件里设置一个土多少钱\n虽然这个插件在生存服里用不是特别好, 但是在空岛生存服里效果非常好\n因为空岛生存中泥土是最珍贵的资源\n\n\n权限:\n  ke.ed.use  --吃土的权限\n\n\n指令: 还是没有(?﹃?)\n\n\n配置: \nenable: true\n  #是否开启这个插件\ndamage: 1\n  #吃土的伤害\nfood: 19\n  #吃土恢复的饱食度\nmaxfood: 19\n  #最大饱食度\n  #饱食度高于这个数值的玩家则不能吃土\nmoney: 50\n  #吃土得到的钱复制代码\n\n\n\n源代码(Java):\npackage cc.moecraft.eatdirtformoney;\nimport org.bukkit.Bukkit;\nimport org.bukkit.ChatColor;\nimport org.bukkit.Material;\nimport org.bukkit.Server;\nimport org.bukkit.Sound;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.configuration.file.FileConfiguration;\nimport org.bukkit.configuration.file.FileConfigurationOptions;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.Action;\nimport org.bukkit.event.player.PlayerInteractEvent;\nimport org.bukkit.inventory.ItemStack;\nimport org.bukkit.plugin.PluginManager;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.plugin.RegisteredServiceProvider;\nimport net.milkbowl.vault.chat.Chat;\nimport net.milkbowl.vault.economy.Economy;\nimport net.milkbowl.vault.economy.EconomyResponse;\nimport net.milkbowl.vault.permission.Permission;\nimport java.util.logging.Logger;\n/**\n *\n * [url=home.php?mod=space&uid=1231151]@author[/url] kilpikonna\n */\npublic class EatDirtForMoney extends JavaPlugin implements Listener\n{\n  int food;\n  int damage;\n  int maxfood;\n  int money;\n  boolean enable;\n  boolean enabledamage;\n  private static final Logger log = Logger.getLogger(\"Minecraft\");\n  public void onEnable()\n  {\n    \n    if (!setupEconomy() ) {\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]没有经济(Vault)插件,插件自动关闭\");\n        getServer().getPluginManager().disablePlugin(this);\n        return;\n    }\n    Bukkit.getServer().getPluginManager().registerEvents(this, this);\n    getConfig().options().copyDefaults(true);\n    saveConfig();\n    this.damage = getConfig().getInt(\"damage\");\n    this.food = getConfig().getInt(\"food\");\n    this.maxfood = getConfig().getInt(\"maxfood\");\n    this.enable = getConfig().getBoolean(\"enable\");\n    this.money = getConfig().getInt(\"money\");\n    this.enable = true; \n    if (this.food < 0){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内food值小于0,插件自动关闭\");\n        this.enable = false;\n    }\n    if (this.food > 20){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内food值大于20,插件自动关闭\");\n        this.enable = false;\n    }\n    if (this.damage < 0.0D){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内damage值小于0,插件自动关闭\");\n        this.enable = false;\n    }\n    if (this.damage > 20.0D){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内damage值大于20,插件自动关闭\");\n        this.enable = false;\n    }\n    if (this.damage == 0.0D){\n        this.enabledamage = false;\n    }\n    if (this.maxfood < 0){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内maxfood值小于0,插件自动关闭\");\n        this.enable = false;\n    }\n    if (this.maxfood > 20){\n        Bukkit.getConsoleSender().sendMessage(\"[KE][吃土][警告]配置文件内maxfood值大于20,插件自动关闭\");\n        this.enable = false;\n    }\n  }\n  public static Economy econ = null;\n  private boolean setupEconomy() \n  {\n    if (getServer().getPluginManager().getPlugin(\"Vault\") == null) {\n        return false;\n    }\n    RegisteredServiceProvider<Economy> rsp = getServer().getServicesManager().getRegistration(Economy.class);\n    if (rsp == null) {\n        return false;\n    }\n    econ = rsp.getProvider();\n    return econ != null;\n  }\n\n  @EventHandler\n  final void onPlayerInteract(PlayerInteractEvent e)\n  {\n    Player player = e.getPlayer();\n    int foodl = player.getFoodLevel();\n    if (player.hasPermission(\"ke.ed.use\")) { \n        if (player.getItemInHand().getType() == Material.DIRT) { \n            if (e.getAction().equals(Action.RIGHT_CLICK_AIR)) {\n                if (player.getHealth() > 1.0D) {\n                    if (foodl <= this.maxfood) {\n                        if (player.getItemInHand().getAmount() == 1) {\n                            player.setItemInHand(new ItemStack(Material.AIR));\n                        } else {\n                            if (player.getItemInHand().getAmount() > 1) {\n                                player.getItemInHand().setAmount(player.getItemInHand().getAmount() - 1);\n                            }\n                        }\n                        if (this.enabledamage){\n                           player.setHealth(player.getHealth() - this.damage); \n                        }\n                        player.playSound(player.getLocation(), Sound.EAT, 10.0F, 1.0F);\n                        if (player.getFoodLevel() + this.food < this.maxfood) {\n                            player.setFoodLevel(foodl + this.food);\n                        } else {\n                            if (player.getFoodLevel() + this.food >= this.maxfood) {\n                                player.setFoodLevel(foodl + this.maxfood);\n                            }\n                        }\n                        EconomyResponse r = econ.depositPlayer(player, this.money);\n                        if(r.transactionSuccess()) {\n                            player.sendMessage(String.format(\"您收到了 %s\", econ.format(r.amount), econ.format(r.balance)));\n                        } else {\n                            player.sendMessage(String.format(\"发生了错误: %s\", r.errorMessage));\n                        }\n                        player.sendMessage(ChatColor.GREEN + \"您成功吃掉了一个土方块 :D\");\n                        player.sendMessage(ChatColor.GREEN + \"获得金币:\" + this.money + \"$; 获得饱食度:\" + (foodl - player.getFoodLevel()));\n                    \n                    }\n                }\n            }\n        }\n    }\n  }\n}复制代码\n\n\n\n截图:  \n\n\n\n\n真是累的一天_(:з」∠)_\n然而明天又会变成另一个累的一天_(:з」∠)_\n喜欢我(的插件)就点一下帖子下面的吧 :D\n这里这里   ↓↓↓↓↓↓↓",
    "replies": [
        {
            "author": "1511173241",
            "timestamp": 1464137340,
            "txt_content": "666\n66666666666666966"
        },
        {
            "author": "zhaoyitao011",
            "timestamp": 1464138180,
            "txt_content": "要是能发送全服广播就好了。。\n比如 某某某玩家 穷的吃土啦。。。\n这样。。。。"
        },
        {
            "author": "huangdou233",
            "timestamp": 1464138660,
            "txt_content": "吃土致富233"
        },
        {
            "author": "755634418a",
            "timestamp": 1464139740,
            "txt_content": "报告老板！我不想吃土我想吃草！"
        },
        {
            "author": "c37",
            "timestamp": 1464140760,
            "txt_content": "比如说配置文件里面写物品或者方块id，然后对应补充什么，有比率调整，比如说吃黑耀石有3%几率状态全满10s，有80%几率瞬间饱食度空，剩下17%几率吃完之后自动喇叭：“口牙好吃嘛嘛香”\n----系统提示：【玩家因尝试吃黑耀石崩掉牙齿而狗带】"
        },
        {
            "author": "andylizi",
            "timestamp": 1464142740,
            "txt_content": "建议：\n您成功吃掉了一个土方块 :D改为好吃么 :D\n\n另：不愧是C#，String.format都用上了"
        },
        {
            "author": "ju哌y",
            "timestamp": 1464146760,
            "txt_content": "楼主人真好！每次都直接把code发上来了"
        },
        {
            "author": "956334981",
            "timestamp": 1467611400,
            "txt_content": "很好的插件，但是，一吃就报错，无法扣血无法给钱，饥饿值能增长。Spigot1.7.2_R0.4\n[13:47:45] [Server thread/ERROR]: Could not pass event PlayerInteractEvent to EatDirtForMoney v0.0.3\norg.bukkit.event.EventException\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:320) ~[spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.java:62) ~[spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.plugin.TimedRegisteredListener.callEvent(TimedRegisteredListener.java:47) ~[spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.plugin.SimplePluginManager.fireEvent(SimplePluginManager.java:487) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.java:472) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.craftbukkit.v1_7_R1.event.CraftEventFactory.callPlayerInteractEvent(CraftEventFactory.java:212) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at org.bukkit.craftbukkit.v1_7_R1.event.CraftEventFactory.callPlayerInteractEvent(CraftEventFactory.java:182) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.PlayerConnection.a(PlayerConnection.java:617) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.PacketPlayInBlockPlace.a(SourceFile:60) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.PacketPlayInBlockPlace.handle(SourceFile:9) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.NetworkManager.a(NetworkManager.java:147) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.ServerConnection.c(ServerConnection.java:77) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.MinecraftServer.u(MinecraftServer.java:700) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.DedicatedServer.u(DedicatedServer.java:273) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.MinecraftServer.t(MinecraftServer.java:562) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.MinecraftServer.run(MinecraftServer.java:469) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        at net.minecraft.server.v1_7_R1.ThreadServerApplication.run(SourceFile:617) [spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\nCaused by: java.lang.NoSuchMethodError: net.milkbowl.vault.economy.Economy.depositPlayer(Lorg/bukkit/OfflinePlayer;D)Lnet/milkbowl/vault/economy/EconomyResponse;\n        at cc.moecraft.eatdirtformoney.EatDirtForMoney.onPlayerInteract(EatDirtForMoney.java:125) ~[?:?]\n        at sun.reflect.GeneratedMethodAccessor548.invoke(Unknown Source) ~[?:?]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_91]\n        at java.lang.reflect.Method.invoke(Unknown Source) ~[?:1.8.0_91]\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:318) ~[spigot-1.7.2-R0.4.jar:git-Spigot-1.7.2-R0.3-122-gb58e277]\n        ... 16 more"
        },
        {
            "author": "艺妓",
            "timestamp": 1582681200,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽\n"
        }
    ]
}