{
    "title": "【开源】【.NET】MC启动模块——停止更新，代码陈旧，不建议使用",
    "author": "mcmny",
    "replyCount": 29,
    "timestamp": 1418565060,
    "txt_content": " 本帖最后由 mcmny 于 2015-4-21 13:42 编辑 \n\n嗯，最近启动器貌似非常火爆，各种启动器如雨后春笋一样冒了出来，而易语言的启动器因为源码铺天盖地，所以启动器非常多，反而我大.NET寥寥无几。。。所以，我依照我原来做的MMCL启动器重新革新代码，做出了本启动模块。。。\n我觉得我做的模块最大的优点便是有强大的错误处理系统可以处理未知错误。。。。\n好了，进入正题：\n调用方法：MRunmc.MRunmc(name,nc,versions)\n传递参数：\nname\n类型:string\n描述：游戏ID\nnc\n类型:string\n描述：以M为单位，游戏内存\nversions\n类型:string\n描述：需要启动的游戏版本(\\.minecraft\\versions)\n返回值：MRunmc.MRunmcreturn结构\n结构定义：\nPublic libraries() As String'根据json文件读取出来的所有需要加载的libraries文件名（部分为空，需要使用if判断是否为\"\")，形如java3d\\vecmath\\1.3.1\\vecmath-1.3.1.jar\nPublic bat As String'启动代码\nPublic suc As Boolean'启动是否成功\nPublic bug As String'错误类型\nPublic bugmsg As String'错误描述信息，可直接展示给用户\n\n错误类型：\nnotfoundjava:找不到java\n发生其他错误时类型为空，描述信息由.NET自动生成\n\n启动实例：\nVB.net:\nDim a As New MRunmc.MRunmc\n\n        Dim b As MRunmc.MRunmcreturn = a.MRunmc(\"player\", \"512\", \"1.7.2\")\n        If b.suc = True Then\n            Shell(b.bat, AppWinStyle.NormalFocus)\n            'For Each lib1 As String In b.libraries   'libraries文件处理实例\n            '    If lib1 <> \"\" Then\n            '        MessageBox.Show(lib1)\n            '    End If\n            'Next\n        Else\n            '错误处理\n        End If复制代码C#:\nMRunmc.MRunmc a = new MRunmc.MRunmc();\n\nMRunmc.MRunmcreturn b = (MRunmcreturn)a.MRunmc(\"player\", \"512\", \"1.7.2\");\nif (b.suc == true) {\n        Interaction.Shell(b.bat, AppWinStyle.NormalFocus);\n//libraries文件处理实例\n//foreach (string lib1 in b.libraries) {\n        //if (!string.IsNullOrEmpty(lib1)) {\n                //MessageBox.Show(lib1);\n        //}\n//}\n\n} else {\n        //错误处理\n}复制代码\n\n\n\n\n下载地址：\n百度云盘\n开源：本源代码以LGPL协议为基础发布，请遵守LGPL协议：http://www.gnu.org/licenses/lgpl.html\nVB.net:\nImports System.IO\nPublic Structure MRunmcreturn\n    Public libraries() As String\n    Public bat As String\n    Public suc As Boolean\n    Public bug As String\n    Public bugmsg As String\nEnd Structure\nPublic Class MRunmc\n    Public Function MRunmc(ByVal name, ByVal nc, ByVal versions)\n        Try\n            Dim libraries2(100) As String\n            Dim MRunmcreturn As New MRunmcreturn\n            Dim mi As Integer = 0\n            Dim libraries1 As Integer = 0\n            Dim a As String\n            Dim json As String\n            Dim json1 As String()\n            a = \"java -Xmx\" + nc + \"m -Dfml.ignoreInvalidMinecraftCertificates=true -Dfml.ignorePatchDiscrepancies=true -Djava.library.path=\" + Chr(34) + \".minecraft\\natives\" + Chr(34) + \" -cp \" + Chr(34)\n            json = File.ReadAllText(Directory.GetCurrentDirectory() + \"\\.minecraft\\versions\" + versions + \"\" + versions + \".json\")\n            json1 = json.Split(New String() {Chr(34)}, StringSplitOptions.RemoveEmptyEntries)\n            For Each m As String In json1\n                If m = \"name\" Then\n                    mi = 4\n                End If\n                If mi > 0 Then\n                    mi = mi - 1\n                End If\n                If mi = 1 And m.Contains(\".\") And m.Contains(\":\") Then\n\n                    Dim mlj As String\n                    Dim mname As String\n                    Dim mmh As Integer = InStr(m, \":\")\n                    mlj = Left(m, mmh - 1)\n                    mlj = Directory.GetCurrentDirectory() + \"\\.minecraft\\libraries\" + mlj.Replace(\".\", \"\")\n                    mname = Right(m, m.Length - mmh + 1)\n                    mlj = mlj + mname.Replace(\":\", \"\") + \"\"\n                    mname = Right(m, m.Length - mmh)\n                    mname = mname.Replace(\":\", \"-\") + \".jar;\"\n\n\n                    libraries2(libraries1) = mlj.Replace(Directory.GetCurrentDirectory() + \"\\.minecraft\\libraries\", \"\") + mname.Replace(\";\", \"\")\n\n                    libraries1 = libraries1 + 1\n                    a = a + mlj + mname\n                End If\n            Next\n            MRunmcreturn.libraries = libraries2\n            \n            'For Each m1 As String In\n            '    My.Computer.FileSystem.GetDirectories(Directory.GetCurrentDirectory() + \"\\.minecraft\\libraries\")\n            '    For Each m2 As String In\n            '        My.Computer.FileSystem.GetDirectories(m1)\n\n            '        For Each m3 As String In\n            '            My.Computer.FileSystem.GetDirectories(m2)\n            '            For Each m4 As String In\n            '                My.Computer.FileSystem.GetFiles(m3)\n            '                If json1.Contains(Path.GetFileNameWithoutExtension(m4)) Then\n            '                    a = a + m4 + \";\"\n            '                End If\n            '            Next\n            '            For Each m5 As String In\n            '                My.Computer.FileSystem.GetDirectories(m3)\n            '                For Each m6 As String In\n            '                    My.Computer.FileSystem.GetFiles(m5)\n            '                    If json1.Contains(Path.GetFileNameWithoutExtension(m6)) Then\n            '                        a = a + m6 + \";\"\n            '                    End If\n            '                Next\n            '                For Each m7 As String In\n            '                    My.Computer.FileSystem.GetDirectories(m5)\n            '                    For Each m8 As String In\n            '                        My.Computer.FileSystem.GetFiles(m7)\n            '                        If json1.Contains(Path.GetFileNameWithoutExtension(m8)) Then\n            '                            a = a + m8 + \";\"\n            '                        End If\n            '                    Next\n            '                    For Each m9 As String In\n            '                        My.Computer.FileSystem.GetDirectories(m7)\n            '                        For Each m10 As String In\n            '                            My.Computer.FileSystem.GetFiles(m9)\n            '                            If json1.Contains(Path.GetFileNameWithoutExtension(m10)) Then\n            '                                a = a + m10 + \";\"\n            '                            End If\n            '                        Next\n            '                        For Each m11 As String In\n            '                            My.Computer.FileSystem.GetDirectories(m9)\n            '                            For Each m12 As String In\n            '                                My.Computer.FileSystem.GetFiles(m11)\n            '                                If json1.Contains(Path.GetFileNameWithoutExtension(m12)) Then\n            '                                    a = a + m12 + \";\"\n            '                                End If\n            '                            Next\n            '                            For Each m14 As String In\n            '                                My.Computer.FileSystem.GetDirectories(m11)\n            '                                For Each m13 As String In\n            '                                      My.Computer.FileSystem.GetFiles(m14)\n            '                                    If json1.Contains(Path.GetFileNameWithoutExtension(m13)) Then\n            '                                        a = a + m13 + \";\"\n            '                                    End If\n            '                                Next\n            '                            Next\n            '                        Next\n            '                    Next\n            '                Next\n            '            Next\n            '        Next\n            '    Next\n            'Next\n            a = a + Directory.GetCurrentDirectory() + \"\\.minecraft\\versions\" + versions + \"\" + versions + \".jar\" + Chr(34)\n            a = a + \" \"\n            a = a + hz(json, name, versions)\n            'If login = True Then\n            'Dim mclogin As New yggdrasil.yggdrasil\n            ' mclogin.Login(name, passwd)\n            'Dim mcfh As New yggdrasil.yggdrasil.LoginInfo\n            'If mcfh.Suc = False Then\n            'login = False\n            'Return mcfh.Errinfo + \" 登录错误！\"\n            'Exit Function\n            'Else\n            'a = a.Replace(\"${auth_access_token}\", mcfh.SID)\n            'End If\n            'login = False\n            'End If\n            Try\n                Shell(\"java\", AppWinStyle.Hide)\n            Catch ex As FileNotFoundException\n                MRunmcreturn.suc = False\n                MRunmcreturn.bug = \"notfoundjava\"\n                MRunmcreturn.bugmsg = \"找不到java，请确认已安装java或java安装正确！\"\n                Return MRunmcreturn\n                Exit Function\n            End Try\n            MRunmcreturn.bat = a\n            MRunmcreturn.suc = True\n            Return MRunmcreturn\n        Catch cw As Exception\n            Dim MRunmcreturn As New MRunmcreturn\n            MRunmcreturn.suc = False\n            MRunmcreturn.bug = \"\"\n            MRunmcreturn.bugmsg = cw.Message\n            Return MRunmcreturn\n            Exit Function\n        End Try\n    End Function\n    Private Function assetIndex(ByVal json As String)\n        Dim a1 As Boolean = False\n        Dim a As Integer = 0\n        Dim json1 As String() = json.Split(New String() {Chr(34)}, StringSplitOptions.RemoveEmptyEntries)\n        For Each m As String In json1\n            If m = \"assets\" Then\n                a1 = True\n            End If\n            If a = 2 Then\n                Return m\n                Exit For\n            End If\n            If a1 = True Then\n                a = a + 1\n            End If\n        Next\n    End Function\n    Private Function hz(ByVal json As String, ByVal name As String, ByVal versions As String)\n        'Dim a As Integer\n        Dim json3 As String = mainclass(json)\n\n        Dim json1 As String() = json.Split(New String() {Chr(34)}, StringSplitOptions.RemoveEmptyEntries)\n        For Each json2 As String In json1\n            If json2.Contains(\"--\") Then\n                json3 = json3 + \" \" + json2\n                Exit For\n            End If\n            'If json2.Contains(Chr(34)) Then\n            '    a = InStr(json2, Chr(34))\n            '    json2 = Left(json2, a - 1)\n            'End If\n            'If json2.Contains(\"[        DISCUZ_CODE_2        ]quot;) Or (json2.Contains(\".\") And json2.Contains(Chr(34)) <> True) Then\n            '    json2 = \"--\" + json2\n            '    json3 = json3 + \" \" + json2\n            'End If\n        Next\n        json3 = json3.Replace(\"${game_directory}\", \".minecraft\")\n        json3 = json3.Replace(\"${assets_root}\", \".minecraft\\assets\")\n        json3 = json3.Replace(\"${game_assets}\", \".minecraft\\assets\")\n        json3 = json3.Replace(\"${user_properties}\", \"{}\")\n        json3 = json3.Replace(\"${auth_player_name}\", name)\n        json3 = json3.Replace(\"${version_name}\", versions)\n        If json3.Contains(\"${assets_index_name}\") Then\n            json3 = json3.Replace(\"${assets_index_name}\", assetIndex(json))\n        End If\n\n        Return json3\n    End Function\n\n\n    'If json2.Contains(\"id\") Then\n    ' json2 = \"\"\n    ' End If\n    'json2 = json2.Replace(Environment.NewLine, \"\")\n    'json2 = json2.Replace(\"{\", \"\")\n    'If json2.Contains(\"}\") And json2.Contains(\"[        DISCUZ_CODE_2        ]quot;) Then\n    ' json2 = \"--\" + json2\n    ' End If\n    'If json2.Contains(\".\") Then\n    'json2 = \"--\" + json2\n    'End If\n    'If json2.Contains(Chr(34)) Then\n    'a = InStr(json2, Chr(34))\n    'json2 = Left(json2, a - 1)\n    'End If\n    'json2 = json2.Replace(\"[        DISCUZ_CODE_2        ]quot;, \"${\")\n\n    Private Function mainclass(ByVal json As String)\n        Dim a1 As Boolean = False\n        Dim a As Integer = 0\n        Dim json1 As String() = json.Split(New String() {Chr(34)}, StringSplitOptions.RemoveEmptyEntries)\n        For Each m As String In json1\n            If m = \"mainClass\" Then\n                a1 = True\n            End If\n            If a = 2 Then\n                Return m\n                Exit For\n            End If\n            If a1 = True Then\n                a = a + 1\n            End If\n        Next\n\n    End Function\nEnd Class\n复制代码C#:\n懒得转成C#了。。。。\n\n求人气，求金币!\n\n\n\n\n",
    "replies": [
        {
            "author": "mcmny",
            "timestamp": 1418565240,
            "txt_content": " 本帖最后由 mcmny 于 2014-12-14 22:41 编辑 \n\n@zhh0000zhh @zhh0000zhh \n@zhh0000zhh \n@zhh0000zhh \n@zhh0000zhh \n\n@zhh0000zhh"
        },
        {
            "author": "1165392650",
            "timestamp": 1418566140,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "mcmny",
            "timestamp": 1418566380,
            "txt_content": "1165392650 发表于 2014-12-14 22:09\n能开发个- -云登陆器就好了\n这其实就是一个启动代码生成模块，可以用来开发启动器。。。"
        },
        {
            "author": "1165392650",
            "timestamp": 1418566500,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "huanghongxun",
            "timestamp": 1418619660,
            "txt_content": "@KMCCC。。。\nhttp://www.mcbbs.net/forum.php?m ... amp;highlight=KMCCC"
        },
        {
            "author": "mcmny",
            "timestamp": 1418641860,
            "txt_content": "huanghongxun 发表于 2014-12-15 13:01\n@KMCCC。。。\nhttp://www.mcbbs.net/forum.php?mod=viewthread&tid=333211&highlight=KMCCC\n这个和KMCCC还是不同的，这个是DLL类库模块，KMCCC是一个完整的启动器。。。而且我相信我的代码不会和KMCCC的一样，因为我的代码都是很奇葩的。。。"
        },
        {
            "author": "zhh0000zhh",
            "timestamp": 1418642340,
            "txt_content": "mcmny 发表于 2014-12-14 21:54\n@zhh0000zhh @zhh0000zhh \n@zhh0000zhh \n@zhh0000zhh \n其实，到最后你也没能@ 上我。。\n我无意中看到的。。\n咳咳，从体积上看。。咳咳，你忘记处理Native了。。"
        },
        {
            "author": "mcmny",
            "timestamp": 1418642580,
            "txt_content": "zhh0000zhh 发表于 2014-12-15 19:19\n其实，到最后你也没能@ 上我。。\n我无意中看到的。。\n咳咳，从体积上看。。咳咳，你忘记处理Native了。。 ...\nnatives要处理？？？我是按照mclauncher（旋律）生成的启动代码仿照做的，直接使用-Djava.library.path=\".minecraft\\natives\"概括了。。。。"
        },
        {
            "author": "我是M哥",
            "timestamp": 1418643540,
            "txt_content": "似乎有个相似的模块"
        },
        {
            "author": "zhh0000zhh",
            "timestamp": 1418644680,
            "txt_content": "mcmny 发表于 2014-12-15 19:23\nnatives要处理？？？我是按照mclauncher（旋律）生成的启动代码仿照做的，直接使用-Djava.library.path=\" ...\n旋律的native是固定的，永远用2.9.0\n标准的不是这样\n官方是在versions下每次解压缩，然后游戏结束后删除，BMCL貌似也是\nMCBN是每次启动解压缩native到native底下\nHMCL不知道。。但是也是启动后退出的，所以他也是不删除native的。"
        },
        {
            "author": "鱼青余",
            "timestamp": 1418645100,
            "txt_content": "Lz头像吊炸天"
        },
        {
            "author": "huanghongxun",
            "timestamp": 1418650920,
            "txt_content": "mcmny 发表于 2014-12-15 19:11\n这个和KMCCC还是不同的，这个是DLL类库模块，KMCCC是一个完整的启动器。。。而且我相信我的代码不会和KMC ...\nKMCCC是类库来的。。"
        },
        {
            "author": "mcmny",
            "timestamp": 1418652600,
            "txt_content": "huanghongxun 发表于 2014-12-15 21:42\nKMCCC是类库来的。。\n不是吧。。。我一直以来以为是启动器。。。。。。"
        },
        {
            "author": "alex1245133",
            "timestamp": 1418653140,
            "txt_content": "對我應該有用的QAQ"
        },
        {
            "author": "zhouyiran2",
            "timestamp": 1418656560,
            "txt_content": "为何不用专业稳定的KMCCC呢？"
        },
        {
            "author": "zhouyiran2",
            "timestamp": 1418656620,
            "txt_content": "mcmny 发表于 2014-12-15 22:10\n不是吧。。。我一直以来以为是启动器。。。。。。\n你在逗我、、（晚看到这条了、、）一直都是类库好不好、、"
        },
        {
            "author": "mcmny",
            "timestamp": 1418728260,
            "txt_content": "zhouyiran2 发表于 2014-12-15 23:16\n为何不用专业稳定的KMCCC呢？\n捉到广告君一只。。。"
        },
        {
            "author": "mcmny",
            "timestamp": 1418728860,
            "txt_content": "开源了。。。@zhh0000zhh"
        },
        {
            "author": "zhh0000zhh",
            "timestamp": 1418736300,
            "txt_content": "mcmny 发表于 2014-12-16 19:21\n开源了。。。@zhh0000zhh\n\n...\n话说，你咋这么喜欢@我。。\n\n有兴趣来群里吧284633248"
        },
        {
            "author": "huanghongxun",
            "timestamp": 1419245460,
            "txt_content": "zhh0000zhh 发表于 2014-12-15 19:58\n旋律的native是固定的，永远用2.9.0\n标准的不是这样\n官方是在versions下每次解压缩，然后游戏结束后删除 ...\n显然是临时解压natives。。\n删除就不删除。。\n第二次启动才删除"
        },
        {
            "author": "zhh0000zhh",
            "timestamp": 1419247200,
            "txt_content": "huanghongxun 发表于 2014-12-22 18:51\n显然是临时解压natives。。\n删除就不删除。。\n第二次启动才删除\n。。。明显只是不知道你的删除逻辑和存放位置而已。。"
        },
        {
            "author": "mcmny",
            "timestamp": 1419247440,
            "txt_content": "huanghongxun 发表于 2014-12-22 18:51\n显然是临时解压natives。。\n删除就不删除。。\n第二次启动才删除\n稀奇事。。。你回复我竟然没有得到通知。。。\n\n\n\n\n360截图20141222191620585.jpg (45.84 KB, 下载次数: 0)\n\n下载附件\n\n2014-12-22 19:20 上传\n\n\n\n\n\n话说，你说的为什么我感觉是病句，我根本没听懂。。。\n"
        },
        {
            "author": "huanghongxun",
            "timestamp": 1419314100,
            "txt_content": "mcmny 发表于 2014-12-22 19:24\n稀奇事。。。你回复我竟然没有得到通知。。。\n话说，你说的为什么我感觉是病句，我根本没听懂。。。\n ...\n意思是\n第一次启动MC，结束后不删除\n第二次启动MC前删除再解压"
        },
        {
            "author": "RK_cfcS",
            "timestamp": 1424466720,
            "txt_content": "冒泡围观撒花ING，，，，"
        },
        {
            "author": "Chen_Jiou",
            "timestamp": 1424598660,
            "txt_content": "zhh0000zhh 发表于 2014-12-15 19:19\n其实，到最后你也没能@ 上我。。\n我无意中看到的。。\n咳咳，从体积上看。。咳咳，你忘记处理Native了。。 ...\n能开发个- -云登陆器就好了！（本句为：“1165392650”所说，太棒了！）"
        },
        {
            "author": "mcmny",
            "timestamp": 1436879340,
            "txt_content": "jimmyzhaoxpft 发表于 2015-7-14 17:49\n@mcmny 弱弱的问一句，搞定name，version，nc，直接调用a就可以吗？\n是的，但是本模块有众多缺点，不建议使用了。。。\nPS：其实是我懒得改了。。。。"
        },
        {
            "author": "mcmny",
            "timestamp": 1438430520,
            "txt_content": "jimmyzhaoxpft 发表于 2015-8-1 15:30\n建议添加uuid的模块\n好像mmcl里有\n对了，@mcmny 那个dll怎么用？我只会把它放到mrunmc.vb ...\ndll是在您的启动器中引用的，mrunmc.vb是dll的开源代码。。。\n不过现在dll已经无法达到论坛软件资源版的启动器要求了，有时间我会再做一个。。。"
        },
        {
            "author": "zhanshi123",
            "timestamp": 1453824300,
            "txt_content": "请问这个模块在C#中怎么调用\n要先DllImport的吧\n但是我不是太懂，还希望楼主教一下"
        },
        {
            "author": "mcmny",
            "timestamp": 1453905900,
            "txt_content": "zhanshi123 发表于 2016-1-27 00:05\n请问这个模块在C#中怎么调用\n要先DllImport的吧\n但是我不是太懂，还希望楼主教一下 ...\n您好，您可以尝试使用MMCLS或者KMCCC，本帖的模块已经不支持新版MC的启动了，谢谢合作！"
        }
    ]
}