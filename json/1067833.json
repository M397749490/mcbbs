{
    "title": "平面直角坐标系和球坐标系的转换问题",
    "author": "轻光233",
    "replyCount": 6,
    "timestamp": 1593136980,
    "txt_content": " 本帖最后由 轻光233 于 2020-6-26 10:21 编辑 \n\n转换代码:\n\n\n\n\nAKII@B7%J}~WPVQVM}VTL2N.png (26.03 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-26 10:01 上传\n\n\n\n\n\n输出结果:\n\n\n\n\nQPPDLIZ8)686@70_IA(5KVT.png (7.9 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-26 10:01 上传\n\n\n\n\n\n坐标系图(手绘:\n\n\n\n\nUVH@4S9~@M45K1DYV_QLO6B.png (160.17 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-26 10:17 上传\n\n\n\n\n\n\n我尝试将一个(-1,-1,-1)的坐标通过以上代码转换成球坐标系然后转换回来\n但不知道为什么会出现正负错误(不是精度问题!)，请求帮助，万分感谢\n\n",
    "replies": [
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1593137340,
            "txt_content": " 本帖最后由 阴阳师元素祭祀 于 2020-6-26 10:11 编辑 \n\n浮点数精度问题\n正常 正常\n\n没什么事就不要互转 或者留一份源数据\nhttps://www.jianshu.com/p/83b1d52d39f7\n\n\n\n你符号都不对了啊\n你是不是应该确定一下正负？\n"
        },
        {
            "author": "轻光233",
            "timestamp": 1593137940,
            "txt_content": " 本帖最后由 轻光233 于 2020-6-26 10:20 编辑 \n阴阳师元素祭祀 发表于 2020-6-26 10:09\n浮点数精度问题\n正常 正常\n\n\n浮点精度问题我没管，反正到实际使用的时候这点精度问题已经不重要了，实际问的就是为什么正负出问题了\n补上了一张坐标系的图，可能会好一点(之前纸上就画的有不想在电脑上画了"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593138180,
            "txt_content": " 本帖最后由 疾风暗影 于 2020-6-26 10:25 编辑 \n\n你第一段里计算v2出错了，atan的返回范围是-pi/2到pi/2，实际应该根据x，y共同的符号修正pi的偏移\n\n比如x=1, y=1, atan返回pi/4\nx=-1,y=-1,atan返回pi/4，修正+pi，为5/4*pi\n\n这也就解释了为什么差个负号\n因为：cos(pi/4)=-cos(5/4*pi)\n"
        },
        {
            "author": "轻光233",
            "timestamp": 1593139260,
            "txt_content": "疾风暗影 发表于 2020-6-26 10:23\n你第一段里计算v2出错了，atan的返回范围是-pi/2到pi/2，实际应该根据x，y共同的符号修正pi的偏移\n\n比如x=1 ...\n所以也就是在y<0,x<0的时候要+pi修正一下是吗？那y<0,x>0呢？"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593139500,
            "txt_content": " 本帖最后由 疾风暗影 于 2020-6-26 10:53 编辑 \n轻光233 发表于 2020-6-26 10:41\n所以也就是在y\nx<0时都需要修正pi，因为极坐标起点是x轴正向逆时针"
        },
        {
            "author": "土球球",
            "timestamp": 1593145020,
            "txt_content": "用 Math.atan2() ...\n\n\n\n\n\nScreenshot from 2020-06-26 12-15-10.png (119.38 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-26 12:17 上传\n\n\n\n\n\n\nMath.atan2(y, x) 名义上是 Math.atan(y / x)，实际上是根据 y 和 x 在二维坐标系的位置自动计算辐角，会帮你把加减 pi 的问题修正好的。\n\n"
        }
    ]
}