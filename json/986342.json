{
    "title": "求找一款可以查询服务器内存具体占用来源的插件",
    "author": "我爱魁拔",
    "replyCount": 12,
    "timestamp": 1585216020,
    "txt_content": " 本帖最后由 我爱魁拔 于 2020-3-26 17:50 编辑 \n\n版本1.12.2 catserver。插件可以分析服务器内存的具体占用对象及其占用比例，比如 具体的某一类型的实体 title。最好可以确定内存占用较多的区块。",
    "replies": [
        {
            "author": "GiNYAi",
            "timestamp": 1585216020,
            "txt_content": "如果是内存占满崩服的话 大概是有插件/mod的代码有问题 导致内存泄漏\n\n而内存的分析一般来说比较困难 \nhttps://www.mcbbs.net/thread-823209-1-1.html\n/spark heapsummary\n可以试一下这个\n\n但是出来的结果大部分也就是byte array 或者 HashMap 之类 没有什么意义的信息\n你也可以尝试直接用/spark heapdump 生成完整的堆快照 然后找人分析"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585216140,
            "txt_content": " 本帖最后由 御炎Roinflam 于 2020-3-26 17:51 编辑 \n\nhttps://www.mcmod.cn/class/1506.html\n我觉得这个挺不错，不过是模组，但客户端不需要加\n\n至于内存的话\ness的/gc就能看\n[SCT][优化][付费]LagAssist —— 不可直视的九合一优化插件[1.8-1.14]\nhttps://www.mcbbs.net/thread-881861-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n[优化|管理|修复] Aegis Clear —— 高版本优化 | 清理 | 管理插件 [全版本]\nhttps://www.mcbbs.net/thread-918981-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n【Bone】React → 插件的优化新高度\nhttps://www.mcbbs.net/thread-876439-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n[综合|经济|传送|管理][少更新]Essentials EssentialsX —— 基础插件[1.7.10-1.14]\nhttps://www.mcbbs.net/thread-619883-1-1.html\n(出处: Minecraft(我的世界)中文论坛)\n\n这几个都行\n\n想看具体的话，为什么不发timings？\n\n\n\n"
        },
        {
            "author": "我爱魁拔",
            "timestamp": 1585216380,
            "txt_content": "御炎Roinflam 发表于 2020-3-26 17:49\nhttps://www.mcmod.cn/class/1506.html\n我觉得这个挺不错，不过是模组，但客户端不需要加\ntiming可以看内存占用吗，好像只能看tick。 = ="
        },
        {
            "author": "结城希亚",
            "timestamp": 1585216440,
            "txt_content": "我爱魁拔 发表于 2020-3-26 17:53\ntiming可以看内存占用吗，好像只能看tick。 = =\ntiles、tick和内存无直接关系\n\n所以你是问了2个问题\n而且下面的插件也能做到查看某个区块的内存什么的"
        },
        {
            "author": "我爱魁拔",
            "timestamp": 1585217280,
            "txt_content": "御炎Roinflam 发表于 2020-3-26 17:54\ntiles、tick和内存无直接关系\n\n所以你是问了2个问题\n抱歉，插件比较多，还没看完。 具体问题是服务器最近每过几个小时（间隔时间十分随机），分配的内存就会占满，然后崩服。一些内存回收的启动参数、优化内存清理区块的插件已经尝试了，但是没有太大的作用。通过观察内存占满间隔时间，发现当服务器里的老玩家多的时候，这个间隔时间就会大幅度缩短，所以推测可能是一些和mod相关的东西过度累积，导致内存占满。so另外请教一下内存占用和什么关系比较大"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585217400,
            "txt_content": "我爱魁拔 发表于 2020-3-26 18:08\n抱歉，插件比较多，还没看完。 具体问题是服务器最近每过几个小时（间隔时间十分随机），分配的内存就会 ...\n你需要提供下服务器的log或者timings\n\n可能是某个插件/模组导致的"
        },
        {
            "author": "白钻想peach",
            "timestamp": 1585218180,
            "txt_content": "yum插件，功能挺多的"
        },
        {
            "author": "我爱魁拔",
            "timestamp": 1585219080,
            "txt_content": "御炎Roinflam 发表于 2020-3-26 18:10\n你需要提供下服务器的log或者timings\n\n可能是某个插件/模组导致的\n其实服务器tps再在高内存占用的时候还是比较健康的，除非达到快占满的情况（比如只剩下300m空闲内存）。timings需要等到内存占满的时候再发，先发一下插件和mod列表\n\n\n。另外可以指出是哪个插件可以查询占用内存大的区块吗，只找到了 LagAssist的区块分析功能，但是好像只显示分数“ 区块分析系统会根据评级分数找到分数最高(也就是最卡)的区块”。"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585219380,
            "txt_content": "我爱魁拔 发表于 2020-3-26 18:38\n其实服务器tps再在高内存占用的时候还是比较健康的，除非达到快占满的情况（比如只剩下300m空闲内存）。t ...\n区块和内存真沾不到什么关系\n\n可能是有个模组/插件一直在发包导致内存占用特别高\n\n要发的话把timings和log发过来看看\n\n而且你laggremove的gc没用吗？可以回收内存的\n如果你懒的话可以加个自定义时间执行命令插件"
        },
        {
            "author": "GiNYAi",
            "timestamp": 1585219620,
            "txt_content": "御炎Roinflam 发表于 2020-3-26 18:43\n区块和内存真沾不到什么关系\n\n可能是有个模组/插件一直在发包导致内存占用特别高\n如果对象仍然有引用仍然存在的话  是不会被GC回收掉的\n他的这种描述应该是有代码有逻辑问题\n\n内存快满的时候tps低 应该是jvm频繁gc导致的"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585219680,
            "txt_content": "GiNYAi 发表于 2020-3-26 18:47\n如果对象仍然有引用仍然存在的话  是不会被GC回收掉的\n他的这种描述应该是有代码有逻辑问题\n那也得有log来看看，不然什么信息都没只能猜"
        },
        {
            "author": "我爱魁拔",
            "timestamp": 1585220820,
            "txt_content": "御炎Roinflam 发表于 2020-3-26 18:43\n区块和内存真沾不到什么关系\n\n可能是有个模组/插件一直在发包导致内存占用特别高\ngc了之后可以减少1g左右，同时服务器卡顿几秒，但是过1分钟左右又回到了原来的占用"
        }
    ]
}