{
    "title": "突破评分区间限制的 Bug",
    "author": "NoName德里奇",
    "replyCount": 20,
    "timestamp": 1542942480,
    "txt_content": " 本帖最后由 NoName德里奇 于 2018-11-23 19:15 编辑 \n\n为了避免无谓的损失，请各位dalao读完之后不要去测试这个 Bug，\n因为之前有不少 dalao 已经验证了，它的确是存在的。\n\n\n如题，事故现场：http://www.mcbbs.net/thread-831229-1-1.html\n这是事故现场的截图：\n\n我在评分时的积分等级是 Lv.8，\n其他的八级用户可以试试看，自己的帖子评分菜单是不是这样：\n\n\n\n\nTIM截图20181123110153.jpg (4.89 KB, 下载次数: 0)\n\n下载附件\n\n2018-11-23 11:04 上传\n\n\n\n\n\n我这里由于某些原因，一次评出 +4 人气，\n但是由于达到本日评分上限，我就没法再尝试一次了。\nBug 复现过程如下：\n1. 正常地输入评分数值，选择或者输入评分附言；\n2. 快速猛击 Ctrl+Enter，如果看到“内部错误，无法现实此内容”，\n    Bug 此时应该复现成功，完成了翻倍评分。\n\n这次事故现场的 dalao 一番慷慨直言，的确值得得到 +4 人气；\n但是如果这种 Bug 被人用来违规金粒转账，我想不是论坛的管.理.员愿意看到的。\n大概就是这样。",
    "replies": [
        {
            "author": "Оil",
            "timestamp": 1542943140,
            "txt_content": "经证实，该BUG是真的。\n版主可酌情考虑撤销我的评分。\n@混乱 \n#脸黑"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1542943500,
            "txt_content": "感谢楼上的测试。\n我这里收到的系统提醒可能有一定的参考意义：\n\n可以看到，楼上 dalao 的评分时 +1/次，但是却能够连续使用四次，\n应该是卡了后台短时间的无响应。"
        },
        {
            "author": "langyo",
            "timestamp": 1542945420,
            "txt_content": "\n\n试了下，在评分已耗尽的情况下是真正的无法评分\n\n这个 Bug 还是有点局限性的\n\n要修复此 Bug 是很困难的一件事，原因不在于 Discuz！ 不稳定，而是因为论坛其实是由多个服务器并行运行的……"
        },
        {
            "author": "动物的世界",
            "timestamp": 1542948060,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "asjkdaskljda",
            "timestamp": 1542949020,
            "txt_content": "老bug了，我第一次在论坛遇到是16年好像\n无线点按钮就OK"
        },
        {
            "author": "Abraham511",
            "timestamp": 1542950820,
            "txt_content": "这个是一个好几年前就有的Bug了....\n\nPS ： 楼主就这样获得了14人气...."
        },
        {
            "author": "Akkariin",
            "timestamp": 1542951360,
            "txt_content": "langyo 发表于 2018-11-23 11:57\n试了下，在评分已耗尽的情况下是真正的无法评分\n\n这个 Bug 还是有点局限性的\n测试了一下还真的可以。\n感觉是因为论坛服务器负载均衡的原因，后台有多台服务器同时处理数据。\n而利用狂按快速发送请求会导致请求被负载均衡处理，而操作写入数据库时是有延迟的。\n这时候如果你的手速过快就可以在第一台服务器写入 db 之前向第二台服务器发起请求，两台服务器都写入 db 数据了，这样就出现了二次评分的情况。\n做过电商网站的人应该都知道，做了负载均衡以后，在遇到秒杀抢购的时候很容易出现重复订单的情况。\n这时候只有通过数据库并发限制接口才能解决这个问题，通过建立一个数据处理队列，通过接口逐条处理数据。"
        },
        {
            "author": "langyo",
            "timestamp": 1542955500,
            "txt_content": "Akkariin 发表于 2018-11-23 13:36\n测试了一下还真的可以。\n感觉是因为论坛服务器负载均衡的原因，后台有多台服务器同时处理数据。\n而利用狂 ...\n我这里重复评分失败了，可能是我这里网络问题（垃圾校园网）\n\n剩余 20 金粒我后续有时间再想办法还给你吧"
        },
        {
            "author": "Belanga",
            "timestamp": 1542960360,
            "txt_content": "正常，我卡过38人气（可以看我在反馈版的帖子），当然最后评分撤回了。"
        },
        {
            "author": "1139365029",
            "timestamp": 1542975720,
            "txt_content": "数据库的线程安全性出了问题而已，\n个人觉得，只需要在表单校验的js里面增加一个判断就可以了，\n\n如果要从根源上解决这个并发问题的话，\n可以通过对数据库添加排它锁来解决，不过几率出现活锁。"
        },
        {
            "author": "skyliye",
            "timestamp": 1542977460,
            "txt_content": "emmmm  大概是手速慢了"
        },
        {
            "author": "zyjking",
            "timestamp": 1542986220,
            "txt_content": "这跟网络环境不好的情况下，一直用鼠标点确认是一样的"
        },
        {
            "author": "zjxx",
            "timestamp": 1543014660,
            "txt_content": "老早以前就有的bug了\n我好像还反馈一次(\n只是这样子撤销评分的话会倒扣相应积分"
        },
        {
            "author": "west.myth",
            "timestamp": 1543130580,
            "txt_content": "在以往的此类反馈贴听说只是看起来而已？现在又是确有其事？\n你这波赚翻了啊\n话说，如果这样评分金粒，会扣除相应数量的吗？（即双倍）@skpsk自己家"
        },
        {
            "author": "Hueihuea",
            "timestamp": 1543131360,
            "txt_content": "west.myth 发表于 2018-11-25 15:23\n在以往的此类反馈贴听说只是看起来而已？现在又是确有其事？\n你这波赚翻了啊\n话说，如果这样评分金粒，会扣 ...\n我压根没有超过30金粒XD"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1543139280,
            "txt_content": "west.myth 发表于 2018-11-25 15:23\n在以往的此类反馈贴听说只是看起来而已？现在又是确有其事？\n你这波赚翻了啊\n话说，如果这样评分金粒，会扣 ...\n确有其事。\n这样得到的积分某种意义上属于非.法所得，\n被管理员没收也是合情合理的，我并不指望依靠 bug 来发财。"
        },
        {
            "author": "匿名",
            "timestamp": 1543167600,
            "txt_content": "这个BUG有时候实际给的数量并没有显示的那么多\n撤销评分之后会倒扣分"
        },
        {
            "author": "风扇滑翔翼",
            "timestamp": 1543657500,
            "txt_content": "这个BUG经过研究甚至可以被人刻意利用 能用一种方法稳定触发"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1543669380,
            "txt_content": "风扇滑翔翼 发表于 2018-12-1 17:45\n这个BUG经过研究甚至可以被人刻意利用 能用一种方法稳定触发\n这种方法已经写在一楼了"
        },
        {
            "author": "风扇滑翔翼",
            "timestamp": 1543671120,
            "txt_content": "NoName德里奇 发表于 2018-12-1 21:03\n这种方法已经写在一楼了\n你这个猛敲坏键盘 而且也不是百分百成功 huaji"
        }
    ]
}