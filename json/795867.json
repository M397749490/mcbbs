{
    "title": "宝石镶嵌代码模板",
    "author": "隔壁老吕",
    "replyCount": 0,
    "timestamp": 1526800260,
    "txt_content": " 本帖最后由 隔壁老吕 于 2018-5-20 17:52 编辑 \nimport java.util.List;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport org.bukkit.Material;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.inventory.ItemStack;\nimport org.bukkit.inventory.meta.ItemMeta;\nimport org.bukkit.event.inventory.InventoryClickEvent;\nimport org.bukkit.event.inventory.InventoryType;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class Baoshi extends JavaPlugin implements Listener{\n    HashMap<String, ItemMeta> usingMap = new HashMap<>();\n    HashMap<String, ItemStack> firstItemMap = new HashMap<>();\n    public ItemMeta baoshi(){\n        ItemStack item = new ItemStack(276);\n        ItemMeta meta = item.getItemMeta();\n        List<String> lore = new ArrayList<>();\n        lore.add(\"xx宝石\");\n        meta.setDisplayName(\"xx宝石\");\n        meta.setLore(lore);\n        return meta;\n    }\n    @EventHandler\n    public void InventoryClickEvent(InventoryClickEvent e){\n        Player p = (Player)e.getWhoClicked();\n        if (e.getRawSlot() < 0) {\n            return;\n        }\n        ItemStack item = e.getCurrentItem();\n        ItemMeta meta = item.getItemMeta();\n        if (usingMap.containsKey(p.getName()))\n        {\n            if(e.isRightClick()){\n                if (e.getInventory().getType() != InventoryType.CRAFTING) {\n                    p.sendMessage(\"§c请在背包内右键\");\n                    return;\n                }\n\n                if ((item == null) || (item.getType().equals(Material.AIR))) {\n                    e.setCancelled(true);\n                    p.closeInventory();\n                    p.sendMessage(\"镶嵌取消\");\n                    usingMap.remove(p.getName());\n                    return;\n                }\n                ItemStack fitem = firstItemMap.get(p.getName());\n                boolean state = false;\n                if(item.getTypeId() == 0/*镶嵌物品id*/){\n                    state = true;\n                }\n\n                if (state == false){\n                    e.setCancelled(true);\n                    p.sendMessage(\"不能镶嵌\");\n                    return;\n                }\n                //code..........\n                p.sendMessage(\"镶嵌成功\");  \n                usingMap.remove(p.getName());\n                firstItemMap.remove(p.getName());\n                int sl = fitem.getAmount() -1;\n                p.getInventory().remove(fitem);\n                ItemStack add = fitem;\n                add.setAmount(sl);\n                p.getInventory().addItem(add);\n                e.setCancelled(true);\n                p.closeInventory();\n            }\n        } else {\n            if (e.isRightClick()){\n                if (meta == baoshi()){\n                    usingMap.put(p.getName(), meta);\n                    firstItemMap.put(p.getName(), item);\n                    p.sendMessage(\"正在镶嵌\");\n                    e.setCancelled(true);\n                    p.closeInventory();\n                }\n            }\n        }\n    }\n}复制代码\n\n",
    "replies": []
}