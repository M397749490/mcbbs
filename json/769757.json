{
    "title": "自定义生成结构(重置版)",
    "author": "ruhuasiyu",
    "replyCount": 7,
    "timestamp": 1511359380,
    "txt_content": " 本帖最后由 ruhuasiyu 于 2018-8-19 09:42 编辑 \n\n版本是18w32a+ (1.13-18w30b记分板操作略有不同)，思路基于pineapple的帖子并做了较多的变动和改进。\n\n首先弄一个进度，用于判断生物群系\ncpp/advancements/generate/root.json\n{\n    \"criteria\":{\n        \"desert\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"desert\"}},\n        \"desert_hills\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"desert_hills\"}},\n        \"mutated_desert\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mutated_desert\"}},\n        \"mesa\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mesa\"}},\n        \"mesa_rock\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mesa_rock\"}},\n        \"mesa_clear_rock\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mesa_clear_rock\"}},\n        \"mutated_mesa\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mutated_mesa\"}},\n        \"mutated_mesa_rock\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mutated_mesa_rock\"}},\n        \"mutated_mesa_clear_rock\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"mutated_mesa_clear_rock\"}},\n        \"roofed_forest\":{\"trigger\":\"minecraft:location\",\"conditions\": {\"biome\": \"roofed_forest\"}}\n    },\n        \"requirements\":[[\n                \"desert\",\n                \"desert_hills\",\n                \"mutated_desert\",\n                \"mesa\",\n                \"mesa_rock\",\n                \"mesa_clear_rock\",\n                \"mutated_mesa\",\n                \"mutated_mesa_rock\",\n                \"mutated_mesa_clear_rock\",\n                \"roofed_forest\"\n        ]],\n    \"rewards\":{\n        \"function\":\"cpp:generate/creeper_dungeon\"\n    }\n}\n复制代码我这里设定的结构只能在沙漠、平顶山和黑森林生成。\n\n玩家进入指定群系后，执行剥夺进度，检测玩家是否在区域药水云标记的东南32*32区域内\ncpp/functions/generate/generate.mcfunction\nadvancement revoke @s only cpp:generate/root\nexecute at @s positioned ~-33 -2 ~-33 unless entity @e[tag=cpp_chunk,dx=34,dy=256,dz=34] run function cpp:generate/mark复制代码若不在，则将玩家坐标对齐到32的倍数处，并放置药水云，并生成用于随机结构的蝙蝠，spread之后杀死之。\ncpp/functions/generate/generate.mcfunction\nsummon armor_stand ~ -1 ~ {Tags:[\"cpp_chunk\",\"cpp_undet\"],Invulnerable:1b,Invisible:1b,Marker:1b,NoGravity:1b,Small:1b,DisabledSlots:7967}\nscoreboard players set #32 cppValue 32\nexecute store result score @s cppValue run data get entity @s Pos[0]\nscoreboard players operation @s cppValue /= #32 cppValue\nexecute store result entity @e[tag=cpp_undet,sort=nearest,limit=1] Pos[0] double 1 run scoreboard players operation @s cppValue *= #32 cppValue\nexecute store result score @s cppValue run data get entity @s Pos[2]\nscoreboard players operation @s cppValue /= #32 cppValue\nexecute store result entity @e[tag=cpp_undet,sort=nearest,limit=1] Pos[2] double 1 run scoreboard players operation @s cppValue *= #32 cppValue\n\nsummon bat ~ ~ ~ {Silent:1b,NoAI:1,DeathLootTable:\"cpp:generate/bat\",Tags:[\"cpp_generate\"]}\nexecute at @e[tag=cpp_undet,sort=nearest,limit=1] run spreadplayers ~ ~ 7 13 false @e[tag=cpp_generate]\ntag @e[tag=cpp_undet] remove cpp_undet\nkill @e[tag=cpp_generate]复制代码然后弄一个loot_table\n\ncpp/loot_tables/generate/bat.json\n{\n    \"pools\": [\n        {\n            \"rolls\": 1,\n            \"entries\": [\n                {\n                    \"type\": \"item\",\n                    \"name\": \"minecraft:wheat_seeds\",\n                    \"weight\": 50,\n                    \"functions\": [\n                        {\n                            \"function\": \"set_nbt\",\n                            \"tag\": \"{Tags:[\"cpp_dead\"]}\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"item\",\n                    \"name\": \"minecraft:wheat_seeds\",\n                    \"weight\": 25,\n                    \"functions\": [\n                        {\n                            \"function\": \"set_nbt\",\n                            \"tag\": \"{Tags:[\"cpp_dead\",\"cpp_wool_tree\"]}\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"item\",\n                    \"name\": \"minecraft:wheat_seeds\",\n                    \"weight\": 1,\n                    \"functions\": [\n                        {\n                            \"function\": \"set_nbt\",\n                            \"tag\": \"{Tags:[\"cpp_dead\",\"cpp_creeper_dungeon\"]}\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"item\",\n                    \"name\": \"minecraft:wheat_seeds\",\n                    \"weight\": 1,\n                    \"functions\": [\n                        {\n                            \"function\": \"set_nbt\",\n                            \"tag\": \"{Tags:[\"cpp_dead\",\"cpp_enchanting_room\"]}\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"item\",\n                    \"name\": \"minecraft:wheat_seeds\",\n                    \"weight\": 1,\n                    \"functions\": [\n                        {\n                            \"function\": \"set_nbt\",\n                            \"tag\": \"{Tags:[\"cpp_dead\",\"cpp_totem_pillar\"]}\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}\n\n复制代码在主循环中，检测蝙蝠的掉落物\ncpp/functions/tick.mcfunction (在minecraft:tick函数标签中添加该函数)\nexecute as @e[type=item,nbt={Item:{tag:{Tags:[\"cpp_dead\"]}}}] at @s run function cpp:generate/build\n复制代码根据掉落物的不同，构建相应的建筑\ncpp:generate/build.mcfunction\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_creeper_dungeon\"]}}}] if block ~ 15 ~ cave_air run function cpp:generate/structures/creeper_dungeon\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_enchanting_room\"]}}}] unless block ~ 62 ~ water run function cpp:generate/structures/enchanting_room\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~32 ~ run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~64 ~ run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~96 ~ run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~128 ~ run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~160 ~ run function cpp:generate/structures/totem_pillar\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_totem_pillar\"]}}}] unless block ~ 62 ~ water positioned ~ ~192 ~ run function cpp:generate/structures/totem_pillar\n\nexecute as @s[nbt={Item:{tag:{Tags:[\"cpp_wool_tree\"]}}}] if block ~ ~-1 ~ grass_block run function cpp:plants/trees/wool_sapling\n\nkill @s\n复制代码例如爬行者地牢\ncpp/functions/generate/structures/creeper_dungeon.mcfunction\nfill ~ 13 ~ ~6 19 ~6 minecraft:air\nsetblock ~2 14 ~1 minecraft:structure_block{posX:-2,posY:-1,posZ:-1,name:\"cpp:build/mossybox\",mode:\"LOAD\",integrity:0.5f}\nsetblock ~1 14 ~1 minecraft:redstone_block\nfill ~ 13 ~ ~6 19 ~6 minecraft:cobblestone keep\nfill ~1 14 ~1 ~5 18 ~5 minecraft:air\nsetblock ~3 14 ~3 minecraft:spawner{MaxNearbyEntities:6s,RequiredPlayerRange:16s,SpawnCount:4s,SpawnData:{id:\"minecraft:creeper\"},MaxSpawnDelay:800s,MaxSpawnDelay:200s,SpawnRange:4s}\nsetblock ~3 14 ~5 minecraft:chest{LootTable:\"minecraft:chests/simple_dungeon\"}\nsetblock ~3 14 ~1 minecraft:chest[facing=south]{LootTable:\"minecraft:chests/simple_dungeon\"}\n复制代码这个方法也适用于生成于同生物群系的多种建筑，只需添加多种掉落物并分配权重即可。\n\n",
    "replies": [
        {
            "author": "2759159258",
            "timestamp": 1511415900,
            "txt_content": "已阅 不过好像没@   到pineapple......(然而是什么高级的补充?看不懂)\n@pineapple"
        },
        {
            "author": "zy934210292",
            "timestamp": 1511953200,
            "txt_content": "6666666666666666"
        },
        {
            "author": "qq2679415013",
            "timestamp": 1512195840,
            "txt_content": "\n很棒的作品！"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1534642860,
            "txt_content": "把计分板操作修改了一下，满足18w32a+版本。"
        },
        {
            "author": "1756746217",
            "timestamp": 1534689960,
            "txt_content": "哇，，真的好乱，看不懂"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1534691040,
            "txt_content": "1756746217 发表于 2018-8-19 22:46\n哇，，真的好乱，看不懂\n好乱？？"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1534718880,
            "txt_content": " 本帖最后由 Teenager_Yang 于 2018-10-6 16:55 编辑 \n\n感觉比菠萝dalao的简单多了……\n终于看得懂了……（感动）\n然后贴上菠萝dalao的帖子：\n[1.12function]在原版添加自定义自然生成建筑<第三代精简易修改版>（附带下载）\nhttp://www.mcbbs.net/thread-735127-1-1.html\n\n\n\n"
        }
    ]
}