{
    "title": "关于BlockState与MetaData[1.12.2]",
    "author": "1696144659",
    "replyCount": 1,
    "timestamp": 1580915580,
    "txt_content": " 本帖最后由 1696144659 于 2020-2-5 23:15 编辑 \n\n我想用meta储存Block的信息,于是定义了六个Boolean值\n    public static final PropertyBool UP = PropertyBool.create(\"up\");\n    public static final PropertyBool DOWN = PropertyBool.create(\"down\");\n    public static final PropertyBool NORTH = PropertyBool.create(\"north\");\n    public static final PropertyBool SOUTH = PropertyBool.create(\"south\");\n    public static final PropertyBool EAST = PropertyBool.create(\"east\");\n    public static final PropertyBool WEST = PropertyBool.create(\"west\");复制代码@Override\n    protected BlockStateContainer createBlockState() {\n        return new BlockStateContainer(this, UP, DOWN, EAST, NORTH, SOUTH, WEST);\n    }\n\n    @Override\n    public IBlockState getStateFromMeta(int meta) {\n        boolean[] position = new boolean[]{false, false, false, false, false, false};\n        String s = Integer.toBinaryString(meta);\n        char[] c = s.toCharArray();\n        for (int i = 0; i < 6; i++){\n            if (c[i] == 1){position[i] = true;}else {position[i] = false;}\n        }\n        return this.getDefaultState()\n                .withProperty(UP, position[0]).withProperty(DOWN, position[1])\n                .withProperty(EAST, position[2]).withProperty(NORTH, position[3])\n                .withProperty(SOUTH, position[4]).withProperty(WEST, position[5]);\n    }\n\n    @Override\n    public int getMetaFromState(IBlockState state) {\n        int i = 0;\n        if (state.getValue(UP)){ i++; }\n        i *= 2;\n        if (state.getValue(DOWN)){ i++; }\n        i *= 2;\n        if (state.getValue(EAST)){ i++; }\n        i *= 2;\n        if (state.getValue(NORTH)){ i++; }\n        i *= 2;\n        if (state.getValue(SOUTH)){ i++; }\n        i *= 2;\n        if (state.getValue(WEST)){ i++; }\n        return i;\n    }复制代码但是一调试就崩,而且只要把getStateFromMeta方法返回this.getDefultState();getMetaFromState方法返回0就不会崩\n 这是怎么回事?谁能帮我看一下这两个方法哪错了?\n\n\n崩溃日志:\n---- Minecraft Crash Report ---- // Don't do that.  Time: 2/5/20 10:54 PM Description: Initializing game  java.lang.ArrayIndexOutOfBoundsException: 16         at net.minecraftforge.registries.GameData$BlockCallbacks.onAdd(GameData.java:353)         at net.minecraftforge.registries.GameData$BlockCallbacks.onAdd(GameData.java:319)         at net.minecraftforge.registries.ForgeRegistry.add(ForgeRegistry.java:357)         at net.minecraftforge.registries.ForgeRegistry.add(ForgeRegistry.java:288)         at net.minecraftforge.registries.ForgeRegistry.register(ForgeRegistry.java:120)         at net.minecraftforge.registries.ForgeRegistry.registerAll(ForgeRegistry.java:161)         at com.ci.handler.RegistryHandler.onBlockRegister(RegistryHandler.java:20)         at net.minecraftforge.fml.common.eventhandler.ASMEventHandler_5_RegistryHandler_onBlockRegister_Register.invoke(.dynamic)         at net.minecraftforge.fml.common.eventhandler.ASMEventHandler.invoke(ASMEventHandler.java:90)         at net.minecraftforge.fml.common.eventhandler.EventBus$1.invoke(EventBus.java:144)         at net.minecraftforge.fml.common.eventhandler.EventBus.post(EventBus.java:182)         at net.minecraftforge.registries.GameData.fireRegistryEvents(GameData.java:847)         at net.minecraftforge.fml.common.Loader.preinitializeMods(Loader.java:628)         at net.minecraftforge.fml.client.FMLClientHandler.beginMinecraftLoading(FMLClientHandler.java:252)         at net.minecraft.client.Minecraft.init(Minecraft.java:514)         at net.minecraft.client.Minecraft.run(Minecraft.java:422)         at net.minecraft.client.main.Main.main(Main.java:118)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at net.minecraft.launchwrapper.Launch.launch(Launch.java:135)         at net.minecraft.launchwrapper.Launch.main(Launch.java:28)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at net.minecraftforge.gradle.GradleStartCommon.launch(GradleStartCommon.java:97)         at GradleStart.main(GradleStart.java:25)   A detailed walkthrough of the error, its code path and all known details is as follows: ---------------------------------------------------------------------------------------  -- Head -- Thread: Client thread Stacktrace:         at net.minecraftforge.registries.GameData$BlockCallbacks.onAdd(GameData.java:353)         at net.minecraftforge.registries.GameData$BlockCallbacks.onAdd(GameData.java:319)         at net.minecraftforge.registries.ForgeRegistry.add(ForgeRegistry.java:357)         at net.minecraftforge.registries.ForgeRegistry.add(ForgeRegistry.java:288)         at net.minecraftforge.registries.ForgeRegistry.register(ForgeRegistry.java:120)         at net.minecraftforge.registries.ForgeRegistry.registerAll(ForgeRegistry.java:161)         at com.ci.handler.RegistryHandler.onBlockRegister(RegistryHandler.java:20)         at net.minecraftforge.fml.common.eventhandler.ASMEventHandler_5_RegistryHandler_onBlockRegister_Register.invoke(.dynamic)         at net.minecraftforge.fml.common.eventhandler.ASMEventHandler.invoke(ASMEventHandler.java:90)         at net.minecraftforge.fml.common.eventhandler.EventBus$1.invoke(EventBus.java:144)         at net.minecraftforge.fml.common.eventhandler.EventBus.post(EventBus.java:182)         at net.minecraftforge.registries.GameData.fireRegistryEvents(GameData.java:847)         at net.minecraftforge.fml.common.Loader.preinitializeMods(Loader.java:628)         at net.minecraftforge.fml.client.FMLClientHandler.beginMinecraftLoading(FMLClientHandler.java:252)         at net.minecraft.client.Minecraft.init(Minecraft.java:514)  -- Initialization -- Details: Stacktrace:         at net.minecraft.client.Minecraft.run(Minecraft.java:422)         at net.minecraft.client.main.Main.main(Main.java:118)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at net.minecraft.launchwrapper.Launch.launch(Launch.java:135)         at net.minecraft.launchwrapper.Launch.main(Launch.java:28)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:498)         at net.minecraftforge.gradle.GradleStartCommon.launch(GradleStartCommon.java:97)         at GradleStart.main(GradleStart.java:25)  -- System Details -- Details:         Minecraft Version: 1.12.2         Operating System: Windows 7 (amd64) version 6.1         Java Version: 1.8.0_144, Oracle Corporation         Java VM Version: Java HotSpot(TM) 64-Bit Server VM (mixed mode), Oracle Corporation         Memory: 134787792 bytes (128 MB) / 408944640 bytes (390 MB) up to 947388416 bytes (903 MB)         JVM Flags: 0 total;          IntCache: cache: 0, tcache: 0, allocated: 0, tallocated: 0         FML: MCP 9.42 Powered by Forge 14.23.5.2836 5 mods loaded, 5 mods active         States: 'U' = Unloaded 'L' = Loaded 'C' = Constructed 'H' = Pre-initialized 'I' = Initialized 'J' = Post-initialized 'A' = Available 'D' = Disabled 'E' = Errored          | State | ID                   | Version      | Source                           | Signature |         |:----- |:-------------------- |:------------ |:-------------------------------- |:--------- |         | LCH   | minecraft            | 1.12.2       | minecraft.jar                    | None      |         | LCH   | mcp                  | 9.42         | minecraft.jar                    | None      |         | LCH   | FML                  | 8.0.99.99    | forgeSrc-1.12.2-14.23.5.2836.jar | None      |         | LCH   | forge                | 14.23.5.2836 | forgeSrc-1.12.2-14.23.5.2836.jar | None      |         | LCH   | reallyelectricitymod | 1.0          | reallyelectricitymod-1.0.jar     | None      |          Loaded coremods (and transformers):          GL info: ' Vendor: 'Intel' Version: '2.1.0 - Build 8.15.10.2869' Renderer: 'Intel(R) G41 Express Chipset'         Launched Version: 1.12.2         LWJGL: 2.9.4         OpenGL: Intel(R) G41 Express Chipset GL version 2.1.0 - Build 8.15.10.2869, Intel         GL Caps: Using GL 1.3 multitexturing. Using GL 1.3 texture combiners. Using framebuffer objects because EXT_framebuffer_object is supported. Shaders are available because OpenGL 2.1 is supported. VBOs are available because OpenGL 1.5 is supported.          Using VBOs: Yes         Is Modded: Definitely; Client brand changed to 'fml,forge'         Type: Client (map_client.txt)         Resource Packs:          Current Language: English (US)         Profiler Position: N/A (disabled)         CPU: 2x Intel(R) Celeron(R) CPU E3400 @ 2.60GHz",
    "replies": [
        {
            "author": "3TUSK",
            "timestamp": 1580926140,
            "txt_content": "定义了六个Boolean值\n\n六个 boolean 需要 6-bit 来存储，一个方块只有 4-bit（0到15）的 metadata，你这样肯定是不行的。\n这个是 Minecraft 区块存储格式的限制。\n\n\n\n1.13 起这个限制倒是没有了……"
        }
    ]
}