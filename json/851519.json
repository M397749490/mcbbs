{
    "title": "1.13手把手教学，用指令写一个贪吃蛇！",
    "author": "Sairos",
    "replyCount": 28,
    "timestamp": 1553251920,
    "txt_content": " 本帖最后由 Sairos 于 2019-3-22 18:52 编辑 \n\n一、游戏简介1.1 原版贪吃蛇游戏介绍\n\n       贪吃蛇一款需要耐心的游戏，通过某种方式比如键盘上下左右控制蛇的方向，寻找吃的东西，通过吃掉东西来获得分数，而且蛇的身子会越吃越长，身子越长玩的难度就越大，不能碰墙，更不能咬自己的身体\n\n\n\n\n20190319_102027_20190319102140.gif (994.36 KB, 下载次数: 1)\n\n下载附件\n\n2019-3-19 10:54 上传\n\n\n\n\n\n上图是我以前用python写的一个贪吃蛇游戏.....当然这也是我为在Minecraft写一个贪吃蛇有个依据\n\n1.2 Minecraft版贪吃蛇游戏介绍\n\n       在Minecraft里面的贪吃蛇与我所写的那个一样，也是通过吃掉食物来使自己的身体增长，在该游戏中除了基本的设计思路，后面还会有进阶操作...\n（在Minecraft中蛇头蛇身都是用的entity，也即实体，与我用python写的贪吃蛇原理一致，在python中我们蛇头蛇身我们叫做Sprite，也即精灵，与Minecraft的实体类似，吃食物增长身体都是通过精灵（实体）之间的碰撞来判定）\n\n\n\n\n20190319_110511_20190319110835.gif (951.85 KB, 下载次数: 2)\n\n下载附件\n\n2019-3-19 11:09 上传\n\n\n\n\n\n\n二、地图设置2.1 创建地图\n\n       因为之前做黄金矿工教程的时候有dalao说没必要吧教程搞这么仔细，所以我就不多讲了...我这里用的虚空地图，读者想用啥都随便了....\n\n2.2 创建函数\n\ndatapacks怎么搞我就不多讲了，我们将要用到以下.mcfunction：\nmain.mcfunction\nmoving.mcfunction\nspeed.mcfunction\neatfood.mcfunction\nothermode.mcfunction\nmode0.mcfunction\nmode1.mcfunction\n\n2.3 地图布置\n\n关于地图的布置问题，我都是以我自己做好的地图为基准，若读者有自己的需要，可自行修改\nmain.mcfunction\n#游戏物品\nreplaceitem entity @a hotbar.0 minecraft:carrot_on_a_stick{display:{Name:\"\"调速度\"\"},Enchantments:[{}]} 1\nreplaceitem entity @a hotbar.1 minecraft:carrot_on_a_stick{display:{Name:\"\"自动\"\"},Enchantments:[{}]} 1\nreplaceitem entity @a hotbar.8 minecraft:barrier{display:{Name:\"\"游戏结束\"\",Lore:[\"按Q结束游戏\"]},Enchantments:[{}]} 1\nreplaceitem entity @a hotbar.7 minecraft:written_book{Enchantments:[{id:\"minecraft:flame\",lvl:1}],title:\"开始游戏\",author:\"DearSairoz\",pages:[\"[{\"text\":\"开始游戏\",\"color\":\"dark_blue\",\"bold\":false,\"clickEvent\":{\"action\":\"run_command\",\"value\":\"/tag @a add start1\"}}]\"]} 1\nexecute as @e[nbt={Item:{id:\"minecraft:carrot_on_a_stick\",Count:1b,tag:{display:{Name:\"\"调速度\"\"}}}}] at @s run kill @s\nexecute as @e[nbt={Item:{id:\"minecraft:lily_pad\",Count:1b,tag:{display:{Name:\"\"第一人称\"\"}}}}] at @s run kill @s\nexecute as @e[nbt={Item:{id:\"minecraft:barrier\",Count:1b,tag:{display:{Name:\"\"游戏结束\"\",Lore:[\"按Q结束游戏\"]}}}}] at @s run tag @e[tag=head] add over\nexecute as @e[nbt={Item:{id:\"minecraft:barrier\",Count:1b,tag:{display:{Name:\"\"游戏结束\"\"}}}}] at @s run kill @s\nreplaceitem entity @a hotbar.2 minecraft:lily_pad{display:{Name:\"\"第一人称\"\"},Enchantments:[{}]} 1\n\n#方块填充\nfill -16 4 16 15 5 -16 air\nexecute as @e[tag=head,x=-16,y=4,z=-16,dx=31,dz=32] at @s run setblock ~ ~ ~ minecraft:red_mushroom_block\nexecute as @e[tag=body,x=-16,y=4,z=-16,dx=31,dz=32] at @s run setblock ~ ~ ~ minecraft:brown_mushroom_block\nexecute as @e[tag=food] at @s unless entity @e[tag=food,x=0,z=0,y=22,distance=..5] run setblock ~ ~ ~ minecraft:pumpkin\nfill 16 4 -17 -17 4 -17 minecraft:black_wool\nfill 16 4 17 -17 4 17 minecraft:black_wool\nfill -17 4 16 -17 4 -16 minecraft:black_wool\nfill 16 4 16 16 4 -16 minecraft:black_wool\nfill -16 3 16 15 3 -16 stone复制代码\n\n\n\n注：在阅读该部分内容之前，若有对指令不熟悉者.....请详看如下两个链接.....\n（重点在execute、scoreboard，其次看data等其他相关指令操作）https://minecraft-zh.gamepedia.com/%E5%91%BD%E4%BB%A4\nhttps://minecraft-zh.gamepedia.com/%E8%AE%B0%E5%88%86%E6%9D%BF#.E5.91.BD.E4.BB.A4.E5.88.97.E8.A1.A8\n\n三、游戏制作3.1 游戏逻辑\n\n首先，既然玩游戏，那就有其开始有其结束\nmain.mcfunction\n\n#开始游戏/tag @a add start1\nexecute if entity @a[tag=start1] run tp @a 0 26 0\nexecute if entity @a[tag=start1] run summon minecraft:armor_stand 0 4 0 {Tags:[\"head\",\"snake\"],CustomName:\"\"Head\"\",CustomNameVisible:0b,NoGravity:0b,Invisible:1b}\nexecute if entity @a[tag=start1] run tag @e[tag=head] add start\nexecute if entity @a[tag=start1] run tag @a remove start1\n#移动\nexecute unless entity @a[scores={auto=1}] run function minecraft:moving\n#移速 \nfunction minecraft:speed\n#食物\nfunction minecraft:eatfood\n#模式选择\nfunction minecraft:othermode\n#第一人称模式\nexecute if entity @a[tag=m1] run function minecraft:mode0\n#自动模式\nexecute if entity @a[scores={auto=1}] run function minecraft:mode1\n#撞墙\nexecute as @e[tag=head] at @s if block ~ ~ ~ minecraft:black_wool run tag @s remove start\nexecute as @e[tag=head] at @s if block ~ ~ ~ minecraft:black_wool run tag @s add over\n#撞自己\nexecute as @e[tag=head,tag=start] at @s if entity @e[tag=body,distance=..0.1] run tag @s remove start\nexecute as @e[tag=head] at @s if entity @e[tag=body,distance=..0.1] run tag @s add over\n#游戏结束\nexecute as @e[tag=head,tag=over] at @s run tp @s 0 4 0\nexecute as @e[tag=head,tag=over] at @s run tellraw @a [\"游戏结束\"]\nexecute as @e[tag=head,tag=over] at @s run scoreboard players set @s body 0\nexecute as @e[tag=head,tag=over] at @s run kill @e[type=!player]\nexecute as @e[tag=head,tag=over] at @s run tag @s remove over\n#清除钓竿分数\nexecute if entity @a[scores={om=1..}] run scoreboard players set @a om 0复制代码在main.mcfunction中，这些指令讲到这里我们暂时还用不上，因为这只是为了之后做的准备\n且看#开始游戏\n      通过第一章第二节的gif图可知，我们对于贪吃蛇的基本控制是站在一个固定的位置，当输入/tag @a add start1(这条指令可以通过第二章第三节里replaceitem得到的成书来代替你执行)，只要玩家有了tag=start1，游戏就会开始了，首先让玩家tp到一个指定的位置，然后判断是否有tag=head的实体，若没有则召唤它，也就是我们的蛇头，然后给蛇头一个tag=start的标记，让它能做之后的动作（这在下一节的蛇头移动中用到），最后清除掉玩家的tag=start1\n\n  #自行结束 \n在第二章第三节里面有这样一条指令\nexecute as @e[nbt={Item:{id:\"minecraft:barrier\",Count:1b,tag:{display:{Name:\"\"游戏结束\"\",Lore:[\"按Q结束游戏\"]}}}}] at @s run tag @e[tag=head] add over复制代码当检测到有nbt={Item:{id:\"minecraft:barrier\",Count:1b,tag:{display:{Name:\"\\\"游戏结束\\\"\",Lore:[\"按Q结束游戏\"]}}}}这样的东西时，就给蛇头加tag=over\n  #撞自己\n当蛇头与蛇身重合也即相撞时，加tag=over\n  #撞墙\n当蛇头撞到黑色羊毛时，加tag=over\n当蛇头有了tag=over，执行#结束游戏部分的内容，对各计分板初始化，清除tag实体等\n\n\n3.2 蛇头移动\n\n蛇头的移动有四个方向+x，-x，+y，-y\n且看指令moving.mcfunction\n######\n##\n#移动\n#头移动\n#+x\nexecute if entity @a[x=1,y=26,z=0,dy=0] unless entity @e[tag=head,scores={movedir=2}] run scoreboard players set @e[tag=head] movedir 1\nexecute as @e[scores={movedir=1},tag=head,tag=start,tag=move] at @s run data merge entity @s {Rotation:[270.0f,0.0f]}\nexecute as @a[x=1,y=26,z=0,dy=0] at @s run tp @a 0 26 0\n#-x\nexecute if entity @a[x=-1,y=26,z=0,dy=0] unless entity @e[tag=head,scores={movedir=1}] run scoreboard players set @e[tag=head] movedir 2\nexecute as @e[scores={movedir=2},tag=head,tag=start,tag=move] at @s run data merge entity @s {Rotation:[90.0f,0.0f]}\nexecute as @a[x=-1,y=26,z=0,dy=0] at @s run tp @a 0 26 0\n#+z\nexecute if entity @a[x=0,y=26,z=1,dy=0] unless entity @e[tag=head,scores={movedir=4}] run scoreboard players set @e[tag=head] movedir 3\nexecute as @e[scores={movedir=3},tag=head,tag=start,tag=move] at @s run data merge entity @s {Rotation:[0.0f,0.0f]}\nexecute as @a[x=0,y=26,z=1,dy=0] at @s run tp @a 0 26 0\n\n#-z\nexecute if entity @a[x=0,y=26,z=-1,dy=0] unless entity @e[tag=head,scores={movedir=3}] run scoreboard players set @e[tag=head] movedir 4\nexecute as @e[scores={movedir=4},tag=head,tag=start,tag=move] at @s run data merge entity @s {Rotation:[180.0f,0.0f]}\nexecute as @a[x=0,y=26,z=-1,dy=0] at @s run tp @a 0 26 0\n\nexecute as @e[tag=head,tag=start,tag=move] at @s run tp @s ^ ^ ^1\n复制代码       如指令所示，蛇头移动是通过玩家处于坐标为0 26 0的位置，按下WSAD移动到四个不同的坐标而实现改变蛇头的朝向，这样的这样的思路在1.13以下的版本也是可行，但是既然有了1.13的局部坐标，可以在每次玩家落入不同的坐标的时候改变蛇头的朝向再让蛇头往自己的前方tp，在这里就要注意一点，那就是不能反向转向，什么意思呢，就是当蛇头在往+x方向前行的时候，是不能突然转成-x方向的，所以为了实现这样一个操作，就必须判断蛇头转向之前是处于什么样的状态，\n       比如+x与-x：只有蛇头记分板的movedir=1时，才朝+x方向走，movedir=2时才朝-x方向走，所以在+x时，不能让他能够一下变成-x，-x方向时，不能一下变成+x。那么我写的这个指令该如何理解？\n       当蛇头往-x方向tp，这时候蛇头是movedir=2的，当玩家按下W键想让蛇头往+x方向走，#+x开始判断：execute if entity @a[x=1,y=26,z=0,dy=0] unless entity @e[tag=head,scores={movedir=2}]玩家达到x=1，y=26，z=0的坐标位置，测试成功，实体tag=head的分数不等于2，测试失败（因为这时候它的确是movedir=2）。于是就不会执行这一整条指令，也就不会让蛇头方向变为+x，但是让蛇头的+x方向朝-z或者+z方向改变那就是完全没有问题的\n\n       那么这里就有疑问了，明明可以直接tp四个方向，这样只需要四条指令，而我这种改变朝向最后再往前方tp，还多了一条指令，不是多此一举吗？我这样做的目的，是为了方便后面的进阶操作的相关判断（具体操作详看后面章节）\n\n3.3 蛇身移动\n\n       或许对于曾经想要在Minecraft制作贪吃蛇但是制作失败的同学来说，从这里开始就是难点了，一方面要移动蛇身，一方面又要让蛇身是跟着蛇头移动，同时移动方向也要正确。其实办法很简单，在这里我就是用标记，如何标记，在这之前，请把以下四条指令分别放在第二节的指令的+x,-x,+z,-z的第一条\nexecute if entity @a[x=1,y=26,z=0,dy=0] unless entity @a[x=-1,y=26,z=0,dy=0] unless entity @e[scores={movedir=2}] unless entity @e[scores={movedir=1}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[270.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n\nexecute if entity @a[x=-1,y=26,z=0,dy=0] unless entity @a[x=1,y=26,z=0,dy=0] unless entity @e[scores={movedir=1}] unless entity @e[scores={movedir=2}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[90.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n\nexecute if entity @a[x=0,y=26,z=1,dy=0] unless entity @a[x=0,y=26,z=-1,dy=0] unless entity @e[scores={movedir=4}] unless entity @e[scores={movedir=3}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[0.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n\nexecute if entity @a[x=0,y=26,z=-1,dy=0] unless entity @a[x=0,y=26,z=1,dy=0] unless entity @e[scores={movedir=3}] unless entity @e[scores={movedir=4}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[180.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}复制代码放好之后是这样的：\n\n\n\n\n[%8PDZ(Z7G716FUW{_XJ{DK.png (112.12 KB, 下载次数: 0)\n\n下载附件\n\n2019-3-19 12:53 上传\n\n\n\n\n\n       这四条指令就实现了，在蛇头每一次转向的时候，在其身上都会summon一个tag=dir的盔甲架，很明显dir有四种，对应蛇头不同的方向转变。\nmoving.mcfunction\n#身体移动\nexecute as @e[tag=body,tag=move] at @s run tp @s ^ ^ ^1\n#修改转向\nexecute as @e[tag=body] at @s if entity @e[tag=dir,distance=..0.1] store result entity @s Rotation[0] float 1 run data get entity @e[limit=1,distance=..0.1,tag=dir] Rotation[0]\n\n#除掉方向标志\nexecute as @e[tag=dir,nbt={Rotation:[270.0f,0.0f]}] at @s unless entity @e[dx=-1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[90.0f,0.0f]}] at @s unless entity @e[dx=1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[0.0f,0.0f]}] at @s unless entity @e[dz=-1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[180.0f,0.0f]}] at @s unless entity @e[dz=1,tag=!dir] run kill @s\n\n复制代码以上指令就可以让蛇身开始移动了。\n       那么作用机理是如何的呢？当蛇头转向时，会在转向的地方生成一个与要转向的方向一致的盔甲架，当后面的蛇身tp上来的时候，判断蛇身是否与tag=dir的实体标志重合，若是，则将该蛇身方向转变成与该tag=dir的朝向一致，这样就实现了蛇身能够紧跟蛇头的同时也正确转向了，至于标志的清除，只需要判断标志的身后还有没有蛇身就行了，若没有，则清除该标志\n注：在这里务必要注意，身体移动与转向的指令一定要写在蛇头之后，否则会出现严重的逻辑错误导致蛇身直接跑飞！\n\n3.4 速度调整\n\n       在上面小节的内容中我们可以看到，蛇头蛇身都有tag=move这么一个东西，这个东西就是用于控制蛇的移动速度的\n那么关于如何实现速度的控制，且看speed.mcfunction\n#####\n#速度\n#speed=1 0.1s =2 0.2s =3 0.5s =4 1s =5 1.5s =6 10s(指令调试) =7 100s(指令调试)\nexecute if entity @e[tag=start] run scoreboard players add @a speed 1\n\n#execute as @e[tag=move] at @s run tag @s remove move\n\n#speed=1\nexecute as @a[scores={setspeed=1,speed=30..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=1,speed=30..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=1,speed=29..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=1,speed=29..}] at @s run tag @e[tag=body] add move\n#speed=2\nexecute as @a[scores={setspeed=2,speed=20..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=2,speed=20..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=2,speed=19..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=2,speed=19..}] at @s run tag @e[tag=body] add move\n#speed=3\nexecute as @a[scores={setspeed=3,speed=10..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=3,speed=10..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=3,speed=9..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=3,speed=9..}] at @s run tag @e[tag=body] add move\n#speed=4\nexecute as @a[scores={setspeed=4,speed=5..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=4,speed=5..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=4,speed=4..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=4,speed=4..}] at @s run tag @e[tag=body] add move\n#speed=5\nexecute as @a[scores={setspeed=5,speed=2..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=5,speed=2..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=5,speed=1..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=5,speed=1..}] at @s run tag @e[tag=body] add move\n#speed=6\nexecute as @a[scores={setspeed=6,speed=200..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=6,speed=200..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=6,speed=199..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=6,speed=199..}] at @s run tag @e[tag=body] add move\n#speed=7\nexecute as @a[scores={setspeed=6,speed=2000..}] at @s run tag @e[tag=snake] remove move\nexecute as @a[scores={setspeed=6,speed=2000..}] at @s run scoreboard players set @a speed 0\nexecute as @a[scores={setspeed=6,speed=1999..}] at @s run tag @e[tag=head] add move\nexecute as @a[scores={setspeed=6,speed=1999..}] at @s run tag @e[tag=body] add move\n\nexecute if entity @a[nbt={SelectedItem:{id:\"minecraft:carrot_on_a_stick\",tag:{display:{Name:\"\"调速度\"\"}}}},scores={om=1..}] run scoreboard players add @a setspeed 1\n\nexecute as @a[scores={setspeed=8..}] run scoreboard players set @a setspeed 1\n\n复制代码       显而易见，这里有一系列的速度设置，直接就是让一个记分板一直加分，加到一定分数就给蛇头tag=move然后分数清零继续加，只有蛇头在有tag=move的时候它才会tp，由指令可以看得出来，add move的分比remove move 的分数低1，这样就能实现有了tag=move的情况下只会执行一次tp       关于这里tag add move的选择器，只需要一条@e[tag=snake]就行了，无需分开tag=head，tag=body，因为我在summon的时候都是有Tags:[\"snake\"]的，什么你问我为什么不写这个非要分开写？我不听我不听我不听\nspeed=6和7读者可自行删去，这两个速度是我用来写指令的时候做检测用的，如果删掉，则需把最后一条的setspeed=8改为6。\n\n3.5 吃掉食物\n\n想致富，先撸....吃食物。想要让蛇身增长，就需要食物，在这里用的南瓜（这蛇胃口真大啊，关键还是吃素的- -）\neatfood.mcfunction\n########\n#\n#食物\nexecute if entity @e[tag=head,tag=start] unless entity @e[tag=food] as @a at @s run summon minecraft:armor_stand ~ ~3 ~ {Tags:[\"food\",\"prespread\"],CustomName:\"\"food\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n#分布食物\nexecute if entity @e[tag=food,tag=prespread] run spreadplayers 0 0 3 15 false @e[tag=food,tag=prespread]\nexecute if entity @e[tag=food,tag=prespread] run tag @e[tag=prespread,tag=food] remove prespread\n#精确分布\nexecute as @e[tag=food] at @s if entity @e[tag=!food,tag=!head,distance=..0] run spreadplayers 0 0 3 15 false @e[tag=food]\nexecute as @e[tag=food] at @s if block ~ ~-1 ~ minecraft:brown_mushroom_block run spreadplayers 0 0 3 15 false @e[tag=food]\nexecute as @e[tag=food,x=0,z=0,y=22,distance=..2] at @s run spreadplayers 0 0 3 16 false @e[tag=food]\n#吃掉食物\nexecute as @e[tag=head,tag=start] at @s if entity @e[tag=food,distance=..0.1] run scoreboard players add @e[tag=snake] body 1\n#召唤蛇身复制代码\n       游戏开始，首先确认有没有tag=food这样一个实体，若没有，就生成，然后就是食物的位置问题，可以利用随机数让他随机分布，在这里我直接spreadplayers了，食物的分布就要注意一下问题，因为我用的spreadplayers，首先就是不能分布到你的站立点，也就是那几个屏障，其次是不能分布到蛇上面。因为生成的食物我们只需要分布一次，所以在生成的是就有一个tag=prespread，在spread一次之后就remove这个tag。\n\n       分布工作做好就是判定蛇头是否吃到（碰撞）食物与蛇身体的如何增长的问题。首先对蛇头进行判定，是否已经接触食物，若是，body计分板就给所有的tag=snake 加1然后kill 掉这个tag=food，至于食物分数加一是有妙用的，这个就可以用于吃掉食物后身体的增长，当蛇头碰到食物并给所有的tag=snake的body记分板分数+1之后，summon一个tag=body的蛇身在body记分板分数为1的实体的后面一格。\nexecute as @e[tag=head,tag=start] at @s if entity @e[tag=food,distance=..0.1] run scoreboard players add @e[tag=snake] body 1\nexecute as @e[tag=head,tag=start] at @s if entity @e[tag=food,distance=..0.1] as @e[tag=snake,scores={body=1}] at @s run summon minecraft:armor_stand ^ ^ ^-1 {Tags:[\"body\",\"snake\",\"preturn\"],CustomName:\"\"body\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}复制代码\n也就是这两条，body记分板分数为1的实体，就是蛇的最后一个身体部分，比如一开始蛇头分数为0，吃掉一个食物，这时候分数为1，然后就会在蛇头后面召唤一个蛇身，再吃掉一个食物，这时候蛇头分数为2，那个蛇身分数为1，这时候就是在这个蛇身的后面召唤一个蛇身，这样说应该容易理解吧？\n之后的指令就是让蛇身与body=1的实体朝向一致，然后做好后续处理即可\n\n一个基础的贪吃蛇就此完成，可以直接食用了，接下来的就是改进此贪吃蛇游戏详看第四章节\n四、游戏进阶4.1 第一人称游戏\n\n\n\n\n\n20190319_181730_20190319182305.gif (945.47 KB, 下载次数: 0)\n\n下载附件\n\n2019-3-19 18:23 上传\n\n\n\n\n\n如图所示，与之前不同的是，这次玩家的视角是蛇头，也可说第一人称视角，先不谈如何运作，先来开启这样一个游戏模式\nothermode.迷彩服你餐厅\n#第一人称模式\nexecute if entity @e[tag=head] if entity @a[nbt={Inventory:[{Slot:-106b,id:\"minecraft:lily_pad\",Count:1b,tag:{display:{Name:\"\"第一人称\"\"}}}]}] run scoreboard players add @a sbianliang 1\nexecute as @a[scores={sbianliang=..1}] at @s rotated as @e[tag=head] run tp ^ ^ ^\nexecute if entity @a[scores={sbianliang=1}] run tag @a add m1\n复制代码       在main.mcfunction里面有一个replaceitem是名字为\"第一人称\"的睡莲，如指令逻辑所示，当把它放在副手的时候，就进入了第一人称模式tag=m1在main函数中用于执行mode0.mcfunction\n与moving.mcfunction逻辑类似，玩家朝向控制蛇头朝向，也要注意反向转向的问题，所以在检测该睡莲在副手之后，立即改变玩家的朝向使其与蛇头朝向一致，否则就会出现比如玩家是朝向+x,而蛇头是朝向-x，若此时进入第一人称模式，蛇头会立马反方向转向，撞死自己。\nmode0.mcfunction\n#第一人称视角\n#方向\n#+x\nexecute if entity @a[y_rotation=226..315,nbt={Inventory:[{Slot:-106b,id:\"minecraft:lily_pad\",Count:1b,tag:{display:{Name:\"\"第一人称\"\"}}}]}] unless entity @e[scores={movedir=2}] unless entity @e[scores={movedir=1}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[270.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n\n复制代码\n       很明显的一个问题，当进入第一人称模式，就不再是通过玩家站四个不同点来控制蛇头的运动方向了，而是通过玩家自身的朝向来控制蛇头前进方向，第一人称在x-z平面，人转一圈360度，我们可以理解为一个朝向占90度\n+x朝向：y_rotation=226..315\n-x朝向 ： y_rotation=46..135\n+z朝向：y_rotation=316..405\n-z朝向：y_rotation=136..225\n当玩家朝向位于以上四个范围中的其中一个时，就能判定出其正确轴向\n       如果要取消第一人称模式，把睡莲从副手取下即可\n4.2 自动进行游戏\n\n\n\n\n\n20190317_202241_20190319190147.gif (980.77 KB, 下载次数: 0)\n\n下载附件\n\n2019-3-19 19:02 上传\n\n\n\n\n\n\n如图所示，该图你会发现， 你既没有处于第一人称视角，也没站在固定屏障上进行定点控制，游戏完全自主进行\n那么这是如何实现的，先来进入自动游戏模式吧\nothermode.mcfunction\n#自动模式选择\nexecute if entity @a[nbt={SelectedItem:{id:\"minecraft:carrot_on_a_stick\",tag:{display:{Name:\"\"自动\"\"}}}},scores={om=1..}] run scoreboard players add @a auto 1\nexecute if entity @a[scores={auto=1}] run tag @a add auto\nexecute if entity @a[scores={auto=2..}] run tag @a remove auto\nexecute if entity @a[scores={auto=2..}] run scoreboard players set @a auto 0\n复制代码\n\n拿着一个名为自动的萝卜钓竿右键可以选择是否是自动模式当它为1就自动模式，为0就其他模式\nmode1.mcfunction\n#头\n#方向\n#+x\nexecute if entity @e[tag=head,nbt={Rotation:[270.0f,-0.001f]}] unless entity @e[scores={movedir=2}] unless entity @e[scores={movedir=1}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[270.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n#-x\nexecute if entity @e[tag=head,nbt={Rotation:[90.0f,-0.001f]}] unless entity @e[scores={movedir=1}] unless entity @e[scores={movedir=2}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[90.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n#+z\nexecute if entity @e[tag=head,nbt={Rotation:[0.0f,-0.001f]}] unless entity @e[scores={movedir=4}] unless entity @e[scores={movedir=3}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[0.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n#-z\nexecute if entity @e[tag=head,nbt={Rotation:[180.0f,-0.001f]}] unless entity @e[scores={movedir=3}] unless entity @e[scores={movedir=4}] as @e[tag=head,tag=start] at @s run summon minecraft:armor_stand ~ ~ ~ {Rotation:[180.0f,0.0f],Tags:[\"dir\"],CustomName:\"\"dir\"\",CustomNameVisible:0b,NoGravity:1b,Invisible:1b}\n\nexecute if entity @e[tag=head,nbt={Rotation:[270.0f,-0.001f]}] run scoreboard players set @e[tag=head] movedir 1\nexecute if entity @e[tag=head,nbt={Rotation:[90.0f,-0.001f]}] run scoreboard players set @e[tag=head] movedir 2\nexecute if entity @e[tag=head,nbt={Rotation:[0.0f,-0.001f]}] run scoreboard players set @e[tag=head] movedir 3\nexecute if entity @e[tag=head,nbt={Rotation:[180.0f,-0.001f]}] run scoreboard players set @e[tag=head] movedir 4\n#头移动\nexecute as @e[tag=head,tag=start,tag=move] at @s run tp @s ^ ^ ^1\n#身体移动\nexecute as @e[tag=body,tag=move] at @s run tp @s ^ ^ ^1\n#修改转向\nexecute as @e[tag=body] at @s if entity @e[tag=dir,distance=..0.1] store result entity @s Rotation[0] float 1 run data get entity @e[limit=1,distance=..0.1,tag=dir] Rotation[0]\n复制代码\n这部分内容就无需解释了吧？前面基础模式与第一人称模式都用到了，关于生成dir与蛇身的移动都在这儿\n       接下来就来谈谈如何实现自动，其实原理非常的简单，就是判断蛇头与食物的位置，然后想办法让蛇头告辞食物并吃掉食物即可\n       值得一提的是.....这里的Rotation与之前的有明显的不同........，之前都是整的[180.0f,0.0f]之类的，而现在，在这里所有的Rotation[1]都是-0.001f，我当时做的时候在这里卡了半个多小时，实在找不到原因，因为我看我的执行逻辑，左看右看怎么都没问题啊，然后我就发现一个很蛇皮的事情，就是当盔甲架Rotation[90.0f,0.0f]时，我exe if entity @e[nbt={Rotation:[90.0f,0.0f]}]测试通过，exe if entity @e[nbt={Rotation:[0.0f,0.0f]}]\n也测试通过，WTF？？？？？？？\n       然后我个人猜测，是因为他在判断我写的[]东西的时候是判断里面是不是都是有相同的值，Rotation[0]是有不同，但是Rotation[1]因为我没有做任何变动所以他是默认值，也就是我需要判断的与实际的实体值，在他看来是一致的，这时候他就给测试通过了（一本正经的胡说八道）然后我让Rotation[1]做了变动，我就发现不管怎么测试，该是多少，那就是多少了，关于这一点也不知道Bugjang是怎么想的.......\n\n回归正题，首先分别获取蛇头与食物的x z坐标，因为是同一平面，不需要y坐标\nmode1.mcfunction\nexecute as @e[tag=food] at @s store result score @s positionx run data get entity @s Pos[0]\nexecute as @e[tag=food] at @s store result score @s positionz run data get entity @s Pos[2]\nexecute as @e[tag=head] at @s store result score @s positionx run data get entity @s Pos[0]\nexecute as @e[tag=head] at @s store result score @s positionz run data get entity @s Pos[2]\n复制代码\n然后要做的就是一系列的判断了\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx unless entity @e[tag=body,dx=1] run data merge entity @s {Rotation:[270.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx > @e[limit=1,tag=food] positionx unless entity @e[tag=body,dx=1] run data merge entity @s {Rotation:[90.0f,-0.001f]}\n\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx if entity @e[tag=body,dx=1] if score @e[limit=1,tag=head] positionz < @e[limit=1,tag=food] positionz run data merge entity @s {Rotation:[0.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx if entity @e[tag=body,dx=1] if score @e[limit=1,tag=head] positionz > @e[limit=1,tag=food] positionz run data merge entity @s {Rotation:[180.0f,-0.001f]}\n\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx = @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz < @e[limit=1,tag=food] positionz run data merge entity @s {Rotation:[0.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx = @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz > @e[limit=1,tag=food] positionz run data merge entity @s {Rotation:[180.0f,-0.001f]}\n\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionz = @e[limit=1,tag=food] positionz if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx unless entity @e[tag=body,dx=1] run data merge entity @s {Rotation:[270.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionz = @e[limit=1,tag=food] positionz if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx unless entity @e[tag=body,dx=-1] run data merge entity @s {Rotation:[90.0f,-0.001f]}\n\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz < @e[limit=1,tag=food] positionz if entity @e[tag=body,dz=1] run data merge entity @s {Rotation:[270.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx > @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz < @e[limit=1,tag=food] positionz if entity @e[tag=body,dz=1] run data merge entity @s {Rotation:[90.0f,-0.001f]}\n\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx < @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz > @e[limit=1,tag=food] positionz if entity @e[tag=body,dz=-1] run data merge entity @s {Rotation:[270.0f,-0.001f]}\nexecute as @e[tag=head] at @s if score @e[limit=1,tag=head] positionx > @e[limit=1,tag=food] positionx if score @e[limit=1,tag=head] positionz > @e[limit=1,tag=food] positionz if entity @e[tag=body,dz=-1] run data merge entity @s {Rotation:[90.0f,-0.001f]}\n复制代码\n\n以上指令从某种意义上讲就是食物相对于蛇头在不同位置的时候，蛇头对于吃到食物的路径判断，只要在前往食物的路线中，蛇头前方没有蛇身即可，以上指令对应以下图示：\n\n\n\n\nBEDH4Q${5F`EXU{D37[WAKI.png (34.03 KB, 下载次数: 0)\n\n下载附件\n\n2019-3-19 20:38 上传\n\n\n\n\n\n最后再清除一下标志：\n#除掉方向标志\nexecute as @e[tag=dir,nbt={Rotation:[270.0f,0.0f]}] at @s unless entity @e[dx=-1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[90.0f,0.0f]}] at @s unless entity @e[dx=1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[0.0f,0.0f]}] at @s unless entity @e[dz=-1,tag=!dir] run kill @s\nexecute as @e[tag=dir,nbt={Rotation:[180.0f,0.0f]}] at @s unless entity @e[dz=1,tag=!dir] run kill @s\n\n复制代码\n这样自动进行游戏就完成了\n\n五、地图小结\n\n       以上就是一个简单的贪吃蛇游戏了，关于自动进行游戏的部分，可以看出，对于蛇靠近食物吃掉这一块，我只做了最基础的部分，没有做进一步的细化，也就是蛇还不够“智能”，比如蛇身和食物同时在蛇头后面，比如因为蛇身太长导致寻觅食物的时候撞到自己身体，我都没有做进一步的判断（懒得去写了），有心人想要让自己的贪吃蛇自动游戏更加完美可以尝试进一步的改进指令\n       还有一点，这个游戏有一个一开始被我认为为bug的地方，如果玩家控制蛇头转向过快，比如蛇头本向X轴正向运动，你想让他反方向运动，你会先转成Z轴再转到X轴，如果转向过快，在刚转成Z轴还没有移动就转到X轴负向的话，会导致蛇身跑飞或者自己反向撞死自己，这个我一开始是做了处理让他避免了因为转向过快撞死自己，后来一想，我又不把他认定为bug又改了回去，我就当他是自己转向太快撞死自己，活该谁让你转向那么快.....\n\n       关于指令制作小游戏的教程我后面还会陆续发贴，一方面是让指令初学者对于指令有进一步的学习和了解，一方面也能让学习者对于用指令做什么作品的时候有一些新的思路，同时也希望我做的教程能给读者有一定的帮助，毕竟，大家触才是真的触2333333\n当然因为课程繁多比较忙可能更贴会很慢.....最后感谢各路大佬萌新能在百忙之中抽时间阅读此教程\n\n对应地图下载：\nhttp://www.mcbbs.net/thread-851645-1-1.html\n\n\n",
    "replies": [
        {
            "author": "wsh13851209598",
            "timestamp": 1553255700,
            "txt_content": "可以的！我看到了一个小未来！"
        },
        {
            "author": "chyx",
            "timestamp": 1553260140,
            "txt_content": " 本帖最后由 chyx 于 2019-3-22 21:14 编辑 \n\n用指令判断NBT的时候 对于列表的判断确实十分诡异。\n如果被测NBT的某个list是A:[A1,A2,A3...]而用来检查的命令里的是B:[B1,B2,B3...]\n那么如果B不是空的的话，通过的条件是B中的每一项都在A中存在。\n如果B是空的，那么通过的条件是A也是空的。\n所以if entity @e[nbt={Rotation:[90.0f,0.0f]}]只是检查Rotation里是否包含90.0f和0.0f\n[90.0f,0.0f]，[0.0f,90.0f]，[90.0f,45.0f,0.0f]都能够通过检查\n\n而if entity @e[nbt={Rotation:[0.0f,0.0f]}]只是检查Rotation里有0.0f\n所以if entity @e[nbt={Rotation:[0.0f,0.0f]}]和if entity @e[nbt={Rotation:[0.0f]}] 完全等效\n"
        },
        {
            "author": "davinc1",
            "timestamp": 1553267220,
            "txt_content": "看不懂系列"
        },
        {
            "author": "华夏D冬天",
            "timestamp": 1553298180,
            "txt_content": " 欺负看不懂的.."
        },
        {
            "author": "Sairos",
            "timestamp": 1553330400,
            "txt_content": "华夏D冬天 发表于 2019-3-23 07:43\n欺负看不懂的..\n不会吧......我原意就是给命令方块学习者的教程..哪里看不懂呢？能说一下吗？"
        },
        {
            "author": "Sairos",
            "timestamp": 1553330460,
            "txt_content": "davinc1 发表于 2019-3-22 23:07\n看不懂系列\n能说一下哪里有不懂的地方吗，是我文字陈述太多还是别的？"
        },
        {
            "author": "Forever_Ghost",
            "timestamp": 1553332020,
            "txt_content": "大佬666啊"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1553333820,
            "txt_content": "黄金矿工、贪吃蛇……\n下一个是不是要轮到俄罗斯方块了……"
        },
        {
            "author": "davinc1",
            "timestamp": 1553334000,
            "txt_content": "Sairos 发表于 2019-3-23 16:40\n不会吧......我原意就是给命令方块学习者的教程..哪里看不懂呢？能说一下吗？ ...\n不知道mcfunction是啥。。。"
        },
        {
            "author": "Sairos",
            "timestamp": 1553334060,
            "txt_content": "Teenager_Yang 发表于 2019-3-23 17:37\n黄金矿工、贪吃蛇……\n下一个是不是要轮到俄罗斯方块了……\n差不多吧，这个被列入在教程范围内了，不过下一关或许是打砖块或许是超级玛丽"
        },
        {
            "author": "Sairos",
            "timestamp": 1553334240,
            "txt_content": "davinc1 发表于 2019-3-23 17:40\n不知道mcfunction是啥。。。\n唔...其实简单理解说来，就是把你本来该放入命令方块的指令，都放入了一个后缀为mcfunction的文件里面，然后在Minecraft运行这个文件就行了"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1553334540,
            "txt_content": " 本帖最后由 Teenager_Yang 于 2019-3-23 18:41 编辑 \nSairos 发表于 2019-3-23 17:41\n差不多吧，这个被列入在教程范围内了，不过下一关或许是打砖块或许是超级玛丽 ...\n打砖块……\n突然让我想到了菠萝 dalao 的关于实现实体与方块间的弹性碰撞的教程……\nhttp://www.mcbbs.net/thread-776362-1-1.html\n不过也不用这么复杂……\n打砖块里的都是匀速直线运动……"
        },
        {
            "author": "davinc1",
            "timestamp": 1553334960,
            "txt_content": "Sairos 发表于 2019-3-23 17:44\n唔...其实简单理解说来，就是把你本来该放入命令方块的指令，都放入了一个后缀为mcfunction的文件里面， ...\n恩，没接触过这一块，\n学习了"
        },
        {
            "author": "Sairos",
            "timestamp": 1553335020,
            "txt_content": "Teenager_Yang 发表于 2019-3-23 17:49\n打砖块……\n突然让我想到了菠萝 dalao 的关于实现实体与方块间的弹性碰撞的教程……\nhttp://www.mcbbs.ne ...\n这个教程就很好了啊、但是我估计我会用我在python写过的打砖块的思路。。。控制实体与方块间的碰撞应该不会有教程那么繁杂，因为该游戏只在一个面.."
        },
        {
            "author": "Sairos",
            "timestamp": 1553335080,
            "txt_content": "davinc1 发表于 2019-3-23 17:56\n恩，没接触过这一块，\n学习了\n食用步骤你可以看黄金矿工第二个章节内容...不需要弄懂，知道怎么创建mcfunction文件和食用就行了....."
        },
        {
            "author": "寒冰之家",
            "timestamp": 1553432760,
            "txt_content": "虽然不懂，不过好厉害的样子！"
        },
        {
            "author": "依然冰奈斯",
            "timestamp": 1554616500,
            "txt_content": "函数指令好神奇！"
        },
        {
            "author": "Herobrine429",
            "timestamp": 1554726780,
            "txt_content": "厉害啊！神了"
        },
        {
            "author": "奶昔杯",
            "timestamp": 1554734160,
            "txt_content": "萌新表示看不动"
        },
        {
            "author": "华夏D冬天",
            "timestamp": 1575168120,
            "txt_content": "有点厉害大脑：我会了。手：不你不会"
        },
        {
            "author": "华夏D冬天",
            "timestamp": 1575280500,
            "txt_content": "Sairos 发表于 2019-3-23 16:40\n不会吧......我原意就是给命令方块学习者的教程..哪里看不懂呢？能说一下吗？ ...\n说白了我们其实只会跟着做但是，根本看不懂指令意思"
        },
        {
            "author": "273684012",
            "timestamp": 1598330640,
            "txt_content": "MC居然还能玩这小游戏awa感觉楼主分享地图"
        },
        {
            "author": "1663691965",
            "timestamp": 1598338560,
            "txt_content": "学会可以造地图"
        },
        {
            "author": "wangpy",
            "timestamp": 1598361120,
            "txt_content": "看不懂系列"
        },
        {
            "author": "宅男Mars",
            "timestamp": 1598404560,
            "txt_content": "可以的，我是学linux的"
        },
        {
            "author": "Memoir_w",
            "timestamp": 1598406060,
            "txt_content": "哇哦，这……"
        },
        {
            "author": "爱吃萝卜和青菜",
            "timestamp": 1598407860,
            "txt_content": "woc 前有mc音游现在有MC贪吃蛇  NB了大佬"
        },
        {
            "author": "pencil521",
            "timestamp": 1607152920,
            "txt_content": "欺负老实人看不懂"
        }
    ]
}