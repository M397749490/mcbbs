{
    "title": "修改玩家背包物品信息(免穷举)",
    "author": "ruhuasiyu",
    "replyCount": 60,
    "timestamp": 1556428860,
    "txt_content": " 本帖最后由 ruhuasiyu 于 2020-4-26 06:28 编辑 \n\n起因是我在做物品处理机，处理任意64个物品压缩成1个带64× Lore的物品时，发现输出到箱子内时，如果要用loot insert的话，必须要解决动态物品id的问题。然后我发现似乎用\"type\": \"minecraft:dynamic\"类型配合挖掘潜影箱的战利品表，可以做到这一点。\n\n例如玩家手持64个物品，我们想把其数量修改为32。\nexecute as @a[nbt={SelectedItem:{Count:64b}}] run function test:modify\n\ntest:modify\nsetblock ~ 255 ~ shulker_box{Items:[{Slot:0b,id:\"minecraft:stone\",Count:32b}]}\ndata modify block ~ 255 ~ Items[0].id set from entity @s SelectedItem.id\ndata modify block ~ 255 ~ Items[0].tag set from entity @s SelectedItem.tag\nreplaceitem entity @s weapon.mainhand air\nloot replace entity @s weapon.mainhand 1 mine ~ 255 ~ minecraft:diamond_pickaxe{isShulkerMarker:1b}\nsetblock ~ 255 ~ air复制代码\n修改minecraft/loot_tables/blocks/shulker_box.json为使用特定nbt的镐挖掘时，掉落内含物而且不掉落潜影盒。\n{\n    \"type\": \"minecraft:block\",\n    \"pools\": [\n        {\n            \"rolls\": 1,\n            \"entries\": [\n                {\n                    \"type\": \"minecraft:alternatives\",\n                    \"children\": [\n                        {\n                            \"type\": \"minecraft:dynamic\",\n                            \"name\": \"minecraft:contents\",\n                            \"conditions\": [\n                                {\n                                    \"condition\": \"minecraft:match_tool\",\n                                    \"predicate\": {\n                                        \"nbt\":\"{isShulkerMarker:1b}\"\n                                    }\n                                }\n                            ]\n                        },\n                        {\n                            \"type\": \"minecraft:item\",\n                            \"functions\": [\n                                {\n                                    \"function\": \"minecraft:copy_name\",\n                                    \"source\": \"block_entity\"\n                                },\n                                {\n                                    \"function\": \"minecraft:copy_nbt\",\n                                    \"source\": \"block_entity\",\n                                    \"ops\": [\n                                        {\n                                            \"source\": \"Lock\",\n                                            \"target\": \"BlockEntityTag.Lock\",\n                                            \"op\": \"replace\"\n                                        },\n                                        {\n                                            \"source\": \"LootTable\",\n                                            \"target\": \"BlockEntityTag.LootTable\",\n                                            \"op\": \"replace\"\n                                        },\n                                        {\n                                            \"source\": \"LootTableSeed\",\n                                            \"target\": \"BlockEntityTag.LootTableSeed\",\n                                            \"op\": \"replace\"\n                                        }\n                                    ]\n                                },\n                                {\n                                    \"function\": \"minecraft:set_contents\",\n                                    \"entries\": [\n                                        {\n                                            \"type\": \"minecraft:dynamic\",\n                                            \"name\": \"minecraft:contents\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"name\": \"minecraft:shulker_box\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}复制代码\n具体想修改物品信息的情形，可以通过直接修改潜影盒内物品实现，这里不做赘述。\n唯一的缺点就是，需要在255高度引入额外的方块潜影盒，这会导致原有的位于255高度的方块消失。\n",
    "replies": [
        {
            "author": "⊙v⊙",
            "timestamp": 1556439480,
            "txt_content": " 本帖最后由 ⊙v⊙ 于 2019-4-27 22:28 编辑 \n\n这方法有一段时间了\n不过想说的是...修改玩家背包这东西十分，十分有用，且使用频率很高，建议找个地方长期存放盒子。\n\n↓ ↓ ↓ 最重要的id得不到就有点菜，且没什么意义了..."
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556439600,
            "txt_content": "⊙v⊙ 发表于 2019-4-28 16:18\n这方法有一段时间了\n不过想说的是...修改玩家背包这东西十分，十分有用，且使用频率很高，建议找个地方长期 ...\n不用盒子的方法，chyx在 http://www.mcbbs.net/thread-837334-1-1.html 中发过，但是要穷举物品id"
        },
        {
            "author": "w186429780",
            "timestamp": 1556441340,
            "txt_content": "我感觉说的对牛逼6666"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556443440,
            "txt_content": "⊙v⊙ 发表于 2019-4-28 16:18\n这方法有一段时间了\n不过想说的是...修改玩家背包这东西十分，十分有用，且使用频率很高，建议找个地方长期 ...\n穷举指的是在loot_table中穷举，function中用的时候是不需要穷举的"
        },
        {
            "author": "⊙v⊙",
            "timestamp": 1556443740,
            "txt_content": " 本帖最后由 ⊙v⊙ 于 2019-4-27 23:30 编辑 \nruhuasiyu 发表于 2019-4-27 23:24\n穷举指的是在loot_table中穷举，function中用的时候是不需要穷举的\nlt中穷举也是很不好(且十分不建议的)啊..."
        },
        {
            "author": "Ruainbow_",
            "timestamp": 1556462640,
            "txt_content": "高度0是基岩来着，替换基岩似乎比有可能替换玩家建筑要赚一点？"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556491860,
            "txt_content": "Ruainbow_ 发表于 2019-4-28 22:44\n高度0是基岩来着，替换基岩似乎比有可能替换玩家建筑要赚一点？\n不是所有地图高度0都是基岩的……"
        },
        {
            "author": "uhuichongfu",
            "timestamp": 1556495400,
            "txt_content": "一涉及到指令，看着就有点吃力。\n指令一般是用来做RPG地图吗？这类指令，感觉建筑和生存都不会用到。"
        },
        {
            "author": "1042102543",
            "timestamp": 1556513340,
            "txt_content": "大佬啊我去，什么鬼代码"
        },
        {
            "author": "Ruainbow_",
            "timestamp": 1556514120,
            "txt_content": "ruhuasiyu 发表于 2019-4-29 06:51\n不是所有地图高度0都是基岩的……\n彳亍口巴23333\n那么在世界边界或者非常遥远的地方加载区块然后使用呢？"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556528640,
            "txt_content": "Ruainbow_ 发表于 2019-4-29 13:02\n彳亍口巴23333\n那么在世界边界或者非常遥远的地方加载区块然后使用呢？\n加载是问题。你要是想手动强制加载，然后固定坐标或许可以。一般谁会把建筑放在255啊……"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556528700,
            "txt_content": "buhuichongfu 发表于 2019-4-29 07:50\n一涉及到指令，看着就有点吃力。\n指令一般是用来做RPG地图吗？这类指令，感觉建筑和生存都不会用到。 ...\n做原版模组和rpg都可能会用到，不过rpg基本固定物品所以可能不需要这样的技巧也可以实现。"
        },
        {
            "author": "(=°ω°)丿",
            "timestamp": 1556671500,
            "txt_content": " 本帖最后由 Teenager_Yang 于 2019-5-1 18:15 编辑 \n\ndata modify 是个好东西。\n就是不知道用驴的箱子可不可以……\n赶紧去试一下……\n跑#summon minecraft:donkey ~ ~ ~ {Tags:[\"test\"],ChestedHorse:1b,Items:[{Slot:2b,id:\"minecraft:stone\",Count:32b}]}\ndata modify entity @e[tag=test,limit=1] Items[0].id set from entity @s SelectedItem.id\ndata modify entity @e[tag=test,limit=1] Items[0].id set from entity @s SelectedItem.tag\nreplaceitem entity @s weapon.mainhand air\nkill @e[tag=test]复制代码貌似是可以的。\n唯一的缺点就是，需要在255高度引入额外的方块潜影盒，这会导致原有的位于255高度的方块消失。\n就是不知道用驴的箱子有什么有什么缺点，反正不用引入额外的方块潜影盒就对了。\n写的稍微有点简陋，dalao 稍微改一下就好了。对 loot table 一窍不通。帖子没看完，谢罪谢罪\n不对，是帖子没仔细看\n（总感觉自己最近这几天好像有哪不大对劲）"
        },
        {
            "author": "chyx",
            "timestamp": 1556683200,
            "txt_content": "Teenager_Yang 发表于 2019-5-1 08:45\ndata modify 是个好东西。\n就是不知道用驴的箱子可不可以……\n赶紧去试一下……\n你写的是什么。。。。\n根本没体现出楼主的作用啊。。。\n"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1556685060,
            "txt_content": "Teenager_Yang 发表于 2019-5-1 08:45\ndata modify 是个好东西。\n就是不知道用驴的箱子可不可以……\n赶紧去试一下……\n我无语了……我要的是把这个物品送到玩家手上或者背包指定的槽位，你给我生成一个掉落物干嘛……\n修改掉落物的nbt有什么可讨论的……"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1556794440,
            "txt_content": "终于，存读档玩家背包的功能实现了（大雾）"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1557620280,
            "txt_content": " 本帖最后由 467440721 于 2019-5-12 08:24 编辑 \n\n没用啊？（指战利品表）\n到手一个潜影盒\n路径block改成blocks又什么都不掉了\n楼主路径的确有问题【\n是blocks不是block\n战利品表用不了是论坛的锅（直接复制有空格导致游戏无法识别）"
        },
        {
            "author": "无情王少",
            "timestamp": 1557900900,
            "txt_content": "我看不懂，什么意思哦"
        },
        {
            "author": "cf6513272991",
            "timestamp": 1558760640,
            "txt_content": "指令一般是用来做RPG地图吗？"
        },
        {
            "author": "chyx",
            "timestamp": 1571331360,
            "txt_content": " 本帖最后由 chyx 于 2019-10-18 00:58 编辑 \n无情王少 发表于 2019-5-15 14:15\n我看不懂，什么意思哦\n因为mojang不让直接修改实体的NBT。\n\n我听说这样做是因为在内存里，一个运行中的实体对象并不是一棵NBTCompound。\n只有在存档里，它才是。\n\n所以，我们修改实体NBT，其实是把这个实体保存了，保存成一棵NBT，把命令里要改的NBTmerge进去，再加载merge了的那棵NBT。\n\n而玩家不好这样做。\n\n\n之前可以改物品的tag里面的原因也是这个。因为tag还真是时时刻刻都是一棵NBT\n"
        },
        {
            "author": "guo143042",
            "timestamp": 1571361600,
            "txt_content": "受教了，还能这么搞"
        },
        {
            "author": "阡喏",
            "timestamp": 1571497620,
            "txt_content": "牛逼就完事了"
        },
        {
            "author": "Ph-苯",
            "timestamp": 1584018780,
            "txt_content": " 本帖最后由 七刀月复 于 2020-3-13 08:57 编辑 \n\n反馈bug\n版本：20w10a/11a（不排除之前的版本也有）\n当替换主手物品时，潜影盒Slot:1b的物品会替换掉副手位，2b会替换掉靴子，3b会替换掉护腿，4b会替换掉胸甲，5b会替换掉头盔。如果上述潜影盒槽位为空，那么玩家对应槽位物品会被清除。\n-----------------------------------------------------------------\n基本命令都忘了，太丢人了"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1584019560,
            "txt_content": "七刀月复 发表于 2020-3-12 21:13\n反馈bug\n版本：20w10a/11a（不排除之前的版本也有）\n当替换主手物品时，潜影盒Slot:1b的物品会替换掉副手位 ...\n你少写了个1吧？ https://www.mcbbs.net/thread-874755-1-1.html"
        },
        {
            "author": "Ph-苯",
            "timestamp": 1584020280,
            "txt_content": " 本帖最后由 七刀月复 于 2020-3-13 09:07 编辑 \nruhuasiyu 发表于 2020-3-12 21:26\n你少写了个1吧？ https://www.mcbbs.net/thread-874755-1-1.html\n可能是我被命令提示给迷惑了，我有时间看看。————————————————————————————————\n我真的被命令提示迷惑了，以为只有这一种格式……"
        },
        {
            "author": "秋亦风云",
            "timestamp": 1584437460,
            "txt_content": "大佬，这个代码真的看不懂，虽然只是针对于服主，但是一涉及到指令就睁眼瞎了"
        },
        {
            "author": "麦克吊",
            "timestamp": 1584446640,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "麦克吊",
            "timestamp": 1584451920,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "DJSouth",
            "timestamp": 1584501960,
            "txt_content": "很多地方都需要。。。。"
        },
        {
            "author": "黑黑大",
            "timestamp": 1586742120,
            "txt_content": "额，那个玩家的末影箱有办法吗"
        },
        {
            "author": "三十晴天",
            "timestamp": 1586765220,
            "txt_content": "厉害厉害（py人气√）"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1586787360,
            "txt_content": "黑黑大 发表于 2020-4-13 09:42\n额，那个玩家的末影箱有办法吗\n类似操作，末影箱也属于玩家的slot，将玩家末影箱内容复制到潜影盒后，用特定镐子挖掘并replace 玩家的末影箱栏位的第0格，而且指定覆盖栏位数量为27即可"
        },
        {
            "author": "12tianxun",
            "timestamp": 1586843700,
            "txt_content": "讲详细点，都啥意思，（一脸闷逼不懂数据包的我）"
        },
        {
            "author": "2629761830",
            "timestamp": 1588518300,
            "txt_content": "ruhuasiyu 发表于 2019-4-28 17:24\n穷举指的是在loot_table中穷举，function中用的时候是不需要穷举的\n是否可以把玩家的手持数据转移到潜影盒当中，然后再执行后面的loot呢\n（我要做副手物品自动转主手）"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1588557060,
            "txt_content": "2629761830 发表于 2020-5-3 23:05\n是否可以把玩家的手持数据转移到潜影盒当中，然后再执行后面的loot呢\n（我要做副手物品自动转主手 ...\n当然可以，loot到副手并指定只输出1个栏位"
        },
        {
            "author": "Chara404",
            "timestamp": 1590822180,
            "txt_content": "这条指令我放1.15测试好像无效啊\n"
        },
        {
            "author": "Chara404",
            "timestamp": 1590822540,
            "txt_content": " 本帖最后由 Chara404 于 2020-5-30 16:46 编辑 \nChara404 发表于 2020-5-30 15:03\n这条指令我放1.15测试好像无效啊\n是我忘了改json了抱歉（但是改了还是没用啊？？？）\n我测试的结果是改了战利品表后仍不会对NBT起反应，但是生成的潜影盒里会带另一个潜影盒(迷惑)"
        },
        {
            "author": "lianqiuchen",
            "timestamp": 1590837360,
            "txt_content": "完全没看懂大佬说的什么意思~"
        },
        {
            "author": "理智反迷你",
            "timestamp": 1594530480,
            "txt_content": "我觉得直接用clear加give不就可以了...."
        },
        {
            "author": "名字没有？",
            "timestamp": 1594823760,
            "txt_content": "谢谢分享！！！"
        },
        {
            "author": "1539776978",
            "timestamp": 1594867680,
            "txt_content": "哇，厉害，之前总有人偷东西，不知道可不可以查到别人背包东西"
        },
        {
            "author": "mchengxiaozi",
            "timestamp": 1595078400,
            "txt_content": " 本帖最后由 mchengxiaozi 于 2020-7-18 21:22 编辑 \n\n潜影盒如果在高度0的地方可以吗？？？（如果有人问过了请无视QAQ）"
        },
        {
            "author": "tingting9554132",
            "timestamp": 1595718000,
            "txt_content": "老老实实 玩生存 看着就花"
        },
        {
            "author": "毁灭解说",
            "timestamp": 1595731680,
            "txt_content": "谢谢楼主的分享"
        },
        {
            "author": "jjuyalp",
            "timestamp": 1595736420,
            "txt_content": "mcbbs有你更精彩"
        },
        {
            "author": "Eternally_yali",
            "timestamp": 1595736540,
            "txt_content": "代码我看不懂咋办"
        },
        {
            "author": "AppleCarrot",
            "timestamp": 1595940240,
            "txt_content": "来考考古\n其实1.16有了自定义维度,也就没必要把0,255,0的方块替换掉了\n完全可以建立一个维度,替换那个维度0,255,0的方块\n"
        },
        {
            "author": "JunYun",
            "timestamp": 1595946300,
            "txt_content": "总有一天，我会肉体将会归于尘埃，我的意志亦会随着落英飞散，而你，我的孩子，你终将继承大统！\nDND测出是守序善良怎么破？这也太偏了吧\n小黑屋随身带\n语句可点\n来看看我的草稿纸吧\n我记忆中最完美的水帖，可惜了，BGM崩了。\n目前在Steam方面决定实行改革开放。"
        },
        {
            "author": "625062218",
            "timestamp": 1595981460,
            "txt_content": "大佬牛逼 感谢感谢"
        },
        {
            "author": "wansn",
            "timestamp": 1597576980,
            "txt_content": " 炒鸡好用的原版模组，我不仅自己用，还推荐给我的朋友用，大家都说好，强烈推荐！！！（五毛一条，记得删括号）"
        },
        {
            "author": "永爱不忘",
            "timestamp": 1597894080,
            "txt_content": "代码  复制好了   人在哪里领"
        },
        {
            "author": "胖虎123",
            "timestamp": 1598027280,
            "txt_content": "新萌看了表示无奈看不懂qaq"
        },
        {
            "author": "430843842",
            "timestamp": 1598030100,
            "txt_content": "大佬，完全看不明白"
        },
        {
            "author": "lxt123qwe",
            "timestamp": 1598067420,
            "txt_content": "新萌看不懂hhh"
        },
        {
            "author": "806の蜗牛",
            "timestamp": 1598496360,
            "txt_content": "谢谢楼主分享"
        },
        {
            "author": "Dearq",
            "timestamp": 1598499840,
            "txt_content": "我记得不是有个叫背包编辑器的东西吗。。。"
        },
        {
            "author": "hahaha936",
            "timestamp": 1598510700,
            "txt_content": "sssssssssssssssssssssss"
        },
        {
            "author": "执笔抚琴弦",
            "timestamp": 1598668380,
            "txt_content": "这数据看的脑壳子疼"
        },
        {
            "author": "Jokey_钥匙",
            "timestamp": 1605142680,
            "txt_content": "RIP rua影盒\n1.14-20w46a"
        },
        {
            "author": "Rechard_xu",
            "timestamp": 1606989840,
            "txt_content": "感觉一涉及到代码我就头大，不愧是大佬，就是感觉穷举ID的话无论是手动还是自动哪个工作量都很大啊"
        }
    ]
}