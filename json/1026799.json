{
    "title": "从Python的角度分析制作mcbbs论坛的原理（正帖★★）",
    "author": "SeaGame",
    "replyCount": 12,
    "timestamp": 1587612060,
    "txt_content": " 本帖最后由 SeaGame 于 2020-4-24 12:53 编辑 \n\n这次是对我上次帖子的完善，包括图片和排版的优化（之前满篇都是字）以及内容的充实，认可请一定要评好分。（这里也要感谢上次为我的帖子提出意见的玩家，感谢你们的意见让我改进了帖子）\n作者：海洋\nmcbbs论坛ID:SeaGame\n本文纯属原创，转载请注明出处。（图片来源于网络）\n\n\n注意：Mcbbs可能用的是像HTML搭配js等这样更为常见的服务器编程语言，但基础原理是不变的。\n一 Html与Python的区别与共通之处\nPython更适合后端的开发，应用场景更广泛，而Html更适合前端的开发，适合与js配合使用。\n\n\n\n\n75.jpg (4.79 KB, 下载次数: 0)\n\n下载附件\n\n2020-4-23 11:34 上传\n\n\n\n\nVS\n\n\n\n\n145223367.png (26.81 KB, 下载次数: 0)\n\n下载附件\n\n2020-4-23 11:34 上传\n\n\n\n\n\n它们的区别其实不小。但为什么我要用Python为例呢。因为它是对新手更友好，并且在mcbbs这个论坛也有不少它的程序猿，方便更好理解。即使是编程新手也能理解一部分。\n二 web程序的实现原理\n这里简单介绍一下web服务器运作的原理，就是服务器通过HTTP协议进行通信，HTTP协议采用的是请求、响应模式，即客户端发起HTTP请求，web服务器接收并解析处理HTTP请求，然后将HTTP响应发送给客户端。\n\n\n\n\n677ewi6le883.jpg (21.67 KB, 下载次数: 0)\n\n下载附件\n\n2020-4-23 11:34 上传\n\n\n\n\n\n现在注意了，不跟我是一种编程语言的人请勿继续（：咳咳，这句话有问题）。当然是可以的，这些都是一些基础初级的逻辑知识，众多语言都是一样的。\n三 Python程序的基础逻辑\n首先，先看看在不使用web程序必须的Django的情况下的Python程序的基础逻辑，这里有助于小白们了解Python工作原理。\n（不要尝试当服务器，会卡爆你的内存！）\n\n这个系统我粗略分析了一下，单从程序来看是一个简单基础的系统，虽然实现起来不怎么容易。以你现在在5级农夫组，马上就要升6级手艺人组为例，因为我们不知道Mcbbs的内部名称是什么，就以farmer代替农夫组，worker代替手艺人组。\n现在你在农夫组，如下文（里面的～指代其他玩家）\nfarmer = ['你','～','～']\n现在你升级了：使用简单函数pop()来弹出你（注意，这个pop(弹出后虽然你在farmer列表中消失了，但你仍然可以使用，如加入到其他列表。学过编程的人都知道)）\nfarmer.pop('你')\n因为不知道你的具体索引在哪里，所以这里直接弹出字符串。\n保存在一个变量：\nnewplayer = farmer.pop('你')\n再把你加入到worker组。\nworker.append(newplayer)\n怎么设定权限呢？\n\n比如挖沙工一小时只能发15条回复，就在他发回复前用if语句进行检查。\n假设这个人已经发了十五条：\nmax3 = 15\nhis = 15\nworkers = ['挖沙工']\nname = '挖沙工'\n假定这里的workers是挖沙工群组，his是他现在每小时发的回复。\n现在他又想发回复了：\n用if语句限定他：\nif name in worders:\n第一条条件测试通过！第二条：\n    if his <= max3:\n        --snip--\n这里是如果他没有发那么多信息，就让他发信息（这里略过了）\n    else:\n          print(\"…………\")\n这里是他一旦发的太多就打印一条消息不让你发。\n不过这是在内存的一种方式，我是从逻辑的角度来分析的\n现在，开始正式讲Python编Web程序服务器（你得先明白逻辑）。\n先要下载一个第三方数据库Django。\nDjango是需要一个虚拟环境……\n啊不不不，讲错了我不是来讲制作web服务器的，跑题了。\n我推断它需要用HTML来创建一个数据库（不然全在内存里，服务器不爆炸了）\n比如下面的简单代码：\n(11_env)mcbbs$ python manage.py migrate\n1 Operations to perform:\nSynchronize unmigrated apps: messages, staticfiles Apply all migrations: contenttypes, sessions, auth, admin\n--snip--\nApplying sessions.0001_initial...OK\n2(11_env)learning_log$1s\ndb.sqlite3 learning_log ll_env manage.py\n这里创建了一个名为mcbbs的数据库，可以进行数据库的迁移。\n这样就不会卡爆内存了。\n：不知道你们注意到没有，无论是登陆还是注册，mcbbs都需要cookie权限。（如果你不知道的话，下载谷歌浏览器，按F12出来开发者页面，来关闭cookie服务试试。）\n（cookie服务会允许mcbbs在你的客户端上写入一些数据，等到你下次输入同样的网址就会自动登录了）\n\n\n四 服务器的登陆与注册\n定义一个类，创建一个模型（model），写一个url，继承一个普通网页或创建一个新网页（为什么要用子类父类继承，因为这可以简化代码，提高代码效率。）\n添加一个链接，生成表单，不断添加与上文模型相关联的表单。最后重构代码，完成。\n如此循环就可以完成完整的登陆系统。\nweb程序属于比较复杂的知识，在此不做过多阐述。\n\nPython的Django它的安全系统还是比较完备的，这方便了我们来分析Html语言的安全保障系统。\n举个例子，比如某用户注册了一个账户，密码为123456，这里又来了一个技术高超的黑客，他想要盗取这个人的账户，那么他就需要密码。但Django存储密码的方式非常有趣，它是存储一个散列值，等用户输入123456，将这个123456转换成散列值，与存储于服务器的散列值相比较，如果散列值正确就让他通过。这个黑客只能盗取到散列值（在网站配置正确情况下），而服务器又尝试将这个黑客的散列值转换成散列值，结果肯定是百分之百不匹配。\n\n\n\n\ndjango-logo.gif (64.36 KB, 下载次数: 0)\n\n下载附件\n\n2020-4-23 11:35 上传\n\n\n\n\n\n五 人机身份验证\n很多玩家都认为人机身份验证很烦，但它存在也有它的道理——反爬。\n反爬就是反爬虫的缩写。比如你登陆，为了防止爬虫暴力刷密码，论坛会采取人机认证。（这也是mcbbs作为一个网站而不是软件的缺点，爬虫可以换N多个ip节点来刷密码，所以验证相当重要。）\n爬虫会严重影响社区内的秩序，当你在登陆的时候，别人在睡觉但别人也登录了并且签到获得奖励。只要巧妙地利用数据挖掘，那些固定在一个地方的可请求数据就会成为爬虫的目标，且爬虫的无限请求也是服务器的杀招。但网上的反爬技术已经日趋完善，只要监控API端口，进行可能连真人都会选错的身份验证能在一定程度上缓解问题。但mcbbs一成不变的验证风格也令人担忧。无需要多么高超的AI技术，就能利用Python这门高效的爬虫语言编写出具有微弱学习能力的爬虫，迟早有一天mcbbs的词库就会被它收于囊中，在加上mcbbs对验证次数无太大限制…………\n已完，即使看不懂也请看在我打这么多字的面子上一定要打高分哦！",
    "replies": [
        {
            "author": "卡壳",
            "timestamp": 1587612360,
            "txt_content": "这帖子我看不懂"
        },
        {
            "author": "飞小RAN",
            "timestamp": 1587612420,
            "txt_content": "图片也不去个水印\n你这还是完善。。。怕不是又水一贴。。"
        },
        {
            "author": "魅-内存君",
            "timestamp": 1587612840,
            "txt_content": "有点乱哈，学学排版吧"
        },
        {
            "author": "我是人1012",
            "timestamp": 1587612840,
            "txt_content": "是茶馆的程序带佬\n\n现在注意了，不跟我是一种编程语言的人请勿继续\n\n（默默走开）"
        },
        {
            "author": "mohui666",
            "timestamp": 1587612960,
            "txt_content": "表情炸了"
        },
        {
            "author": "尧leon",
            "timestamp": 1587613020,
            "txt_content": "这帖子我不懂"
        },
        {
            "author": "尧leon",
            "timestamp": 1587613020,
            "txt_content": "这么多字啊"
        },
        {
            "author": "小丛雨",
            "timestamp": 1587613140,
            "txt_content": "tql，sdl，我看不懂"
        },
        {
            "author": "-xiao_kai-",
            "timestamp": 1587613680,
            "txt_content": "是个大佬，恕我看不懂这贴"
        },
        {
            "author": "SeaGame",
            "timestamp": 1587619320,
            "txt_content": "-xiao_kai- 发表于 2020-4-23 11:48\n是个大佬，恕我看不懂这贴\n……看不懂给个高分鼓励一下吧"
        },
        {
            "author": "SeaGame",
            "timestamp": 1587619380,
            "txt_content": "我是人1012 发表于 2020-4-23 11:34\n是茶馆的程序带佬\n\n现在注意了，不跟我是一种编程语言的人请勿继续\n\n给个高分鼓励一下"
        },
        {
            "author": "SeaGame",
            "timestamp": 1587619440,
            "txt_content": "魅-内存君 发表于 2020-4-23 11:34\n有点乱哈，学学排版吧\n感谢反馈，以后的帖子会改的"
        }
    ]
}