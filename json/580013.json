{
    "title": "■■■■■ 真好用解决配置文件变Unicode方法 ■■■■■",
    "author": "seesaw_233",
    "replyCount": 4,
    "timestamp": 1462015860,
    "txt_content": " 本帖最后由 seesaw_233 于 2016-5-1 13:39 编辑 此问题只限于1.7.5-1.8.8服务器\n这是原来 andylizi (安利233) 的帖子:\n[插件]解决1.7.5后的服务器配置文件中文变Unicode码问题\n\n然后通过getConfig()访问\n我这个方法代替了saveDefaultConfig()、reloadConfig()和getConfig()的功能不过如果再次调用reloadConfig()方法则又需要执行该段代码\n还反射，这对于菜鸟来说太深奥了\n\n\n    \n\n\n干脆另起炉灶算了\nimport java.io.File;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport org.bukkit.configuration.file.YamlConfiguration;\nimport org.bukkit.configuration.file.YamlConstructor;\nimport org.bukkit.configuration.file.YamlRepresenter;\nimport org.yaml.snakeyaml.DumperOptions;\nimport org.yaml.snakeyaml.Yaml;\nimport org.yaml.snakeyaml.representer.Representer;\n\n代码\n\npublic class MyYamlConfiguration extends YamlConfiguration\n{\n\n    private final DumperOptions yamlOptions = new DumperOptions();\n    private final Representer yamlRepresenter = new YamlRepresenter();\n    private final Yaml yaml;\n    private final File f;\n\n    public MyYamlConfiguration(File f) throws FileNotFoundException\n    {\n        if(f == null || !f.exists())\n            throw new java.io.FileNotFoundException();\n        this.f = f;\n        yamlOptions.setAllowUnicode(false);  // 这货默认为true   要自己先改成false\n        this.yaml = new Yaml(new YamlConstructor(), this.yamlRepresenter, this.yamlOptions);\n    }\n\n    @Override  //覆盖\n    public String saveToString()\n    {\n       yamlOptions.setIndent(options().indent());\n       yamlOptions.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);\n       yamlOptions.setAllowUnicode(false); // 还用问吗\n       yamlRepresenter.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK); \n        String header = buildHeader();\n        String dump = this.yaml.dump(getValues(false));\n        if (dump.equals(\"{}\\n\"))\n            dump = \"\";\n        return header + dump;\n    }\n\n    public boolean toSave()  // 这个爱要不要\n    {\n        try \n        {   this.save(f);   } \n        catch (IOException none) \n        {   return false;   }\n        return true;\n    }\n\n    public void setUnicode(boolean flag)  // 逗你玩233\n    {\n        yamlOptions.setAllowUnicode(flag);\n    }\n\n}\n\n\n\n\n抄下来，实例化，开始玩耍吧 !\n{:10_525:}\n\n\n 看我人多好 还帮你们染色 ^_^ \n\n\n\n\n",
    "replies": [
        {
            "author": "seesaw_233",
            "timestamp": 1462017120,
            "txt_content": "我猜肯定有梨子粉说话\n我猜梨子肯定说: 如果你想这样,请便"
        },
        {
            "author": "tdiant",
            "timestamp": 1462076340,
            "txt_content": "梨子的方法覆盖了原来的，代码稍加修改就能用，复制粘贴梨子的代码就OK\n你这个还得把所有的读取改了，这对于老鸟来说太麻烦了\n\n\n    扯犊子吧"
        },
        {
            "author": "t9044",
            "timestamp": 1462370460,
            "txt_content": "seesaw_233 发表于 2016-4-30 19:52\n我猜肯定有梨子粉说话\n我猜梨子肯定说: 如果你想这样,请便\n神预测..."
        },
        {
            "author": "andylizi",
            "timestamp": 1463643480,
            "txt_content": " 本帖最后由 andylizi 于 2016-5-19 15:42 编辑 \n\n感觉更复杂了\n不过如果你想这样，请便"
        }
    ]
}