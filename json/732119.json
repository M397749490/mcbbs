{
    "title": "根据固定值获得头颅皮肤",
    "author": "鸭蛋只吃黄",
    "replyCount": 0,
    "timestamp": 1507457580,
    "txt_content": " 本帖最后由 凋灵兔子 于 2017-10-8 22:50 编辑 \n\n本来是我问的问题...但是长时间没人解答我自己解决了，发上来分享一下，这是原题：\n\n如题，Bikkit只给出了setOwner使用正版所有者的名字来获取头颅外形的方式，有没有其他方法能直接根据如下的值直接设置皮肤？感觉这样快很多\neyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHBzOi8vd3d3LmJhaWR1LmNvbSJ9fX0K复制代码API提供了使用设置所有者的方式来获得带皮肤的脑袋，其实想一下就知道是从他们的服务器下载下来的数据，我们要做的就是绕过请求服务器这一步，直接把我门持有的数据塞进要设置的头颅中。\n其实一看上面这串数据我们就知道这是Base64编码后的，我们还原一下（论坛这个排版简直爆炸，我还是上图吧）：\n\n这个图待会有用\n\n通过反编译SkullMeta我们知道决定头颅长啥样的字段是GameProfile类型的profile。GameProfile是mojang的一个Minecraft玩家，里面存着玩家的各种信息。从此我们确定下步骤：\n1. 创建一个GameProfile对象，并且给他设置皮肤\n2. 使用反射解除SkullMeta中对相关字段的保护，把我们自制的GameProfile换上去\n3. 更新方块ItemMeta\n\n我们先伪造一个GameProfile\nGameProfile gf = new GameProfile(UUID.randomUUID(), null); //UUID那里你随便，他自带的是使用(UUID)null，我感觉不大靠谱复制代码\n在GameProfile**有五个字段\nprivate final UUID id;\n    private final String name;\n    private final PropertyMap properties = new PropertyMap();\n    private boolean legacy;复制代码只要智力水平没问题的都应该知道properties就是咱们需要修改的字段，打开这个proxxxxxxx，一看他没有put方法，但是他是Multimap的子类，那就put。再看上面那个图，textures指的是材质仙阁解散了算了！又输了！，而他的第二个参数Property咱们都很熟悉，这里就不再赘述\n\ngf.getProperties().put(\"textures\", new Property(\"textures\", \"这里是一大堆数据\"));\n复制代码\n\n然后我们需要把我们自制的这个gf塞进原来头颅中，这里需要用到反射中的暴力访问。\nField f = ItemMeta的对象.getClass().getDeclaredField(\"profile\");\nf.setA(代码补全)(true);复制代码然后就是一个换\nf.set(meta, gf);复制代码然后这个meta就是我们更换过脑袋数据的了\n\n第三步大家都会，这里就不说了。\n\n其实现在想想也没什么难的，用这个方式也可以直接更换皮肤，我记得很久之前我有一位朋友教过我这个，但是我给忘了，当时有很多限制，有来自格式的，有来自mojang的，这里都没遇到，不过代码确实能用。\n\n有什么问题欢迎dalao指点。\n",
    "replies": []
}