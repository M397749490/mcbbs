{
    "title": "[NSS][NPC][Bgm][编辑中]CustomNpcs高版本脚本教程：创造全新的世界吧！",
    "author": "Heer_Kaisair",
    "replyCount": 27,
    "timestamp": 1563933300,
    "txt_content": " 本帖最后由 小黑的手臂 于 2019-8-6 17:36 编辑 \n\n\n教程编辑中...\n\n\n前排提醒1.本教程不推荐毫无基础还想一步登天的玩家使用2.编写脚本务必配合APIDOC,注意标点符号。3.禁止回复任何售卖脚本内容。4.不会编程请先进行初步学习并且理解，谢谢。------------------------------------------------1.7.10请进入灰灰的教程https://www.mcbbs.net/thread-816677-1-1.html\n\n不推荐无编程基础直接上手请Look一下https://www.mcbbs.net/thread-816677-1-1.html（灰灰的教程）中的js基础\n\n我的一点小废话1.搜索功能很棒。2.大焕欣，比1.7.10的结构好了很多。3.不用进行引入也可以使用很多功能：forge，player...先直接放APIDOC地址 http://www.kodevelopment.nl/customnpcs/api/1.12.2/overview-summary.html\n我们来..和灰灰一样熟悉一下界面\n\n看见右上角那个了么，就是搜索框。（当然你得差不多知道个方法才能搜出来英语水平捉急）\n黄框框里面的是接口！对接口！（你想了解？知乎）\n不过大家还是后面一边学一边了解吧！记住APIDOC要看要看要看！\n\n第一章：我与NPC\n本章将以可爱的npc为例，对npc进行编写脚本。\n完成进度1.空手的异乡人(√)2.我的工作与对我工作(√)3.弟弟哥哥？(√)\n\n\n序列1-空手的异乡人\n\n好的我们有了npc，我们开放了ECMA。然后这个npc只会说hello？\n不！！我不要hello！\n我们去给他添加一个脚本。\n\n\n我们的构思是：如果玩家手上空空如也，就不说话。玩家手上有东西，就让东西-1，npc说出\"美妙的约会,一起买菜\"然后，我们怎么找相应的方法？\n我们都知道，这是一个交互事件！那么 就用function interact(e){}\ne就是指那个NpcEvent.InteractEvent\n看看这个event的field 里面是Iplayer player ,当然，还有继承NpcEvent 的npc好的我们获取到player对象了，就是你 e.player !\n然后我们该如何判断手上有没有物品呢？\nplayer 肯定是个 Entity\n于是我们浏览noppes.npcs.api.entity包发现了IPlayer 类，就是你！里面都是关于Iplayer的方法~你会发现，这个类似乎并不有任何与获取手上物品有关的方法？\n别急，player 继承了 IEntity以及 IEntityLivingBase 因为其实僵尸也是entityliving，它手上也有物品对吧我下看，发现IEntityLivingBase包含getMainhandItem() 那怎么判断有没有东西？getMainhandItem() 返回的是 IItemStack  找到IItemStack的方法 isEmpty()还有，让手上的物品-1就要使用setStackSize?(int size)和getStackSize()方法好了我们基本上完成惹看看代码\nfunction interact(e){\n    var handItem = e.player.getMainhandItem();\n    if(handItem.isEmpty()!=true){\n        handItem.setStackSize(handItem.getStackSize()-1);\n        e.npc.say(\"美妙的约会,一起买菜\");\n    }\n}复制代码\n序列2-扯淡快乐人\n对于这个本地人，身为异乡人的我们自然是没话可说。但是作为外地的卑鄙人，免不了要套一些话比如 ：今天天气怎么样这要用world)，你吃了吗，你现在啥工作啊，你衣服哪里买的...\n这边1.12.2的方法与1.7.10有很大不同，我们不再直接对event.npc进行getName()来获取名字，而是先获取npc的INPCDisplay对象例如：对npc操作 e.npc.getDIsplay().getName()为什么这边要着重强调这个？因为这样做有一个更好的归类性（瞎讲）...\nINPCDisplay\n中就包含了关于npc 显示/展示 出来的所有东西，包括 skin皮肤 ，名字 血条bossbar 模型model...\n\n以此类推，你现在啥工作？这个问题可以获取npc的INPCJob,也就是getJob() 当然，when you finished then you should use the method getType() ,also ,it's will return an int value.\nHow to 。。。对不起有点什么奇怪的语言混进来了，关于这个获取的int值，判断？那么你就要快乐的用到noppes.npcs.api.constants.JobType里面提供的枚举.\n\n还有一件事！1.12.2为脚本增加了分页设计，比如上一个教程的空手不说话根本不用删，直接新建一个第二页，在里面写上function interact(e){\n    var npcdisplay=e.npc.getDisplay();\n    var weather=e.npc.getWorld().isRaining();// get a boolen value presents is the world raining \n    var skin = npcdisplay.getSkinTexture();\n    e.npc.sayTo(e.player,\"Hello,my name is\"+npcdisplay.getName());\n    if(weather){\n        e.npc.sayTo(e.player,\"現在下雨呢\");\n    }else{\n        e.npc.sayTo(e.player,\"天氣晴朗\");\n    }\n    e.npc.sayTo(e.player,\"我的衣服？我來看看\");\n    e.npc.sayTo(e.player,skin);\n    \n} 复制代码這樣就可以和npc扯淡了。hhh。\n如何判斷npc的Job就给你们当作业（提示，这枚举不多，不用写入一个Map再用了！（JS有MAP嘛，还是Directory<>?））！\n\n序列3-spawnClone与实体操作\n好了我们进入正题，如何做出“影分身”效果：\nnpc被攻击会产生影分身，3秒后影分身消失。影分身存在的时候不会再次生成影分身好的我们先给面前的npc取个名字 ：信球思望 \n我们先来想一下如何创造分身？\n分身肯定来源于npc自己！我们来看一下IWorld中提供的方法（为什么是IWorld？不然你怎么生成？！因为是生成在世界里啊，所有在要看IWorld）\n那么我们找到了几种方法 spawnEntity?(IEntity entity）和 spawnClone?(double x, double y, double z, int tab, java.lang.String name)嗯接下来发现 spawnClone比较垃圾（还要在复制魔杖里搞？太烦了）\n那么我们选择了spawnEntity?(IEntity entity）但是这个IEntity对象哪里搞？\n没错，IWorld下提供了\ncreateEntity(java.lang.String id)\ncreateEntityFromNBT(INbt nbt)\n但是这些似乎只能用来生成原有的生物（玩家也无法生成）。\n那该怎么办呢？！！！要使用spawnClone() 了吗！那就用吧..把这e.npc.storeAsClone(1,\"storedNpc\")把他放进clone里面。再利用world的getClone(1,\"storedClone\")来获取IEntity。\n\n\n然而还有一个办法是我非常推荐的，就是在\n生成一个npc，把他塞进npc复制魔杖的server里面。名字叫clone。\n以后直接成成他，在把需要复制的npc的nbt给予那个新的。并且要设置home啊！(但是home数据可以用nbt)所以 综合一下\n 对于npc来说，最好的生成方法（纯脚本）就是利用服务器提供的API（NpcAPI）来创造出npc，再将原来的npc的EntityNbt给新创造的nbt，同时再次设定新npc的Position。\n\n\n操作完他的属性，我们来生成。\n来看看生成分身代码：\nvar entity=e.API.        createNPC(e.npc.getWorld().getMCWorld());\nentity.setEntityNbt(e.npc.getEntityNbt());\nentity.        setPosition(e.npc.getX()+1,e.npc.getY(),e.npc.getZ()+1);\nentity.getDisplay().setName(\"影分身\");复制代码\n\n然后关于三秒后消失？使用Timer！\n下面我们讲述如何使用timer进行延迟\n就关于上面那个entity对象，让它永久消失就是despawn() [死亡可以复活用kill()]\n首先我们要获取Timers对象 ：方法 e.npc.getTimers()\n再次，我们启动一个id为1的timer \ne.npc.getTimers().forceStart(1,40,false);//40就是两秒（这边我用了forcestart，因为不想再去检测这个id有没有timer了）\n然后，创建timer钩子\nfunction timer(e){}\n里面填写 if(e.id==1){e.npc.kill()}\n\n\n\n8\n\n9\n\n10\n\n11\n\n12function ExpPlayer(player,exp){\n    this.player=player;//这里推荐用playername，毕竟好操作\n    this.exp=exp;\n}\n//定义一个结构 包含player 和 exp 。\n\n//模拟定义一些玩家\nvar heer = new ExpPlayer(\"heer\",100);//赫尔，100经验\nvar siwang = new ExpPlayer(\"siwang\",800);//思望，800经验\n\n//创建一个数组\nvar arr=new Array();\n//把你们加进去。\narr.push(heer);\narr.push(siwang);\n\n//定义魔改版冒泡算法（从高到低）\nfunction bubbleSortPlus(arr) {\n    var len = arr.length;\n    for (var i = 0; i < len; i++) {\n        for (var j = 0; j < len - 1 - i; j++) {\n            if (arr[j].exp < arr[j+1].exp) {        //相邻元素两两对比\n                var temp = arr[j+1];        //元素交换\n                arr[j+1] = arr[j];\n                arr[j] = temp;\n            }\n        }\n    }\n    return arr;\n}\n//获得排序后数组\narr = bubbleSortPlus(arr);//这个arr已经排序过了。\n\n\n/*\n        //这边方法我随便取的，都是错误。别管，看懂就行\n        var arr2=world.getAllServerPlayers();\n        var arr3=new Array(); //定义新的arr3\n        for(var i=0;i<arr2.length;i++)\n        {\n                arr3.push(new ExpPlayer(arr2[i].getName(),arr2[i].getExp()));\n        }\n        arr2 = bubbleSortPlus(arr2);//同理\n*/复制代码\n\n\n\n\n[groupid=1595]CNPC Script Studio[/groupid]",
    "replies": [
        {
            "author": "淑芳",
            "timestamp": 1563937560,
            "txt_content": "非常期待你能写完awa,因为脚本这东西真的 超 超 超好用的！"
        },
        {
            "author": "Heer_Kaisair",
            "timestamp": 1563942240,
            "txt_content": "占楼放提醒\n————救世主赫尔"
        },
        {
            "author": "1370698539",
            "timestamp": 1563942660,
            "txt_content": "小黑的手臂 发表于 2019-7-24 12:24\n占楼放提醒\n————救世主赫尔\n赫尔大佬nb！(我是黎明)"
        },
        {
            "author": "Colin_Sakuya",
            "timestamp": 1563953520,
            "txt_content": "顶起来，大佬牛逼"
        },
        {
            "author": "1370698539",
            "timestamp": 1564117200,
            "txt_content": "赫尔大佬nb！！！！"
        },
        {
            "author": "1764191550",
            "timestamp": 1564124100,
            "txt_content": "神乎其技，不服不行！"
        },
        {
            "author": "1764191550",
            "timestamp": 1564124100,
            "txt_content": "大佬nb！！！！！"
        },
        {
            "author": "1764191550",
            "timestamp": 1564124160,
            "txt_content": "顶起来，大佬牛逼"
        },
        {
            "author": "1764191550",
            "timestamp": 1564124220,
            "txt_content": "真的nb真的厉害哇"
        },
        {
            "author": "Heer_Kaisair",
            "timestamp": 1564141080,
            "txt_content": "1764191550 发表于 2019-7-26 15:02\n66666666666666666\n请勿水贴刷评论"
        },
        {
            "author": "思望文宣",
            "timestamp": 1564158480,
            "txt_content": "支持支持"
        },
        {
            "author": "Nayo996",
            "timestamp": 1564707120,
            "txt_content": " 很不错的教程"
        },
        {
            "author": "思望文宣",
            "timestamp": 1565098620,
            "txt_content": "支持赫尔"
        },
        {
            "author": "j1612480068",
            "timestamp": 1567066920,
            "txt_content": "赫尔大佬我要定制脚本 q 1612480068"
        },
        {
            "author": "fadlp321",
            "timestamp": 1579594740,
            "txt_content": "我的天，非常期待你能写完awa,因为脚本这东西真的 超 超 超好用的！"
        },
        {
            "author": "Heer_Kaisair",
            "timestamp": 1579772760,
            "txt_content": "fadlp321 发表于 2020-1-21 16:19\n我的天，非常期待你能写完awa,因为脚本这东西真的 超 超 超好用的！\n我咕咕咕了，有时间再说吧=="
        },
        {
            "author": "常规操作",
            "timestamp": 1581310740,
            "txt_content": "大佬想问下怎么用脚本做个菜单，我朋友在1.7.10做了个菜单，他说用脚本做的"
        },
        {
            "author": "soil-sword",
            "timestamp": 1581407700,
            "txt_content": "十分高水平的教程，但是这对观看教程者提出了一些要求。\n期待完成后的帖子，那肯定是十分美好的作品。"
        },
        {
            "author": "d321313",
            "timestamp": 1582394820,
            "txt_content": "太强了.."
        },
        {
            "author": "1023436457",
            "timestamp": 1582456260,
            "txt_content": "非常感谢，教程很有用"
        },
        {
            "author": "gbfjvyj",
            "timestamp": 1586478180,
            "txt_content": "支持支持，大佬nb"
        },
        {
            "author": "KindLHJ",
            "timestamp": 1586522820,
            "txt_content": "看不懂0.0但是还要感谢楼主，力顶！！！"
        },
        {
            "author": "Heer_Kaisair",
            "timestamp": 1586523540,
            "txt_content": "KindLHJ 发表于 2020-4-10 20:47\n看不懂0.0但是还要感谢楼主，力顶！！！\n咕咕咕（发出了鸽子的声音"
        },
        {
            "author": "2786761452",
            "timestamp": 1587784380,
            "txt_content": "大佬厉害，教程很不错，楼主加油"
        },
        {
            "author": "oywc8094",
            "timestamp": 1589775300,
            "txt_content": "非常感谢，很有意思，坐等更新物品"
        },
        {
            "author": "H笔挺的虎鲸h",
            "timestamp": 1611908520,
            "txt_content": "萌新看的一脸懵逼"
        },
        {
            "author": "hdxbl005",
            "timestamp": 1613608080,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽\n"
        }
    ]
}