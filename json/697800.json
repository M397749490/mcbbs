{
    "title": "剧情之力：用变量来掌控事件，自定义NPC下对剧情事件系统的优化",
    "author": "泣血暗影",
    "replyCount": 13,
    "timestamp": 1497266160,
    "txt_content": " 本帖最后由 泣血暗影 于 2017-6-15 19:50 编辑 \n\n这个脑洞由来相当久远，可以扯到3年前我想把某个游戏的世界观展现在MC中的时候。\n\n另一个脑洞来源http://www.bilibili.com/video/av1403148，以及http://www.bilibili.com/video/av1799016/某个RPGmaker的教程，也有点年头了。。。事件和变量控制部分从第一个视频的14分40秒开始，后续可以看第二个视频的9分45秒开始。一定程度上，我目前就是希望能够实现这样的效果。\n\n上个月的时候，和一个比较喜欢自定义NPC的腐竹，以及一个比较擅长玩mod的朋友三个人一起（但是编程水平都不怎么样，NPC脚本魔杖，现在正在研究中，已经只剩我一个人还在研究了）讨论起这个问题，于是有了开坑的想法。\n\n因为目前对脚本魔杖都不熟，所以可能我所需要的这些功能可以通过脚本魔杖实现，毕竟编程。。。。说真的就算今年内有人说用mc实现了AlphaGo我都不一定会觉得奇怪。。。。\n\n于是后面慢慢写正文。。。\n\n\n\n\n首先，如果看了前面提到的视频的话大概就会有这么一个 变量 的概念了。其实简单来说，就是设置了更加灵活的判定条件。CustomNPCs本身基本上是用事件来控制事件的，事件的触发条件为完成某个前置事件之类的。结果带来的一种感觉就是，任务环环相扣，东北灭完火西边又地震，被任务牵着鼻子走，但是同时，你又并不是不可以不管任务到处乱跑。\n视频当中做的只是个非常简单的解释，事实上，可以设置非常多的变量，在中间的每一个步骤都可以增加变量的变化，变化的结果也可以设置为不同的数，这样的话，整个剧情系统就显得非常精细了。\n\n\n\n理论的东西我不多说，用举例来一点点描述我的想法。\n\n假设我做了一个庞大的副本，规模参考大型MMORPG。人数限定6到12人。\n\n于是我做了一个“副本管理员”由他控制副本变量、副本刷新和玩家的副本传送。用红色来表示变量的变化，蓝色来表示判定条件，紫色来表示未实施的可行变量变化\n初始状态——副本变量：0。所有玩家副本状态变量：0\n副本管理员接受副本启动申请\n一名新玩家（副本状态变量为0）向副本管理员互动，提出启动副本——副本变量：1，该玩家副本状态变量：1（队长）\n副本管理员不再接受启动申请，转而接受副本团队加入申请\n副本状态变量为1的玩家可以申请解散团队（所有变量重置为0）\n5名新玩家分别向副本管理员互动加入团队——副本变量：2→6，每名玩家副本状态变量都变为2。\n副本状态变量为1的玩家可以申请不再让更多人加入（副本变量：12）\n又有6名新玩家与副本管理员互动加入团队——副本变量：7→12，玩家副本状态变量：2\n副本管理员不再接受新玩家申请\n副本管理员刷新副本内怪物（怪物不再启用时间复活的机制）\n队长向副本管理员提出传送请求——副本变量：13\n副本状态变量为1或2的玩家（遍历所有玩家的该状态号，大概可能会有点低效率）被传送至副本。\n副本状态变量为1或2的玩家可以和副本管理员互动传送副本（死后跑尸）\n副本变量为1的玩家可以申请放弃副本（副本变量重置为0，全队玩家传送回管理员处且副本状态变量：3，计时器12小时后副本状态变量重置为0）\n计时器a启动，时限为120分钟（暂定）\n副本最终boss被击败——副本变量：14（当然可以考虑顺便中间做点解谜或者其他判定也用这条变量）全队玩家副本状态变量：3\n计时器a停止\n计时器b开始，时限为30秒（捡掉落物）\n计时器b计满30秒——副本变量：0，全队玩家传送离开副本回到管理员处\n若计时器a计满120分钟——副本变量重置为0，全队玩家传送回管理员处且副本状态变量：3\n\n\n\n\n\n第二个例子，前面说的多人，这里说个单人的\n不知道有没有玩过《露塞提娅：道具屋经营妙方》的？\n\n\n\n\nQQ截图20170612223308.jpg (226.52 KB, 下载次数: 1)\n\n下载附件\n\n2017-6-12 22:33 上传\n\n\n\n\n\n\n曾经想过在mc里还原这样的设定。\n使用了多个变量来帮助判定的话，就能大体上实现了\n时间系统，用一个变量就能解决，顺便由变量控制天色，再顺手做个每20tick回退20tick之类的时停就好\n经营系统需要好几个变量，我甚至有点不想做讲价。。。。\n佣兵系统。。。反正也是史蒂夫同志自己上场，感觉还是利用多世界不统一背包之类的黑科技来做方便得多，利用变量决定玩家的属性和装备，带回的物品，终点给个末影箱估计都可以。\n迷宫系统，随机地图还是算了吧，不过副本的刷新可以参考上一个例子，用变量来刷新而不是时间，可以有效避免玩家滞留副本刷怪\n随机剧情，在时间变量里带条件地随机分配几个值给剧情大概就可以了吧\n\n\n\n\n其实说到底，这并不算是一个非常复杂的功能，脚本魔杖大概也是可能实现的，但是毕竟脚本魔杖。。。我都也还没看明白，到现在也没找到几个教程，能投入实用的就不说了。。。\n考虑到我们这边三个人的编程水平都比较入门，我也在考虑是自己研究脚本魔杖，还是研究写mod，还是把脑洞交给别人来做\n\n\n\n\n\n\n来更新正式的设计\n既然打算作为CustomNPC的附属mod，基本上也就按照CustomNPC的风格来设计好了\n剧情之力，作为一个纯粹的算法mod，本身并不需要设计什么方块，所以就做两个创造工具：剧情笔记和剧情标尺。\n\n\n\n先说剧情笔记。（剧情笔记的图标就做成书与笔的样子大概不错？）\n剧情笔记，顾名思义就是做剧情的，准确说，做事件。（顺便可以考虑把内置教程放在剧情笔记里）\n\n对空气右键，可以创建和编辑全局变量和玩家变量\n全局变量保存在系统，常时进行判定，举个例子的话，多人合作冒险时一个人达到check point时候将所有人都算作达到这个check point，为每个人做一个玩家变量遍历一遍大概还是太费事了。。。有的时候设计单人地图的时候为了避免有人用多人模式游玩发生任务冲突奖励重复等情况，也可以直接做成全局变量。（其实在上面的第一个例子里，副本变量保存在系统可能比保存在副本管理员更合适）\n玩家变量则是保存在玩家身上。比如说每个玩家的任务进度独立，不同的职业会有不同的分配，不同的选择分支会带来不同的结果等情况，都会将变量保存在玩家身上。\n编辑变量时基本就是判定条件和变量变化，每个变量会在什么情况下变化成什么。判定条件可以设置多条，并用可以用或/且/非来判定条件关系\n\n对一个NPC右键，可以编辑该NPC的事件和变量。\nNPC事件可以简单地理解为一段对话。一个NPC可以创作许多个事件，事件本身其实和原本NPCmod差距不大，主要是添加了变量的内容，比如说把变量作为事件的判定条件，以及事件过程中变量的变化。大多数变量的变化可以直接写在事件里，以避免全局变量和玩家变量的界面被塞得太满。。。\nNPC变量则是保存在NPC身上的。它和全局变量比较类似，但是因为变量的全程都只有这一个NPC参与判定，保存在NPC身上比较省事。（sans：你已经被我杀死5次了。哦好吧其实这个应该存个人变量，NPC变量是已经有5个人死在我脚下了）\n\n（备选效果）对话框设计/立绘展示/自定义界面。。。。大概可以朝着橙光游戏制作工具的方向考虑。\n\n\n\n然后是剧情标尺。。。（原版有什么比较像尺子的东西来着。。。剪刀可以么？）\n其实我有点犹豫要不要做这玩意的，毕竟功能和剧情笔记有点重复\n剧情标尺是一个快捷的变量查看和整理的工具。\n剧情标尺设计（或者选定）了一条变量作为核心变量，再根据各个事件的变量条件，由此展开一条事件树。创作者可以由此来判断自己事件安排得是否合理，分支是否平衡，支线密度是否均衡，或者有没有条件太苛责之类的。\n通常，创作者可以在做完主线各个分支之后，根据事件树来安插支线\n\n",
    "replies": [
        {
            "author": "平凡的行者",
            "timestamp": 1497267600,
            "txt_content": " 本帖最后由 平凡的行者 于 2017-6-12 19:49 编辑 \n\n我提供个想法吧\nNPCmod中的阵营点数(实际应用上也可以作为一个变量)其实已经足够做为传递事件的中介了，因为和NPC的很多互动都会影响阵营点数(任务完成、杀敌、对话...之类的)\n而且触发NPC的事件(能否对话、NPC与玩家的敌对关系之类的)的条件，也可以设定成是否根据阵营点数的状况来判断\n\n不一定需要用到npc的脚本，只是有脚本就能做到更精细的控制。\n\n而这个概念其实就跟用记分板上的统计类判据和命令方块的组合，做到事件侦测，是一样的。楼主不访可以参考一下这类的设计。\n"
        },
        {
            "author": "xjlxzcdwq",
            "timestamp": 1497270120,
            "txt_content": "支持楼主，我刚好想做这个类型的剧情触发，但是苦于不知道怎么做...."
        },
        {
            "author": "langyo_v3",
            "timestamp": 1497271020,
            "txt_content": "脑洞很棒,把它以mcfunction来实现是再好不过了"
        },
        {
            "author": "泣血暗影",
            "timestamp": 1497274800,
            "txt_content": "平凡的行者 发表于 2017-6-12 19:40\n我提供个想法吧\nNPCmod中的阵营点数(实际应用上也可以作为一个变量)其实已经足够做为传递事件的中介了，因 ...\n想过阵营点数的问题，但是变量可能不够细致，判定条件也比较有限"
        },
        {
            "author": "泣血暗影",
            "timestamp": 1497278880,
            "txt_content": "说个题外话，我要不要找禁忌剧情之力大佬来做JAVA顾问和形象代言呢→_→"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1497279600,
            "txt_content": " 本帖最后由 平凡的行者 于 2017-6-12 23:40 编辑 \n泣血暗影 发表于 2017-6-12 21:40\n想过阵营点数的问题，但是变量可能不够细致，判定条件也比较有限\n我之前有做过类似你举的副本例子\n不过我是做BOSS挑战场。里面包含了有我精心设计的行动模式的BOSS和简单的队伍系统。\n\n我先给你的想法一点建议，好帮助你设计：\n首先如果你想要用npc的脚本魔杖做的话，就不要浪费程序语言的能力\n脚本魔杖允许你使用编程用的语言，预设即是javascript(要其他的脚本语言可以安装对应的安装包以使用诸如PHP之类的语言)来操控NPC或是其他东西\n\n简单来说，你就是使用程式语言在控制NPC了\n\n你需要认清这点，脚本魔杖的使用方式跟RPGmaker的事件触发完全不一样\n\n\n然后我可以给一些之前我自己的经验：\n之前我做的BOSS竞技场有一个简单的队伍系统。\n我使用了一个阵列来记录当前挑战这个BOSS的玩家，以及地图上剩余的挑战时间(同时如果这个阵列存在，代表当前有队伍正在挑战BOSS)\n阵列是纪录在world物件上，副本管理员可以简单的直接存取\n当这个阵列不存在时(当前无人挑战)，有玩家和管理员对话时，就会新开一个队伍(会产生新的阵列)，并将玩家加入队伍，同时开始倒数计时。\n倒计时期间可以有其他玩家再次和管理员对话加入队伍，或是已加入队伍的玩家可以和管理员对话而离开队伍。\n当倒计时结束后，传送所有玩家进入副本内挑战BOSS，同时开始计时挑战时间。\n计时结束或队伍内没人后，会将队伍内所有玩家送出场地，同时结束队伍(阵列删除)。\n"
        },
        {
            "author": "泣血暗影",
            "timestamp": 1497320880,
            "txt_content": "平凡的行者 发表于 2017-6-12 23:00\n我之前有做过类似你举的副本例子\n不过我是做BOSS挑战场。里面包含了有我精心设计的行动模式的BOSS和简单的 ...\n是有考虑过的，可能我整条设计都是脚本魔杖可以实现的。\n\n然而脚本魔杖的使用方法还没摸清楚\n\n我想要一个比较完整的示例，比如说实现某个功能所需要的所有js文件的完整内容，包括格式。\n毕竟编程水平也就半桶水"
        },
        {
            "author": "平凡的行者",
            "timestamp": 1497347580,
            "txt_content": "泣血暗影 发表于 2017-6-13 10:28\n是有考虑过的，可能我整条设计都是脚本魔杖可以实现的。\n\n然而脚本魔杖的使用方法还没摸清楚\n那么你可以参考一下这篇的回覆\nhttp://mcbbs.tvt.im/forum.php?mo ... p;extra=&page=1\n虽然只有几个例子，不过应该能让你大致了解脚本魔杖到底在做什么\n\n另外，你如果在考虑要使用脚本魔杖还是去写mod的话\n我可以给你一点建议：\n如果你放弃了脚本魔杖就别去写mod了，因为你一旦会使用脚本魔杖，那么也有办法学着写mod\n\n如我上面所述，脚本魔杖的用法其实就是使用编程语言控制NPC，虽然使用的语言跟写mod用的(Java)不同，但不管是javascript或Java语言，都有类似的概念在里面。只要掌握这概念(物件导向设计)，学起来就不算难。只是要注意一下语法背后的细节。\n\n所以你原本的三个选择变成了两个：\n是要去学编程呢?还是把脑洞交给别人来做?\n\n"
        },
        {
            "author": "泣血暗影",
            "timestamp": 1497348420,
            "txt_content": "平凡的行者 发表于 2017-6-13 17:53\n那么你可以参考一下这篇的回覆\nhttp://mcbbs.tvt.im/forum.php?mod=viewthread&tid=656550&extra=&page=1 ...\n好的谢谢吧，因为我专业课也正在学java，所以会有这样的打算，但是毕竟初学"
        },
        {
            "author": "迷失的绵羊",
            "timestamp": 1498984620,
            "txt_content": "我电脑有点垃圾，登入游戏就立刻重启233"
        },
        {
            "author": "2831974192",
            "timestamp": 1500036120,
            "txt_content": "估计 有点脑洞 编程起来 没1个月 做不出来的2333"
        },
        {
            "author": "泣血暗影",
            "timestamp": 1500039780,
            "txt_content": "2831974192 发表于 2017-7-14 20:42\n估计 有点脑洞 编程起来 没1个月 做不出来的2333\n目前就是缺乏编程思路。。。。正在阅读理解CustomNPC"
        },
        {
            "author": "小心傷",
            "timestamp": 1500090660,
            "txt_content": "谢谢楼主"
        }
    ]
}