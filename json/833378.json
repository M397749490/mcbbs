{
    "title": "MC最新版本是否屏蔽了外部postmessage",
    "author": "yuezhuxue",
    "replyCount": 4,
    "timestamp": 1544264880,
    "txt_content": "\n正在用vb.net编写一个后台给MC发送键盘命令的程序，使用的是postmessage方法\n\n代码\nhwnd = FindWindow(vbNullString, \"Minecraft 1.13.2\") \nPostMessage(hwnd, WM_KEYDOWN, 69, 0)       '按下e键\nPostMessage(hwnd, WM_KeyUP, 69, 0)             '松开e键\n在1.6.4、1.11.2、1.12.2版本中，\n以上代码都能正常作用（打开GUI），\n唯独1.13、1.13.2没有反应，\n\n此外也同样测试了按键T、/、w等等\n\n想请教各位老师：\n①是否从1.13开始，MC屏蔽了外部程序postmessage\n②是否我的算法有问题，1.13开始要特殊对待\n\n③是否有其他算法实现此功能",
    "replies": [
        {
            "author": "langyo",
            "timestamp": 1544268660,
            "txt_content": "你这用的是 Windows API 么？\n\n运行游戏的 JVM 虚拟机很可能屏蔽了这些来自外部的原生底层平台消息，这应该是由于 JVM 本身的安全机制导致的\n\n如果你真的想模拟按键，只能用诸如 SimulateMouse 这类函数\n\n例如……这是易语言的实现：https://jingyan.baidu.com/article/7c6fb4283d677780642c9009.html"
        },
        {
            "author": "yuezhuxue",
            "timestamp": 1544315880,
            "txt_content": " 本帖最后由 yuezhuxue 于 2018-12-9 08:49 编辑 \nlangyo 发表于 2018-12-8 19:31\n你这用的是 Windows API 么？\n\n运行游戏的 JVM 虚拟机很可能屏蔽了这些来自外部的原生底层平台消息，这应该 ...\n可能我没有表述清楚吧，\n详细说一下：不需要模拟鼠标，只需要模拟键盘消息，\n\n可能并不是JVM的原因，因为，\n在1.13之前的版本，程序都能正确的把所有的键盘命令传递到MC,\n所有的MC都运行于java8的jre之上\n\n经过研究，到了1.13之后，\n传递的命令能在下列界面生效，\n\n\n\n\n\n搜狗截图20181209081925.jpg (94.75 KB, 下载次数: 0)\n\n下载附件\n\n2018-12-9 08:26 上传\n\n\n\n\n\n\n\n\n\n\n搜狗截图20181209081853.jpg (53.78 KB, 下载次数: 0)\n\n下载附件\n\n2018-12-9 08:26 上传\n\n\n\n\n\n\n\n\n\n\n搜狗截图20181209081835.jpg (54.23 KB, 下载次数: 0)\n\n下载附件\n\n2018-12-9 08:26 上传\n\n\n\n\n\n\n\n\n\n\n搜狗截图20181209081806.jpg (40.8 KB, 下载次数: 0)\n\n下载附件\n\n2018-12-9 08:25 上传\n\n\n\n\n\n\n\n\n\n\n搜狗截图20181209082705.jpg (52.09 KB, 下载次数: 0)\n\n下载附件\n\n2018-12-9 08:29 上传\n\n\n\n\n\n\n游戏界面的其他操作就完全无效\n还有一个未解之谜，\n只发送单个按键e按下(keydown)的消息，到了1.13里面全都变成了ee\n按理说，\n要是这样的话，\n发送指令t，效果应该是打开聊天并输入t\n发送指令w，效果应该是打开疾跑并一直往前\n\n然而什么都没有发生，\n不知道是啥原因\n1.13的本质是复读机吗？\n\n\n\n\n"
        },
        {
            "author": "langyo",
            "timestamp": 1544359560,
            "txt_content": "yuezhuxue 发表于 2018-12-9 08:38\n可能我没有表述清楚吧，\n详细说一下：不需要模拟鼠标，只需要模拟键盘消息，\n我查了下，找到了一种似乎可行的办法，不过还得你去试试\n\n首先贴出来自 Java 自带支持的 awt.Robot 类：http://tool.oschina.net/uploads/ ... java/awt/Robot.html\n然后再给以 Java 模拟键盘按键的例子：http://bbs.51cto.com/thread-1097189-1.html\n然后是所需的 GraphicsDevice，用这个应该能获取到 Minecraft 窗口的图形设备：http://tool.oschina.net/uploads/ ... GraphicsDevice.html\n\n具体的做法大概是你写个 mod，获取到 Minecraft 的图形设备（或者如果有可能的话，从游戏程序外部获取到 Minecraft 进程的窗口图形设备，似乎也可行），然后拿 Robot 操作\n\n仅供参考，不一定有效\n\n顺带一提……我看了你的 github 主页、 bilibili 主页和微博主页……请问下你的站点最底部的统计部分的“雪花片”是访问次数的意思么？……\n\n差点就同城了"
        },
        {
            "author": "yuezhuxue",
            "timestamp": 1544452920,
            "txt_content": "langyo 发表于 2018-12-9 20:46\n我查了下，找到了一种似乎可行的办法，不过还得你去试试\n\n首先贴出来自 Java 自带支持的 awt.Robot 类：h ...\n雪花的确是访问统计。\n\n另外我也解决了“复读机”的问题\n原因是PostMessage(hwnd, WM_KEYDOWN, 69, 0)   默认传参\n改成PostMessage(hwnd, WM_KEYDOWN, 69, &H1)即可\n\n同时还发现使用sendkey可以使游戏出现按下Esc的效果\n\n   "
        }
    ]
}