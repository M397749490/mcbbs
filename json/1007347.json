{
    "title": "服务器开久了有时候就TPS太低，求助",
    "author": "2629735078",
    "replyCount": 6,
    "timestamp": 1585906800,
    "txt_content": " 本帖最后由 skyliye 于 2020-4-6 15:23 编辑 \n\nTimings 报告https://timings.aikar.co/?id=433dc084c4164647a1c0e4a654e9575d\n\n我认为可能是区块无法卸载的问题\n服务器除了生存世界其他世界的区块都无法正常卸载，比如地狱末地，有时候区块加起来上7000多\n用着用着服就崩了\n太痛苦了\n\n而且今天的有一段错误报告 未响应29秒\n我10天后换个比这个好点机子，能有救吗\n\n\n[16:16:30] [Paper Watchdog Thread/ERROR]: --- DO NOT REPORT THIS TO PAPER - THIS IS NOT A BUG OR A CRASH ---\n[16:16:30] [Paper Watchdog Thread/ERROR]: The server has not responded for 29 seconds! Creating thread dump\n[16:16:30] [Paper Watchdog Thread/ERROR]: ------------------------------\n[16:16:30] [Paper Watchdog Thread/ERROR]: Server thread dump (Look for plugins here before reporting to Paper!):\n[16:16:30] [Paper Watchdog Thread/ERROR]: ------------------------------\n[16:16:30] [Paper Watchdog Thread/ERROR]: Current Thread: Server thread\n[16:16:30] [Paper Watchdog Thread/ERROR]:         PID: 19 | Suspended: false | Native: false | State: RUNNABLE\n[16:16:30] [Paper Watchdog Thread/ERROR]:         Stack:\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.yaml.snakeyaml.parser.ParserImpl.checkEvent(ParserImpl.java:148)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.yaml.snakeyaml.composer.Composer.getSingleNode(Composer.java:104)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.yaml.snakeyaml.constructor.BaseConstructor.getSingleData(BaseConstructor.java:140)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.yaml.snakeyaml.Yaml.loadFromReader(Yaml.java:524)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.yaml.snakeyaml.Yaml.load(Yaml.java:437)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.configuration.file.YamlConfiguration.loadFromString(YamlConfiguration.java:53)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.configuration.file.FileConfiguration.load(FileConfiguration.java:162)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.configuration.file.FileConfiguration.load(FileConfiguration.java:130)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.configuration.file.YamlConfiguration.loadConfiguration(YamlConfiguration.java:178)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.CSCoreLibPlugin.Configuration.Config.<init>(Config.java:51)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.Slimefun.Objects.Research.hasUnlocked(Research.java:208)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.Slimefun.Objects.Research.hasUnlocked(Research.java:193)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.Slimefun.api.Slimefun.hasUnlocked(Slimefun.java:144)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.Slimefun.listeners.ItemListener.onRightClick(ItemListener.java:208)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 com.destroystokyo.paper.event.executor.asm.generated.GeneratedEventExecutor957.execute(Unknown Source)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.EventExecutor$2.execute(EventExecutor.java:70)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 co.aikar.timings.TimedEventExecutor.execute(TimedEventExecutor.java:78)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.java:62)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.java:513)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 me.mrCookieSlime.CSCoreLibPlugin.events.Listeners.ItemUseListener.onRightClick(ItemUseListener.java:22)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 com.destroystokyo.paper.event.executor.asm.generated.GeneratedEventExecutor248.execute(Unknown Source)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.EventExecutor$2.execute(EventExecutor.java:70)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 co.aikar.timings.TimedEventExecutor.execute(TimedEventExecutor.java:78)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.java:62)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.java:513)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 org.bukkit.craftbukkit.v1_12_R1.event.CraftEventFactory.callPlayerInteractEvent(CraftEventFactory.java:236)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PlayerInteractManager.a(PlayerInteractManager.java:486)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PlayerConnection.a(PlayerConnection.java:1011)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PacketPlayInUseItem.a(PacketPlayInUseItem.java:37)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PacketPlayInUseItem.a(PacketPlayInUseItem.java:5)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PlayerConnectionUtils.lambda$ensureMainThread$0(PlayerConnectionUtils.java:14)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.PlayerConnectionUtils$$Lambda$990/283396682.run(Unknown Source)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 java.util.concurrent.FutureTask.run(Unknown Source)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.SystemUtils.a(SourceFile:46)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.MinecraftServer.D(MinecraftServer.java:850)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.DedicatedServer.D(DedicatedServer.java:423)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.MinecraftServer.C(MinecraftServer.java:774)\n[16:16:30] [Paper Watchdog Thread/ERROR]:                 net.minecraft.server.v1_12_R1.MinecraftServer.run(MinecraftServer.java:666)\n[16:16:30] [Paper Watchdog Thread/ERROR]: ------------------------------\n[16:16:30] [Paper Watchdog Thread/ERROR]: --- DO NOT REPORT THIS TO PAPER - THIS IS NOT A BUG OR A CRASH ---\n[16:16:30] [Paper Watchdog Thread/ERROR]: ------------------------------\n\n\n\n\n\n\n8DM{[43S]C(K3_**3)01X.png\n(3.26 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-4-3 17:29 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n9KY_]BE(7TQIR7SHL6B3~$U.png\n(1.49 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-4-3 17:30 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[@9D745OYAM8$GX1$2@VTC8.png\n(5.31 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-4-3 17:30 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2O$ZASRFVL[EFG2H[%E_@XP.png\n(8.42 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-4-3 17:30 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "结城希亚",
            "timestamp": 1585906800,
            "txt_content": " 本帖最后由 结城希亚 于 2020-4-3 18:00 编辑 \n\n出现watchdog的情况是snakeyaml插件检查事件导致的\n删除或者在spigot.yml里把timeout-time改为9999999\n\n服务器卡顿是数据包处理，没有什么好的优化（而且长期tps20,中间有掉tps的情况）\n尝试改一下配置文件吧\n可以优化下tps\n\n\n1、在bukkit.yml里\n（1）spawn-limits值设为\n  monsters: 20\n  animals: 4\n  water-animals: 1\n  ambient: 1\n（2）chunk-gc\nperiod-in-ticks设为300\n（3）ticks-per.monster-spawns设为6\n2、在spigot.yml里\n（1）save-user-cache-on-stop-only改为true\n（2）max-tick-time数值改为5或者3000\n（3）mob-spawn-range设为3\n（4）entity-activation-range分别改为8、6、12、2\n（5）tick-inactive-villagers改为false\n（6）merge-radius都设置为64\n（7）nerf-spawner-mobs改为true\n（8）arrow-despawn-rate改为400\n（9）view-distance改为2\n\n3、在Paper.yml里\n（1）max-auto-save-chunks-per-tick改为6\n（2）optimize-explosions改为true\n（3）mob-spawner-tick-rate改为4\n（4）max-entity-collisions改为1\n（5）despawn-ranges分别改为28和96\n\n\n\n顺便提供下机子的信息吧，cpu型号内存什么的\n\n"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1585907340,
            "txt_content": "tps看着挺高\n唯一原因是这个\nMinecraft::Packet Processing\ncount(33581)  \n是这个插件的占用\nEnchantmentsEnhance\n你考虑删除或更换之类的?\n\nwatchdog报错的原因是无法加载slimefun插件的配置文件(在玩家解锁物品后)\n备份slimefun配置文件，然后删除配置文件看看还会不会出现再慢慢看问题吧\n"
        },
        {
            "author": "2629735078",
            "timestamp": 1585908120,
            "txt_content": "EmptyLava 发表于 2020-4-3 17:49\ntps看着挺高\n唯一原因是这个\nMinecraft::Packet Processing\n\n那服务器占用区块占用有的高，而且末地地狱世界区块卸载不掉怎么办，用了nsc了都木有用\n常驻区块不可能那么多吧就不卸载"
        },
        {
            "author": "结城希亚",
            "timestamp": 1585908960,
            "txt_content": "2629735078 发表于 2020-4-3 18:02\n那服务器占用区块占用有的高，而且末地地狱世界区块卸载不掉怎么办，用了nsc了都木有用\n常驻区块不可能那 ...\n有区块加载器？直接删除文件夹看看还会不会加载"
        },
        {
            "author": "Tseyanlok尼克",
            "timestamp": 1585913340,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "W_JunJie",
            "timestamp": 1586152320,
            "txt_content": "顶！！！！！！"
        }
    ]
}