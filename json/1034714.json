{
    "title": "[还有问题未解决]如何在物品NBT内储存数据和JAVA如何设定几率",
    "author": "3079655185",
    "replyCount": 33,
    "timestamp": 1588298580,
    "txt_content": " 本帖最后由 3079655185 于 2020-5-1 18:41 编辑 \n\n最近在写一个插件，其中有两个东西不太懂，就合在一个帖子发了，希望看到的带佬能回答一下=-=\n\n1.有没有方法可以在物品NBT内储存自己想要储存的数据。比如我要在NBT添加一个节点叫“owner”，内容叫“Tian_Zun”，以此判断物品的主人（这和我写的插件的功能无关，只是举个例子）。\n\n\n2.List<String> list = new LinkedList<>();\nlist.add(\"MCBBS\");\nlist.add(\"JAVA\");\nlist.add(\"Bukkit\");\n\n我想要从里面以一定几率取得一个数据，例如：50%的几率取得\"MCBBS\",30%的几率取得\"JAVA\",20%的几率取得\"Bukkit\"。\n不知道能不能实现。\n\n\n（关于第二点再BB个自己考虑到的问题：这个几率的总和一定要是100%吗，有可能不是100%吗）\n\n\n会的带佬希望能抽出时间回答一下我这个小白\n\n",
    "replies": [
        {
            "author": "天辉胡萝卜",
            "timestamp": 1588298820,
            "txt_content": "可以在nbt中存，但与其存在nbt，你这种存在lore里面足够了\n\n至于概率，加起来需不需要为100看你的实现方式\n比如把50,30,20看成是选取权重的话就不需要和为100"
        },
        {
            "author": "3079655185",
            "timestamp": 1588298940,
            "txt_content": "疾风暗影 发表于 2020-5-1 10:07\n可以在nbt中存，但与其存在nbt，你这种存在lore里面足够了\n\n至于概率，加起来需不需要为100看你的实现方式\n1.如果有时间的话还希望请说一下NBT的储存方式，万一以后有用呢awa\n\n2.能不能说一下JAVA如何设定概率，给教程网址也行"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1588299120,
            "txt_content": "以及一个基于权重抽取的例子\n\n建立类\nRandomCollection.java\npublic class RandomCollection<E> {\n    private final NavigableMap<Double, E> map = new TreeMap<Double, E>();\n    private final Random random;\n    private double total = 0;\n\n    public RandomCollection() {\n        this(new Random());\n    }\n\n    public RandomCollection(Random random) {\n        this.random = random;\n    }\n\n    public RandomCollection<E> add(double weight, E result) {\n        if (weight <= 0) return this;\n        total += weight;\n        map.put(total, result);\n        return this;\n    }\n\n    public E next() {\n        double value = random.nextDouble() * total;\n        return map.higherEntry(value).getValue();\n    }\n}\n复制代码\n之后调用\nRandomCollection<String> rc = new RandomCollection<>()\n                              .add(50, \"MCBBS\").add(30, \"JAVA\").add(20, \"Bukkit\");\n\nfor (int i = 0; i < 10; i++) {\n    System.out.println(rc.next());\n} \n复制代码\nrc.next()这个方法可以按概率输出结果\n\n"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1588299300,
            "txt_content": "至于nbt，bukkit没有封装需要自己调用nms，nms每个版本不一样\n\n比如1.12\n\nNBTTagCompound tag = new NBTTagCompound();\nNBTTagCompound f = new NBTTagCompound();\nf.setByte(\"Flight\", (byte) 3);\ntag.set(\"Fireworks\", f);\n\nnet.minecraft.server.v1_12_R1.ItemStack nms_item = CraftItemStack.asNMSCopy(bukkit_item);\nnms_item.setTag(tag);\nbukkit_item = CraftItemStack.asBukkitCopy(nms_item);复制代码\n\n上述方法可以给bukkit_item加上自己想要的nbt tag"
        },
        {
            "author": "3079655185",
            "timestamp": 1588299900,
            "txt_content": "疾风暗影 发表于 2020-5-1 10:15\n至于nbt，bukkit没有封装需要自己调用nms，nms每个版本不一样\n\n比如1.12\n十分感谢带佬啊。\n问下\nf.setByte(\"Flight\", (byte) 3);\ntag.set(\"Fireworks\", f);复制代码\n是不是\"Flight\"是内容,\"Fireworks\"是节点？\n另外，NBT的节点是不是和yml那样，可以有多级\n\n还有就是希望上面你写的RandomCollection.java类可以给个注释=-="
        },
        {
            "author": "William_Shi",
            "timestamp": 1588301400,
            "txt_content": "3079655185 发表于 2020-5-1 10:25\n十分感谢带佬啊。\n问下\n节点？？？？？？"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588302060,
            "txt_content": "3079655185 发表于 2020-5-1 10:25\n十分感谢带佬啊。\n问下\nhttps://www.mcbbs.net/thread-697478-1-1.html，莫老的\n\n是时候写一篇教程梳理一下NBT了\n大量的不准确表述\n\n\nlore其实是物品的NBT混合数据包的名为display数据键的混合数据包当中的一个列表数据包\n\n\n你想要做的事情是在物品的NBT混合数据包里添加数据键和基础数据包（包括字节数据包"
        },
        {
            "author": "3079655185",
            "timestamp": 1588302660,
            "txt_content": "William_Shi 发表于 2020-5-1 11:01\nhttps://www.mcbbs.net/thread-697478-1-1.html，莫老的\n\n是时候写一篇教程梳理一下NBT了\n哈哈哈，不太懂，谢谢大佬给的教程链接了"
        },
        {
            "author": "3079655185",
            "timestamp": 1588303200,
            "txt_content": " 本帖最后由 3079655185 于 2020-5-1 11:26 编辑 \nWilliam_Shi 发表于 2020-5-1 11:01\nhttps://www.mcbbs.net/thread-697478-1-1.html，莫老的\n\n是时候写一篇教程梳理一下NBT了\n就是NBT里面存的是物品的各种数据呗，显示名称、lore、伤害、攻击速度等，修改这些就能改变物品属性。\n然后也可以自己添加数据：compound.set(\"属性名\", new NBTTagString(\"内容\"));\n是吗\n那么怎么根据\"属性名\"获取\"内容\"呢\n顺便问下怎么把NBT内容弄成String输出出来\n\n\n上面带佬提到的，这个(byte)3是什么\nf.setByte(\"Flight\", (byte) 3);tag.set(\"Fireworks\", f);\n"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588307880,
            "txt_content": "3079655185 发表于 2020-5-1 11:20\n就是NBT里面存的是物品的各种数据呗，显示名称、lore、伤害、攻击速度等，修改这些就能改变物品属性。\n然 ...\nNBT基础数据包有一个叫做 toString 的方法\n\n并不是说修改NBT就能修改属性\n如果是一些奇奇怪怪的属性那可能是你自己的插件实现的\n如果是原版属性，规范一点（PVPIN）翻译是NMS属性修改器\n也就是AttributeModifier\n\n\n\n"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588308060,
            "txt_content": "3079655185 发表于 2020-5-1 11:20\n就是NBT里面存的是物品的各种数据呗，显示名称、lore、伤害、攻击速度等，修改这些就能改变物品属性。\n然 ...\n如果你不知道什么是 byte 就先给我学Java数据类型\n\n内置数据类型\nJava语言提供了八种基本类型。六种数字类型（四个整数型，两个浮点型），一种字符类型，还有一种布尔型。\nbyte：\nbyte 数据类型是8位、有符号的，以二进制补码表示的整数；\n最小值是 -128（-2^7）；\n最大值是 127（2^7-1）；\n默认值是 0；\nbyte 类型用在大型数组中节约空间，主要代替整数，因为 byte 变量占用的空间只有 int 类型的四分之一；\n例子：byte a = 100，byte b = -50。\n"
        },
        {
            "author": "3079655185",
            "timestamp": 1588309620,
            "txt_content": "William_Shi 发表于 2020-5-1 12:41\n如果你不知道什么是 byte 就先给我学Java数据类型\n我知道什么是byte啊，我说这个参数表示的是什么..."
        },
        {
            "author": "3079655185",
            "timestamp": 1588310340,
            "txt_content": "疾风暗影 发表于 2020-5-1 10:12\n以及一个基于权重抽取的例子\n\n建立类\n这个我是不是可以这么理解：\nRandomCollection<String> rc = new RandomCollection<>().add(3, \"MCBBS\").add(2, \"JAVA\").add(1, \"Bukkit\");\n然后用rc.next()获取到“MCBBS”的概率是(3+2+1)分之3\n\n另外问下rc.next是全随机还是\n（拿你写的举例子）必出5次“MCBBS”，3次“JAVA”2次，“Bukkit’”"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1588310580,
            "txt_content": "3079655185 发表于 2020-5-1 13:19\n这个我是不是可以这么理解：\nRandomCollection rc = new RandomCollection().add(3, \"MCBBS\").add(2, \"JA ...\n请自行查阅以下概念\n\n频率 概率 伪随机 数学期望"
        },
        {
            "author": "3079655185",
            "timestamp": 1588312440,
            "txt_content": "疾风暗影 发表于 2020-5-1 13:23\n请自行查阅以下概念\n\n频率 概率 伪随机 数学期望\n哈哈哈哈，那我的假设对不对啊"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588312680,
            "txt_content": "3079655185 发表于 2020-5-1 13:07\n我知道什么是byte啊，我说这个参数表示的是什么...\n你可以强行调用a方法把Byte 3 转为NBT字节数据包\n然后再用set方法把？ extends NBT基础数据包 设置进NBT混合数据包"
        },
        {
            "author": "HELLO丶sky",
            "timestamp": 1588313820,
            "txt_content": "请问开发文档里面的Block.getMetadata(String metadataKey)这个方法里面的metadataKey要怎么填呢，我目前填啥都没办法得到任何东西"
        },
        {
            "author": "HELLO丶sky",
            "timestamp": 1588313880,
            "txt_content": "版本是1.15.2"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1588314120,
            "txt_content": "3079655185 发表于 2020-5-1 13:54\n哈哈哈哈，那我的假设对不对啊这个我是不是可以这么理解：\nRandomCollection<String> rc = new RandomCollection<>().add(3, \"MCBBS\").add(2, \"JAVA\").add(1, \"Bukkit\");\n然后用rc.next()获取到“MCBBS”的概率是(3+2+1)分之3\n\n基本上是这种情况"
        },
        {
            "author": "Sssss...",
            "timestamp": 1588315080,
            "txt_content": "第一个：CraftItemStack.asNMSCopy(ItemStack xxx).getTag 获取NBT对象\n然后你用ide的自动补全就知道怎么用了\n改完要set回去\n获取Bukkit的物品：CraftItemStack.asBukkitCopy(nms物品)\n第二个：\n在0~权重总和内随机取一个数，然后判定属于哪个区间"
        },
        {
            "author": "3079655185",
            "timestamp": 1588321560,
            "txt_content": "Sssss... 发表于 2020-5-1 14:38\n第一个：CraftItemStack.asNMSCopy(ItemStack xxx).getTag 获取NBT对象\n然后你用ide的自动补全就知道怎么用 ...\n懂了，谢"
        },
        {
            "author": "3079655185",
            "timestamp": 1588328940,
            "txt_content": "疾风暗影 发表于 2020-5-1 10:15\n至于nbt，bukkit没有封装需要自己调用nms，nms每个版本不一样\n\n比如1.12\n\n\n\n\nimage.png (20.15 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-1 18:27 上传\n\n\n\n\n\n\n\n\nimage.png (5.13 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-1 18:28 上传\n\n\n\n\n\n这样的话是不是给物品的NBT中\"leavel\"下的\"leavle\"的值为1.\n那怎么获取到呢，我看到了\nnms_item.getTag().getString(\"\");里面应该咋填\n"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588329780,
            "txt_content": "3079655185 发表于 2020-5-1 18:29\n这样的话是不是给物品的NBT中\"leavel\"下的\"leavle\"的值为1.\n那怎么获取到呢，我看到了\nnms_item.getTag( ...\n参数是i，整数int\n结果你set的时候当成byte\n创建字节数据包\n甚至int强转byte\n"
        },
        {
            "author": "3079655185",
            "timestamp": 1588338120,
            "txt_content": "William_Shi 发表于 2020-5-1 18:43\n参数是i，整数int\n结果你set的时候当成byte\n创建字节数据包\n？？？，你在回答什么"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588340040,
            "txt_content": "3079655185 发表于 2020-5-1 21:02\n？？？，你在回答什么\nByte是 -128~127\nint是-2,147,483,648~2,147,483,647\n而你，把int直接强转byte\n这是一种什么操作，你自己，应该清楚\n\n\nNBT基础数据包，有一种NBT字节数组数据包（NBTTagByteArray)\n如果你非不用NBT整数数据包、NBT整数数组数据包，\n还想要把int存进去的话\n就把int转成byte[]存进去，（位操作符，你值得拥有）"
        },
        {
            "author": "3079655185",
            "timestamp": 1588341960,
            "txt_content": "William_Shi 发表于 2020-5-1 21:34\nByte是 -128~127\nint是-2,147,483,648~2,147,483,647\n而你，把int直接强转byte\n这不是前面那位大佬写的吗，怎么开始吐槽我了.."
        },
        {
            "author": "William_Shi",
            "timestamp": 1588342440,
            "txt_content": "3079655185 发表于 2020-5-1 22:06\n这不是前面那位大佬写的吗，怎么开始吐槽我了..\n他只是set了一个1，当然没有问题，但是万一set一个 比如说1000 会发生什么？\n你要自己动脑思考\n不一定非得是NBT字节数据包\n你也可以用NBT整数数据包啊\n要不然就前后一致，方法的参数也是byte"
        },
        {
            "author": "3079655185",
            "timestamp": 1588343880,
            "txt_content": "William_Shi 发表于 2020-5-1 22:14\n他只是set了一个1，当然没有问题，但是万一set一个 比如说1000 会发生什么？\n你要自己动脑思考\n不一定非 ...\n好的好的知道了，\n那能不能回答下怎么获取"
        },
        {
            "author": "William_Shi",
            "timestamp": 1588387500,
            "txt_content": " 本帖最后由 William_Shi 于 2020-5-2 10:47 编辑 \n3079655185 发表于 2020-5-1 22:38\n好的好的知道了，\n那能不能回答下怎么获取\nget\n我觉得你应该自己去反编译\n而不是在这里追问\n每一个版本的nms都有一些小的差异\n你可以看一下我的NBT教程就知道了"
        },
        {
            "author": "lefpaG",
            "timestamp": 1588388040,
            "txt_content": "wow         。"
        },
        {
            "author": "Sssss...",
            "timestamp": 1588487640,
            "txt_content": "3079655185 发表于 2020-5-1 18:29\n这样的话是不是给物品的NBT中\"leavel\"下的\"leavle\"的值为1.\n那怎么获取到呢，我看到了\nnms_item.getTag( ...\nsetByte换成setInt，后面的(byte)去掉即可\n\n获取的话，用getInt(String)，里面的是NBT路径\n这样：nms_item.getTag().getCompound(\"leavel\").getCompount(\"leavel\")\n\n另外你是不是分不清int byte String等类型？你的命名方式也很奇怪，建议先学一下java基础和命名规范\nsetString getInt这类方法的意思应该是很容易猜出来的"
        },
        {
            "author": "3079655185",
            "timestamp": 1588500900,
            "txt_content": "Sssss... 发表于 2020-5-3 14:34\nsetByte换成setInt，后面的(byte)去掉即可\n\n获取的话，用getInt(String)，里面的是NBT路径\n我知道啊，我以为他只能setByte，我那不是强转吗0.0"
        },
        {
            "author": "Sssss...",
            "timestamp": 1588501800,
            "txt_content": "3079655185 发表于 2020-5-3 18:15\n我知道啊，我以为他只能setByte，我那不是强转吗0.0\n你是看不到你ide的自动补全内容吗……\n\nint强转byte就几乎不可能再转回去了"
        }
    ]
}