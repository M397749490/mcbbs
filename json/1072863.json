{
    "title": "请问为什么TrMenu获取到的玩家头颅不卡，我获取到的卡",
    "author": "Mello_M",
    "replyCount": 4,
    "timestamp": 1593946500,
    "txt_content": "\nTrMenu获取到的第一次也不卡\n\n第一次获取到的时候卡，第二次就不卡了\n\n\n            ItemStack 玩家头颅 = new ItemStack(Material.PLAYER_HEAD);\n            SkullMeta sm = (SkullMeta) 玩家头颅.getItemMeta();\n            sm.setOwningPlayer(Bukkit.getPlayer(strings[0]));\n            sm.setDisplayName(strings[0]);\n            玩家头颅.setItemMeta(sm);\n            playe.getInventory().addItem(玩家头颅);\n\n\n\n\n",
    "replies": [
        {
            "author": "Hueihuea",
            "timestamp": 1593948960,
            "txt_content": "虽然我不是很懂\n但是获取玩家头颅肯定要过mojang服务器\n可能是你链接mojang服务器速度太慢了\n可以试试异步处理"
        },
        {
            "author": "拉普达",
            "timestamp": 1593949020,
            "txt_content": " 本帖最后由 拉普达 于 2020-7-5 19:38 编辑 \n\n因为，TrMenu可能做了异步处理。\n\n我是这么做的：\n打开菜单，先显示默认头颅。\n同时，开一个异步任务，把默认头颅变成对应头颅。\n首先，第一次打开不会卡顿。\n第二次打开，不会见到默认头颅。"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593967740,
            "txt_content": "你的获取方式是采用的给头颅设定owner\nMC的处理过程如下：\n1. 根据owner name，访问mojang验证服务器获取uuid\n2. 访问mojang服务器获取texture\n\n因为两步是网络事件，所以会卡主线程\n\n\n解决方案：\n1. 用异步线程获取uuid和texture\n或\n1. 如果是固定图标，那么图标网站会告诉你uuid和texture，直接写在代码中\n\n\n附：如果加载uuid与texture\n\nString uuid = \"66d19f8d-b159-4034-9b86-3f75b6064629\";\nString textures = \"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvODY0Zjc3OWE4ZTNmZmEyMzExNDNmYTY5Yjk2YjE0ZWUzNWMxNmQ2NjllMTljNzVmZDFhN2RhNGJmMzA2YyJ9fX0=\";\nItemStack head = new ItemStack(Material.PLAYER_HEAD);\nSkullMeta headMeta = (SkullMeta) head.getItemMeta();\nGameProfile profile = new GameProfile(UUID.fromString(uuid), null);\nprofile.getProperties().put(\"textures\", new Property(\"textures\", textures));\nField profileField;\ntry {\n    profileField = headMeta.getClass().getDeclaredField(\"profile\");\n    profileField.setAccessible(true);\n    profileField.set(headMeta, profile);\n} catch (NullPointerException | NoSuchFieldException | IllegalArgumentException | IllegalAccessException e1) {\n}\nhead.setItemMeta(headMeta);\n复制代码"
        },
        {
            "author": "吕易天",
            "timestamp": 1594100880,
            "txt_content": "因为第一次获取没有缓存，需要老老实实从mojang服务器上下载皮肤，而如果你是在主线程获取的就会卡死主线程，第二次由于第一次已经下过了，所以会直接用缓存，所以会快很多（主要是mojang服务器在国外所以延迟高）"
        }
    ]
}