{
    "title": "求vb.net,自动获取java路径代码",
    "author": "78713888",
    "replyCount": 3,
    "timestamp": 1453013940,
    "txt_content": "前些日子看到了mcmny大大开源的启动器MMCLS，但是其中寻找JAVA代码貌似失效了，WIN7，WIN10均测试无法自动获取，求各位大神告知代码！\n以下是mcmny大大的寻找JAVA代码：\nIf djavapath = \"\" Then\n            Try\n                Dim rk As RegistryKey = Registry.LocalMachine\n\n                rk = rk.OpenSubKey(\"SOFTWARE\")\n                rk = rk.OpenSubKey(\"JavaSoft\")\n\n                rk = rk.OpenSubKey(\"Java Runtime Environment\")\n\n                Dim javaver As String = \"\"\n\n                javaver = rk.GetSubKeyNames(0)\n                rk = rk.OpenSubKey(javaver)\n\n                djavapath = rk.GetValue(\"JavaHome\") + \"\\bin\\javaw.exe\"\n\n            Catch ex As NullReferenceException\n                If MessageBox.Show(\"程序未发现java主程序文件，可能您没有安装java(MC启动必需)，也可能是程序判断错误！如果是判断错误，请选择否并手动选择java路径，如果不是，是否前往java官网下载？\", \"提示\", MessageBoxButtons.YesNo) = Windows.Forms.DialogResult.Yes Then\n\n                    System.Diagnostics.Process.Start(\"http://www.java.com/\")\n                    djavapath = \"javaw\"\n                    End\n                Else\n                    djavapath = \"javaw\"\n                    Form2.Show()\n                End If\n            End Try\n\n\n{:10_512:}感谢各位大神啦~\n",
    "replies": [
        {
            "author": "78713888",
            "timestamp": 1453019640,
            "txt_content": "哦自己修复好了……不用各位了，给大家放下我修复的代码：\nDim checkjava As Object\n                checkjava = CreateObject(\"wscript.shell\")\n                Dim a As String\n                a = checkjava.regread(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\javaws.exe\\Path\")\n                djavapath = a + \"\\javaw.exe\""
        },
        {
            "author": "huuhghhgyg",
            "timestamp": 1453076280,
            "txt_content": "让我来看看能不能换成c#的发上来{:10_512:}"
        },
        {
            "author": "gamerteam",
            "timestamp": 1453091280,
            "txt_content": "你用VB.Net的话，如果是.net 4，可以直接用KMCCC来着。"
        }
    ]
}