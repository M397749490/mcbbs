{
    "title": "spigot1.12怎么监听药水效果，类似1.13的EntityPotionEffectEvent的那种",
    "author": "Freeze_Dolphin",
    "replyCount": 2,
    "timestamp": 1580783340,
    "txt_content": "如题。。。当前开发的插件需要监听这样一个事件，然而去api一查发现在1.13才有= =\n\n具体是Slimefun中对辐射的处理，我写了一套新的强化防化服，来抵抗更强的辐射，然而写完之后正要开本地服debug，突然想起这样写的话貌似防不了slimefun自带的辐射了= =\n\n穿透性辐射的代码: (从eclipse里直接复制代码居然缩进被去掉了= =,勉强看看吧= =)\npackage me.Freeze_Dolphin.lab;\n\nimport org.bukkit.entity.Player;\nimport org.bukkit.inventory.ItemStack;\nimport org.bukkit.potion.PotionEffect;\nimport org.bukkit.potion.PotionEffectType;\n\nimport me.mrCookieSlime.CSCoreLibPlugin.Configuration.Config;\nimport me.mrCookieSlime.Slimefun.SlimefunStartup;\nimport me.mrCookieSlime.Slimefun.Setup.SlimefunManager;\nimport me.mrCookieSlime.Slimefun.api.Slimefun;\n\npublic class StartupTasks extends Main {\n\n        public StartupTasks() {\n                \n                Config config = SlimefunStartup.getCfg();\n                \n                Main.debug(String.valueOf(config.getBoolean(\"options.enable-armor-effects\")) + \" , \" + config.getInt(\"options.armor-update-interval\"));\n                \n                if (config.getBoolean(\"options.enable-armor-effects\")) {\n                        getServer().getScheduler().runTaskTimer(this, new Runnable() {\n\n                                @Override\n                                public void run() {\n\n                                        // copy from slimefun v4.1.15 and modified some of the code\n\n                                        for (Player p: getServer().getOnlinePlayers()) {\n                                                for (ItemStack radioactive: Variables.penetratingRadioactive) {\n                                                        if (p.getInventory().containsAtLeast(radioactive, 1) || SlimefunManager.isItemSimiliar(p.getInventory().getItemInOffHand(), radioactive, true)) {\n                                                                // Check if player is wearing the [REINFORCED] hazmat suit\n                                                                // If so, break the loop\n                                                                if (SlimefunManager.isItemSimiliar(Lab.REINFORCED_SCUBA_HELMET, p.getInventory().getHelmet(), true) &&\n                                                                                SlimefunManager.isItemSimiliar(Lab.REINFORCED_HAZMATSUIT_CHESTPLATE, p.getInventory().getChestplate(), true) &&\n                                                                                SlimefunManager.isItemSimiliar(Lab.REINFORCED_HAZMATSUIT_LEGGINGS, p.getInventory().getLeggings(), true) &&\n                                                                                SlimefunManager.isItemSimiliar(Lab.REINFORCED_RUBBER_BOOTS, p.getInventory().getBoots(), true)) {\n                                                                        break;\n                                                                }\n\n                                                                // If the item is enabled in the world, then make radioactivity do its job\n                                                                if (Slimefun.isEnabled(p, radioactive, false)) {\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.WITHER, 400, 5), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.BLINDNESS, 400, 3), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.CONFUSION, 400, 3), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.WEAKNESS, 400, 3), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.SLOW, 400, 1), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.SLOW_DIGGING, 400, 1), true);\n                                                                        \n                                                                        // the more terrible potion effects will be added to the player\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.NIGHT_VISION, 400, 3), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.HUNGER, 400, 15), true);\n                                                                        p.addPotionEffect(new PotionEffect(PotionEffectType.JUMP, 400, -1), true);\n                                                                        \n                                                                        p.setFireTicks(400);\n                                                                        \n                                                                        break; // Break the loop to save some calculations\n                                                                }\n                                                        }\n                                                }\n                                        }\n                                }\n\n                        }, 0L, config.getInt(\"options.armor-update-interval\") * 20L);\n                }\n        }\n}\n复制代码\n\n\n应该怎么改才能使这套全新的强化防护服防止slimefun自带的辐射呢= =\n\n\n（注：在不改写slimefun本体的情况下）\n\n",
    "replies": [
        {
            "author": "yxiaobai",
            "timestamp": 1580785860,
            "txt_content": "用asm改run方法体"
        },
        {
            "author": "Freeze_Dolphin",
            "timestamp": 1580795580,
            "txt_content": "byxiaobai 发表于 2020-2-4 11:11\n用asm改run方法体\n具体怎么做，asm没搞过诶"
        }
    ]
}