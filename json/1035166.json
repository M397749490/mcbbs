{
    "title": "关于插件序列化map的一个坑，以及序列化Location等类的疑惑",
    "author": "堕落男",
    "replyCount": 0,
    "timestamp": 1588328220,
    "txt_content": "最近刚开始学习插件开发，在尝试建一个简单的领地插件。在领地中有领地数据的功能。然而现实骨感，满屏的红字。\n\nMap序列化接口无效\n储存领地数据的是一个实现了bukkit序列化接口的类，继承于map，实现的序列化接口方法如下\npublic Map<String, Object> serialize() {\n    put(\"==\", getClass().getName());\n    return this;\n    }复制代码这是一个很正常的序列化操作。然而实际序列化出来的结果却是这样子的\n'2':\n  ==: cn.japlayguan.mcplugin.area.v0_2.Area\n<b style=\"background-color: yellow;\">  data: \n    test: test</b>\n  point1:\n    ==: org.bukkit.Location\n    world: world\n    x: -71.0\n    y: 62.0\n    z: -37.0\n    pitch: 0.0\n    yaw: 0.0\n  point2:\n    ==: org.bukkit.Location复制代码是的，序列化时的put并没有生效。\n\n\n\n尝试寻找官方类（如Location）的序列化方法\n在序列化添加绑定class无效的时候，我首先就想到了官方序列化流程是不是有什么规则\n说明：这里我并没有找到官方类的一些序列划流程，只是我在看Location实现序列化接口的时候并没有添加“==”这个键，而实际出来的确是自动加上了，因此想问问大佬们关于序列化时类的绑定是否有其他方法？  比如，此处的location到底是再哪、以怎么样的方式绑定的。\n注：下方代码是Location类实现的序列化接口\n\npublic Map<String, Object> serialize() {\n  Map<String, Object> data = new HashMap<String, Object>();\n  data.put(\"world\", this.world.getName());\n\n  data.put(\"x\", this.x);\n  data.put(\"y\", this.y);\n  data.put(\"z\", this.z);\n\n  data.put(\"yaw\", this.yaw);\n  data.put(\"pitch\", this.pitch);\n\n  return data;\n    }复制代码\n\n\n\n关于Map序列化接口put无效的最终结果\n因为我菜，找官方序列化的流程走一半之后我就理不过来了，于是只能动手在原来的领地数据类中的序列化方法多做几次尝试。\n当我尝试直接 return null时，时，其结果和上面的结果一模一样。\npublic Map<String, Object> serialize() {\n  return null;\n    }复制代码\n是的，总结：当需要序列化的类是Map的子类时，会直接取Map的键值对数据！\n也就是说，当你的类继承于map时，接口ConfigurationSerializable的实现方法不会有任何效果，你只能在外面put一个“==”进行绑定class。\n但是，你仍然需要实现这个接口，因为你需要反序列化。\n\n\n这个坑跳了两三个小时，苦恼。希望大家不要踩了= =\n",
    "replies": []
}