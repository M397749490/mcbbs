{
    "title": "使用/schedule做音乐",
    "author": "chyx",
    "replyCount": 9,
    "timestamp": 1541312700,
    "txt_content": " 本帖最后由 chyx 于 2018-11-4 14:27 编辑 \n\n使用1.14的延迟指令（schedule）做的音乐。 \n\n\n\n\n这个指令简直天生就是为了音乐做的。\n因为不能传递任何指令上下文，也不能重复执行同一个指令，所以做系统时很鸡肋。\n但做音乐就很舒服了。\n我注意到这个指令再level.dat文件里做的标记的格式，照着做，把把乐谱转成音符和游戏刻对应的形式写入文件，即可在指定的游戏刻播放音乐。 \n进入游戏什么都不用做。 \n我还发现 只有schedule自己限制了不能有重复的，但其实真写进去完全没有问题。\n先建立一些函数 每个里面就一个playsound不提\n我稍微写了点代码：\nimport nbtlib\nfrom nbtlib.tag import *\nimport re\nx=nbtlib.load(\"level.dat\")\np=\"5353531 24325   5353531 24321   2244315 24325   5353531 24321\"\np= re.findall(\"( |(?:\\.+|-+)?\\ds?)\",p)\ndef trig(name,function,time):\n    return Compound({'Callback': Compound({'Type': String('minecraft:function'), 'Name': String(function)}), 'Name': String(name), 'TriggerTime': Long(time)})\n#\nx.root[\"Data\"][\"Time\"]=Long(0)\nx.root[\"Data\"]['ScheduledEvents']=List[Compound]()\n\n\nfor i,j in enumerate(p):\n    if j !=\" \":\n        x.root[\"Data\"]['ScheduledEvents'].append(trig(f\"{i}\",f'chyx:{j}',4*i+200))\nx.save()复制代码把乐谱写进去。里面可以改每个音符多少游戏刻 进入游戏多久开始播。\n\n效果：https://vc.bilibili.com/video/1912714\n\n注 使用了@Soma-Komeiji的资源包。自己转成了1.14版本",
    "replies": [
        {
            "author": "langyo",
            "timestamp": 1541315460,
            "txt_content": "http://www.mcbbs.net/thread-827808-1-1.html\n\n有个人比你还快\n\n其实，我更在意你那个音乐资源包……"
        },
        {
            "author": "xiaowei233v",
            "timestamp": 1541315760,
            "txt_content": "Abraham511 发表于 2018-11-4 15:28\n看来1.14以后的音乐地图会多很多~~\n因该可能会配合1.13的tp-rotation做出音乐风景欣赏的地图awa"
        },
        {
            "author": "xiaowei233v",
            "timestamp": 1541316000,
            "txt_content": "所以说1.13没有这个schedule\n得靠记分板一个一个加变量\n然后playsound还得联动function疯狂@e[...]awa"
        },
        {
            "author": "Abraham511",
            "timestamp": 1541316480,
            "txt_content": "看来1.14以后的音乐地图会多很多~~"
        },
        {
            "author": "⭐✔️",
            "timestamp": 1541339340,
            "txt_content": " 本帖最后由 贰逼 于 2018-11-4 21:50 编辑 \n\n这个schedule的延迟是按刻计时的吗\n我现在正在向A2M添加基于scoreboard的数据包音乐生成功能，如果这个schedule也是按刻即时，那我也可以基于它来制作了\n它目前看起来是这样的：\n[bili=34814375]1[/bili]\n"
        },
        {
            "author": "chyx",
            "timestamp": 1541341860,
            "txt_content": " 本帖最后由 chyx 于 2018-11-4 22:33 编辑 \n贰逼 发表于 2018-11-4 21:49\n这个schedule的延迟是按刻计时的吗\n我现在正在向A2M添加基于scoreboard的数据包音乐生成功能，如果这个sche ...\n是按游戏刻计时的。\n不过和方块刻不同 他在存档里记录的是执行时的总时间\n就是time query gametime的那个\n\n=============\n这个的好处就是不用搞一个记分板 并且检查分数来做了。"
        },
        {
            "author": "深度I罪恶",
            "timestamp": 1541401320,
            "txt_content": "66666666666"
        },
        {
            "author": "⭐✔️",
            "timestamp": 1549108500,
            "txt_content": "最后还是用计分板作为datapack音乐的timer，软件已经实装了该功能：\nhttp://www.mcbbs.net/thread-799862-1-1.html\n测试过感觉schedule操作起来不太方便，毕竟要遍历每个乐器的每个音符\n虽然用的是计分板，但一个乐曲独立一个计分板独立一个命名空间，就没什么问题\n而且计分板还能做到暂停和快进，随时重置，比schedule更实际一点"
        },
        {
            "author": "runckey",
            "timestamp": 1549243140,
            "txt_content": "流批，兄弟"
        }
    ]
}