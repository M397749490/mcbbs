{
    "title": "[TRP]二进制转换BCD码",
    "author": "719823597",
    "replyCount": 8,
    "timestamp": 1461380220,
    "txt_content": " 本帖最后由 719823597 于 2016-4-23 10:57 编辑 \n\n二进制转换BCD码\n\n什么是BCD码\nBCD(二进制编码的十进制)是一种用4位二进制数来表示一个十进制数的方法，一个4位的二进制数可以表示出从0到15的十进制数，但是在BCD中，每4位只能组合出十进制中的0到9。\n\n\n两个BCD数相加后，结果的4位数可能会出现不合法的值(0到9之外)，这时我们得将它们加上6来修正(至于为什么是加6，后文会讲)，这种修正被称作为“十进制数调整”(感兴趣的可以去搜索一下“十进制数加调整指令”)。\n\n\n\n如何转换成BCD码\n\n二进制转换成BCD码，需要用到Double Dabble算法。\n    \n  实现方法\n\n  拿11111111来举例子，我们先建立一个表格，把二进制数放入右侧的二进制区，然后开始运算。\n\n  1. 当二进制区不为空时，将内容左移\n  2. 然后判断3个BCD区中的值是否大于4\n            * 若是，则将单个BCD区内的数+3处理\n            * 否则，不做处理\n\n  重复以上两个操作，直到二进制区为空(为空时立即停止操作，不用接着判断BCD区是否大于4)\n\n\n\n\n\n\n屏幕快照 2016-04-23 上午10.37.51.png (47.67 KB, 下载次数: 5)\n\n下载附件\n\n2016-4-23 10:35 上传\n\n\n\n\n\n\n\n在游戏中的实现\n\n\n\n  1.枚举\n我们通常是通过“枚举”的方式来实现的，这里说的“枚举”并不是指把所有的结果列出来，而是把+3前后的取值枚举出来，对照表如 下：\n\n\n原码+3处理备注00010001不需要修正00100010不需要修正00110011不需要修正01000100不需要修正01011000\n01101001\n01111010\n10001011\n10011100\n\n\n通过将模块错位排列的方式实现移位操作\n\n\n\n\n\n\nBCD.png (12.7 KB, 下载次数: 5)\n\n下载附件\n\n2016-4-23 10:39 上传\n\n\n\n\n\n\n\n  2.加法器\n  和上一个方法很相像，不过这里用到并不是枚举模块，而是加法器。同样地，先是判断是否大于4，然后用加法器来代替枚举模块进行+3的操作。\n  总结在游戏中+3模块的体积总是大于加法器的，常规+3模块最低延时为2Ticks，所以第一种方法是牺牲了空间，换得了较少的延时。而第二种方法是用时间换得了较小体积(当然，加法器的结构不同，运算耗时也不同，这里使用行波进位加法器作为比较对象)。\n\n\n对于+3模块的优化\n\n我们先看回刚刚的对照表，可以发现表内有4种情况是不用修正的，意味着输入是多少，输出也是多少，如果将这4组数据也放入译码编码的过程，那将会占用不少的时间(因为移位时需要+3的情况是很少的，多数情况都是不需要修正的)。\n\n\n所以，我们可以对+3模块进行优化，在输入为前4种形式时，不做任何操作，直接把线接到输出那。对于其他情况做+3处理。\n\n\n参考\n\nWhy does double dabble work\n\n[groupid=143]The Redpixel[/groupid]",
    "replies": [
        {
            "author": "xuelang123",
            "timestamp": 1461380760,
            "txt_content": "沙发给点个赞"
        },
        {
            "author": "阿散ASun",
            "timestamp": 1461399540,
            "txt_content": "本來是來看度度發帖紀錄找庫的...\n沒想到看到這個教程，一開始還以為論壇抽了..."
        },
        {
            "author": "TSStudio",
            "timestamp": 1461400320,
            "txt_content": "具体发一下游戏中图片"
        },
        {
            "author": "uhuichongfu",
            "timestamp": 1461545760,
            "txt_content": "纯底层技术，来点GUI 啊。\n有实际应用图更好，否则功底不深的一点不明白。"
        },
        {
            "author": "宇宙公主",
            "timestamp": 1461586440,
            "txt_content": "嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯嗯"
        },
        {
            "author": "宇宙公主",
            "timestamp": 1461586980,
            "txt_content": "ffffff方式认购的感动过的人过得更多个地方"
        },
        {
            "author": "719823597",
            "timestamp": 1461591780,
            "txt_content": "buhuichongfu 发表于 2016-4-25 08:56\n纯底层技术，来点GUI 啊。\n有实际应用图更好，否则功底不深的一点不明白。 ...\n我就随便写写 看看我那么久没玩 和之前的水平有没有差距\n随便看看就好了"
        },
        {
            "author": "167832391",
            "timestamp": 1568524860,
            "txt_content": "emmmmmmmmmmmm"
        }
    ]
}