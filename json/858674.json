{
    "title": "千年村庄millenaire 炼金术士任务tnt黑曜石判定问题",
    "author": "common",
    "replyCount": 2,
    "timestamp": 1555615080,
    "txt_content": " 本帖最后由 common 于 2019-4-19 03:37 编辑 \n\n千年村庄millenaire mod诺曼的创世神任务，寻找炼金术士，第七环 炼金术士要求你将20个tnt放在黑曜石下引爆，尝试炸开基岩。某些玩家(比如我)会发现，明明放好了tnt黑曜石它不判定，明明已经引爆它不认。我回档了三次无法解决，于是我无耻的抄了答案(看了源代码)。这个bug的原因是千年村庄mod中action的判定问题。上判定代码(来自JD-JUI)(不想看源代码的可以跳过这一段折叠的直接看结论)\n\n黑曜石tnt放置判定代码String pStr = mw.getProfile(player).getActionData(\"action_borehole_pos\");复制代码Point p = new Point(pStr);复制代码if (p.distanceToSquared(player) > 25.0D) {\n      return;\n    }\n    int nbTNT = 0;复制代码for (int x = p.getiX() - 2; x < p.getiX() + 3; x++) {\n      for (int z = p.getiZ() - 2; z < p.getiZ() + 3; z++)\n      {\n        boolean obsidian = false;\n        for (int y = 6; y > 0; y--)\n        {\n          Block block = WorldUtilities.getBlock(mw.world, x, y, z);\n          if (block == Blocks.field_150343_Z) {\n            obsidian = true;\n          } else if ((obsidian) && (block == Blocks.field_150335_W)) {\n            nbTNT++;\n          }\n        }\n      }\n    }复制代码if (nbTNT >= 20)\n    {\n      ServerSender.sendTranslatedSentence(player, '7', \"actions.boreholetnt_success\", new String[0]);\n      mw.getProfile(player).clearTag(\"action_boreholetnt\");\n      mw.getProfile(player).setTag(\"action_boreholetnt_complete\");\n      mw.getProfile(player).setTag(\"action_boreholetntlit\");\n      mw.getProfile(player).clearActionData(\"action_boreholetnt_max\");\n      return;\n    }复制代码\n从代码中我们可以看到有一个点P，玩家距离(推测是欧氏距离)这个点25m以上判定不通过，X Z 坐标 +3-2，Y坐标0~6范围内找到的黑曜石-tnt组合数量少于20个判定不通过，都满足则通过，貌似玩家接近点P时进行判定(来自游戏内实测)\n\n引爆判定代码\nif ((!mw.getProfile(player).isTagSet(\"action_boreholetntlit\")) || (mw.getProfile(player).isTagSet(\"action_boreholetntlit_complete\"))) {\n      return;\n    }\n    Point p = new Point(mw.getProfile(player).getActionData(\"action_borehole_pos\"));\n    \n    int nbtnt = mw.world.func_72872_a(EntityTNTPrimed.class, new AxisAlignedBB(p.x, p.y, p.z, p.x + 1.0D, p.y + 1.0D, p.z + 1.0D).func_72321_a(8.0D, 4.0D, 8.0D)).size();\n    if (nbtnt > 0)\n    {\n      ServerSender.sendTranslatedSentence(player, '7', \"actions.boreholetntlit_success\", new String[0]);\n      mw.getProfile(player).clearTag(\"action_boreholetntlit\");\n      mw.getProfile(player).setTag(\"action_boreholetntlit_complete\");\n      return;\n    }复制代码同样是点P，玩家在点P附近(貌似是1,1,1范围内，不确定)同时8,4,8范围内有点燃的TNT时通过判定\n\n这两个判定都涉及到点P,通过代码我们可以看到点P的位置来自于一个叫action_borehole_pos的ActionData，这个ActionData的位置是\n存档文件夹\\millenaire\\profiles\\一串UID\\actiondata.txt中，action_borehole_pos:X坐标/Y坐标/Z坐标  这里。可以直接用记事本修改这个文档，重新进入存档后会读取这个数据到游戏中。推测这个点来自于挖天坑这这个任务。\n\n总结，找到 存档文件夹\\millenaire\\profiles\\一串UID\\actiondata.txt这个文档，找到或修改 action_borehole_pos:X坐标/Y坐标/Z坐标 ，得到或设置判定点，玩家在判定点欧氏距离25m之内，判定点X Z 坐标 +3-2，Y坐标0~6范围内找到的黑曜石-tnt组合数量大于等于20个则判定放好。\n放好后，玩家在判定点1,1,1范围内，判定点/玩家(没搞清楚具体是哪个)8,4,8范围内有点燃的TNT则判定已点燃。\n版本为 mc 1.12.2   forge 1.12.2-14.23.5.2808   millenaire-7.2.0\n\n另，上传了 放好后，点燃后没回报前，汇报后存储的数据\n\n\n\n千年村庄mod黑曜石tnt任务数据.zip\n(2.13 KB, 下载次数: 113)\n\n\n\n2019-4-19 03:14 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n另，不知道是否错版，应该不算是mod技巧吧......\n\n\n\n",
    "replies": [
        {
            "author": "全球loli",
            "timestamp": 1555654620,
            "txt_content": "厉害！感谢，我也卡在这里动不了"
        },
        {
            "author": "萌鑫521",
            "timestamp": 1566974460,
            "txt_content": "看不懂啊大佬"
        }
    ]
}