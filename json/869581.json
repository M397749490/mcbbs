{
    "title": "建议论坛增加 Markdown 语法支持（附实现功能的方法以及源码）",
    "author": "Akkariin",
    "replyCount": 16,
    "timestamp": 1559064840,
    "txt_content": " 本帖最后由 Akkariin 于 2019-5-29 05:50 编辑 \n\n什么是 Markdown？\nMarkdown 是一种优雅的文本标记语言，利用简单的符号标记即可对文本内容进行快速排版，Markdown 的语法格式非常丰富，涵盖了文本、图片、音频多媒体等。你只需要简单的学习，即可快速上手使用 Markdown。\n\n为什么要使用 Markdown？\n传统的 bbcode 过于复杂，编写时只能依赖可视化编辑器，bbcode 只不过是将 html 代码换个方式表达，对于新人来说较难学习。而 Markdown 不同，它不像 bbcode 一样需要 / 闭合的代码标签，你只需要在文字的前面或者左右两侧用一两个简单的字符标记即可。\n\n我们来对比一下，同样一段内容，用 bbcode 和 markdown 来表达。首先是 bbcode：\n[size=6]一个二级标题[/size]\n一段简短的内容，[b]一小段加粗的文字[/b]\n[quote]一个 quote 块[/quote]复制代码然后是 markdown：\n## 一个二级标题\n一段简短的内容，**一小段加粗的文字**\n> 一个 quote 块复制代码很明显，Markdown 在编写的时候会更加容易，你不需要去记住那些复杂的标签，只需要记住一些符号即可。\n随着 Markdown 的流行，现在越来越多的互联网社区已经开始支持 Markdown 语法发布帖子和评论。\n作为一个国内最大的 Minecraft 交流论坛，这里汇集了众多的技术人士，我们当然也应该与时俱进，一起来支持 Markdown。\n\n如何给 Discuz 增加 Markdown 支持？\n具体看这里吧，因为内容包含 script 标签，应该是被 WAF 防火墙拦下来了，发帖出现 417 错误\nhttps://cooltext.cn/s/dc241f6da8680d558f9cc016b19fa4ce\n\n召唤: @混乱  @gamerteam \n\n",
    "replies": [
        {
            "author": "匿名",
            "timestamp": 1559081760,
            "txt_content": "http://www.mcbbs.net/thread-814010-1-1.html\nhttp://www.mcbbs.net/thread-848702-1-1.html\n祝楼主好运。"
        },
        {
            "author": "Akkariin",
            "timestamp": 1559082540,
            "txt_content": "匿名者 发表于 2019-5-29 06:16\nhttp://www.mcbbs.net/thread-814010-1-1.html\nhttp://www.mcbbs.net/thread-848702-1-1.html\n祝楼主好运。 ...\n这两个帖子都提到了安装插件，而我所说的这个方法不需要安装插件\n插件的原理是 Markdown -> BBCode，而我这个方法不需要转为 BBCode，它是在浏览器端进行渲染的\n实现起来相当轻松，只需要改两个文件就行"
        },
        {
            "author": "licrafter",
            "timestamp": 1559092560,
            "txt_content": "吼啊，资瓷"
        },
        {
            "author": "EventMsg",
            "timestamp": 1559094780,
            "txt_content": "Akkariin 发表于 2019-5-29 06:29\n这两个帖子都提到了安装插件，而我所说的这个方法不需要安装插件\n插件的原理是 Markdown -> BBCode，而我 ...\n....这么改  之后dz还升不升级了"
        },
        {
            "author": "Akkariin",
            "timestamp": 1559096820,
            "txt_content": "EventMsg 发表于 2019-5-29 09:53\n....这么改  之后dz还升不升级了\n升级也无关紧要，如果你看过了我写的修改方式，你会发现修改起来五分钟都不用。\n每次升级完了再改一下就好了，用不了多长时间，而且也不是经常升级。"
        },
        {
            "author": "混乱",
            "timestamp": 1559098020,
            "txt_content": "EventMsg 发表于 2019-5-29 09:53\n....这么改  之后dz还升不升级了\n以目前discuz官方几个月没动静的更新频率来看，我们很少会需要整体升级，有版本更新也可以自己手动执行更新和代码比对。我们会考虑加入对Markdown语法的支持，不过可能还需要进行一段时间的测试。"
        },
        {
            "author": "NoName德里奇",
            "timestamp": 1559099580,
            "txt_content": "吼啊，资瓷。\n在MCBBS还没有实装MD支持的时候，大佬可以先用这个工具将就一下：\nhttp://www.mcbbs.net/thread-779668-1-1.html"
        },
        {
            "author": "Farewell_Q",
            "timestamp": 1559101260,
            "txt_content": "好像wiki的语法？"
        },
        {
            "author": "EventMsg",
            "timestamp": 1559121840,
            "txt_content": "混乱 发表于 2019-5-29 10:47\n以目前discuz官方几个月没动静的更新频率来看，我们很少会需要整体升级，有版本更新也可以自己手动执行更 ...\n嘛  现在不是在oschina更新么  都是小的更新"
        },
        {
            "author": "Zapic",
            "timestamp": 1559126340,
            "txt_content": "据我所知,大家都挺喜欢用顶部的工具栏的...所以大概除了喜欢用删除线的人没有人会去记那些BBCode的,特别是水怪.\n已经被推翻了的东西\n但考虑到已经存在的帖子,论坛方面肯定不会去掉BBCode的解析(除非连夜冒烟转为MD).\nBBCode最常使用的就是中括号,没错就是这两个->  [ ]\nMarkdown里中括号也是有意义的,那么混用会不会导致一些问题?\n[b]我是粗体![/b](瑟瑟发抖)复制代码[text](URL)->text\n\n但是论坛先解析了BBCode,客户端再接收到文本处理时BBCode的中括号已经被处理的干干净净了.\n目前没有想到可能出问题的偏激情况.\n\n但是我对这个问题我表示赞成,只要协调好BBcode和Markdown的关系,这个方案也是可行的.\n论坛的鬼畜富文本编辑器真的伤了一代懒人的心,格式经常串行,莫名其妙一行的格式应用到全文,直接修改代码块各种文本丢失(上次写教程时发现疏漏改了一下代码块以下的东西全部消失????)"
        },
        {
            "author": "Akkariin",
            "timestamp": 1559129940,
            "txt_content": "Zapic 发表于 2019-5-29 18:39\n据我所知,大家都挺喜欢用顶部的工具栏的...所以大概除了喜欢用删除线的人没有人会去记那些BBCode的,特别 ...Markdown 是在前端渲染的\n由于 Markdown 在 [ code ] 标签里面，因此不会被 Discuz 作为 BBCode 来解析\n在前端显示出来的效果是这样的\nmarkdown\n# 这是大标题\n## 这是二级标题\n这是文字内容\n这是 [链接](http://www.mcbbs.net/)\n> 这是引用复制代码内容显示出来其实是\n<div class=\"blockcode\">\n这里面是 Markdown 内容\n</div>复制代码前端的 showdown 再根据 getElementsByClassName(\"blockcode\") 去取 Markdown 内容然后渲染，渲染完了写入原来的 div 里并去掉 class=\"blockcode\"\n这样就不会出现你所说的问题了"
        },
        {
            "author": "鬼畜畜",
            "timestamp": 1559132940,
            "txt_content": "混乱 发表于 2019-5-29 10:47\n以目前discuz官方几个月没动静的更新频率来看，我们很少会需要整体升级，有版本更新也可以自己手动执行更 ...\n太好了 太好了！ 举坛欢庆！\n\n另外还请修一下所见即所得编辑器发的帖子所见非所得的问题"
        },
        {
            "author": "Zapic",
            "timestamp": 1559197800,
            "txt_content": "Ghost_chu 发表于 2019-5-29 20:29\n太好了 太好了！ 举坛欢庆！\n\n另外还请修一下所见即所得编辑器发的帖子所见非所得的问题 ...\n所见非所得确实是一个巨坑...\n水怪无所谓写教程的是真的苦了.\n有时候写完一长串会双击显示纯文本的复选框,让他重新解析一次BBCode免得出意外.\n我认为论坛不应该主动去修正潜在的BBcode语法错误,有些没有错的愣是改成一坨shit.\n\nMarkdown就是典型的所想即所得还是很爽的,就是不知道会不会有Markdown预览的操作.\n\n等等(突然想到)----\nMarkdown本身不支持一些富文本有的骚操作(字体颜色etc),需要配合HTML标签实现,但是论坛貌似会转义HTML.那么在code块里的BBcode和HTML标签都不会起作用,这就会让作者脑阔疼(彩色标题/鬼排版).这时如何让Markdown写下的文本两全呢?还是直接舍弃某些功能?"
        },
        {
            "author": "1139365029",
            "timestamp": 1559206620,
            "txt_content": " 本帖最后由 1139365029 于 2019-5-30 18:39 编辑 \nZapic 发表于 2019-5-29 18:39\n据我所知,大家都挺喜欢用顶部的工具栏的...所以大概除了喜欢用删除线的人没有人会去记那些BBCode的,特别 ...\nBBcode和Markdown是可以共存的，我曾经在一个论坛（现在那个论坛打不开了）看见过同时共存html、markdown、bbcode三种语法的富文本编辑器，而且没有冲突，\n后来我自己尝试过实现这种效果，可能还有一些问题，不过基本上已经实现了三种语法的共存：\n\n\n\n\nTIM截图20190530164003.png (6.26 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-30 16:51 上传\n\n\n\n\n\n这说明了在未来的某一天，论坛可能会真的会在不抛弃bbcode的情况下支持markdown，\n[数据删除]喜欢用顶部的工具栏，从来不记语法 +1"
        },
        {
            "author": "Zapic",
            "timestamp": 1559212140,
            "txt_content": "1139365029 发表于 2019-5-30 16:57\nBBcode和Markdown是可以共存的，喜欢用顶部的工具栏，从来不记语法 +1\nAkkariiin的说法是把Markdown裹在code块里,在code块里的bbcode不会被解析:\n[b]我要加粗![/b]复制代码\n这就会出现两难:\n1.我用Markdown,字体清一色.\n2.我用BBCode,越写越难受.\n\n所以我才会提出那样的疑问."
        },
        {
            "author": "混乱",
            "timestamp": 1559283900,
            "txt_content": "\n\n\n\n\nimage.png (72.05 KB, 下载次数: 0)\n\n下载附件\n\n2019-5-31 14:25 上传\n\n\n\n\n\n楼主的代码已经测试通过了，预计下周实装到线上\n\n"
        }
    ]
}