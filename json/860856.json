{
    "title": "使用BlockData API来操作Sign",
    "author": "鬼畜畜",
    "replyCount": 0,
    "timestamp": 1556377020,
    "txt_content": " 本帖最后由 Ghost_chu 于 2019-4-27 23:00 编辑 \n\n1.14后，不能再使用org.spigotmc.material.Sign和org.spigotmc.material.data了（反正这个Dev是这样）\n\n和MD_5一通交流，应使用BlockData API，翻了一圈SpigotMC毛线都没找到\n\n经过3个小时的折腾，我整理了一套教程，虽然代码特别菜，但希望能帮到你\n\norg.bukkit.material.Sign 不能在 1.14 上正常工作了，所以我们要换掉这个\n\n获取Sign示例，可以用来设置牌子文字：\n\nBlock b = <在这里获取你的牌子方块>;\norg.bukkit.block.Sign sign = (org.bukkit.block.Sign) b.getState();\nsign.setText(....);\nsign.update(..);复制代码\n如果你需要操作 Facing 那么就要用BlockData Type了：\n\nBlockDataAPI区分SIGNPOST（插地上的）和WALLSIGN（贴墙上的），所以代码不同：\n\nbs=<在这里获取你的贴墙上的牌子方块>.getState();\norg.bukkit.block.data.type.WallSign signBlockDataType = (org.bukkit.block.data.type.WallSign) bs.getBlockData();复制代码bs=<在这里获取你的插地上的牌子方块>.getState();\norg.bukkit.block.data.type.Sign signBlockDataType = (org.bukkit.block.data.type.Sign) bs.getBlockData();复制代码\n\n\n获取到牌子的BlockDataType后，你可以用这个来操作 Facing\n\n\nsignBlockDataType.setFacing(<需要设置为的BlockFace>);\nbs.setBlockData(signBlockDataType);复制代码\n\n\n附上一个QSRR正在用的检测牌子是否贴在某个方块上的方法\n\n@param Block b - 需要检测的方块\n\n@Return Block - 被检测方块依附的方块，没有返回null\n\n\npublic static Block getAttached(Block b) {\n        try {\n            if(b.getBlockData() instanceof Directional) {\n                Directional directional = (Directional) b.getBlockData();\n                return b.getRelative(directional.getFacing().getOppositeFace());\n            }else {\n                //No Directionalable\n                return null;\n            }\n        } catch (NullPointerException|ClassCastException e) {\n            debugLog(\"What's this?\");\n            debugLog(e.getMessage());\n            return null;\n        }\n    }复制代码\n\n\n经测试可在1.13与1.14使用\n\n\n",
    "replies": []
}