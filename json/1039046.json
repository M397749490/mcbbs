{
    "title": "如何讓自製怪物有可以打開GUI的功能?",
    "author": "lycorisrad",
    "replyCount": 16,
    "timestamp": 1588697640,
    "txt_content": " 本帖最后由 lycorisrad 于 2020-5-6 00:59 编辑 \n\n不好意思新手第一次發文，最近想寫出像女僕模組一樣的自製生物，但是都找不到方法讓自製的生物有可以打開gui的功能，請問各位大大有方法可解嗎?還是有資源範例可以看呢?我找了很多模組的源碼，但是自己試了一遍還是不行，求助!!\n\nEntityCentaur.class\npackage hiro.mod.entity;\n\nimport javax.annotation.Nonnull;\nimport javax.annotation.Nullable;\nimport javax.swing.Icon;\n\nimport hiro.mod.Main;\nimport hiro.mod.api.IMonsterTask;\nimport hiro.mod.api.MonsterAPI;\nimport hiro.mod.api.MonsterAbstract;\nimport hiro.mod.api.event.MonsterInteractEvent;\nimport hiro.mod.capability.MonsterNumHandler;\nimport hiro.mod.capability.MonsterNumSerialzer;\nimport hiro.mod.config.GeneralConfig;\nimport hiro.mod.init.ItemInit;\nimport hiro.mod.util.handlers.MonsterGuiHandler;\nimport net.minecraft.entity.EntityAgeable;\nimport net.minecraft.entity.EntityLivingBase;\nimport net.minecraft.entity.SharedMonsterAttributes;\nimport net.minecraft.entity.ai.EntityAIAttackMelee;\nimport net.minecraft.entity.ai.EntityAIBase;\nimport net.minecraft.entity.ai.EntityAIFollowOwner;\nimport net.minecraft.entity.ai.EntityAIFollowParent;\nimport net.minecraft.entity.ai.EntityAILeapAtTarget;\nimport net.minecraft.entity.ai.EntityAILookIdle;\nimport net.minecraft.entity.ai.EntityAIMate;\nimport net.minecraft.entity.ai.EntityAIPanic;\nimport net.minecraft.entity.ai.EntityAISwimming;\nimport net.minecraft.entity.ai.EntityAITempt;\nimport net.minecraft.entity.ai.EntityAIWanderAvoidWater;\nimport net.minecraft.entity.ai.EntityAIWatchClosest;\nimport net.minecraft.entity.passive.EntityCow;\nimport net.minecraft.entity.player.EntityPlayer;\nimport net.minecraft.init.Blocks;\nimport net.minecraft.init.Items;\nimport net.minecraft.item.Item;\nimport net.minecraft.item.ItemFood;\nimport net.minecraft.item.ItemStack;\nimport net.minecraft.network.datasync.DataParameter;\nimport net.minecraft.network.datasync.DataSerializers;\nimport net.minecraft.network.datasync.EntityDataManager;\nimport net.minecraft.util.DamageSource;\nimport net.minecraft.util.EnumHand;\nimport net.minecraft.util.ResourceLocation;\nimport net.minecraft.util.SoundEvent;\nimport net.minecraft.util.text.TextComponentTranslation;\nimport net.minecraft.world.World;\nimport net.minecraftforge.common.MinecraftForge;\nimport net.minecraftforge.common.capabilities.ICapabilityProvider;\n\npublic class EntityCentaur extends MonsterAbstract implements ICapabilityProvider{\n\n        private static final DataParameter<Integer> EXP = EntityDataManager.createKey(EntityCentaur.class, DataSerializers.VARINT);\n        private static final DataParameter<String> TASK = EntityDataManager.createKey(EntityCentaur.class, DataSerializers.STRING);\n        \n\n    private static final int Priority_Task =5;        \n            \n    @Nullable\n    private EntityAIBase taskAI;\n    public boolean guiOpened;\n    \n    @Nonnull\n    private IMonsterTask task = MonsterAPI.getIdleTask();\n        public EntityCentaur(World worldIn) {\n                super(worldIn);\n                this.setSize(0.9F, 2.0F);\n                }\n         @SuppressWarnings(\"unchecked\")\n         @Override\n                protected void initEntityAI() {\n           \n                    this.tasks.addTask(1, new EntityAISwimming(this));\n                this.tasks.addTask(2, this.aiSit);\n                this.tasks.addTask(4, new EntityAILeapAtTarget(this, 0.4F));\n                this.tasks.addTask(5, new EntityAIAttackMelee(this, 1.0D, true));\n                this.tasks.addTask(6, new EntityAIFollowOwner(this, 1.0D, 10.0F, 2.0F));\n                this.tasks.addTask(7, new EntityAIMate(this, 1.0D));\n                this.tasks.addTask(8, new EntityAIWanderAvoidWater(this, 1.0D));\n           \n                this.tasks.addTask(10, new EntityAIWatchClosest(this, EntityPlayer.class, 8.0F));\n                this.tasks.addTask(10, new EntityAILookIdle(this));\n                this.tasks.addTask(1, new EntityAIPanic(this, 2.0D));\n                this.tasks.addTask(2, new EntityAIMate(this, 10D));\n                this.tasks.addTask(3, new EntityAITempt(this, 1.25D, ItemInit.COPPER_INGOT, false));\n                this.tasks.addTask(4, new EntityAIFollowParent(this, 1.25D));\n                this.tasks.addTask(5, new EntityAIWanderAvoidWater(this, 1.0D));\n                this.tasks.addTask(6, new EntityAIWatchClosest(this, EntityPlayer.class, 6.0F));\n                this.tasks.addTask(7, new EntityAILookIdle(this));\n                \n                }\n          public IMonsterTask getTask() {\n                return MonsterAPI.findTask(new ResourceLocation(this.dataManager.get(TASK)))\n                        .or( MonsterAPI.getIdleTask());\n            }\n          protected void applyEntityAttributes()\n            {\n                super.applyEntityAttributes();\n                this.getEntityAttribute(SharedMonsterAttributes.MOVEMENT_SPEED).setBaseValue(0.30000001192092896D);\n\n                if (this.isTamed())\n                {\n                    this.getEntityAttribute(SharedMonsterAttributes.MAX_HEALTH).setBaseValue(20.0D);\n                }\n                else\n                {\n                    this.getEntityAttribute(SharedMonsterAttributes.MAX_HEALTH).setBaseValue(8.0D);\n                }\n\n                this.getAttributeMap().registerAttribute(SharedMonsterAttributes.ATTACK_DAMAGE).setBaseValue(2.0D);\n            }\n        \n                 @Override\n    public float getEyeHeight() {\n            return 2.6F;\n    }\n    @Override\n    public MonsterAbstract createChild(EntityAgeable ageable) {\n            return new EntityCentaur(world);\n    }\n    @Override\n    protected SoundEvent getAmbientSound() {\n            return super.getAmbientSound();\n    }\n    @Override\n    protected SoundEvent getHurtSound(DamageSource source) {\n            return super.getHurtSound(source);\n    }\n    @Override\n    protected SoundEvent getDeathSound() {\n            return super.getDeathSound();\n    }\n    private boolean monsteropenGui(EntityPlayer player) {\n                if(!world.isRemote) {\n                        player.openGui(hiro.mod.Main.instance, MonsterGuiHandler.MainGui.MAIN.getId(), world, this.getEntityId(),0 , 0);\n                }\n                return true;\n        }\n        @Override\n        public void attackEntityWithRangedAttack(EntityLivingBase target, float distanceFactor) {\n                // TODO Auto-generated method stub\n                \n        }\n        @Override\n        public void setSwingingArms(boolean swingingArms) {\n                // TODO Auto-generated method stub\n                \n        }\n        @Override\n        public boolean canBeCollidedWith() {\n                return true;\n        }\n        @Override\n        public int getExp() {\n                // TODO Auto-generated method stub\n                return 0;\n        }\n        \n\n\n        \n         \n}\n复制代码MonsterGuiHandler.class\npackage hiro.mod.util.handlers;\n\nimport javax.annotation.Nullable;\n\nimport hiro.mod.entity.EntityCentaur;\nimport hiro.mod.inventory.MonsterMainContainer;\nimport net.minecraft.entity.Entity;\nimport net.minecraft.entity.player.EntityPlayer;\nimport net.minecraft.world.World;\nimport net.minecraftforge.fml.common.network.IGuiHandler;\nimport scala.reflect.internal.Trees.New;\n\npublic class MonsterGuiHandler  implements IGuiHandler{\n        \n        @Nullable\n        @Override\n        public Object getServerGuiElement(int guiId, EntityPlayer player,World world,int entityId,int taskIndex,int startRow) {\n                Entity entity = world.getEntityByID(entityId);\n                if(guiId == MainGui.MAIN.getId() && entity instanceof EntityCentaur) {\n                   return new MonsterMainContainer(player.inventory, (EntityCentaur) entity,taskIndex);\n                }\n                return null;\n        }\n\n        \n        @Nullable\n        @Override\n        public Object getClientGuiElement(int guiId, EntityPlayer player,World world,int entityId,int taskIndex,int startRow) {\n                Entity entity = world.getEntityByID(entityId);\n                if(guiId == MainGui.MAIN.getId() && entity instanceof EntityCentaur) {\n                   return new MonsterMainContainer(player.inventory, (EntityCentaur) entity,taskIndex); \n        }\n                return null;\n                }\n     \n        public enum MainGui{\n                MAIN(1),\n                INVENTORY(2);\n                \n                private int id;\n                \n                MainGui(int id){this.id=id;}\n                  public int getId() {\n                    return id;  }\n        } \n}\n复制代码MonsterMainContainer.class\npackage hiro.mod.inventory;\n\nimport java.awt.Container;\n\nimport javax.annotation.Nonnull;\nimport javax.annotation.Nullable;\n\nimport hiro.mod.api.IMonsterTask;\nimport hiro.mod.api.MonsterAPI;\nimport hiro.mod.entity.EntityCentaur;\nimport hiro.mod.network.simpleimpl.ChangeMonsterTaskMessage;\nimport hiro.mod.proxy.CommonProxy;\nimport net.minecraft.enchantment.EnchantmentHelper;\nimport net.minecraft.entity.player.EntityPlayer;\nimport net.minecraft.inventory.EntityEquipmentSlot;\nimport net.minecraft.inventory.IInventory;\nimport net.minecraft.inventory.Slot;\nimport net.minecraft.item.ItemArmor;\nimport net.minecraft.item.ItemStack;\nimport net.minecraftforge.fml.relauncher.Side;\nimport net.minecraftforge.fml.relauncher.SideOnly;\nimport net.minecraftforge.items.CapabilityItemHandler;\nimport net.minecraftforge.items.IItemHandler;\nimport net.minecraftforge.items.SlotItemHandler;\n\npublic class MonsterMainContainer extends net.minecraft.inventory.Container{\n private static final EntityEquipmentSlot[] VALID_EQUIPMENT_SLOTS = new EntityEquipmentSlot[]{EntityEquipmentSlot.HEAD, EntityEquipmentSlot.CHEST, EntityEquipmentSlot.LEGS, EntityEquipmentSlot.FEET};        \n public EntityCentaur monster;\n public int taskIndex;\n public IMonsterTask task;\n \n public MonsterMainContainer (IInventory playerInventory,EntityCentaur monster,int taskIndex) {\n          addPlayerSlots(playerInventory);\n         this.monster = monster;\n         if(0 < taskIndex && taskIndex < MonsterAPI.getTasks().size()) {\n                 this.taskIndex = taskIndex;\n                 \n         }else {\n                 this.taskIndex =0;\n         }\n         task = MonsterAPI.getTasks().get(this.taskIndex);\n         monster.guiOpened = true;\n }\n        \n @Override\n public void detectAndSendChanges() {\n         monster.guiOpened = true;\n         super.detectAndSendChanges();\n }\n \n @Override\n public void onContainerClosed(EntityPlayer playerIn) {\n         monster.guiOpened = false;\n         if(playerIn.world.isRemote) {\n                 CommonProxy.INSTANCE.sendToServer(new ChangeMonsterTaskMessage(monster.getUniqueID(), task));\n         }\n         super.onContainerClosed(playerIn);\n }\n \n @Override\n public boolean canInteractWith(@Nonnull EntityPlayer playerIn) {\n         return this.monster.getOwnerId() != null && this.monster.getOwnerId().equals(playerIn.getUniqueID())\n                         && this.monster.isEntityAlive() && this.monster.getDistance(playerIn) < 5.0F;\n } \n private void addPlayerSlots(IInventory playerInventory) {\n         //玩家物品欄\n         for (int i=0 ; i<3 ;++i) {\n                 for(int j1=0;j1<9;++j1) {\n                         this.addSlotToContainer(new Slot(playerInventory, j1 + (i+ 1) * 9, 8 + j1 * 18, 84 + i * 18));\n                 }\n         }\n         for(int i1=0;i1<9;++i1) {\n                 this.addSlotToContainer(new Slot(playerInventory, i1, 8 + i1 * 18, 142));\n         }\n }\n private void addEntityArmorAndHandSlots(EntityCentaur BasicMonster) {\n     IItemHandler itemHandler = BasicMonster.getCapability(CapabilityItemHandler.ITEM_HANDLER_CAPABILITY, null);\n     // 占用 0-3\n     addArmorSlot(BasicMonster, itemHandler);\n     // 占用 4-5\n     addHandSlot(itemHandler);\n }\n\n private void addArmorSlot(EntityCentaur BasicMonster, IItemHandler itemHandler) {\n     for (int k = 0; k < 4; ++k) {\n         final EntityEquipmentSlot entityequipmentslot = VALID_EQUIPMENT_SLOTS[k];\n         this.addSlotToContainer(new SlotItemHandler(itemHandler, 3 - k, 8, 8 + k * 18) {\n     \n             @Override\n             public int getSlotStackLimit() {\n                 return 1;\n             }\n\n      \n             @Override\n             public boolean isItemValid(@Nonnull ItemStack stack) {\n                 return stack.getItem().isValidArmor(stack, entityequipmentslot, BasicMonster) && super.isItemValid(stack);\n             }\n\n             @Override\n             public boolean canTakeStack(EntityPlayer playerIn) {\n                 ItemStack itemstack = this.getStack();\n                 return (itemstack.isEmpty() || playerIn.isCreative() || !EnchantmentHelper.hasBindingCurse(itemstack)) && super.canTakeStack(playerIn);\n             }\n\n             @Override\n             @Nullable\n             @SideOnly(Side.CLIENT)\n             public String getSlotTexture() {\n                 return ItemArmor.EMPTY_SLOT_NAMES[entityequipmentslot.getIndex()];\n             }\n         });\n     }\n }\n\n private void addHandSlot(IItemHandler itemHandler) {\n     this.addSlotToContainer(new SlotItemHandler(itemHandler, 4, 80, 62));\n     this.addSlotToContainer(new SlotItemHandler(itemHandler, 5, 98, 62) {\n         @Override\n         @SideOnly(Side.CLIENT)\n         public String getSlotTexture() {\n             return \"minecraft:items/empty_armor_slot_shield\";\n         }\n     });\n }\n\n\n @Nonnull\n @Override\n public ItemStack transferStackInSlot(EntityPlayer playerIn, int index) {\n     ItemStack itemstack = ItemStack.EMPTY;\n     Slot slot = this.inventorySlots.get(index);\n\n     if (slot != null && slot.getHasStack()) {\n         ItemStack itemstack1 = slot.getStack();\n         itemstack = itemstack1.copy();\n\n         if (index < 6) {\n             if (!this.mergeItemStack(itemstack1, 6, this.inventorySlots.size(), true)) {\n                 return ItemStack.EMPTY;\n             }\n         } else if (!this.mergeItemStack(itemstack1, 0, 6, false)) {\n             return ItemStack.EMPTY;\n         }\n\n         if (itemstack1.isEmpty()) {\n             slot.putStack(ItemStack.EMPTY);\n         } else {\n             slot.onSlotChanged();\n         }\n     }\n\n     return itemstack;\n }\n}\n复制代码MonsterMainContianerGui.class\npackage hiro.mod.client.gui;\n\nimport hiro.mod.api.MonsterAbstract;\nimport hiro.mod.client.gui.inventory.AbstractMonsterGuiContainer;\nimport hiro.mod.entity.EntityCentaur;\nimport hiro.mod.inventory.MonsterMainContainer;\nimport net.minecraft.client.renderer.GlStateManager;\nimport net.minecraft.client.resources.I18n;\nimport net.minecraft.entity.SharedMonsterAttributes;\nimport net.minecraft.entity.player.InventoryPlayer;\nimport net.minecraftforge.fml.relauncher.Side;\nimport net.minecraftforge.fml.relauncher.SideOnly;\n\nimport static hiro.mod.util.handlers.MonsterGuiHandler.MainGui.MAIN;\n\nimport java.util.Locale;\n@SideOnly(Side.CLIENT)\npublic class MonsterMainContainerGui extends AbstractMonsterGuiContainer{\n   public MonsterMainContainerGui(InventoryPlayer inventory,EntityCentaur monster,int taskIndex) {\n           super(new MonsterMainContainer(inventory, monster, taskIndex), MAIN.getId());\n   }\n   @Override\n   public void drawCustomScreen(int mouseX, int mouseY, float partialTicks) {\n       int i = this.guiLeft;\n       int j = this.guiTop;\n       GlStateManager.pushMatrix();\n       mc.renderEngine.bindTexture(BACKGROUND);\n       GlStateManager.disableLighting();\n       drawTexturedModalRect(i + 80, j + 10, 178, 93, 9, 9);\n       drawTexturedModalRect(i + 80, j + 22, 188, 93, 9, 9);\n       drawTexturedModalRect(i + 105, j + 10, 178, 104, 64, 9);\n       drawTexturedModalRect(i + 105, j + 22, 178, 104, 64, 9);\n       drawTexturedModalRect(i + 107, j + 12, 180, 114, (int) (64 * monster.getHealth() / monster.getMaxHealth()), 5);\n       double armorNum = monster.getEntityAttribute(SharedMonsterAttributes.ARMOR).getAttributeValue();\n       drawTexturedModalRect(i + 107, j + 24, 180, 120, (int) (64 * (armorNum % 20.00000000001) / 20), 5);\n       GlStateManager.enableLighting();\n       GlStateManager.popMatrix();\n       fontRenderer.drawString(String.valueOf(Math.round(monster.getHealth())), i + 91, j + 11, 0x555555, false);\n       fontRenderer.drawString(String.valueOf(Math.round(armorNum)), i + 91, j + 23, 0x555555, false);\n       fontRenderer.drawString(I18n.format(\"gui.touhou_little_monster.info.attack\", DECIMAL_FORMAT.format(monster.getEntityAttribute(SharedMonsterAttributes.ATTACK_DAMAGE).getAttributeValue())), i + 80, j + 35, 0x555555, false);\n       fontRenderer.drawString(I18n.format(\"gui.touhou_little_monster.info.experience\", monster.getExp()), i + 80, j + 46, 0x555555, false);\n   }\n@Override\n   public void drawCustomBackground(int mouseX, int mouseY, float partialTicks) {\n   }\n\n   @Override\n   public void drawCustomTooltips(int mouseX, int mouseY, float partialTicks) {\n   }\n\n   @Override\n   public int getRenderPotionStartXOffset() {\n       return 0;\n   }\n\n   @Override\n   public String getGuiName() {\n       return MAIN.name().toLowerCase(Locale.US);\n   }\n}\n        \n复制代码MonsterInteractEvent.class\npackage hiro.mod.api.event;\n\nimport hiro.mod.api.MonsterAbstract;\nimport net.minecraft.entity.player.EntityPlayer;\nimport net.minecraft.item.ItemStack;\nimport net.minecraft.world.World;\nimport net.minecraftforge.fml.common.eventhandler.Cancelable;\nimport net.minecraftforge.fml.common.eventhandler.Event;\nimport scala.tools.reflect.Eval;\n\n@Cancelable\npublic class MonsterInteractEvent extends Event{\n\n        private World world;\n        private MonsterAbstract monster;\n        private EntityPlayer player;\n        private ItemStack stack;\n        \n        public MonsterInteractEvent(EntityPlayer player,MonsterAbstract monster,ItemStack stack)\n        {\n                this.world = player.getEntityWorld();\n                this.player = player;\n                this.stack = stack;\n                this.monster = monster;\n                \n        }\n    public EntityPlayer getplayer() {return player;}\n    \n    public World getworld() {return world;}\n    \n    public MonsterAbstract getmonsterid() {return monster;}\n    \n    public ItemStack getstack() {return stack;}\n}复制代码Main.calss\npackage hiro.mod;\n\nimport hiro.mod.init.BlockInit;\nimport hiro.mod.objects.blocks.BlockBase;\nimport hiro.mod.proxy.CommonProxy;\nimport hiro.mod.tabs.HiroTab;\nimport hiro.mod.util.Reference;\nimport hiro.mod.util.handlers.RegistryHandler;\nimport net.minecraft.creativetab.CreativeTabs;\nimport net.minecraftforge.fml.common.Mod;\nimport net.minecraftforge.fml.common.Mod.EventHandler;\nimport net.minecraftforge.fml.common.Mod.Instance;\nimport net.minecraftforge.fml.common.SidedProxy;\nimport net.minecraftforge.fml.common.event.FMLInitializationEvent;\nimport net.minecraftforge.fml.common.event.FMLPostInitializationEvent;\nimport net.minecraftforge.fml.common.event.FMLPreInitializationEvent;\n\n\n@Mod(modid = Reference.MODID,name = Reference.NAME, version = Reference.VERSION)\npublic class Main {\n\n        public static final CreativeTabs Hirotab = new HiroTab(\"hiro's tab\");\n        \n        @Mod.Instance\n        public static Main instance;\n        \n        @SidedProxy(clientSide = Reference.CLIENT, serverSide = Reference.COMMON)\n        public static CommonProxy proxy;\n        \n        @EventHandler\n        public static void preInit(FMLPreInitializationEvent event) {\n                RegistryHandler.preInitRegistries();\n                proxy.registerTileEntities();\n        }\n        @EventHandler\n    public static void init(FMLPostInitializationEvent event) {\n                RegistryHandler.initRegistries(event);\n        }\n        @EventHandler\n    public static void postInit(FMLInitializationEvent event) {\n                RegistryHandler.postInitRegistries(event);\n        }\n        \n}\n复制代码AbstractMonsterGuiContainer.class\npackage hiro.mod.client.gui.inventory;\n\nimport java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.ScheduledThreadPoolExecutor;\nimport java.util.concurrent.TimeUnit;\n\nimport org.apache.commons.lang3.concurrent.BasicThreadFactory;\nimport org.lwjgl.opengl.GL11;\n\nimport hiro.mod.api.IMonsterTask;\nimport hiro.mod.api.MonsterAPI;\nimport hiro.mod.entity.EntityCentaur;\nimport hiro.mod.inventory.MonsterMainContainer;\nimport hiro.mod.proxy.CommonProxy;\nimport hiro.mod.util.Reference;\nimport hiro.mod.util.handlers.MonsterGuiHandler;\nimport net.minecraft.client.gui.GuiButtonImage;\nimport net.minecraft.client.gui.GuiButtonToggle;\nimport net.minecraft.client.gui.ScaledResolution;\nimport net.minecraft.client.gui.inventory.GuiContainer;\nimport net.minecraft.client.gui.inventory.GuiInventory;\nimport net.minecraft.client.renderer.GlStateManager;\nimport net.minecraft.client.renderer.RenderHelper;\nimport net.minecraft.client.resources.I18n;\nimport net.minecraft.init.Blocks;\nimport net.minecraft.init.Items;\nimport net.minecraft.item.Item;\nimport net.minecraft.item.ItemStack;\nimport net.minecraft.potion.Potion;\nimport net.minecraft.potion.PotionEffect;\nimport net.minecraft.util.ResourceLocation;\nimport net.minecraft.util.text.TextFormatting;\nimport net.minecraftforge.fml.relauncher.Side;\nimport net.minecraftforge.fml.relauncher.SideOnly;\n\n@SideOnly(Side.CLIENT)\npublic abstract class AbstractMonsterGuiContainer extends GuiContainer{\n        protected static final DecimalFormat DECIMAL_FORMAT = new DecimalFormat(\"0.0\");\n    protected static final ResourceLocation BACKGROUND = new ResourceLocation(Reference.MODID, \"textures/gui/inventory_main.png\");\n    private static final ResourceLocation SIDE = new ResourceLocation(Reference.MODID, \"textures/gui/inventory_side.png\");\n    private static final ResourceLocation ICON = new ResourceLocation(Reference.MODID, \"textures/gui/inventory_icon.png\");\n    private static ItemStack BARRIER = new ItemStack(Blocks.BARRIER);\n    private static ScheduledExecutorService timer;\n    private static int taskPageIndex;\n    protected MonsterMainContainer container;\n    protected EntityCentaur monster;\n    private int guiId;\n    private int taskPageTotal;\n    private GuiButtonToggle togglePickup;\n    private GuiButtonToggle toggleHome;\n\n    public AbstractMonsterGuiContainer(MonsterMainContainer inventorySlotsIn, int guiId) {\n        super(inventorySlotsIn);\n        this.guiId = guiId;\n        this.container = inventorySlotsIn;\n        this.monster = container.monster;\n        this.taskPageTotal = (MonsterAPI.getTasks().size() - 1) / 6;\n    }\n\n\n    public abstract void drawCustomBackground(int mouseX, int mouseY, float partialTicks);\n\n\n    public abstract void drawCustomScreen(int mouseX, int mouseY, float partialTicks);\n\n\n    public abstract void drawCustomTooltips(int mouseX, int mouseY, float partialTicks);\n\n  \n    public abstract String getGuiName();\n\n    @Override\n    public void initGui() {\n       \n        this.buttonList.clear();\n        this.labelList.clear();\n\n        super.initGui();\n        int i = this.guiLeft;\n        int j = this.guiTop;\n\n \n \n        this.buttonList.add(new GuiButtonImage(BUTTON.MAIN.ordinal(), i + 6, j - 25, 22,\n                22, 234, 234, 0, BACKGROUND));\n        this.buttonList.add(new GuiButtonImage(BUTTON.INVENTORY.ordinal(), i + 34, j - 25, 22,\n                22, 234, 234, 0, BACKGROUND));\n\n   \n        GuiButtonImage leftSwitch = new GuiButtonImage(BUTTON.TASK_LEFT_SWITCH.ordinal(), i - 70, j + 150, 7,\n                11, 177, 0, 16, SIDE);\n        GuiButtonImage rightSwitch = new GuiButtonImage(BUTTON.TASK_RIGHT_SWITCH.ordinal(), i - 17, j + 150, 7,\n                11, 165, 0, 16, SIDE);\n        leftSwitch.visible = taskPageIndex > 0;\n        rightSwitch.visible = taskPageIndex < taskPageTotal;\n        this.buttonList.add(leftSwitch);\n        this.buttonList.add(rightSwitch);\n\n\n        for (int k = 0; k < 6; k++) {\n            if (k + taskPageIndex * 6 >= MonsterAPI.getTasks().size()) {\n                break;\n            }\n            if (MonsterAPI.getTasks().get(k + taskPageIndex * 6) == container.task) {\n                this.buttonList.add(new GuiButtonImage(k + BUTTON.values().length, i - 70, j + 23 + 21 * k, 60,\n                        20, 98, 0, 0, SIDE));\n            } else {\n                this.buttonList.add(new GuiButtonImage(k + BUTTON.values().length, i - 70, j + 23 + 21 * k, 60,\n                        20, 98, 20, 20, SIDE));\n            }\n        }\n\n        \n    }\n\n\n\n    @Override\n    public void drawScreen(int mouseX, int mouseY, float partialTicks) {\n        super.drawScreen(mouseX, mouseY, partialTicks);\n\n\n        this.drawCustomScreen(mouseX, mouseY, partialTicks);\n\n        int i = this.guiLeft;\n        int j = this.guiTop;\n        boolean xInRange;\n        boolean yInRange;\n\n\n        String currentModeName = TextFormatting.DARK_GRAY + I18n.format(container.task.getTranslation());\n        fontRenderer.drawString(currentModeName, (float) (i - 39 - fontRenderer.getStringWidth(currentModeName) / 2), j + 9, 0xffffff, false);\n        String pageText = String.format(\"%s%d/%d\", TextFormatting.DARK_GRAY, taskPageIndex + 1, this.taskPageTotal + 1);\n        fontRenderer.drawString(pageText, (float) (i - 39 - fontRenderer.getStringWidth(pageText) / 2), j + 151, 0xffffff, false);\n\n \n        for (int k = 0; k < 6; k++) {\n            if (k + taskPageIndex * 6 >= MonsterAPI.getTasks().size()) {\n                break;\n            }\n           IMonsterTask task = MonsterAPI.getTasks().get(k + taskPageIndex * 6);\n            drawItemStack(task.getIcon(), i - 68, j + 25 + 21 * k);\n            String name = I18n.format(task.getTranslation());\n            fontRenderer.drawString(name, i - 32 - fontRenderer.getStringWidth(name) / 2.0f, j + 29 + 21 * k, 0xdddddd, false);\n        }\n\n\n        mc.renderEngine.bindTexture(ICON);\n        drawModalRectWithCustomSizedTexture(i + 8, j + 170, 0, 0, 14, 14, 256, 256);\n        drawModalRectWithCustomSizedTexture(i + 29, j + 170, 14, 0, 14, 14, 256, 256);\n        drawModalRectWithCustomSizedTexture(i + 50, j + 170, 28, 0, 14, 14, 256, 256);\n        drawModalRectWithCustomSizedTexture(i + 71, j + 170, 42, 0, 14, 14, 256, 256);\n\n\n        for (int k = 2; k < 6; k++) {\n            drawItemStack(BARRIER, i + 49 + 21 * k, j + 169);\n        }\n\n\n        int spacing = 0;\n        Collection<PotionEffect> effects = monster.getActivePotionEffects();\n        for (PotionEffect effect : effects) {\n            if (effect.getDuration() <= 0) {\n                continue;\n            }\n\n            Potion potion = effect.getPotion();\n            int startX = i + 178 + getRenderPotionStartXOffset();\n            int startY = j + 5 + spacing;\n            spacing += 12;\n\n            GlStateManager.pushMatrix();\n            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);\n            GlStateManager.translate(startX, startY - 1.5, 0);\n            GlStateManager.scale(0.6, 0.6, 0.6);\n            this.mc.getTextureManager().bindTexture(INVENTORY_BACKGROUND);\n            if (potion.hasStatusIcon()) {\n                int index = potion.getStatusIconIndex();\n                this.drawTexturedModalRect(0, 0, index % 8 * 18, 198 + index / 8 * 18, 18, 18);\n            }\n            GlStateManager.popMatrix();\n            potion.renderInventoryEffect(i, j, effect, mc);\n            if (!potion.shouldRenderInvText(effect)) {\n                continue;\n            }\n            if (effect.getDuration() > 0) {\n                fontRenderer.drawString(String.format(\"%s %s %s %s%s\",\n                        effect.getPotion().isBadEffect() ? TextFormatting.RED : TextFormatting.RESET,\n                        I18n.format(effect.getEffectName()),\n                        I18n.format(\"enchantment.level.\" + (effect.getAmplifier() + 1)),\n                        TextFormatting.GRAY,\n                        Potion.getPotionDurationString(effect, 1.0f)\n                ), startX + 9, startY, 0xffffffff, true);\n            }\n        }\n\n       \n    }\n\n\n    @Override\n    protected void drawGuiContainerBackgroundLayer(float partialTicks, int mouseX, int mouseY) {\n        int i = this.guiLeft;\n        int j = this.guiTop;\n\n        this.drawDefaultBackground();\n\n        GlStateManager.color(1, 1, 1, 1);\n        mc.getTextureManager().bindTexture(BACKGROUND);\n        this.drawTexturedModalRect(i + 3, j - 28, 0, 193, 168, 32);\n\n\n        mc.getTextureManager().bindTexture(SIDE);\n        this.drawTexturedModalRect(i - 76, j, 0, 0, 89, this.ySize);\n\n\n        mc.getTextureManager().bindTexture(BACKGROUND);\n        this.drawTexturedModalRect(i, j, 0, 0, this.xSize, this.ySize);\n\n        drawCustomBackground(mouseX, mouseY, partialTicks);\n\n        mc.getTextureManager().bindTexture(BACKGROUND);\n        this.drawTexturedModalRect(i + 3 + 28 * (guiId - 1), j - 28, 28 * (guiId - 1), 224, 28, 32);\n\n\n        this.drawItemStack(Items.WRITABLE_BOOK.getDefaultInstance(), i + 9, j - 19);\n        this.drawItemStack(Item.getItemFromBlock(Blocks.CHEST).getDefaultInstance(), i + 37, j - 19);\n        this.drawItemStack(new ItemStack(Items.DYE, 1, 4), i + 65, j - 19);\n        this.drawItemStack(BARRIER, i + 93, j - 19);\n        this.drawItemStack(BARRIER, i + 121, j - 19);\n        this.drawItemStack(BARRIER, i + 149, j - 19);\n\n\n        ScaledResolution res = new ScaledResolution(mc);\n        double scaleW = mc.displayWidth / res.getScaledWidth_double();\n        double scaleH = mc.displayHeight / res.getScaledHeight_double();\n        GL11.glScissor((int) ((i + 26) * scaleW), (int) ((j + 87.5) * scaleH), (int) (49 * scaleW), (int) (70 * scaleH));\n        GL11.glEnable(GL11.GL_SCISSOR_TEST);\n        GuiInventory.drawEntityOnScreen(i + 51, j + 70, 28,\n                (float) (i + 51) - mouseX, (float) (j + 70 - 45) - mouseY, monster);\n        GL11.glDisable(GL11.GL_SCISSOR_TEST);\n    }\n\n \n    private void drawItemStack(ItemStack stack, int x, int y) {\n        RenderHelper.enableGUIStandardItemLighting();\n        GlStateManager.translate(0.0F, 0.0F, 32.0F);\n        this.zLevel = 200.0F;\n        this.itemRender.zLevel = 200.0F;\n        this.itemRender.renderItemAndEffectIntoGUI(stack, x, y);\n        this.zLevel = 0.0F;\n        this.itemRender.zLevel = 0.0F;\n        RenderHelper.disableStandardItemLighting();\n    }\n\n\n    abstract public int getRenderPotionStartXOffset();\n\n    @Override\n    public int getXSize() {\n        if (monster.getActivePotionEffects().size() <= 0) {\n            return super.getXSize() + getRenderPotionStartXOffset();\n        } else {\n            int i = 0;\n            for (PotionEffect effect : monster.getActivePotionEffects()) {\n                i += effect.getDuration();\n            }\n            if (i == 0) {\n                return super.getXSize() + getRenderPotionStartXOffset();\n            }\n            return super.getXSize() + 128 + getRenderPotionStartXOffset();\n        }\n    }\n\n \n\n    @Override\n    public void onGuiClosed() {\n\n        timer.shutdownNow();\n        super.onGuiClosed();\n    }\n\n\n    public enum BUTTON {\n\n        MAIN(MonsterGuiHandler.MainGui.MAIN.getId()),\n  \n        INVENTORY(MonsterGuiHandler.MainGui.INVENTORY.getId());\n\n \n        private int guiId;\n\n \n        BUTTON(int guiId) {\n            this.guiId = guiId;\n        }\n\n        public int getGuiId() {\n            return guiId;\n        }\n    }\n        \n\n}\n复制代码\n\n麻煩了!!",
    "replies": [
        {
            "author": "3TUSK",
            "timestamp": 1588698900,
            "txt_content": "你的 EntityCentaur.class 没有调用 EntityPlayer#openGui。参考这个：\nhttps://github.com/TartaricAcid/ ... Maid.java#L672-L689"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588700400,
            "txt_content": "3TUSK 发表于 2020-5-6 01:15\n你的 EntityCentaur.class 没有调用 EntityPlayer#openGui。参考这个：\nhttps://github.com/TartaricAcid/T ...\n我調用他的processinteract還是一樣沒有效果，我覺得我需要一個最簡單的範例讓我能搞清楚其原理，非常感謝大大幫忙。"
        },
        {
            "author": "hanbofeng",
            "timestamp": 1588715460,
            "txt_content": "？看不懂"
        },
        {
            "author": "飞翔之歌",
            "timestamp": 1588726200,
            "txt_content": "你是想往机器里塞东西吗？\n使用Capability\n你的自制怪物又不是玩家，何来的打开GUI?"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588730040,
            "txt_content": " 本帖最后由 lycorisrad 于 2020-5-6 09:59 编辑 \n飞翔之歌 发表于 2020-5-6 08:50\n你是想往机器里塞东西吗？\n使用Capability\n你的自制怪物又不是玩家，何来的打开GUI? ...\n\n我是想讓自製怪物可以像原版的馬一樣，按shift+右鍵可以打開物品欄或是功能鍵，但是弄不出來，我不知道entity. Class應該放什麼東西，或是我少加了哪些class，還是感謝回答。"
        },
        {
            "author": "飞翔之歌",
            "timestamp": 1588732320,
            "txt_content": "lycorisrad 发表于 2020-5-6 09:54\n我是想讓自製怪物可以像原版的馬一樣，按shift+右鍵可以打開物品欄或是功能鍵，但是弄不出來，我不知道en ...\n你需要添加一个GUI\n思路是：\n监听玩家互动事件，如果被互动的对象是你的怪物，就打开GUI。"
        },
        {
            "author": "MaxSeth",
            "timestamp": 1588733280,
            "txt_content": " 本帖最后由 12356789onetwo 于 2020-5-6 10:53 编辑 \n\nEntity类里有个叫processInitialInteract的方法，覆写这个方法应该就能在右键时候打开gui"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588734060,
            "txt_content": "飞翔之歌 发表于 2020-5-6 10:32\n你需要添加一个GUI\n思路是：\n监听玩家互动事件，如果被互动的对象是你的怪物，就打开GUI。\n\n對我已經有寫出Gui的class了，然後照你的思路是指這串代碼嗎？如果是的話我試過了還是沒有用。我不知道是怎麼回事，還是感謝幫忙，我試試看打掉重寫一遍。\n\n@Override\n    public boolean processInteract(EntityPlayer player, @Nullable EnumHand hand) {\n        // 必须是主手\n        if (hand == EnumHand.MAIN_HAND) {\n            boolean isYourMaid = this.isTamed() && this.getOwnerId() != null && this.getOwnerId().equals(player.getUniqueID());\n            ItemStack itemstack = player.getHeldItem(hand);\n            if (isYourMaid) {\n                // 事件系统实现更清晰的交互\n                // 利用短路原理，逐个触发对应的交互事件\n                return MinecraftForge.EVENT_BUS.post(new InteractMaidEvent(player, this, itemstack))\n                        || itemstack.interactWithEntity(player, this, EnumHand.MAIN_HAND)\n                        || openMaidGui(player);\n            } else {\n                return tamedMaid(itemstack, player);\n            }\n        }\n        return false;\n    }\n\n/**\n     * 打开 GUI\n     *\n     * @return 该逻辑是否成功应用\n     */\n    private boolean openMaidGui(EntityPlayer player) {\n        // 否则打开 GUI\n        if (!world.isRemote) {\n            player.openGui(TouhouLittleMaid.INSTANCE, MaidGuiHandler.MAIN_GUI.MAIN.getId(), world, this.getEntityId(), LittleMaidAPI.getTasks().indexOf(task), 0);\n        }\n        return true;\n    }\n"
        },
        {
            "author": "飞翔之歌",
            "timestamp": 1588734420,
            "txt_content": "lycorisrad 发表于 2020-5-6 11:01\n對我已經有寫出Gui的class了，然後照你的思路是指這串代碼嗎？如果是的話我試過了還是沒有用。我不知道是 ...\n思路就是这个了\n如果你是在开发环境测试的，那么请重新召唤一个测试。因为名字会变（Forge使用的是随机名字/UUID）"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588734540,
            "txt_content": "12356789onetwo 发表于 2020-5-6 10:48\nEntity类里有个叫processInitialInteract的方法，覆写这个方法应该就能在右键时候打开gui ...\n謝謝幫忙，你的意思是說entity.class要實現觸發gui，重點就是這個processInteract函數嗎？也就是說任何mob或是entity只要加上這個函數就可以打開任何gui？"
        },
        {
            "author": "飞翔之歌",
            "timestamp": 1588734900,
            "txt_content": "lycorisrad 发表于 2020-5-6 11:09\n謝謝幫忙，你的意思是說entity.class要實現觸發gui，重點就是這個processInteract函數嗎？也就是說任何mo ...\n不不不。\n这个函数会在实体被右键时调用。\n你可以借此打开GUI"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588734900,
            "txt_content": " 本帖最后由 lycorisrad 于 2020-5-6 11:16 编辑 \n飞翔之歌 发表于 2020-5-6 11:07\n思路就是这个了\n如果你是在开发环境测试的，那么请重新召唤一个测试。因为名字会变（Forge使用的是随机名 ...\n\n非常感謝幫忙我已經抓到重點了，因為我以為entity. Class還要加一些其他東西才能實現觸發gui。但我照搬女僕作者的代碼還是沒法實現，可能需要再改一些東西。"
        },
        {
            "author": "飞翔之歌",
            "timestamp": 1588735020,
            "txt_content": "lycorisrad 发表于 2020-5-6 11:15\n非常感謝幫忙我已經抓到重點了，因為我以為entity. Class還要加一些其他東西才能實現觸發gui。但我照搬女 ...\nEntityPlayer.openGUI();可以用于打开GUI"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588735260,
            "txt_content": "飞翔之歌 发表于 2020-5-6 11:17\nEntityPlayer.openGUI();可以用于打开GUI\n我懂了就是下面這代碼的方法，可以打開自己設計的gui，另外還有一個問題想問，如果怪物用蛋生不出來是為什麼？是錯誤嗎？還是要重開世界。\n\n/**\n     * 打开 GUI\n     *\n     * @return 该逻辑是否成功应用\n     */\n    private boolean openMaidGui(EntityPlayer player) {\n        // 否则打开 GUI\n        if (!world.isRemote) {\n            player.openGui(TouhouLittleMaid.INSTANCE, MaidGuiHandler.MAIN_GUI.MAIN.getId(), world, this.getEntityId(), LittleMaidAPI.getTasks().indexOf(task), 0);\n        }\n        return true;\n    }"
        },
        {
            "author": "3TUSK",
            "timestamp": 1588738680,
            "txt_content": "lycorisrad 发表于 2020-5-6 11:21\n我懂了就是下面這代碼的方法，可以打開自己設計的gui，另外還有一個問題想問，如果怪物用蛋生不出來是為 ...可以打開自己設計的gui\n其实我一开始就提到了 EntityPlayer#openGui 来着。你往下翻一点就能看到了……\n\n\n\n怪物蛋刷不出怪可能是因为你注册实体的时候没有考虑进去蛋。\n\n@SubscribeEvent\npublic static void registerEntity(RegistryEvent.Register<EntityEntry> event) {\n  event.getRegistry().register(EntityEntryBuilder.create()\n    .entity(MyEntity.class)\n    .id(new ResourceLocation(\"my_mod_id\", \"my_entity_id\"), 1)\n    .name(\"my_entity_name\")\n    .tracker(16, 80, true)\n    .egg(0x00FF00, 0x0000FF) // 第一个是 primary color，第二个是 secondary color，两个共同决定刷怪蛋什么颜色。格式是 RGB。\n    .build());\n}复制代码"
        },
        {
            "author": "lycorisrad",
            "timestamp": 1588741140,
            "txt_content": " 本帖最后由 lycorisrad 于 2020-5-6 13:00 编辑 \n3TUSK 发表于 2020-5-6 12:18\n其实我一开始就提到了 EntityPlayer#openGui 来着。你往下翻一点就能看到了……\n\n\n\n\n對我知道，因為我本身就是仿照女僕作者寫的entity. Class所以他那串我其實有看到，只是不懂他的邏輯，還有我套用他的那串代碼也沒有效果，所以我不知道打開gui的關鍵點在哪。\n最後即使我都打好了就變成我怪物生不出來，所以蠻苦惱的，已經有一個禮拜都找不到方法，快放棄了QWQ\n還好你有解答我要不然卡蠻久的，真的非常感謝你寫這麼詳細，我回去試試看。"
        }
    ]
}