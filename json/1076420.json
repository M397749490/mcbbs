{
    "title": "[原创][装饰][BN]autoFireWork自动放烟花——让服务器拥有绚烂的天空[python编写]",
    "author": "超神的冰凉",
    "replyCount": 4,
    "timestamp": 1594474980,
    "txt_content": "AutoFireWork\n高度自定义的烟花装饰插件\n插件功能：\n高度自定义的烟火装饰! 可以自定义燃放频率，燃放位置，烟花飞行时间，烟花颜色，烟花形状，烟花轨迹和是否闪烁\n全开源，高效运行，流畅不卡服\n如何安装：\n1、首先正确安装BlocklyNukkit，下载链接https://www.mcbbs.net/thread-987302-1-1.html\n2、安装其python模块（本插件由纯python编写），使用命令\nbninstall python复制代码3、等待安装完毕，可能需要消耗1-2分钟时间，过程全自动\n4、下载本帖附件中的jar包，放到服务器插件目录下，重启服务器即可\n5、安装本插件后bn解释器启动会有6-7秒卡顿，属正常现象，因为bn解释器正在初始化python到java字节码的jit编译器\n如何使用：\n\n命令：\nfire 间隔tick 烟花规则  ->新建一个燃放规则fire remove ->打开移除规则gui命令权限节点autoFireWork.All，默认op\n如何编写烟花规则：\n烟花规则是由英文分号;连缀逻辑组件表达式，项数是1到6项位置逻辑组件，用于标识烟花的燃放位置，不存在默认在主世界重生点燃放，格式为pos:x:y:z:世界名复制代码\n颜色逻辑组件，用于标识烟花爆炸产生的粒子的颜色，不存在系统随机取颜色，格式为color:颜色\n/* 可选的颜色\n *  black red green brown blue purple cyan \n *  lightgrey grey pink lightyellow yellow lightblue\n *  magenta orange white\n */复制代码\n闪烁逻辑组件，用于标识烟花爆炸之后粒子是否闪烁，没有参数，存在即代表闪烁，不存在代表不闪烁，格式为flick复制代码\n轨迹逻辑组件，用于标识烟花是否拖着一串粒子轨迹上天，没有参数，存在即代表有，不存在代表无，格式为trail复制代码\n时间逻辑组件，用于标识烟花飞多久爆炸，没有则随机取时间格式为time:时间enum\n/*\n * 时间enum可取的值只能是0,1,2\n * 分别代表短，一般，长\n */复制代码\n形状逻辑组件，用于标识烟花爆炸之后的形状，没有则随机取形状，格式为shape:形状\n/*\n * 形状的可用值为：\n * smallball bigball star creeper burst\n */复制代码\n例如命令 fire 10 pos:5:64:6:myworld;trail;shape:creeper\n\n在myworld世界每10tick（0.5秒）燃放一个带有轨迹颜色随机飞行时间随机不闪烁的苦力怕型烟花\n例如命令 fire 15 trail;flick;color:orange;time:2\n在默认主世界重生点每15tick（0.75秒）燃放一个橙色带有轨迹和爆炸闪烁飞行时间长形状随机的烟花\n源代码：\n\n\n# -*- coding: UTF-8 -*-\n# pragma Python\nimport json\nimport random\nimport cn.nukkit.level.Position as POS\n\ndef isChinese():\n    return u\"中文\" in server.getLanguage().getName()\n\nlogger.info(u\"自动烟花插件加载完成\" if isChinese() else u\"autoFireWork plugin successfully loaded!\")\nmanager.createPermission(\"autoFireWork.All\",\"autoFireWork Permission\",\"OP\")\nmanager.createCommand(\"fire\",u\"自动烟花设置\" if isChinese() else u\"autoFireWork settings\",\"autoFireWorkCall\",\"autoFireWork.All\")\n\ntext = manager.readFile(\"./plugins/autoFireWork/config.json\")\nif text == \"FILE NOT FOUND\":\n    manager.writeFile(\"./plugins/autoFireWork/config.json\",\"[]\")\n    text = \"[]\"\nconfig = json.loads(text)\nmanager.createLoopTask(\"dotickFireWork\",1)\n\ndef dotickFireWork(tick):\n    for entry in config:\n        if tick%entry['interval'] == 0:\n            mkfirewordk(entry['rule'])\n\ndef mkfirewordk(ruleEntry):\n    ruleEntry = ruleEntry.replace(\" \",'')\n    group = ruleEntry.split(\";\")\n    pos = server.getDefaultLevel().getSpawnLocation()\n    color = random.randint(0,15)\n    flick = False\n    trail = False\n    shape = random.randint(0,4)\n    time = random.randint(0,3)\n    for each in group:\n        if each.startswith('pos'):\n            each = each.replace(\"pos:\",\"\")\n            tmpgroup = each.split(\":\")\n            pos = POS.fromObject(manager.buildvec3(float(tmpgroup[0]),float(tmpgroup[1]),float(tmpgroup[2])),server.getLevelByName(tmpgroup[3]))\n        elif each.startswith('color'):\n            each = each.replace(\"color:\",\"\").replace(\"black\",\"0\").replace('red',\"1\").replace('green','2').replace(\"brown\",'3').replace(\"blue\",'4').replace(\"purple\",\"5\")\n            each = each.replace(\"cyan\",\"6\").replace(\"lightgrey\",\"7\").replace(\"grey\",\"8\").replace('pink','9').replace('lightyellow','10').replace('yellow','11').replace('lightblue','12')\n            each = each.replace(\"magenta\",'13').replace(\"orange\",'14').replace('white','15')\n            color = int(each)\n        elif each == 'flick':\n            flick = True\n        elif each == \"trail\":\n            trail = True\n        elif each.startswith(\"shape\"):\n            each = each.replace(\"shape:\",\"\").replace('smallball',\"0\").replace(\"bigball\",'1').replace(\"star\",\"2\").replace('creeper','3').replace(\"burst\",'4')\n            shape = int(each)\n        elif each.startswith(\"time\"):\n            each = each.replace(\"time:\",\"\")\n            time = int(each)\n    particle.drawFireWork(pos,color,flick,trail,shape,time)\n\ndef removecall(event):\n    ruleentry = window.getEventCustomVar(event, 1, \"dropdown\").replace(u'；',';')\n    pl = event.getPlayer()\n    for x in config:\n        if ruleentry == x['rule']:\n            config.remove(x)\n            pl.sendMessage(u\"§a规则\"+ruleentry+u\"成功移除\" if isChinese() else u\"§arule \"+ruleentry+u\" has been removed\")\n            manager.writeFile(\"./plugins/autoFireWork/config.json\",json.dumps(config))\n\n\ndef autoFireWorkCall(sender,args):\n    if not sender.isOp():\n        sender.sendMessage(u\"§c你没有权限使用此命令\" if isChinese() else u\"§cYou do not have the permission to use this command\")\n        return\n    if len(args)<1:\n        sender.sendMessage(u\"§c命令参数太少了\" if isChinese() else u\"§cToo few arguments!\")\n        return\n    if args[0] == \"delete\" or args[0] == 'remove':\n        bd = window.getCustomWindowBuilder(u'移除自动烟花规则' if isChinese() else u'remove autoFireWork rules')\n        bd.buildLabel(u'选择一条规则进行移除' if isChinese() else \"Select a rule to remove\")\n        bd.buildDropdown(u'自动烟花规则' if isChinese() else u'autoFireWork rules',''.join(i['rule'].replace(\";\",u\"；\")+\";\" for i in config))\n        bd.showToPlayer(server.getPlayer(sender.getName()),'removecall')\n    else:\n        rules = args[1] if len(args)>1 else \"\"\n        config.append({\"interval\":int(args[0]),\"rule\":rules})\n        manager.writeFile(\"./plugins/autoFireWork/config.json\",json.dumps(config))\n        sender.sendMessage(u\"§a成功添加新的自动烟花规则！\" if isChinese() else u\"§aSuccessfully added a new autoFireWork rule!\")\n\n\n\n\n\n下载：\n\n\n\nautoFireWork-1.0.0.jar\n(4.27 KB, 下载次数: 27)\n\n\n\n2020-7-11 21:41 上传\n点击文件名下载附件\n\n\n\n\n\n\n预览图：\n\n\n\n\n\n\n批注 2020-07-11 154424.png (94.24 KB, 下载次数: 3)\n\n下载附件\n\n2020-7-11 21:42 上传\n\n\n\n\n\n如果您的服务器预设语言为中文，窗口文字将自动变为中文\n\n\n\n\n批注 2020-07-11 154351.png (88.01 KB, 下载次数: 5)\n\n下载附件\n\n2020-7-11 21:42 上传\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "52648496",
            "timestamp": 1594478040,
            "txt_content": "厉害了，我的冰凉(ง •̀_•́)ง"
        },
        {
            "author": "catrinbow",
            "timestamp": 1594946280,
            "txt_content": "高自定义烟花，支持一下"
        },
        {
            "author": "祈葬",
            "timestamp": 1604411640,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "王~",
            "timestamp": 1609750200,
            "txt_content": "python有用了，支持楼主"
        }
    ]
}