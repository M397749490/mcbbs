{
    "title": "请问如何在MOD中修改角色的属性",
    "author": "380465530",
    "replyCount": 14,
    "timestamp": 1366282140,
    "txt_content": "我想修改角色的经验，可是表面上是修改了，但是保存后再进来，角色经验并没有被修改。\n\n我修改经验调用的代码是\nMinecraft(的对象).thePlayer.addExperience();\n据我分析thePlayer对象只是用来显示的表象，真正生效的数值储存并不是它。\n在这我想请教一下高手有没有什么办法可以修改。\n\n\n我想给小地图插件增加瞬移功能。\n在小地图的标记点编辑界面增加了一个瞬移按钮。\n当瞬移按钮被单击时，调用那个函数。（先拿增加经验做实验。免得坐标算错了跳到陌生的地方。）\n不知道修改那个对象的属性或者调用哪个方法可以让数据生效，请高手指点迷津。\n",
    "replies": [
        {
            "author": "hendyzone",
            "timestamp": 1366295400,
            "txt_content": "楼主的意思是在gui上点击按钮然后改变角色的属性？\n那么你首先需要获取到要改变的角色EntityPlayer的实例\n然后直接修改就行\n当然在gui上操作的话还有个同步的问题lz不要忘了=.=\n(怎么觉得这个帖子之见过)"
        },
        {
            "author": "380465530",
            "timestamp": 1366334580,
            "txt_content": "hendyzone 发表于 2013-4-18 22:30 \n楼主的意思是在gui上点击按钮然后改变角色的属性？\n那么你首先需要获取到要改变的角色EntityPlayer的实例\n ...\n我在别的区发过帖子，结果被删了，还扣了我的分，新人伤不起啊。\n对啊对啊困扰我的似乎就是这个同步问题，EntityPlayer很好找，但是我不知道怎么同步。\n当我修改了坐标后，在gui关闭之前，坐标都是改的，但是在gui关闭之后，坐标又自动回来了。\n\n我后来又尝试修改经验，表面上看是修改了，但是在杀怪之后，经验又变回来了。\n\n问题似乎就是数据同步问题。"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366345500,
            "txt_content": "380465530 发表于 2013-4-19 09:23 \n我在别的区发过帖子，结果被删了，还扣了我的分，新人伤不起啊。\n对啊对啊困扰我的似乎就是这个同步问题 ...\n在gui操作只会改变客户端的数据 需要通过包传递数据到服务端=。=\n基本步骤就是 在@network里加上Packethandle=niiT使用的定义包处理类 以及channel={\"\"线程名称}\n然后建立一个包处理类（就是实现IPackethandle接口的）\n再详细的就去看看forge的wiki或者其他人的代码\n 我语死早。。。"
        },
        {
            "author": "380465530",
            "timestamp": 1366368360,
            "txt_content": "hendyzone 发表于 2013-4-19 12:25 \n在gui操作只会改变客户端的数据 需要通过包传递数据到服务端=。=\n基本步骤就是 在@network里加上Packeth ...\n只有自己玩也要这么处理么？"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366368600,
            "txt_content": "380465530 发表于 2013-4-19 18:46 \n只有自己玩也要这么处理么？\n是的 你本身在玩的时候也是在服务器上 1.3之后都是这样了╮(￣▽￣\")╭"
        },
        {
            "author": "380465530",
            "timestamp": 1366373760,
            "txt_content": " 本帖最后由 380465530 于 2013-4-19 20:17 编辑 \nhendyzone 发表于 2013-4-19 18:50 \n是的 你本身在玩的时候也是在服务器上 1.3之后都是这样了╮(￣▽￣\")╭\nMinecraftServer.java\n里的这几句是不是就是储存角色数据的地方。\n            theProfiler.startSection(\"save\");\n            serverConfigManager.saveAllPlayerData();\n            saveAllDimensions(true);\n            theProfiler.endSection();\n不知道我在修改角色信息之后调用这几句储存数据行不行。\n"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366374060,
            "txt_content": "380465530 发表于 2013-4-19 20:16 \nMinecraftServer.java\n里的这几句是不是就是储存角色数据的地方。\n            theProfiler.startSecti ...\n{:10_493:}\n不能你说错了。。。\n但是你如果调用这个也不过是再把原本的数据再存一遍 没把客户端的数据同步上去"
        },
        {
            "author": "380465530",
            "timestamp": 1366374480,
            "txt_content": "hendyzone 发表于 2013-4-19 20:21 \n不能你说错了。。。\n但是你如果调用这个也不过是再把原本的数据再存一遍 没把客户端的数据同 ...\nMinecraftServer.java\n和Minecraft.java\n应该有同步数据的部分吧。要么原生的数据交互是怎么完成的。我找到原生的同步数据代码调用一下应该就能实现上传数据了吧，因为我不需要上传什么特殊的数据到服务器，只是想把当前thePlayer保存一下。"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366375380,
            "txt_content": "380465530 发表于 2013-4-19 20:28 \nMinecraftServer.java\n和Minecraft.java\n应该有同步数据的部分吧。要么原生的数据交互是怎么完成的。我 ...\npacket是minecraft用来同步数据的工具 话说我前面已经说过了= ="
        },
        {
            "author": "380465530",
            "timestamp": 1366376100,
            "txt_content": "hendyzone 发表于 2013-4-19 20:43 \npacket是minecraft用来同步数据的工具 话说我前面已经说过了= =\n嗯，对的，由于我之前从没接触过mc代码。只是一边看一边理解。\n您说的@network我暂时还不知道它是个什么玩意。\n包处理类好像有现成的，我找到了NetClientHandler.java里的\npublic void handleEntityTeleport(Packet34EntityTeleport par1Packet34EntityTeleport)\n方法，它应该就是处理包进行瞬移的。\n剩下的就是怎么去触发这个处理程序了对吧。"
        },
        {
            "author": "380465530",
            "timestamp": 1366376340,
            "txt_content": "hendyzone 发表于 2013-4-19 20:43 \npacket是minecraft用来同步数据的工具 话说我前面已经说过了= =\n好像不对，我找到的是处理客户端收到的包的处理程序，您说的应该是组织包然后上传到服务器的处理程序对吧。"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366376880,
            "txt_content": "380465530 发表于 2013-4-19 20:59 \n好像不对，我找到的是处理客户端收到的包的处理程序，您说的应该是组织包然后上传到服务器的处理程序对吧 ...\nNetClientHandler内的处理大部分都是对于原版\n我们需要通过实现一个继承于自制包的类将需要传递的数据放在这个包里传递给服务器\n而包处理程序是接受到包之后进行的动作 当然这个包本身是可以从客户端传递到服务端也可以从客户端 传递到服务端\n、、、其实有具体的代码的话应该很好理解的。。。你去找找饮水mod的源码看看"
        },
        {
            "author": "380465530",
            "timestamp": 1366377120,
            "txt_content": "hendyzone 发表于 2013-4-19 21:08 \nNetClientHandler内的处理大部分都是对于原版\n我们需要通过实现一个继承于自制包的类将需要传递的数据放 ...\n好的谢谢你，我再研究研究。\n我的这次修改应该不需要使用自制的包，找到储存角色实体的包，构造一个对象传到服务器应该就可以了，一切应该都有现成的代码，只是没有找到而已。"
        },
        {
            "author": "hendyzone",
            "timestamp": 1366377600,
            "txt_content": "380465530 发表于 2013-4-19 21:12 \n好的谢谢你，我再研究研究。\n我的这次修改应该不需要使用自制的包，找到储存角色实体的包，构造一个对象 ...\n在客户端和服务端之间建立连接的方法只有包。。。 或者你的操作本身在两端会同步"
        }
    ]
}