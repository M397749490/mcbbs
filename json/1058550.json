{
    "title": "服务器cpu吃满，疑似某个mod卡线程",
    "author": "lengshao233",
    "replyCount": 23,
    "timestamp": 1591589580,
    "txt_content": " 本帖最后由 lengshao233 于 2020-6-8 13:51 编辑 \n\n简单说明一下情况：正常服务器开着的时候，\n\n\n\n\nimage.png (20.53 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:00 上传\n\n\n\n\n正常是这样的，有时候会变得不正常（随缘变的，可能5分钟后，可能5小时后）\n\n\n\n\nimage.png (43.56 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:01 上传\n\n\n\n\n这个是不正常时的，不正常时tps会暴跌，可能是机子原本可以完全承受服务器的性能，但因为某种原因，吃满了cpu，承受不住了，所以掉tps，服务器，每次重启后又会恢复正常，当然随缘的cpu满载会导致tps低，一些有用的信息如下：正常时的gc数据：\n\n\n\n\nimage.png (22.46 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:05 上传\n\n\n\n\n不正常时的gc数据：\n\n\n\n\nimage.png (24.14 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 13:43 上传\n\n\n\n\n\n正常时的timings：https://timings.aikar.co/?id=7de986edb9e0430b967f8fbe50815cf2 不正常的timings：https://timings.aikar.co/?id=8a34dd4a56404aa29a7ebf54e44a3a48\n\n正常时的spark：https://spark.lucko.me/#JqtdRA08RD 不正常时的spark：https://spark.lucko.me/#0ylQkgZfPB\n\n正常时用jdk的jstack打出来的线程文件：https://paste.ubuntu.com/p/2bWTg4MGxc/ 不正常时用jdk的jstack打出来的线程文件：https://paste.ubuntu.com/p/qGJcQBbJB6/\n正常时的任务管理器进程图\n\n\n\n\nimage.png (19.36 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:11 上传\n\n\n\n\n不正常时任务管理器的进程图：\n\n\n\n\nimage.png (10.45 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 13:45 上传\n\n\n\n\n\n重要信息就是以上几点了，跪求大佬帮忙，已经联系几周都是这样子了，只能一天重启n次，治标不治本如果怀疑玩家进行过什么了的话，我一个一个查过房了，没出现过什么异常举动\n服务器mods文件夹截图：\n\n\n\n\nfile_1591589620000.jpg (64.41 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:14 上传\n\n\n\n\n\n\n\n\nimage.png (302.55 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:15 上传\n\n\n\n\n\n\n\n\nimage.png (285.67 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:15 上传\n\n\n\n\n\n\n\n\nimage.png (284.55 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:15 上传\n\n\n\n\n\n\n\n\nimage.png (273.41 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 12:15 上传\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "结城希亚",
            "timestamp": 1591589640,
            "txt_content": "都很正常\n\n暂时无\n三个数据一个都没，你觉得能看出什么呢"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591589760,
            "txt_content": "结城希亚 发表于 2020-6-8 12:14\n都很正常\n大佬，等一下吧，我刚刚重启，他随缘来的，我也不确定什么时候可以补上"
        },
        {
            "author": "结城希亚",
            "timestamp": 1591589940,
            "txt_content": "lengshao233 发表于 2020-6-8 12:16\n大佬，等一下吧，我刚刚重启，他随缘来的，我也不确定什么时候可以补上 ...\nzy世界的区块有点异常\n占用挺高\n\n\n看起来是什么填充"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591590120,
            "txt_content": "结城希亚 发表于 2020-6-8 12:19\nzy世界的区块有点异常\n占用挺高\n\n\n我让玩家去一趟zy世界看看吧，看看会不会触发cpu满载"
        },
        {
            "author": "The_jimeng",
            "timestamp": 1591590420,
            "txt_content": "Emmmm为什么 都是正常的报告  然而这样怎么处理呢  建议整理一下错误报告！"
        },
        {
            "author": "本诺先森",
            "timestamp": 1591590780,
            "txt_content": "mek的管道  传物品的那个ban了吗？？\n还有工业的分拣器 ban了吗\n工业的区块加载ban了吗\n\n这些都是非常占用u的机器"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591594980,
            "txt_content": " 本帖最后由 lengshao233 于 2020-6-8 14:03 编辑 \n\n大佬们，开始了\n\n\n\n\nimage.png (69.82 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 13:43 上传\n\n\n\n\n\n对了，还有一个信息，就是我用lagassist的区块排行榜看了一下，发现zy世界的某个区块吃了很大数据，于是我直接重置了一次资源世界，发现tps回到了17，但后台cpu还是一样吃满\n\n\n\n\nimage.png (45.74 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 14:03 上传\n\n\n\n\n\n\n\n\nimage.png (24.03 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-8 14:03 上传\n\n\n\n\n\n"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591595280,
            "txt_content": "@EmptyLava @结城希亚 @本诺先森 @The_jimeng 大佬们，cpu满载了，不正常的信息全部放上去了，求救啊"
        },
        {
            "author": "木木啧啧",
            "timestamp": 1591599000,
            "txt_content": "尝试提高服务器内存 设置为最大13G 最小13G"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591608300,
            "txt_content": "激萌的萌 发表于 2020-6-8 14:50\n尝试提高服务器内存 设置为最大13G 最小13G\n大哥，并不关内存问题"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1591610520,
            "txt_content": "\n\n离谱的区块占用\nnet.minecraft.world.gen.ChunkProviderServer.originalGetChunkAt()45.78%\nnet.minecraft.world.gen.ChunkProviderServer.func_186028_c()23.34%\nnet.minecraft.world.gen.ChunkProviderServer.loadChunk()23.34%\nnet.minecraftforge.common.chunkio.ChunkIOExecutor.syncChunkLoad()23.34%\nnet.minecraftforge.common.chunkio.ChunkIOProvider.run()23.34%\nnet.minecraft.world.chunk.storage.AnvilChunkLoader.loadChunk__Async()23.27%\nnet.minecraft.world.chunk.storage..getChunkInputStreamCB()23.27%\njava.lang.Object.notifyAll()0.06%\nnet.minecraft.world.chunk.Chunk.populateCB()19.12%\nnet.minecraft.world.chunk.Chunk.func_186034_a()19.05%\nco.aikar.timings.TimedChunkGenerator.func_185931_b()8.89%\nnet.minecraftforge.fml.common.registry.GameRegistry.generateWorld()8.12%508ms\n\n以及服务器数据包传输\nnet.minecraft.network.play.client.CPacketPlayer.func_148833_a()11.51%\n\n\n区块那个看不来，可能是区块加载\n有没有保存世界的插件之类的？"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591626780,
            "txt_content": "EmptyLava 发表于 2020-6-8 18:02\n离谱的区块占用\n\n\n\n有自动备份插件，是那个的问题吗？"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591762800,
            "txt_content": "EmptyLava 发表于 2020-6-8 18:02\n离谱的区块占用\n我删除备份插件后一天，还是会出现那种问题，但感觉出现的频率小了很多"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1591762860,
            "txt_content": "lengshao233 发表于 2020-6-10 12:20\n我删除备份插件后一天，还是会出现那种问题，但感觉出现的频率小了很多 ...\n那暂时就这样吧\n你服务器区块文件有多大呢"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591767660,
            "txt_content": "EmptyLava 发表于 2020-6-10 12:21\n那暂时就这样吧\n你服务器区块文件有多大呢\n不算其他世界有2g多最大的一个区块文件8000kb"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591767720,
            "txt_content": "EmptyLava 发表于 2020-6-10 12:21\n那暂时就这样吧\n你服务器区块文件有多大呢\n还有个问题，虽然tps不怎么掉了，但\n\n\n\n\nimage.png (74.44 KB, 下载次数: 0)\n\n下载附件\n\n2020-6-10 13:42 上传\n\n\n\n\ncpu一直处于快满载快满载的情况"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1591767840,
            "txt_content": "lengshao233 发表于 2020-6-10 13:42\n还有个问题，虽然tps不怎么掉了，但cpu一直处于快满载快满载的情况\ntps高，那不就说明cpu用到了吗..\n\n这个占用我觉得是正常的，如果你不觉得话再发一次spark"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591767900,
            "txt_content": "EmptyLava 发表于 2020-6-10 13:44\ntps高，那不就说明cpu用到了吗..\n\n这个占用我觉得是正常的，如果你不觉得话再发一次spark ...\n好，这个占用还是有点奇怪，就像之前cpu满载的情况那样，但又不满载"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591768140,
            "txt_content": "https://spark.lucko.me/#Owptm60ekm"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591768200,
            "txt_content": "EmptyLava 发表于 2020-6-10 12:21\n那暂时就这样吧\n你服务器区块文件有多大呢\nhttps://spark.lucko.me/#Owptm60ekm"
        },
        {
            "author": "lengshao233",
            "timestamp": 1591799340,
            "txt_content": "EmptyLava 发表于 2020-6-10 13:44\ntps高，那不就说明cpu用到了吗..\n\n这个占用我觉得是正常的，如果你不觉得话再发一次spark ...\n不行不行不行，还是会出现100%cpu满载的问题，求救啊大佬"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1591829700,
            "txt_content": "lengshao233 发表于 2020-6-10 13:50\nhttps://spark.lucko.me/#Owptm60ekm\nspark的数据是正常了\n\n但是这里似乎有1/3的时间主线程都在休眠\njava.lang.Thread.sleep()39.66%\n\n先不用管，因为你服务器tps高，要等接下来满载的时候spark数据"
        },
        {
            "author": "lengshao233",
            "timestamp": 1592106660,
            "txt_content": "从墨端更换到cat端后已解决，疑似墨端与某种mod或插件冲突"
        }
    ]
}