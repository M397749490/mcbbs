{
    "title": "关于Forge with Minecraft 1.8（1.8.9）的一些物品和方块的注册机制的名称解读",
    "author": "土球球",
    "replyCount": 4,
    "timestamp": 1456223880,
    "txt_content": " 本帖最后由 ustc_zzzz 于 2016-2-23 18:49 编辑 \n\n本人最近经常看到一些人因为物品、方块等的注册名称而迷惑，而Minecraft 1.8引入的全新的BlockState系统，使得这种迷惑进一步加剧，所以本人就想发一个关于物品和方块的注册名称解读的帖子，苦于没有时间并且本人的拖延症又犯了=_=||所以直到今日才开帖。\n本部分内容是关于Forge with Minecraft 1.8（当然还有1.8.9）的，1710党可以退散了→_→\n\n引言：\n很多Mod开发教程（包括我的教程）都没有把各种注册名称说清楚，而是采取了一种偷懒的方法，也就是把各种名称都设置成一样的。这就导致了相当一部分人在注册物品和方块的时候心里是异常困惑的：这些名称都TM是什么玩意啊(╯°口°)╯︵┴─┴比如下面最简单的注册方块的步骤：\n我们先注册这个方块：GameRegistry.registerBlock(block, blockname);我们再注册关于这个方块的渲染：Minecraft.getMinecraft().getRenderItem().getItemModelMesher().register(Item.getItemFromBlock(block), 0, new ModelResourceLocation(modid + \":\" + blockname, \"inventory\"));方块内部还有一个setUnlocalizedName：block.setUnlocalizedName(blockname);好了现在我们开始写json了，首当其冲的是新建一个blockstates文件：assets/modid/blockstates/blockname.json这个blockstates文件里的内容：{ \"variants\": { \"normal\": { \"model\": \"modid:blockname\" } } }然后我们写模型，也就是这个文件：assets/modid/models/block/blockname.json模型文件的内容：{ \"parent\": \"block/cube_all\", \"textures\": { \"all\": \"modid:blocks/blockname\" } }天哪，为了保证物品栏里的方块还要被渲染，我们需要这个文件：assets/modid/models/item/blockname.json上面那个文件的内容：{ \"parent\": \"modid:block/blockname\", \"display\": { .../*此处省略若干字*/... } }最后上一张贴图：assets/modid/textures/blocks/blockname.png还有语言文件，比如中文语言的语言文件就是assets/modid/lang/zh_CN.lang，里面有一句：tile.blockname.name=你方块的名字\n\n刚刚的所有内容，也就是注册方块，还是一个最简单的方块的所有流程，里面出现了9个modid，11个blockname，这不头晕才怪呢。\n\n这里本人要讲的内容，就是以注册一个最简单的物品和一个最简单的方块为例，把上面这一串名称分清。\n\n注册物品：\n首先，我们要使用Forge的方法注册这个物品：\n        GameRegistry.registerItem(item, item_name);\nitem_name就是这个物品的名称，Forge会检测当前调用这个方法的Mod的modid是什么，然后注册到对应的modid，也就是说，我们可以通过调用命令：\n        /give @p modid:item_name\n获得这个物品，item_name是物品的第一个名字。\n然后我们注册这个物品的渲染：\n        Minecraft.getMinecraft().getRenderItem().getItemModelMesher().register(item, 0, new ModelResourceLocation(modid + \":\" + item_model_name, \"inventory\"));\n这里，item_model_name是出现的第二个名字，通过这个名字，Minecraft就可以去找到描述这个物品渲染的json文件，这个文件的位置，就是assets/modid/models/item/item_model_name.json。\n然后我们看一看这个文件的内容：\n        {\n                \"parent\": \"builtin/generated\",\n                \"textures\": {\n                    \"layer0\": \"modid:items/item_texture_name\"\n                },\n                \"display\": {\n                    \"thirdperson\": {\n                        \"rotation\": [ -90, 0, 0 ],\n                        \"translation\": [ 0, 1, -2 ],\n                        \"scale\": [ 0.55, 0.55, 0.55 ]\n                    },\n                    \"firstperson\": {\n                        \"rotation\": [ 0, -135, 25 ],\n                        \"translation\": [ 0, 4, 2 ],\n                        \"scale\": [ 1.7, 1.7, 1.7 ]\n                    }\n                }\n        }\n这个文件的\"textures\"对应的值描述了对应材质的位置，也就是modid:items/item_texture_name。这里出现了第三个名字，也就是item_texture_name，很多时候，为了方便起见，常常会把item_texture_name和item_model_name设置成一样的，因为一个物品往往只有一个贴图，当然如果存在多个物品一个贴图的情况的话item_texture_name和item_model_name不一样也是会出现的。\nmodid:items/item_texture_name告诉了Minecraft这个材质的位置在assets/modid/textures/items/item_texture_name.png，Minecraft找到了这个材质，并完成了渲染。\n除此之外，我们还会调用setUnlocalizedName方法：\n        item.setUnlocalizedName(itemUnlocalizedName);\n这里的itemUnlocalizedName，是这个物品的非本地化名称，不过，这里建议使用小写驼峰式，而不是上面显示的小写加下划线，这个非本地化名称是用于语言文件的，比如我们会在assets/modid/lang/zh_CN.lang这个中文语言文件中加上一句：\n        item.itemUnlocalizedName.name=你的物品名称\n最后我们总结一下：在物品，也就是item这个对象的注册过程中，我们用到了四个名称，分别是item_name、item_model_name、item_texture_name、和itemUnlocalizedName。实际使用中，建议把前三个名称设置成一样的，而最后一个名称和前三个名称分开，比如前三个名称设置成“dummy_item”，最后一个设置成“dummyItem”。\n\n注册方块：\n首先我们要使用Forge的方法注册这个方块：\n        GameRegistry.registerItem(block, block_name);\nblock_name这个名称的意义和上面说的item_name一样，此处不再赘述。\n然后我们先看看blockstate文件，也就是assets/modid/blockstates/block_name.json这个文件是怎么回事。\n大家可能注意到了，这里我没有使用新的名称，这个json文件的名称和刚刚注册的这个方块的名称，也就是block_name是一致的。这是因为Minecraft在没有特殊指定方块模型文件位置的时候，使用的是名为net.minecraft.client.renderer.block.statemap.DefaultStateMapper的类的实例，来完成blockstate文件的寻找的，这个类的实例寻找blockstate文件的方式，就是获取方块的名称，也就是block_name，来获取blockstate文件的文件名。那么我们现在来看看assets/modid/blockstates/block_name.json这个文件：\n        {\n            \"variants\": {\n                \"normal\": { \"model\": \"modid:block_model_name\" }\n            }\n        }\n很简单对吧。我们先来解释一下\"normal\"是什么意思。\n\n在这个帖子的一开始我就说到，Minecraft 1.8引入了全新的BlockState机制，也就是说，每一个方块都会有一个或若干个BlockState，比如火焰有着三千多种BlockState。这个BlockState由若干个变量拼接而成，作为举例，我们看看蛋糕的blockstate文件，也就是assets/minecraft/blockstates/cake.json文件：\n        {\n                \"variants\": {\n                    \"bites=0\": { \"model\": \"cake_uneaten\" },\n                    \"bites=1\": { \"model\": \"cake_slice1\" },\n                    \"bites=2\": { \"model\": \"cake_slice2\" },\n                    \"bites=3\": { \"model\": \"cake_slice3\" },\n                    \"bites=4\": { \"model\": \"cake_slice4\" },\n                    \"bites=5\": { \"model\": \"cake_slice5\" },\n                    \"bites=6\": { \"model\": \"cake_slice6\" }\n                }\n        }\n这里的蛋糕的BlockState就只有一个变量，也就是bites，可以取值0到6共七个值，我们再看看酿造台的blockstate文件：\n        {\n                \"variants\": {\n                    \"has_bottle_0=false,has_bottle_1=false,has_bottle_2=false\": { \"model\": \"brewing_stand_empty\" },\n                    \"has_bottle_0=true,has_bottle_1=false,has_bottle_2=false\": { \"model\": \"brewing_stand_bottles_1\" },\n                    \"has_bottle_0=false,has_bottle_1=true,has_bottle_2=false\": { \"model\": \"brewing_stand_bottles_2\" },\n                    \"has_bottle_0=false,has_bottle_1=false,has_bottle_2=true\": { \"model\": \"brewing_stand_bottles_3\" },\n                    \"has_bottle_0=true,has_bottle_1=true,has_bottle_2=false\": { \"model\": \"brewing_stand_bottles_12\" },\n                    \"has_bottle_0=true,has_bottle_1=false,has_bottle_2=true\": { \"model\": \"brewing_stand_bottles_13\" },\n                    \"has_bottle_0=false,has_bottle_1=true,has_bottle_2=true\": { \"model\": \"brewing_stand_bottles_23\" },\n                    \"has_bottle_0=true,has_bottle_1=true,has_bottle_2=true\": { \"model\": \"brewing_stand_bottles_123\" }\n                }\n        }\n这里的酿造台的BlockState就有着三个变量，分别代表三个瓶子是否存在。\n那么问题来了，如果没有变量，也就是只有一个BlockState怎么办？\n这里，Minecraft中约定，没有变量的BlockState，使用\"normal\"这个值，这就是\"normal\"这个值的含义。\n我们注意到，\"normal\"这个值，对应的是\"modid:block_model_name\"这个位置，这个位置，就应该在assets/modid/models/block/block_model_name.json这个位置，那么这个文件是这个样子的：\n        {\n                \"parent\": \"block/cube_all\",\n                \"textures\": {\n                    \"all\": \"modid:blocks/block_texture_name\"\n                }\n        }\n这个\"textures\"提供了一个名为modid:blocks/block_texture_name的位置，和物品一样，我们需要去assets/modid/textures/blocks/block_texture_name.png里找材质，那么问题来了，这个\"all\"是啥意思呢？\n我们注意到有这么一行：\n        \"parent\": \"block/cube_all\",\n这里显然提供了一个parent的位置，也就是block/cube_all，这个模型文件继承了这个对应的模型文件。不过这里没有\"modid\"作为前缀，所以在查找位置的时候，要自行加上\"minecraft\"前缀，也就是说，我们要在assets/minecraft/models/block/cube_all.json里面看一看：\n        {\n                \"parent\": \"block/cube\",\n                \"textures\": {\n                    \"particle\": \"#all\",\n                    \"down\": \"#all\",\n                    \"up\": \"#all\",\n                    \"north\": \"#all\",\n                    \"east\": \"#all\",\n                    \"south\": \"#all\",\n                    \"west\": \"#all\"\n                }\n        }\n天哪还有一个parent，我们再去assets/minecraft/models/block/cube.json里看一看：\n        {\n                \"elements\": [\n                    {   \"from\": [ 0, 0, 0 ],\n                        \"to\": [ 16, 16, 16 ],\n                        \"faces\": {\n                            \"down\":  { \"texture\": \"#down\", \"cullface\": \"down\" },\n                            \"up\":    { \"texture\": \"#up\", \"cullface\": \"up\" },\n                            \"north\": { \"texture\": \"#north\", \"cullface\": \"north\" },\n                            \"south\": { \"texture\": \"#south\", \"cullface\": \"south\" },\n                            \"west\":  { \"texture\": \"#west\", \"cullface\": \"west\" },\n                            \"east\":  { \"texture\": \"#east\", \"cullface\": \"east\" }\n                        }\n                    }\n                ]\n        }\n终于没有parent了。我们整合一下这三个json：\n        {\n                \"textures\": {\n                    \"particle\": \"#all\",\n                    \"down\": \"#all\",\n                    \"up\": \"#all\",\n                    \"north\": \"#all\",\n                    \"east\": \"#all\",\n                    \"south\": \"#all\",\n                    \"west\": \"#all\",\n                    \"all\": \"modid:blocks/block_texture_name\"\n                },\n                \"elements\": [\n                    {   \"from\": [ 0, 0, 0 ],\n                        \"to\": [ 16, 16, 16 ],\n                        \"faces\": {\n                            \"down\":  { \"texture\": \"#down\", \"cullface\": \"down\" },\n                            \"up\":    { \"texture\": \"#up\", \"cullface\": \"up\" },\n                            \"north\": { \"texture\": \"#north\", \"cullface\": \"north\" },\n                            \"south\": { \"texture\": \"#south\", \"cullface\": \"south\" },\n                            \"west\":  { \"texture\": \"#west\", \"cullface\": \"west\" },\n                            \"east\":  { \"texture\": \"#east\", \"cullface\": \"east\" }\n                        }\n                    }\n                ]\n        }\n\"elements\"对应的值是一个数组，这个数组的每个元素，都代表着一个长方体，这里的长方体只有一个，并且从[ 0, 0, 0 ]到[ 16, 16, 16 ]，意义是很明显的。\n这里我们不去关心诸如\"cullface\"（有的时候还会有\"uvlock\"等别的进来）的意思，这个是材质包作者的任务，那么这个json的意义应该很直观了吧。比如我们以上方的贴图为例：\nMinecraft先去读\"up\"对应的值，发现是\"#up\"，这代表一个引用，Minecraft就去\"textures\"对应的值里去找\"up\"对应的值，发现是\"#all\"，Minecraft又再去找\"all\"对应的值，终于找到了贴图对应的位置，也就是刚刚说的assets/modid/textures/blocks/block_texture_name.png，Minecraft便渲染上了这个贴图。\n好，现在方块的注册还剩两步，一步是调用setUnlocalizedName方法：\n        block.setUnlocalizedName(blockUnlocalizedName);\n再在语言文件中加上tile.blockUnlocalizedName.name就可以了。\n还有一步，就是注册这个方块对应物品的渲染：\n        Minecraft.getMinecraft().getRenderItem().getItemModelMesher().register(Item.getItemFromBlock(block), 0, new ModelResourceLocation(modid+ \":\" + item_of_block_model_name, \"inventory\"));\n这里的item_of_block_model_name，和上面item_model_name的含义差不多。我们来看看assets/modid/item/item_of_block_model_name.json：\n        {\n            \"parent\": \"modid:block/block_model_name\",\n            \"display\": {\n                \"thirdperson\": {\n                    \"rotation\": [ 10, -45, 170 ],\n                    \"translation\": [ 0, 1.5, -2.75 ],\n                    \"scale\": [ 0.375, 0.375, 0.375 ]\n                }\n            }\n        }\n又继承了上面那个assets/modid/models/block/block_model_name.json的模型，一切都串进来了。\n当然，block_model_name、block_texture_name、和item_of_block_model_name这三个名称不一样也很常见，因为一个方块可能有多个BlockState、一个BlockState可能需要多张贴图，和物品相比，这还是很常见的。\n最后我们总结一下：在方块，也就是block这个对象的注册过程中，我们用到了五个名称，分别是block_name、block_model_name、block_texture_name、item_of_block_model_name、和blockUnlocalizedName。实际使用中，建议把前四个名称设置成一样的，而最后一个名称和前四个名称分开，比如前四个名称设置成“dummy_block”，最后一个设置成“dummyBlock”。\n\n写在最后：\n实际上，本人的这个帖子，还有一些小坑没有填，比如没有讲\"display\"对应的值是什么意思，等等。\n如果有时间的话，作者慢慢填啦～",
    "replies": [
        {
            "author": "土球球",
            "timestamp": 1456283940,
            "txt_content": "沙发占个坑先，如果心情好就在这个楼讲讲\"display\"是什么意思、还有我手动忽略的\"cullface\"、\"uvlock\"等是啥意思，具体原因就是MCBBS的审核速度。。。你懂得（另外这TM怎么还是新人帖(╯°口°)╯︵┴─┴）"
        },
        {
            "author": "lzjohnny",
            "timestamp": 1456654860,
            "txt_content": "感谢楼主！正在看github上的教程...正好我也对名称有些困惑~{:10_512:}"
        },
        {
            "author": "ddee",
            "timestamp": 1466943660,
            "txt_content": "谢谢！可是该死的forge把贴图弄的这么难，哎。。。。。"
        },
        {
            "author": "棒法芬芳",
            "timestamp": 1564065840,
            "txt_content": "ustc_zzzz 发表于 2016-2-24 11:19\n沙发占个坑先，如果心情好就在这个楼讲讲\"display\"是什么意思、还有我手动忽略的\"cullface\"、\"uvlock\"等是 ...\nuvlock是开启或关闭方块的材质旋转吗"
        }
    ]
}