{
    "title": "[New API][经济赌场插件指令全汉化+BUG完美修复]赌场俱乐部老虎机",
    "author": "minecraftpe8",
    "replyCount": 6,
    "timestamp": 1425567660,
    "txt_content": " 本帖最后由 minecraftpe8 于 2015-3-5 23:16 编辑 \n\n[New API][经济赌场插件指令全汉化+BUG完美修复]\n★ 玩家可以开设自己的赌场俱乐部!\n★ 玩家可以加入别人的赌场俱乐部!\n★ 玩家还可以玩老虎机游戏,中大奖!\n★ OP可以自定义赌场数量上限和老虎机中奖概率!\n\n★ 本次汉化修复 5 个严重BUG!基本可以完美运行!\n\n★中文命令功能和用法说明★\n一、赌场管理命令:\n1 开设自己的赌场\n用法:  /赌场 开设\n2 关闭自己的赌场\n用法:  /赌场 关闭\n3 加入别人的赌场\n用法:  /赌场 加入 <赌场主的名字>\n4 退出别人的赌场\n用法:  /赌场 退出\n5 列出现有的赌场\n用法:  /赌场 列表\n6 赌场主设置赌注(设置好赌注,系统自动开奖)\n用法:  /赌场 赌注 <金钱>\n7 OP关闭非法赌场\n用法:  /赌场 关闭 <赌场主的名字>\n\n二、老虎机游戏:\n用法:  /老虎机 <金钱>\n后台使用截图:\n\n\n\n\n\n经济赌场插件后台使用截图.png (9.84 KB, 下载次数: 17)\n\n下载附件\n\n2015-3-5 22:16 上传\n\n\n\n\n\n\n★配置文件说明★\n1 允许开设的最大赌场数目:\nmax-game: 10\n说明: 表示服务器允许开设赌场的最大数目为10!\n2 老虎机的中奖概率\njackpot-winning: 1\n说明: 表示老虎机的中奖概率为1/(1+1)=50%;设为9表示中奖概率为1/(1+9)=10%;以此类推!\n\n★详细使用示例★\n一、赌场管理:\n1 开设自己的赌场\n\n\n\n\n\n开设赌场.png (102.37 KB, 下载次数: 19)\n\n下载附件\n\n2015-3-5 22:05 上传\n\n\n\n\n\n\n2 关闭自己的赌场\n\n\n\n\n\n关闭赌场.png (96.22 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:05 上传\n\n\n\n\n\n\n3 加入别人的赌场\n\n\n\n\n\n加入赌场.png (96.64 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n4 退出别人的赌场\n\n\n\n\n\n退出赌场.png (97.67 KB, 下载次数: 18)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n5 列出现有的赌场\n\n\n\n\n\n赌场列表.png (92.15 KB, 下载次数: 20)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n6 赌场主设置赌注(设置好赌注,系统自动开奖)\n\n\n\n\n\n赌场开奖.png (91.13 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n7 OP关闭非法赌场\n\n\n\n\n\nOP关闭赌场.png (98.37 KB, 下载次数: 12)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n二、老虎机游戏:\n\n\n\n\n\n老虎机1.png (91.21 KB, 下载次数: 18)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n\n\n老虎机2.png (90.44 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:06 上传\n\n\n\n\n\n\n★对本次修复的5个BUG详细说明★\n1 控制台运行命令BUG\ncase \"jackpot\":\n        $money = array_shift($params);\n        if(!is_numeric($money)){\n                $sender->sendMessage(\"Usage: \".$command->getUsage());\n                break;\n        }\n改为\ncase \"老虎机\":\n if(!$sender instanceof Player){\n                $sender->sendMessage(\"请在游戏里运行该命令.\");\n                break;\n        }\n        $money = array_shift($params);\n        if(!is_numeric($money)){\n                $sender->sendMessage(\"Usage: \".$command->getUsage());\n                break;\n        }\n错误说明: 命令分2种类型,控制台命令和游戏内命令.必须做好区分,否则导致严重错误!加一个限定判断,即可解决!\n此BUG未修复之前的后台出错信息:\n\n\n\n\n\n赌场BUG截图1.png (5.45 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:32 上传\n\n\n\n\n\n\n2 引用API函数BUG\nif($rand === 0){\n        $this->api->addMoney($sender, $money);\n        $sender->sendMessage(\"You've wined jackpot! You've got \".$this->api->monetaryUnit().\"$money\");\n}else{\n        $sender->sendMessage(\"You've failed your jackpot! You've lost \".$this->api->monetaryUnit().\"$money\");\n}\n改为\nif($rand === 0){\n        $this->api->addMoney($sender, $money);\n        $sender->sendMessage(\"恭喜您中奖啦 ! 奖金 : \".$this->api->getMonetaryUnit().\"$money 美元\");\n}else{\n        $sender->sendMessage$sender->sendMessage(\"很遗憾您未中奖, 输掉 \".$this->api->getMonetaryUnit().\"$money 美元\");\n}\n\nforeach($this->casino[$sender->getName()][\"players\"] as $p => $v){\n        if($got === $p){\n                $this->getServer()->getPlayerExact($p)->sendMessage(\"You've win \".$this->api->monetaryUnit().\"$all!\");\n        }else{\n                $this->getServer()->getPlayerExact($p)->sendMessage(\"You've lost \".$this->api->monetaryUnit().\"$money\");\n        }\n}\n改为\nforeach($this->casino[$sender->getName()][\"players\"] as $p => $v){\n        if($got === $p){\n                $this->getServer()->getPlayerExact($p)->sendMessage(\"恭喜您赢得 \".$this->api->getMonetaryUnit().\"$all 美元!\");\n        }else{\n                $this->getServer()->getPlayerExact($p)->sendMessage(\"很遗憾您输掉 \".$this->api->getMonetaryUnit().\n\"$money 美元\");\n        }\n}\nif($this->api->myMoney($sender) < $money){\n        $sender->sendMessage(\"You don't have money to gamble \".$this->api->monetaryUnit().\"$money\");\n        break;\n}\n\n\n改为\nif($this->api->myMoney($sender) < $money){\n        $sender->sendMessage(\"你没有足够多的金钱来押注,\\n需要 \".$this->api->getMonetaryUnit().\"$money 美元\");\n        break;\n}\n\n★错误说明: 此BUG非常严重,后果就是服务器崩溃!原代码引用了核心插件API内并未定义的函数!\n此BUG未修复之前的后台出错信息: (此BUG不修复,直接蹦服)\n\n\n\n\n\n\n赌场BUG截图2.png (39.35 KB, 下载次数: 13)\n\n下载附件\n\n2015-3-5 22:33 上传\n\n\n\n\n\n\n3 赌场算法BUG\n$got = array_rand($this->casino[$sender->getName()]);\n改为\n$got = array_rand($this->casino[$sender->getName()][\"players\"]);\n错误说明: casino数组成员访问出错,没有给定正确的下标!\n此BUG未修复之前的游戏出错信息: (此BUG不修复,赌场功能无法使用,会一直输钱)\n\n\n\n\n\n\n赌场BUG截图4.png (25.77 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:34 上传\n\n\n\n\n\n\n4 老虎机算法BUG\n$this->api->reduceMoney($sender, $money);\n$rand = rand(0, $this->config->get(\"jackpot-winning\"));\n\nif($rand === 0){\n        $this->api->addMoney($sender, $money);\n        $sender->sendMessage(\"You've wined jackpot! You've got \".$this->api->monetaryUnit().\"$money\");\n}else{\n        $sender->sendMessage(\"You've failed your jackpot! You've lost \".$this->api->monetaryUnit().\"$money\");\n}\n改为\n$rand = rand(0, $this->config->get(\"jackpot-winning\"));\nif($rand === 0){\n        $this->api->addMoney($sender, $money);\n        $sender->sendMessage(\"恭喜您中奖啦 ! 奖金 : \".$this->api->getMonetaryUnit().\"$money 美元\");\n}else{\n        $this->api->reduceMoney($sender, $money);\n        $sender->sendMessage$sender->sendMessage(\"很遗憾您未中奖, 输掉 \".$this->api->getMonetaryUnit().\"$money 美元\");\n}\n错误说明: 老虎机算法逻辑出错,中奖增加玩家的金钱,未中奖扣掉玩家的金钱,很自然的道理!\n此BUG未修复之前的游戏出错信息: (此BUG不修复,老虎机中奖没奖金,输了要扣钱)\n\n\n\n\n\n赌场BUG截图5.png (68.05 KB, 下载次数: 13)\n\n下载附件\n\n2015-3-5 22:34 上传\n\n\n\n\n\n\n5 老虎机刷钱BUG\ncase \"jackpot\":\n        $money = array_shift($params);\n        if(!is_numeric($money)){\n                $sender->sendMessage(\"Usage: \".$command->getUsage());\n                break;\n        }\n        $this->api->reduceMoney($sender, $money);\n        $rand = rand(0, $this->config->get(\"jackpot-winning\"));\n改为\ncase \"jackpot\":\n        $money = array_shift($params);\n        if(!is_numeric($money)){\n                $sender->sendMessage(\"Usage: \".$command->getUsage());\n                break;\n        }\n        $money = (int)$money;\n        if($this->api->myMoney($sender) < $money){\n                $sender->sendMessage(\"骚年, 你没有足够多的 \".$this->api->getMonetaryUnit().\"$money 美元来投注\");\n                break;\n        }\n        $rand = rand(0, $this->config->get(\"jackpot-winning\"));\n\n错误说明: 原代码没有对玩家输入的金钱值做限制,导致老虎机可以无限刷钱!\n此BUG未修复之前的游戏出错信息: (此BUG不修复,老虎机可以无限刷钱)\n\n\n\n\n\n赌场BUG截图3.png (114.35 KB, 下载次数: 14)\n\n下载附件\n\n2015-3-5 22:34 上传\n\n\n\n\n\n\n\"PM插件指令汉化合集\"已上传到百度网盘,持续更新中:\nhttp://pan.baidu.com/s/1gdBysa3\n\"经济赌场插件指令全汉化(BUG完美修复)\"百度网盘下载链接:\nhttp://pan.baidu.com/s/1eQhEsOq\n\n\n\n\n\n\n\n\n\n经济赌场插件指令全汉化(BUG完美修复).zip\n\n\n2015-3-5 22:58 上传\n点击文件名下载附件\n\n\n\n\n823.26 KB, 下载次数: 271\n\n\n开个赌场俱乐部,玩玩老虎机!\n\n\n\n",
    "replies": [
        {
            "author": "simon3000",
            "timestamp": 1425568260,
            "txt_content": "mark慢慢看   "
        },
        {
            "author": "Cd9r",
            "timestamp": 1425568320,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "minecraftpe8",
            "timestamp": 1425568980,
            "txt_content": "Cd9r 发表于 2015-3-5 23:12\n很棒的作品！但是还是希望指令不要汉化的比较好，不太方便。\n如果不汉化,有几个玩家认识赌场命令casino,老虎机命令jackpot,玩家不会用命令,插件存在的意义就没有了!当然了,我后面可能还会发布指令中英双语版,合二为一,你喜欢用英文就用英文指令,喜欢中文就用中文指令,同时用,不冲突!"
        },
        {
            "author": "wkyyzhb",
            "timestamp": 1425571560,
            "txt_content": "对不起，你因为涉嫌聚众赌博，已经被警方通缉了，你的ip已经被我们锁定了，请在48小时内到公安机关投案自首争取宽大处理。"
        },
        {
            "author": "1523464360",
            "timestamp": 1425603960,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "MCPE服务器8",
            "timestamp": 1427093640,
            "txt_content": "非常棒的插件!"
        }
    ]
}