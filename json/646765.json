{
    "title": "无法添加BUFF，和一个config的问题",
    "author": "1402367475",
    "replyCount": 10,
    "timestamp": 1478347980,
    "txt_content": " 本帖最后由 1402367475 于 2016-11-6 14:12 编辑 \n\n无法添加BUFF，和一个config的问题\nconfig问题是我想在配置中添加个 enable: false/true 来控制BUFF\n然后我多次修改后的代码这样，怎么研究都搞不懂为什么添加不了BUFF\n@EventHandler\n                public void Death(PlayerDeathEvent evt)\n                {\n                        Player p = evt.getEntity();\n                        money = getConfig().getDouble(\"spendmoney\");\n                        playermoney = economy.getBalance(p);\n                        economy.withdrawPlayer(p, money);\n                }\n                @EventHandler\n                public void Respawn(PlayerRespawnEvent evt)\n                {\n                        Player p = evt.getPlayer();        \n                        String name = evt.getPlayer().getName();\n                        if(playermoney >= money){ \n                        p.sendMessage(name + \" 你已上缴了§e \" + money +\" §a军饷，已免遭报应\");\n                } else {\n                        if((p.isOp()) || (p.hasPermission(\"swcf.notpunish\"))){\n                        p.sendMessage(name + \"§a你拥有御赐玉佩在身，已免遭报应\");\n                        return;\n                        }\n                        p.sendMessage(\"没有足够的银子上缴军饷，已遭受报应\");\n                        int Slow_time = getConfig().getInt(\"Slow_time\");\n                        p.addPotionEffect(new PotionEffect(PotionEffectType.SLOW, Slow_time * 20, 1));\n                }\n                }\n        }复制代码\n我这次整了以后应该是PlayerRespawnEvent的问题，因为我换了个事件PlayLevelChangeEvent 后是可以添加BUFF的\n但是不知道应该怎么解决这个问题\n",
    "replies": [
        {
            "author": "602723113",
            "timestamp": 1478360820,
            "txt_content": "提供BUFF\nint Slow_time = getConfig().getInt(\"Slow_time\");\nSlow_time = Slow_time * 20;\np.addPotionEffect(new PotionEffect(PotionEffectType.SLOW,Slow_time,1) );复制代码\n\n控制BUFF\nIf(!getConfig().getBoolean(\"enable\")) {\n  return;\n}\n//上面的是指,当enable为关闭时则自动返回复制代码"
        },
        {
            "author": "1402367475",
            "timestamp": 1478409660,
            "txt_content": " 本帖最后由 1402367475 于 2016-11-6 13:26 编辑 \n602723113 发表于 2016-11-5 23:47\n提供BUFF还是无法添加BUFF@EventHandler\n                public void Respawn(PlayerRespawnEvent evt)\n                {\n                        Player p = evt.getPlayer();        \n                        String name = evt.getPlayer().getName();\n                        if(playermoney >= money){ \n                        p.sendMessage(name + \" 你已上缴了§e \" + money +\" §a军饷，已免遭报应\");\n                } else {\n                        if((p.isOp()) || (p.hasPermission(\"swcf.notpunish\"))){\n                        p.sendMessage(name + \"§a你拥有御赐玉佩在身，已免遭报应\");\n                        return;\n                        }\n                        p.sendMessage(\"没有足够的银子上缴军饷，已遭受报应\");\n                        int Slow_time = getConfig().getInt(\"Slow_time\");\n                        Slow_time = Slow_time * 20;\n                        p.addPotionEffect(new PotionEffect(PotionEffectType.SLOW, Slow_time, 1));\n                        }\n                        }\n                }复制代码\n\n顺道想问一下大佬在物品栏上方发消息是什么特性？\n我看了一下actionbar，比actionbar要低的多\n"
        },
        {
            "author": "602723113",
            "timestamp": 1478410800,
            "txt_content": "1402367475 发表于 2016-11-6 13:21\n还是无法添加BUFF\n\n顺道想问一下大佬在物品栏上方发消息是什么特性？\n那个啊。。。那个是1.8之后的特性了\n\n如果你还是无法添加BUFF的话你还是去问别人吧=w="
        },
        {
            "author": "1402367475",
            "timestamp": 1478411220,
            "txt_content": "602723113 发表于 2016-11-6 13:40\n那个啊。。。那个是1.8之后的特性了\n\n如果你还是无法添加BUFF的话你还是去问别人吧=w= ...\n谢谢大佬"
        },
        {
            "author": "q513902026",
            "timestamp": 1478670720,
            "txt_content": "respawnEvent事件触发时应该玩家还未重生 所以简单的延时一下添加BUFF应该就能完成\n\n延时代码\nnew BukkitRunnable()\n{\n@Override\npublic void run()\n{\n//添加BUFF的代码 如果调用外部的成员 请保证是final的\n}\n}.runTaskLater(插件实例,延迟时间)"
        },
        {
            "author": "291837341",
            "timestamp": 1478754540,
            "txt_content": "q513902026 发表于 2016-11-9 13:52\nrespawnEvent事件触发时应该玩家还未重生 所以简单的延时一下添加BUFF应该就能完成\n\n延时代码\n哦哦哦谢谢！！我也正为这个烦恼"
        },
        {
            "author": "1402367475",
            "timestamp": 1478856840,
            "txt_content": "q513902026 发表于 2016-11-9 13:52\nrespawnEvent事件触发时应该玩家还未重生 所以简单的延时一下添加BUFF应该就能完成\n\n延时代码\n成功解决谢谢大佬！"
        },
        {
            "author": "1402367475",
            "timestamp": 1478859660,
            "txt_content": "q513902026 发表于 2016-11-9 13:52\nrespawnEvent事件触发时应该玩家还未重生 所以简单的延时一下添加BUFF应该就能完成\n\n延时代码\n大触问一下延迟时间的单位是？？？runTaskLater(Main, 10L);10L是表示多久？"
        },
        {
            "author": "1402367475",
            "timestamp": 1478865600,
            "txt_content": "q513902026 发表于 2016-11-9 13:52\nrespawnEvent事件触发时应该玩家还未重生 所以简单的延时一下添加BUFF应该就能完成\n\n延时代码\n解决L是long型变量，20延时为1秒，但对插件实例缺乏认识我该怎么弄？？？望大触指导"
        },
        {
            "author": "1402367475",
            "timestamp": 1478866380,
            "txt_content": "1402367475 发表于 2016-11-11 20:00\n解决L是long型变量，20延时为1秒，但对插件实例缺乏认识我该怎么弄？？？望大触指导 ...package Toto.com;\n\nimport java.io.File;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.entity.PlayerDeathEvent;\nimport org.bukkit.event.player.PlayerRespawnEvent;\nimport org.bukkit.plugin.Plugin;\nimport org.bukkit.plugin.RegisteredServiceProvider;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.potion.PotionEffect;\nimport org.bukkit.potion.PotionEffectType;\nimport org.bukkit.scheduler.BukkitRunnable;\n\nimport net.milkbowl.vault.economy.Economy;\n\npublic class Main extends JavaPlugin implements Listener{\n        private Economy economy;\n        private boolean isEco = false;\n        private double money;\n        private double playermoney;\n        private boolean setEconomy() {\n                RegisteredServiceProvider<Economy> eco = getServer().getServicesManager().getRegistration(net.milkbowl.vault.economy.Economy.class);\n                if(eco != null) {\n                        economy = eco.getProvider();\n                }\n                return (economy != null);\n        }\n        public void onEnable() {\n                Bukkit.getServer().getPluginManager().registerEvents(this, this);\n                if (Bukkit.getPluginManager().getPlugin(\"Vault\") != null) {\n                        isEco = setEconomy();\n                        if(!getDataFolder().exists()) {\n                                getDataFolder().mkdir();\n                        }\n                        File file=new File(getDataFolder(),\"config.yml\");\n                        if (!(file.exists())) {\n                        saveDefaultConfig();\n                        }\n                        reloadConfig();\n                }\n                else {\n                        getLogger().info(\"无法检测到Vault插件，插件已关闭\");\n                }        \n        }\n                @EventHandler\n                public void Death(PlayerDeathEvent evt)\n                {\n                        Player p = evt.getEntity();\n                        money = getConfig().getDouble(\"spendmoney\");\n                        playermoney = economy.getBalance(p);\n                        economy.withdrawPlayer(p, money);\n                }\n                @EventHandler\n                public void Respawn(PlayerRespawnEvent evt)\n                {\n                        Player p = evt.getPlayer();        \n                        String name = evt.getPlayer().getName();\n                        if(playermoney >= money) { \n                        p.sendMessage(name + \" §a你已上缴了§e \" + money +\" §a军饷，已免遭报应\");\n                } else {\n                        if(!getConfig().getBoolean(\"Enable\")) {\n                        return;\n                        }\n                        if((p.isOp()) || (p.hasPermission(\"swcf.notpunish\"))) {\n                        p.sendMessage(name + \"§a你拥有御赐玉佩在身，已免遭报应\");\n                        return;\n                        }\n                        p.sendMessage(\"没有足够的银子上缴军饷，已遭受报应\");\n                        }\n                }\n                public void Buff(final Player p2) {\n                        new BukkitRunnable() {\n                                public void run() {\n                                        p2.addPotionEffect(new PotionEffect(PotionEffectType.SLOW, 20, 1));\n                                }\n                        }.runTaskLater(plugin, 10);\n                                }\n                }复制代码"
        }
    ]
}