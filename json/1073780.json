{
    "title": "关于centos定时重启",
    "author": "moraplze_",
    "replyCount": 7,
    "timestamp": 1594089600,
    "txt_content": "我又来了233...实在是支付不起金粒了;w;\n我希望在下午13点重启一次服务器以缓解紧张的内存占用。在spigot.yml上修改了重启的脚本，但是依然无法完成重启。一般就直接提示一句然后就照常关闭服务器，也没有显示重启的部分，谁能告诉我spigot.yml怎么填？\n服务器是centos7.2\n我不知道怎么放截图比较合适，如果需要截图的话我会第一时间发上来的。",
    "replies": [
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1594089720,
            "txt_content": "spigot.yml填重启执行脚本(比如./start.sh) ?\n另外关服使用的命令是\nrestart么\n\n现在重启会有什么输出么\nspigot.yml发来看看？\n启动的脚本也发来看看？"
        },
        {
            "author": "22856139",
            "timestamp": 1594090320,
            "txt_content": "直接使用重启脚本，防止停止服务器后没有启动，或者使用重启插件"
        },
        {
            "author": "moraplze_",
            "timestamp": 1594090380,
            "txt_content": "阴阳师元素祭祀 发表于 2020-7-7 10:42\nspigot.yml填重启执行脚本(比如./start.sh) ?\n另外关服使用的命令是\nrestart么\n图片在下面\nrestart.sh是我注释的那行没保存\n版本是1.16.1\n\n\n\n\n\n捕获.PNG\n(41.04 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-7-7 10:50 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nroot.PNG\n(36.97 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-7-7 10:50 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nrestart.PNG\n(6.85 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-7-7 10:52 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        {
            "author": "阴阳师元素祭祀",
            "timestamp": 1594090680,
            "txt_content": " 本帖最后由 阴阳师元素祭祀 于 2020-7-7 10:59 编辑 \nmoraplze_ 发表于 2020-7-7 10:53\n图片在下面\nrestart.sh是我注释的那行没保存\n版本是1.16.1\n这个spigot似乎是新开一个runtime来执行那个脚本\n试试巴./restart.sh改成restart.sh\n或者改成\nsh restart.sh\n\n另外给restart.sh相应权限没\n安利一波screen 这样直接执行java -jar没问题么"
        },
        {
            "author": "蕾米洛伊",
            "timestamp": 1594090680,
            "txt_content": " 本帖最后由 蕾米洛伊 于 2020-7-7 11:08 编辑 \n\n啊这，你们在讨论 spigot 的重启方法，那我不打扰了\n那我还是再打扰一下\nSpigot 貌似会新开进程来执行脚本，所以服务器有可能不会在你的 session 里面输出，请\nps -A | grep java <-- 输入这个看一下是否有后台 Java 进程正在运行\n另外，记得chmod加一下运行权限。"
        },
        {
            "author": "moraplze_",
            "timestamp": 1594093140,
            "txt_content": "蕾米洛伊 发表于 2020-7-7 10:58\n啊这，你们在讨论 spigot 的重启方法，那我不打扰了\n那我还是再打扰一下\nSpigot 貌似会新开进程来执行脚本 ...\n啊这，我打开客户端才发现服务器已经启动了xd\n也就说我着三十金粒白花咯（划掉）\n我怎么进入spigot新开的线程啊，我得去后台管理呀"
        },
        {
            "author": "蕾米洛伊",
            "timestamp": 1594093560,
            "txt_content": "moraplze_ 发表于 2020-7-7 11:39\n啊这，我打开客户端才发现服务器已经启动了xd\n也就说我着三十金粒白花咯（划掉）\n我怎么进入spigot新开的 ...\n没白花 撒，给我吧\n所以最好在启动脚本里使用 screen 之类的东西, 你可以自己百度一下XD\n或者复制我这个东西到你的启动脚本 可能比较复杂233\n\n# 服务器在哪个目录执行, 一般填写你的服务端根目录\nHOME_PATH=\"/home\"\nNAME=$(cat /proc/sys/kernel/random/uuid)\n# 开始创建 screen\nscreen -dmS $NAME\necho \"启动的会话名: $NAME\"\necho \"$NAME\" > ~/fuwuqi.txt\nscreen -S $NAME -p bash -X stuff $\"cd $HOME_PATH && java -Xmx1G xxxx\"\n\n就完事了。进到服务器就输入 screen -S $(cat ~/fuwuqi.txt) 完事。"
        }
    ]
}