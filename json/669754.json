{
    "title": "【1000金粒】关于压测的正确防御手段= =",
    "author": "小烦",
    "replyCount": 13,
    "timestamp": 1486017720,
    "txt_content": "我又重新开服务器了。\n于是我又想测试一下服务器抗压测的能力。\n选择了压测4.0（motd压测）\n开了1000线程……\n结果瞬间tps 17 - 18\n之前效果好像也没这么明显啊……\nGreatFireWall 、 AAT 、 Neverlag之类的都装了，so不要给我推荐一些太主流的插件，\n只想知道原因和解决方法……因为换服务器之前压测效果没这么明显。\n\n用的是ColorMotd\n",
    "replies": [
        {
            "author": "浅念哥",
            "timestamp": 1486017720,
            "txt_content": "你想通过插件防的话AAT目前应该是效果最好的插件\n但是说到底原理仍然是阻止压测客户端获取MOTD\n如果你按了colormotd可能会比AAT早一步发送数据包，那样就会造成一定的卡顿\n最好的解决方案(不考虑美观等因素):\nhttp://www.mcbbs.net/thread-403578-1-1.html\n用这个服务端\n把这些插件都删掉\n即可"
        },
        {
            "author": "Mr_Des",
            "timestamp": 1486019220,
            "txt_content": "试试安全狗233"
        },
        {
            "author": "小烦",
            "timestamp": 1486021380,
            "txt_content": "139746a 发表于 2017-2-2 15:52\n[安全|防御]AntiAttack4——让熊孩子的压测全部失效吧！|02-02更新[1.4-1.11]\nhttp://www.mcbbs.net/forum. ...\n大哥你有仔细看我问题么==\nAAT之类的主流插件就不用发了\n我都有装。。\n\n一言不合乱抛插件*1"
        },
        {
            "author": "139746a",
            "timestamp": 1486021920,
            "txt_content": "[安全|防御]AntiAttack4——让熊孩子的压测全部失效吧！|02-02更新[1.4-1.11]\nhttp://www.mcbbs.net/forum.php?mod=viewthread&tid=622875\n(出处: http://www.mcbbs.net/)"
        },
        {
            "author": "小烦",
            "timestamp": 1486021920,
            "txt_content": "Mr_Des 发表于 2017-2-2 15:07\n试试安全狗233\n没用哦 ，之前就装了 \n这也算主流的东西，，\n不过不是插件\n谢谢哦==不过"
        },
        {
            "author": "小烦",
            "timestamp": 1486021980,
            "txt_content": "浅念哥 发表于 2017-2-2 15:58\n你想通过插件防的话AAT目前应该是效果最好的插件\n但是说到底原理仍然是阻止压测客户端获取MOTD\n如果你按了c ...\n多谢，可惜没有PaperSpigot。\n我再参考一下有没有其他答案，\n没问题的话就是你了=="
        },
        {
            "author": "葉子の",
            "timestamp": 1486023240,
            "txt_content": "压测的正当解释其实是用于测试服务器压力\n\n 主要是考验一个服务器承载上限，此类测试一般以机器人调试，通过不断添加机器人数据，测试服务器正常承载上限，一般单服正常承载同时在线玩家1500左右(也有更高的)，但是由于用户行为偏差，机器人的参考价值只能定位70%(或许更低)，意思就是若服务器承载机器人上限为1000人，则玩家只能以700人为参考。\n\n但是如果被非正当所用则为网络攻击[DDOS]\n TCP混乱数据包攻击\n发送伪造源IP的 TCP数据包，TCP头的TCP Flags 部分是混乱的可能是syn,ack,syn+ack,syn+rst等等，会造成一些防火墙处理错误锁死，消耗服务器CPU内存的同时还会堵塞带宽。\n\n\n 用UDP协议的攻击[主要用于攻击聊天软件]\n很多聊天室，视频音频软件，都是通过UDP数据包传输的，攻击者针对分析要攻击的网络软件协议，发送和正常数据一样的数据包，这种攻击非常难防护，一般防护墙通过拦截攻击数据包的特征码防护，但是这样会造成正常的数据包也会被拦截。\n\n\n WEB Server变种攻击[主要用于攻击网站]\n通过控制大量肉鸡同时连接访问网站，一点连接建立就不断开，一直发送一些特殊的GET访问请求造成网站数据库或者某些页面耗费大量的CPU,这样通过限制每个连接过来的IP连接数就失效了，因为每个肉鸡可能只建立一个或者只建立少量的连接。这种攻击非常难防护，后面给大家介绍防火墙的解决方案。\n\n\n 针对游戏服务器的攻击\n因为游戏服务器非常多，这里介绍最早也是影响最大的传奇游戏，传奇游戏分为登陆注册端口7000,人物选择端口7100，以及游戏运行端口7200,7300,7400等，因为游戏自己的协议设计的非常复杂，所以攻击的种类也花样倍出，大概有几十种之多，而且还在不断的发现新的攻击种类，这里介绍目前最普遍的假人攻击，假人攻击是通过肉鸡模拟游戏客户端进行自动注册、登陆、建立人物、进入游戏活动从数据协议层面模拟正常的游戏玩家，很难从游戏数据包来分析出哪些是攻击哪些是正常玩家。\n\n\n如果想防御压测和DDOS的话\n目前有效的方法有以下几点\n防火墙\n 防火墙几乎是最常用的安全产品，但是防火墙设计原理中并没有考虑针对DDOS攻击的防护，在某些情况下，防火墙甚至成为DDOS攻击的目标而导致整个网络的拒绝服务。\n首先是防火墙缺乏DDOS攻击检测的能力。通常，防火墙作为三层包转发设备部署在网络中，一方面在保护内部网络的同时，它也为内部需要提供外部Internet服务的设备提供了通路，如果DDOS攻击采用了这些服务器允许的合法协议对内部系统进行攻击，防火墙对此就无能为力，无法精确的从背景流量中区分出攻击流量。虽然有些防火墙内置了某些模块能够对攻击进行检测，但是这些检测机制一般都是基于特征规则，DDOS攻击者只要对攻击数据包稍加变化，防火墙就无法应对，对DDOS攻击的检测必须依赖于行为模式的算法。\n第二个原因就是传统防火墙计算能力的限制，传统的防火墙是以高强度的检查为代价，检查的强度越高，计算的代价越大。而DDOS攻击中的海量流量会造成防火墙性能急剧下降，不能有效地完成包转发的任务。\n最后防火墙的部署位置也影响了其防护DDOS攻击的能力。传统防火墙一般都是部署在网络入口位置，虽然某种意义上保护了网络内部的所有资源，但是其往往也成为DDOS攻击的目标，攻击者一旦发起DDOS攻击，往往造成网络性能的整体下降，导致用户正常请求被拒绝。\n为了解决这一问题，上海云盾开发一种能够隐藏真实用户IP的特殊技能。云盾为用户网站提供了革命性的替身安全模式。由于用户修改了相关的网站域名记录，黑客通过网站域名记录获取的将是云盾某个防护节点的IP地址，进而尝试渗透或DDoS的目标，也都是云盾的相应安全节点。由于云盾的安全节点均经过定制的服务器加固，并且在部署形式上，提供了完备的冗余方案和专用的抗DDoS节点。云盾就像用户在互联网上的替身一样，有效为用户源站的真实服务器屏蔽掉来自外界的各种威胁。\n\n\n  入侵检测\n目前IDS系统是最广泛的攻击检测工具，但是在面临DDOS攻击时，IDS系统往往不能满足要求。\n原因其一在于入侵检测系统虽然能够检测应用层的攻击，但是基本机制都是基于规则，需要对协议会话进行还原，但是目前DDoS攻击大部分都是采用基于合法数据包的攻击流量，所以IDS系统很难对这些攻击有效检测。虽然某些IDS系统本身也具备某些协议异常检测的能力，但这都需要安全专家手工配置才能真正生效，其实施成本和易用性极低。\n原因之二就在于IDS系统一般对攻击只进行检测，但是无法提供阻断的功能。IDS系统需要的是特定攻击流检测之后实时的阻断能力，这样才能真正意义上减缓DDOS对于网络服务的影响。\nIDS系统设计之初就是作为一种基于特征的应用层攻击检测设备。而DDOS攻击主要以三层或是四层的协议异常为其特点，这就注定了IDS技术不太可能作为DDOS的检测或是防护手段。目前的防御算法对所有已知的拒绝服务攻击是免疫的，也就是说，是完全可以抵抗已知DoS/DDoS攻击的。\n采用高性能的网络设备\n\n首先要保证网络设备不能成为瓶颈，因此选择路由器、交换机、硬件防火墙等设备的时候要尽量选用知名度高、口碑好的产品。再就是假如和网络提供商有特殊关系或协议的话就更好了，当大量攻击发生的时候请他们在网络接点处做一下流量限制来对抗某些种类的DDOS攻击是非常有效的。\n\n\n 充足的网络带宽保证\n网络带宽直接决定了能抗受攻击的能力，假若仅仅有10M带宽的话，无论采取什么措施都很难对抗现在的SYNFlood攻击，当前至少要选择100M的共享带宽，最好的当然是挂在1000M的主干上了。但需要注意的是，主机上的网卡是1000M的并不意味着它的网络带宽就是千兆的，若把它接在100M的交换机上，它的实际带宽不会超过100M，再就是接在100M的带宽上也不等于就有了百兆的带宽，因为网络服务商很可能会在交换机上限制实际带宽为10M，这点一定要搞清楚。\n\n\n升级主机服务器硬件\n在有网络带宽保证的前提下，请尽量提升硬件配置，要有效对抗每秒10万个SYN攻击包，服务器的配置至少应该为：P4 2.4G/DDR512M/SCSI-HD，起关键作用的主要是CPU和内存，若有志强双CPU的话就用它吧，内存一定要选择DDR的高速内存，硬盘要尽量选择SCSI的，别只贪IDE价格不贵量还足的便宜，否则会付出高昂的性能代价，再就是网卡一定要选用3COM或Intel等名牌的，若是Realtek的还是用在自己的PC上吧。\n\n\n 增强操作系统的TCP/IP栈\nWin2000和Win2003作为服务器操作系统，本身就具备一定的抵抗DDOS攻击的能力，只是默认状态下没有开启而已，若开启的话可抵挡约10000个SYN攻击包，若没有开启则仅能抵御数百个，具体怎么开启，自己去看微软的文章吧！《强化 TCP/IP 堆栈安全》。\n如果用的是Linux和FreeBSD怎么办？很简单，按照这篇文章去做吧！《SYN Cookies》。\n\n\n 安装专业抗DDOS防火墙\n\n\n绿盟黑洞： X86架构，Linux内核与自主专利的抗syn-flood算法。对抗单一类型的syn，udp，icmp dos效果很好，但是当多种混合时效果就略差。优点是更新快，技术支持比较好，在100M环境下对syn-flood有绝对优势。缺点是文档和信息缺乏，同时工作(软硬件两方面)不是很稳定。\n天网防火墙:：最早基于OpenBSD内核，X86架构，现在应该也是Linux内核了。很早就加入了抗syn-flood功能，实际应该是syn-cache/syn-cookie的改进或加强版。实际测试syn流量64B包抵抗极限大概是25M左右。当小于20M是还是可以看到效果的。同时结合良好的防火墙策略应该也可以做到针对udp/icmp等类型的限制。\n云盾的云Web防火墙：云盾依托实时更新的安全云系统，主动收集来自全世界的网站攻击手段，自动更新所有安全节点的防护规则，实时阻断各种常见与不常见的SQL注入、跨站脚本等攻击，使所有加入云盾的网站免受攻击的侵害。\n\n\n\n\n若是楼主满意，还请设为最佳，谢谢。\n\n"
        },
        {
            "author": "翼LOVE·小爱",
            "timestamp": 1486044300,
            "txt_content": "其实用安全狗更改安全策略就可以了 不会的话可以使用\nhttp://www.mcbbs.net/thread-654167-1-1.html"
        },
        {
            "author": "小烦",
            "timestamp": 1486044720,
            "txt_content": "葉子の 发表于 2017-2-2 16:14\n压测的正当解释其实是用于测试服务器压力\n然而你要对问题啊\n\n你看看我到底问的什么……\n\n我前面已经说了\n就是motd压测\n\n不是ddos\n\n也不是其他用于网站或其他游戏服务器的……"
        },
        {
            "author": "小烦",
            "timestamp": 1486045320,
            "txt_content": "葉子の 发表于 2017-2-2 16:14\n压测的正当解释其实是用于测试服务器压力\n这不就是百度的么。。\n你到底认！真！看！我！问！题！了！吗！大！哥！\n\n\n\n\nq.jpg (112.67 KB, 下载次数: 0)\n\n下载附件\n\n2017-2-2 22:22 上传\n\n\n\n\n\n\n\n\n1.jpg (52.26 KB, 下载次数: 0)\n\n下载附件\n\n2017-2-2 22:22 上传\n\n\n\n\n\n\n然而我选择浅念"
        },
        {
            "author": "1575442826",
            "timestamp": 1486109220,
            "txt_content": "adawdwadwadaw136456"
        },
        {
            "author": "923100020",
            "timestamp": 1487324460,
            "txt_content": "其实你还可以用linux的防火墙配置一些安全策略的"
        },
        {
            "author": "小烦",
            "timestamp": 1487341080,
            "txt_content": "923100020 发表于 2017-2-17 17:41\n其实你还可以用linux的防火墙配置一些安全策略的\nwin server=="
        }
    ]
}