{
    "title": "[mcfunction技巧]这个坑，曾让许多人中招，用好了是神器！",
    "author": "Y制杖杖",
    "replyCount": 21,
    "timestamp": 1583454900,
    "txt_content": " 本帖最后由 Y制杖杖 于 2020-3-6 10:24 编辑 \n\n在揭晓这个坑之前，我们先来思考一个简单的问题：\n如何让两名玩家调换位置？\n小A：这还不简单！！? 我反手放两个CB:\ntp A B\ntp B A复制代码\n相信在座的各位已经看出小A的问题，如果将A tp 至B，B再tp至A时，将tp到B的原位。\n那么这个问题该如何解答呢？\n小B：当然是现在A处生成一个隐形的盔甲架，然后将A tp 至B，再将B tp 至盔甲架，最后移除盔甲架。\n\n小B的做法应该是大多数人第一反应的做法，但是这种方法不免有些麻烦，那有什么简便的方法呢？\n\n来看以下mcfunction：\ntp @s B\ntp B ~ ~ ~复制代码然后我们让A执行这个指令，或是在CB中输入execute as A at @s run function mcfunction来调用\n\n咋一看，大家可能会觉得，这不就是“先把A tp到 B，再把B tp到 A”吗？当然不行\n然鹅，这样违反常识的做法，却的确正确！！\n\n\n这就涉及到了今天我们要讲的东西：命令环境（command enviroment)\n\n何为命令环境？如果你学过编程，可能可以这样理解：命令环境就是传入函数的参数\n我们每个mcfunction，都可以看做一个有参函数，参数有：坐标，朝向，维度，执行者\n是不是感觉挺熟悉？没错，它们就分别对应着execute指令的positioned，rotated，in，as四个子命令\n当然，也可以是at和as两个子命令，因为at同时包括了坐标，朝向，维度\n如此一来，函数abc就可以看做：\n//函数的返回值用于stored子命令\nint abc(int[] position,int[] rotation,mcdimension dimension,mob target){\n     ......\n}\n复制代码\n\n所以，如果你在聊天框执行了/function abc (也就是/execute as @s at @s run function a)\n就好像执行了一个有参函数 abc(position,rotation,dimension,target)\n\n好的，既然我们已经传入了四个参数，这些参数如何在mcfunction中调用呢？\n坐标：函数中需要坐标的指令，可以用~指代命令环境中的x|y|z（即数组position的三个元素）\n我们回到上面的例子。\nA在执行了下列函数时，会把自己的position等传入函数，那么函数命令环境中的postion就应该变为了A执行该函数时的坐标\ntp @s B\ntp B ~ ~ ~复制代码也就是说，函数中的~ ~ ~已经变为A执行该函数时的x，y，z坐标，尽管第一条指令已经将A的坐标改变，但是命令环境并不会因此改变。\n这也就是为什么，上面的函数可以完成互换A、B的任务。\n执行者：函数中的@s，指代的是命令环境的执行者（target）\n朝向：函数中需要朝向的指令，可以用~指代命令环境中的朝向（有两个元素）\n栗子：如果把上面的函数改为\ntp @s B\ntp B ~ ~ ~ ~ ~\n复制代码那么它不仅会将B传送到A处，还会使B与A的朝向一致\n\n维度：函数中所有指令执行的默认维度（除非用in子命令覆盖）\n\n\n就讲到这里吧，希望对大家有所帮助!\n\n",
    "replies": [
        {
            "author": "(=°ω°)丿",
            "timestamp": 1583455080,
            "txt_content": "我怀疑你是标题党，并且我有证据 "
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1583455260,
            "txt_content": "隐退 发表于 2020-3-6 08:38\n我怀疑你是标题党，并且我有证据\n哈哈哈哈哈哈不用怀疑"
        },
        {
            "author": "EMT的工具人",
            "timestamp": 1583458920,
            "txt_content": "楼主很厉害，虽然我看不懂，哈哈哈哈"
        },
        {
            "author": "SPGoding",
            "timestamp": 1583540640,
            "txt_content": "相比于使用 tp B ~ ~ ~，使用 tp B ~ ~ ~ ~ ~ 还能够设置 B 的朝向为当前环境中的朝向，使其效果更接近于 tp B A。\n\n顺带，一个无关的漏洞：\n\nMC-169660\n\n\ntp ~ ~ ~ 会改变当前执行实体的朝向。\n\n"
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1583562480,
            "txt_content": "SPGoding 发表于 2020-3-7 08:24\n相比于使用 tp B ~ ~ ~，使用 tp B ~ ~ ~ ~ ~ 还能够设置 B 的朝向为当前环境中的朝向，使其效果更接近于 t ...\ntp B ~ ~ ~ ~ ~ 我下面提到了\n另外这个漏洞是怎么回事..."
        },
        {
            "author": "沈念6",
            "timestamp": 1583633940,
            "txt_content": "dddddddddddddddddddddddddddd"
        },
        {
            "author": "晴路卡",
            "timestamp": 1583652060,
            "txt_content": "有点长...\n简单的说就是exe的执行坐标 朝向等参数一旦确定\n直到该命令执行结束都不会发生改变是吗"
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1583652840,
            "txt_content": "晴路卡 发表于 2020-3-8 15:21\n有点长...\n简单的说就是exe的执行坐标 朝向等参数一旦确定\n直到该命令执行结束都不会发生改变是吗 ...\n是的，function也是这样，我这里主要讲的是function（不过其实function也可以看做/execute as @s at @s run function，理解为exe也ok了）"
        },
        {
            "author": "dv123321",
            "timestamp": 1583661660,
            "txt_content": "感觉没什么用处，主要是好复杂，眼累"
        },
        {
            "author": "闲饼干",
            "timestamp": 1583673240,
            "txt_content": "感觉很厉害但是看不懂 好复杂"
        },
        {
            "author": "3065556368",
            "timestamp": 1583837760,
            "txt_content": "我也看不懂"
        },
        {
            "author": "自闭的邪灵",
            "timestamp": 1583844480,
            "txt_content": "命令方块 不会用,.,,"
        },
        {
            "author": "1_41421356237",
            "timestamp": 1583976120,
            "txt_content": "一言以蔽之：/execute at命令所定义的位置在整个execute过程中都有效，即使被at的实体换了位置。"
        },
        {
            "author": "基哥Grumm",
            "timestamp": 1584193620,
            "txt_content": "貌似懂了一点点\n大概知道无缝传送的原理了\n记得还可以做到原地TP实现盔甲架旋转的功能，但是忘了怎么做，求大佬指点"
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1584225780,
            "txt_content": "基哥Grumm 发表于 2020-3-14 21:47\n貌似懂了一点点\n大概知道无缝传送的原理了\n记得还可以做到原地TP实现盔甲架旋转的功能，但是忘了怎么做，求 ...\n这个不用function就可以\n直接execute as @e[type=armor_stand,limit=1,sort=nearest] at @s run tp ~ ~ ~ ~ ~30\n会让最近的盔甲架旋转30度"
        },
        {
            "author": "B_white_",
            "timestamp": 1586091000,
            "txt_content": "一个小游戏好像就是互换双方位置弄死对方。终于知道原理了，I了I了"
        },
        {
            "author": "Xiao2",
            "timestamp": 1586095260,
            "txt_content": " 本帖最后由 Xiao2 于 2020-4-5 22:03 编辑 \n\n所以执行命令的顺序是\n             ——\n————\n             ——\n像这样双线并举，而只是前面后面先后发生？\n\n我还想请教一下：\n1————\n2——递归（function xxx）\n3————\n是不是陷入一个递归函数后，只有递归函数内完全执行完才会继续下一条（3）"
        },
        {
            "author": "是叶子呀",
            "timestamp": 1586136480,
            "txt_content": "楼主厉害，但我感觉第一种更简单"
        },
        {
            "author": "1786056234",
            "timestamp": 1586150340,
            "txt_content": "看不懂但是觉得很有道理"
        },
        {
            "author": "渔家傲",
            "timestamp": 1586159100,
            "txt_content": "我可以理解为：瞬间移动？？？"
        },
        {
            "author": "Y制杖杖",
            "timestamp": 1611656460,
            "txt_content": "Xiao2 发表于 2020-4-5 22:01\n所以执行命令的顺序是\n             ——\n————\n第一个的话指令是有严格的先后顺序的，也就是说指令执行次序是完全确定的\n第二个的话的确是这样"
        }
    ]
}