{
    "title": "求助，服务器卡顿严重，使用的是Paper端",
    "author": "qsi7474741",
    "replyCount": 16,
    "timestamp": 1588824660,
    "txt_content": "服务器用的阿里云，配置2核4G，3M固定带宽。使用的是Paper的服务端，插件只有个登录、自动备份、内存优化\n\n\n\n\nKHFV`)N5O{DC~4BD8G7Z48B.png (5.38 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-7 12:05 上传\n\n\n\n\n\n\n现在服务器也就10来个人，平均在线也就3~5个人，但是经常卡顿和回档，比如挖方块回档，进地狱门传送后必卡顿回档。以前还没那么严重，现在回档时间越来越长，卡顿也越来越严重。\n\n在论坛里看了看我这个配置能支持更多的人玩卡顿也不会这么严重，而且服务器的配置文件我都按照一些帖子里面的教程优化过的，影响卡顿的我基本都调了，现在实在没什么别的办法了，希望大佬能说一下我这个问题究竟在哪，需要优化哪方面？\n\n\n",
    "replies": [
        {
            "author": "结城希亚",
            "timestamp": 1588824780,
            "txt_content": "CPU主频不行，3GHz都没，硬件是问题\n升级CPU主频吧\n\n顺便把timings发过来"
        },
        {
            "author": "可爱和虎",
            "timestamp": 1588824960,
            "txt_content": "建议你升级一下网速\n3M换算下来只有375kb/s\n下载速度无所谓，上传速度太慢就会造成很明显的卡顿回弹，4g加这个cpu正常5个人左右能吃住"
        },
        {
            "author": "qsi7474741",
            "timestamp": 1588825020,
            "txt_content": "timings报告：https://timings.aikar.co/?id=37fd2345353443bd955abc3f85752dc6"
        },
        {
            "author": "qsi7474741",
            "timestamp": 1588825080,
            "txt_content": "结城希亚 发表于 2020-5-7 12:13\nCPU主频不行，3GHz都没，硬件是问题\n升级CPU主频吧\n只升级主频就行了吗？但是我看后台使用中，CPU并没有拉满，甚至还差的挺多的"
        },
        {
            "author": "结城希亚",
            "timestamp": 1588825140,
            "txt_content": "qsi7474741 发表于 2020-5-7 12:18\n只升级主频就行了吗？但是我看后台使用中，CPU并没有拉满，甚至还差的挺多的 ...\nCPU吃满才有鬼了\n你的timings里显示占用并不是很高\n差不多就是主频太低的原因\n\n顺便你ping一下你服务器，看看延迟多少\n3M感觉有点不够"
        },
        {
            "author": "qsi7474741",
            "timestamp": 1588825560,
            "txt_content": "这个是刚测的ping值\n"
        },
        {
            "author": "lun_yi~",
            "timestamp": 1588825560,
            "txt_content": "如果是基友服的话，可以试试fabric 端  有个完全不影响生电、生存的有效优化mod lithum和光照优化mod。fabric比forge和插件端卡顿都小。  主频太低，导致tps上不去（此外基友服自己试过只有fabric优化后能稳定20tps），就会实体运动各种卡，回弹可能就是ping太高了"
        },
        {
            "author": "qsi7474741",
            "timestamp": 1588825680,
            "txt_content": "结城希亚 发表于 2020-5-7 12:19\nCPU吃满才有鬼了\n你的timings里显示占用并不是很高\n差不多就是主频太低的原因\n因为是自己朋友玩的服务器，也没多少人，大概也就这几个了，3M还不够10个人的吗？"
        },
        {
            "author": "Daleynf",
            "timestamp": 1588826400,
            "txt_content": "带宽有点低，主频也太低，建议升级"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1588826400,
            "txt_content": "qsi7474741 发表于 2020-5-7 12:28\n因为是自己朋友玩的服务器，也没多少人，大概也就这几个了，3M还不够10个人的吗？ ...\n高版本在传送的时候完全不够\n以前开服教程给的推荐带宽已经过时了\n\n玩家传送的时候看看带宽占用\n\n对了，服务器版本多少？"
        },
        {
            "author": "结城希亚",
            "timestamp": 1588826460,
            "txt_content": "qsi7474741 发表于 2020-5-7 12:26\n这个是刚测的ping值\n挺正常的\n\n就是机器主频不行了"
        },
        {
            "author": "Salt_lovely",
            "timestamp": 1588827600,
            "txt_content": "好像不是TPS问题，服务器应该没有过载（17.26% of tick）（但是timings最上面那个图加载不出来就很奇怪），应该是网络问题。网络问题一般是玄学/钞能力解决方法。\n\n我有几个治标不治本的手段可以暂时缓解网络卡顿问题（也可以降低服务器负载）。\n\nserver.properties里面，降低视野距离可以减少玩家加载地图的时间\nview-distance=6 #视野距离复制代码\n在bukkit.yml中（对照着改，不要直接复制粘贴）\nspawn-limits: #怪物上限=玩家人数x设置的上限\n  monsters: 35 #怪物上限，建议设置为35以下，人多/卡顿则可以设置为30以下\n  animals: 10 #动物上限，建议10以下\n  water-animals: 5 #水生生物上限，建议5以下\n  ambient: 1 #蝙蝠，建议2以下或者直接设置为没有蝙蝠（0）复制代码\n\n在spigot.yml中（对照着改，不要直接复制粘贴）\n    mob-spawn-range: 4 #怪物生成距离，建议改成4\n    merge-radius: #善用掉落物/经验球合并可以大大降低掉落物/经验球卡服的可能\n      item: 3.0 #掉落物合并距离\n      exp: 4.8 #经验球合并距离\n    entity-tracking-range: #实体可见距离，不会影响性能但是会影响客户端和网络占用\n      other: 32\n      players: 32\n      monsters: 32\n      animals: 32\n      misc: 16\n复制代码"
        },
        {
            "author": "mcheheyixiao",
            "timestamp": 1588827720,
            "txt_content": "升级cpu吧"
        },
        {
            "author": "qsi7474741",
            "timestamp": 1588832760,
            "txt_content": "Salt_lovely 发表于 2020-5-7 13:00\n好像不是TPS问题，服务器应该没有过载（17.26% of tick）（但是timings最上面那个图加载不出来就很奇怪）， ...\n刚才那会服务器里没人，我特意开了个号去挂了会并挖了点东西进出了地狱门，然后又生成了一份，希望大佬再帮我看看\nhttps://timings.aikar.co/?id=0b0f25b57ff54d068758bccf3e9cabe2"
        },
        {
            "author": "Salt_lovely",
            "timestamp": 1588838520,
            "txt_content": "qsi7474741 发表于 2020-5-7 14:26\n刚才那会服务器里没人，我特意开了个号去挂了会并挖了点东西进出了地狱门，然后又生成了一份，希望大佬再 ...\n这个报告里面全程TPS20。\n\n虽然entityTick (SELF)、Connection Handler (SELF)占用很奇怪（之前没见过自身可以占用那么高的），但是我还是坚持我之前回答的内容（13楼）（你可以先试试，那些都是降低服务器压力的基本优化）\n\n此外，推荐换最新版的paper1.14，信不过我这个链接的话可以自己去找paper最新构建（我今天登不上去，可能是路由器炸了）"
        },
        {
            "author": "qq1831723028",
            "timestamp": 1588915080,
            "txt_content": "我觉得是物理的问题，你宽带太小了，你可以改按流量收费，别固定流量，这样就快很多貌似是不限制的"
        }
    ]
}