{
    "title": "求NPC脚本",
    "author": "DoZei",
    "replyCount": 5,
    "timestamp": 1584090240,
    "txt_content": "版本1.7.10 \n语言 ECMA\n\n我想在NPC死亡时候 延时执行一个命令\n\n以及有人进入这个世界的时候 重置所有NPC",
    "replies": [
        {
            "author": "粘兽",
            "timestamp": 1584090240,
            "txt_content": " 本帖最后由 粘兽 于 2020-3-13 18:03 编辑 \n\n问题1:\n写入killed钩子中\n死亡3000毫秒(3秒)后执行指令say test\nsetTimeout(function(){\n    npc.executeCommand('say test');\n},3000);\n\nfunction setTimeout(func,ms){\n    var Thread = Java.type('java.lang.Thread');\n    var MyRun = Java.extend(Java.type('java.lang.Runnable'),{\n        run: function(){\n            try{\n                Thread.sleep(ms);\n                func.apply();\n            }catch(err){\n                throw err;\n            }\n        }\n    });\n    new Thread(new MyRun()).start();\n}\n复制代码\n\n问题2:\n这是想做副本刷新?\n但这算一个系统，并不是我给你一块砖头就能砌好的。"
        },
        {
            "author": "DaiBM1",
            "timestamp": 1584091500,
            "txt_content": "ECMA指的是javascript吗"
        },
        {
            "author": "DoZei",
            "timestamp": 1584095040,
            "txt_content": "粘兽 发表于 2020-3-13 17:59\n问题1:\n写入killed钩子中\n死亡3000毫秒(3秒)后执行指令say test\n那粘可以给个问题2类似的解决方法吗\n能刷新就行"
        },
        {
            "author": "粘兽",
            "timestamp": 1584095100,
            "txt_content": "DoZei 发表于 2020-3-13 18:24\n那粘可以给个问题2类似的解决方法吗\n能刷新就行\n在适合的时候给npc用reset()方法"
        },
        {
            "author": "1042571047",
            "timestamp": 1584096300,
            "txt_content": "给每个NPC的更新项加上判断\nif(world.getBlock(x,y,z) != null){\n npc.reset();\n}\n然后每次玩家传送进这个世界都会踩到踏板 踏板下面隐藏黏性活塞 活塞黏住红石块 当玩家踩到踏板 红石块就会被推到x,y,z这个坐标\n同时x y z坐标旁藏一个命令方块 让玩家每次过来都会激活\n这个命令方块负责指令传送该玩家/tp 玩家 x y z，用来把玩家传送出这个出生地\n\nNPC判断到x y z有方块 就会自动重置 但是有一个很重要的点就是这些NPC得是区块载入者 否则他们不会在没玩家的时候运行脚本\n\n其实这样非常浪费区块资源 而且容易出现bug\n推荐是红石块被推动到xyz以后 用红石的那个延时的东西延迟玩家传送的时间 以免玩家已经传送 结果NPC没重置的问题\n\n思路给你了 具体的你自己看着办 要重置大量NPC我也很无奈"
        }
    ]
}