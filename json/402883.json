{
    "title": "MCPING攻击 原理及防御",
    "author": "1277832129",
    "replyCount": 36,
    "timestamp": 1423131540,
    "txt_content": " 本帖最后由 1277832129 于 2015-2-5 19:28 编辑 \n\n从昨天晚上开始,陆续在群里面看到几位服主服务器遭到攻击,大概检查了一下,发现原理很简单.\n\n先说下什么是PING攻击,不是CMD里面的那个PING,获取服务器MOTD后 客户端会向服务端发送PING包,来检测延迟,\n在熊吧看到,有人想通过获取MOTD的方式打服,那样太没效率,会因为使用的套接字太多,最后被服务器拦下的.\n但是通过PING攻击,只需要使用几个套接字即可,基本不会被抓.\n\n原理:\n先上图说说,ping攻击.我这里所演示的服务器,是某位熊孩子的,我就不说了.\n\n\n\n\n\n1.png (12.5 KB, 下载次数: 39)\n\n下载附件\n\n2015-2-5 17:26 上传\n\n\n\n\n\n\n如图所示红框部分,就是PING状态,并不是MOTD部分,而是单独的.怎么说好呢···总之先看吧.\n\n\n\n\n\n1.png (57.07 KB, 下载次数: 46)\n\n下载附件\n\n2015-2-5 17:29 上传\n\n\n\n\n\n\n如图所示,可以发现,在获取MOTD后 就可以发送PING包了 这个时候你PING一次 服务器同样也会返回一次,\n所以熊孩子估计就用了这点吧 \n\n\n先说说效果,一般的随便找台宽带不错的服务器,用差不多5个socket打服 就可以达到很好的效果,\n服务器那边的现象是,不会有任何提示,服务器无缘无故内存溢出(报错outofmemory),最后服务器崩溃.\n在这种情况下很难找到真实IP,所以很麻烦.因为是MC协议,防火墙也不会拦截,认为这是一次正常的访问.\n\n\n实战:\n我实战的目的只是为告诉大家威力,希望大家重视,不希望被熊孩子利用\n我选取了一台服务器,这台服务器是刚刚攻击其他人的,我只是用来做演示,并无恶意.\n根据原理 我写好了一套简单的工具 直接开始演示威力\n还是刚刚看到的那个服务器,开始攻击后\n\n\n\n\n\n1.png (393 Bytes, 下载次数: 38)\n\n下载附件\n\n2015-2-5 17:39 上传\n\n\n\n\n\n\n\n\n2.png (722 Bytes, 下载次数: 39)\n\n下载附件\n\n2015-2-5 17:39 上传\n\n\n\n\n\n\n可以看到宽带占用量大幅提高\n\n\n\n\n1.png (24.33 KB, 下载次数: 38)\n\n下载附件\n\n2015-2-5 18:28 上传\n\n\n\n\n\n一会可以看到 基本挂了 过不了多久 就会垮掉.\n\n\n防御：\n两种办法\n接到Ping包后 返回一次就行了 接着close掉socket\n或者是直接发完MOTD后 断开连接\n这里举两个例子\n\nBungeeCord服的自动防御:\n\n\n\n\n1.png (17.86 KB, 下载次数: 44)\n\n下载附件\n\n2015-2-5 18:11 上传\n\n\n\n\n\n\n如图所示 这样的好处在于 可以看到PING条 会是绿的\n\n一些MOTD为了满足特殊需求,不能发送PING包 但是歪打正着的防御了PING攻击 比如动态MOTD插件\n\n\n\n\n\n1.png (22.74 KB, 下载次数: 45)\n\n下载附件\n\n2015-2-5 18:15 上传\n\n\n\n\n\n\n\n\n2.png (29 KB, 下载次数: 42)\n\n下载附件\n\n2015-2-5 18:15 上传\n\n\n\n\n\n\n如图所示是一款动态MOTD插件抓包的截图,为了实现动态MOTD，不得不放弃PING.\n\n\n\n\n1.png (13.83 KB, 下载次数: 39)\n\n下载附件\n\n2015-2-5 18:16 上传\n\n\n\n\n\n可以看到这里的绿灯变成了红灯,这种方法也是有效的\n\n\n另外这个BUG也提交给保护插件的作者了 所以估计很快 保护插件 会增加这个的防御\n\n\n\n\n\n\n\n\n\n\n3.png\n(22.33 KB, 下载次数: 48)\n\n\n\n\n下载附件\n\n\n2015-2-5 17:39 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "Mayomi",
            "timestamp": 1423131780,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "LZX6238",
            "timestamp": 1423131780,
            "txt_content": "包括我的- -"
        },
        {
            "author": "lin998776",
            "timestamp": 1423131780,
            "txt_content": "{:10_492:}隆大神就是厉害"
        },
        {
            "author": "Johnny.R",
            "timestamp": 1423131780,
            "txt_content": "赞233333萨比隆就是powerful!"
        },
        {
            "author": "179962678",
            "timestamp": 1423131900,
            "txt_content": "已阅——来自Bakaの折痕的帐号"
        },
        {
            "author": "GenjiKai",
            "timestamp": 1423132380,
            "txt_content": "又是攻击\n感觉熊已经都变高端了呢"
        },
        {
            "author": "丶米饭",
            "timestamp": 1423132440,
            "txt_content": "不错。{:10_492:}"
        },
        {
            "author": "1395195415",
            "timestamp": 1423132500,
            "txt_content": "没看懂 哪个解决方法"
        },
        {
            "author": "sulu",
            "timestamp": 1423132800,
            "txt_content": "熊技术越来越叼了."
        },
        {
            "author": "shunmiaoxiaolin",
            "timestamp": 1423133340,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "HC20011015",
            "timestamp": 1423133400,
            "txt_content": "DOS攻击?"
        },
        {
            "author": "wjk13720041",
            "timestamp": 1423133820,
            "txt_content": "我看到周末云了我会乱说？"
        },
        {
            "author": "冰之魂魄",
            "timestamp": 1423134120,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "leavessoft",
            "timestamp": 1423138200,
            "txt_content": "感谢lz研究并分享，谢谢！"
        },
        {
            "author": "q1170695169",
            "timestamp": 1423191720,
            "txt_content": "能不能发一个动态MOTD插件，我总是被这样攻击！但是找不到这种插件！"
        },
        {
            "author": "1258400122@qq.c",
            "timestamp": 1423200600,
            "txt_content": "知道了  楼主真厉害"
        },
        {
            "author": "1258400122@qq.c",
            "timestamp": 1423200600,
            "txt_content": "看来 得加强防御"
        },
        {
            "author": "1258400122@qq.c",
            "timestamp": 1423200720,
            "txt_content": "额  这..我是打酱油的"
        },
        {
            "author": "我才是小灰灰",
            "timestamp": 1423200720,
            "txt_content": "这感觉就跟假人一样 能不能把假人问题给Mojang反映一下。。"
        },
        {
            "author": "282904893",
            "timestamp": 1423209720,
            "txt_content": "即使是动态motd想要防御都得去掉ping变量。"
        },
        {
            "author": "w253307725",
            "timestamp": 1423215780,
            "txt_content": "感谢lz研究并分享"
        },
        {
            "author": "caoli5288",
            "timestamp": 1423222860,
            "txt_content": "由插件防御比较麻烦，所以我打算直接修改服务端。\n代码已提交给spigot社区，上游版本修复由社区更新，1.7.10版本稍后放出。"
        },
        {
            "author": "a215051606",
            "timestamp": 1423288200,
            "txt_content": "顶顶顶，，，，，，，多点人看到才好"
        },
        {
            "author": "nick513",
            "timestamp": 1423299960,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "youyang",
            "timestamp": 1423320960,
            "txt_content": "我会告诉我完全没看懂么= =   熊孩子都成技术熊了现在"
        },
        {
            "author": "江湖神医",
            "timestamp": 1423414140,
            "txt_content": "yzr1933043571 发表于 2015-2-5 18:33\n又是攻击\n感觉熊已经都变高端了呢\n我一句都没看懂0.0"
        },
        {
            "author": "huanghongxun",
            "timestamp": 1423839420,
            "txt_content": "话说这个监视网络活动的软件叫啥= ="
        },
        {
            "author": "Lucency",
            "timestamp": 1424930580,
            "txt_content": "现在的熊还腻害啊{:10_524:}"
        },
        {
            "author": "奇迹之都",
            "timestamp": 1424959380,
            "txt_content": "LZ大人这个插件的MCBBS帖子没有标明是把插件扔进服务器的插件文件夹还是BC端的插件文件夹..跪求LZ解答..\n顺+LZ他们这个动态motd是怎么做的~"
        },
        {
            "author": "xcc",
            "timestamp": 1425027420,
            "txt_content": "攻击之后会怎么样呢。。。。"
        },
        {
            "author": "xcc",
            "timestamp": 1425027540,
            "txt_content": "攻击之后会怎么样呢。。。。崩溃而已。。。。。"
        },
        {
            "author": "zouchanglin",
            "timestamp": 1425791580,
            "txt_content": "群里是舍意思，。。  有群号嘛..."
        },
        {
            "author": "Spker",
            "timestamp": 1425888660,
            "txt_content": "攻击分好多种,ICMP也就是ping攻击,这个最好防御,UDP纯流量还有SYN攻击,.这些不好防吧~"
        },
        {
            "author": "4one_R",
            "timestamp": 1432029840,
            "txt_content": "0F 00 2F 31 32 37 2E 30 2E 30 2E 31 63 DD 01"
        },
        {
            "author": "pmpklover",
            "timestamp": 1436764740,
            "txt_content": "Spker 发表于 2015-3-9 16:11\n攻击分好多种,ICMP也就是ping攻击,这个最好防御,UDP纯流量还有SYN攻击,.这些不好防吧~ ...\n遇到这种攻击就只能硬件防火墙了"
        },
        {
            "author": "喵喵人",
            "timestamp": 1444975320,
            "txt_content": "国内熊孩子总是给国内的MC业造成严重打击"
        }
    ]
}