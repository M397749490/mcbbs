{
    "title": "[原创][MiaoScript] ItemTag —— 让掉落在物品上的显示名称 [1.8+]",
    "author": "yumc",
    "replyCount": 10,
    "timestamp": 1515502200,
    "txt_content": " 本帖最后由 yumc 于 2019-9-19 11:01 编辑 \n\nItemTag\n这是一个 MiaoScript 脚本插件 同时支持 Bukkit Sponge 本体插件传送门 => MiaoScript\n新版本MiaoScript将在9月底发布 具体进展请加群 650545561\n\n\n使用 MPM 包管理工具安装当前插件 mpm install ItemTag\n脚本源码\n\n'use strict';\n/*global Java, base, module, exports, require*/\n\nvar event = require('api/event');\nvar wrapper = require('api/wrapper');\nvar command = require('api/command');\nvar server = require('api/server');\nvar http = require('http');\nvar fs = require('fs');\n\nvar nameMap = [];\n\nvar description = {\n    name: 'ItemTag',\n    version: '1.0',\n    author: '喵♂呜'\n};\n\nvar itemConfig;\n\nfunction load() {\n    var itemFile = self.file('item.yml');\n    if (!itemFile.exists()) {\n        base.save(itemFile, http.get('https://data.yumc.pw/config/Item_zh_CN.yml'));\n    }\n    itemConfig = self.getConfig('item.yml');\n}\n\nfunction enable() {\n    switch (DetectServerType) {\n        case ServerType.Bukkit:\n            event.on(self, 'ItemMergeEvent', function (event) {\n                bukkit(event.target, event.entity.itemStack.amount + event.target.itemStack.amount);\n            })\n            event.on(self, 'ItemSpawnEvent', function (event) {\n                if (event.entity.itemStack) {\n                    bukkit(event.entity, event.entity.itemStack.amount);\n                }\n            })\n            break;\n        case ServerType.Sponge:\n            event.on(self, 'itemmergeitemevent', function (event) {\n                // Sponge 暂未实现当前事件\n            })\n            event.on(self, 'spawnentityevent', function (event) {\n                event.entities.forEach(function (entity) {\n                    if (entity.type.name === \"item\") sponge(entity);\n                })\n            })\n            break;\n    }\n}\n\nfunction getItemName(name) {\n    return itemConfig[(name + '').toUpperCase()] || name;\n}\n\nfunction bukkit(item , amount) {\n    var amounts = amount == 1 ? \"\" : \"*\" + amount;\n    item.setCustomName('§b' + getItemName(item.itemStack.type) + amounts);\n    item.setCustomNameVisible(true);\n}\n\nfunction sponge(entity) {\n    var itemOptional = entity.get(Keys.REPRESENTED_ITEM);\n    if (itemOptional.isPresent()) {\n        var item = itemOptional.get();\n        var amounts = item.count == 1 ? \"\" : \"*\" + item.count;\n        entity.offer(org.spongepowered.api.data.key.Keys.DISPLAY_NAME, org.spongepowered.api.text.Text.of('§b' + getItemName(item.type.name.split(':')[1]) + amounts));\n        entity.offer(org.spongepowered.api.data.key.Keys.CUSTOM_NAME_VISIBLE, true);\n    }\n}\n\nmodule.exports = {\n    description: description,\n    load: load,\n    enable: enable,\n    disable: disable\n};复制代码使用方式 先安装 MiaoScriptPackageManager然后输入命令 mpm install ItemTag\n效果图\n\nBukkit 效果图\n\n\n\n\nQQ图片20180109204821.png (202.08 KB, 下载次数: 6)\n\n下载附件\n\n2018-1-9 20:48 上传\n\n\n\n\n\nSponge 效果图\n\n\n\n\nQQ图片20180109204826.jpg (150.56 KB, 下载次数: 2)\n\n下载附件\n\n2018-1-9 20:49 上传\n\n\n\n\n\n\n\n[groupid=1465]银河系气功协会[/groupid]",
    "replies": [
        {
            "author": "雲都",
            "timestamp": 1515502560,
            "txt_content": "大佬的效率就是高，我这个菜鸡连第一个编辑器都没写完"
        },
        {
            "author": "guiqikan",
            "timestamp": 1515502680,
            "txt_content": "日常围观大佬(然而我只会一点点插件"
        },
        {
            "author": "498525451",
            "timestamp": 1515510840,
            "txt_content": "大佬又出来放插件了，顶顶顶。"
        },
        {
            "author": "li709854423",
            "timestamp": 1515512940,
            "txt_content": "仰望。我也要学习用喵了"
        },
        {
            "author": "背着书包丶",
            "timestamp": 1515665520,
            "txt_content": "Cauldron支持吗"
        },
        {
            "author": "ffloverr00",
            "timestamp": 1515667680,
            "txt_content": "按照步骤来的，这是啥意思啊。。1.71的\n\n\n\n\n\nMK1(NY6O}0J7MN0AS~FEJPQ.png\n(87.23 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2018-1-11 18:47 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        {
            "author": "yumc",
            "timestamp": 1515723960,
            "txt_content": "ffloverr00 发表于 2018-1-11 18:48\n按照步骤来的，这是啥意思啊。。1.71的\n不好意思 忘了改了 这个不支持1.7.10 只支持1.8以上的"
        },
        {
            "author": "yumc",
            "timestamp": 1515724020,
            "txt_content": "背着书包丶 发表于 2018-1-11 18:12\nCauldron支持吗\n支持1.8+的"
        },
        {
            "author": "弈缘仙阁丶",
            "timestamp": 1574485380,
            "txt_content": "大哥 1.7.10可以使用嘛"
        },
        {
            "author": "Onism_",
            "timestamp": 1595774880,
            "txt_content": "作者大大，出现这个原因是怎么回事\n[22:38:02 INFO]: [MS][PM] 开始下载插件: ItemTag\n[22:38:02 INFO]: [MiaoScript] 插件执行任务时发生错误 TypeError: Cannot read property \"url\" from undefined\n[22:38:02 INFO]: [MiaoScript] TypeError: Cannot read property \"url\" from undefined\n[22:38:02 INFO]: [MiaoScript]     -> \\plugins\\MiaoScriptPackageManager.js:293 => <anonymous>\n[22:38:02 INFO]: [MiaoScript]     -> \\node_modules\\@ccms\\api\\src\\task.ts:63 => run\n[22:38:02 INFO]: [MiaoScript]     -> \\node_modules\\@ccms\\bukkit\\src\\task.ts:27 => run\n\n"
        }
    ]
}