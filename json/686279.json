{
    "title": "【易语言】Minecraft启动器源码分享",
    "author": "Mc2raft",
    "replyCount": 11,
    "timestamp": 1492001700,
    "txt_content": " 本帖最后由 Mc2raft 于 2017-4-13 17:59 编辑 \n\n前言\n\n由于LZ第一次发帖，所以请多多谅解！不好的地方可以在评论留言。谢谢！\n本启动器源码部分来自互联网，如果你的权益受损可以在评论留言，LZ会尽快删除！谢谢合作！\n本源码仅供学习，请勿用于商业用途！否则后果自负！\n废话说完！\n\n源码下面是激动人心的源码！\n1.首先打开易语言5.6（废话）\n\n2.然后新建一个窗口程序（好像也是废话）\n\n\n\n\n\n2345截图20170412202015.png (54.07 KB, 下载次数: 12)\n\n下载附件\n\n易语言\n2017-4-12 20:04 上传\n\n\n\n\n\n\n3.新建DLL命令,复制源码:\n\n\n\n\n\n2345截图20170412202344.png (87.36 KB, 下载次数: 0)\n\n下载附件\n\n2017-4-12 20:08 上传\n\n\n\n\n\n\n.版本 2\n\n.DLL命令 GetCurrentProcess, 整数型, \"kernel32.dll\", \"GetCurrentProcess\"\n\n.DLL命令 API_RegQueryValueEx, 整数型, \"advapi32.dll\", \"RegQueryValueExA\", , 获取一个项的设置值　零（ERROR_SUCCESS）表示成功。其他任何值都代表一个错误代码\n    .参数 hKey, 整数型, , 一个已打开项的句柄，或者指定一个标准项名\n    .参数 lpValueName, 文本型, , 要获取值的名字\n    .参数 lpReserved, 整数型, , 未用，设为零\n    .参数 lpType, 整数型, , 用于装载取回数据类型的一个变量\n    .参数 lpData, 整数型, , 用于装载指定值的一个缓冲区\n    .参数 lpcbData, 整数型, , 用于装载lpData缓冲区长度的一个变量。一旦返回，它会设为实际装载到缓冲区的字节数;\n\n.DLL命令 GetProcAddress, 整数型, \"kernel32.dll\", \"GetProcAddress\"\n    .参数 hModule, 整数型\n    .参数 lpProcName, 文本型\n\n.DLL命令 LoadLibrary, 整数型, \"kernel32.dll\", \"LoadLibraryA\"\n    .参数 lpFileName, 文本型\n\n.DLL命令 GetSystemDirectory, 整数型, \"kernel32.dll\", \"GetSystemDirectoryA\"\n    .参数 lpBuffer, 文本型, 传址\n    .参数 uSize, 整数型\n\n.DLL命令 IsWow64Process, 整数型, \"kernel32.dll\", \"IsWow64Process\"\n    .参数 Process, 整数型\n    .参数 IsWow64Process, 逻辑型, 传址\n\n.DLL命令 API_RegEnableReflectionKey, 整数型, \"advapi32.dll\", \"RegEnableReflectionKey\"\n    .参数 hBase, 整数型\n\n.DLL命令 API_Wow64RevertWow64FsRedirection, 逻辑型, \"kernel32.dll\", \"Wow64RevertWow64FsRedirection\"\n    .参数 oldvalue, 整数型\n\n.DLL命令 API_RegCloseKey, 整数型, \"advapi32.dll\", \"RegCloseKey\", , 关闭系统注册表中的一个项（或键）　零（ERROR_SUCCESS）表示成功。其他任何值都代表一个错误代码\n    .参数 hKey, 整数型, , 要关闭的项;\n\n.DLL命令 API_RegDisableReflectionKey, 整数型, \"advapi32.dll\", \"RegDisableReflectionKey\"\n    .参数 hBase, 整数型\n\n.DLL命令 FreeLibrary, 整数型, \"kernel32.dll\", \"FreeLibraryA\"\n    .参数 hModule, 整数型\n\n.DLL命令 API_RegOpenKeyEx, 整数型, \"advapi32.dll\", \"RegOpenKeyExA\", , 打开一个现有的项。在win32下推荐使用这个函数　零（ERROR_SUCCESS）表示成功。其他任何值都代表一个错误代码\n    .参数 hKey, 整数型, , 一个已打开项的句柄，或指定一个标准项名\n    .参数 lpSubKey, 文本型, , 欲打开注册表项的名字\n    .参数 ulOptions, 整数型, , 未用，设为零\n    .参数 samDesired, 整数型, , 带有前缀KEY_??的一个或多个常数。它们的组合描述了允许对这个项进行哪些操作\n    .参数 phkResult, 整数型, , 用于装载打开项的名字的一个变量;\n\n.DLL命令 GlobalMemoryStatusEx, 整数型, \"kernel32.dll\", \"GlobalMemoryStatusEx\"\n    .参数 lpBuffer, MEMORYSTATUSEX\n\n.DLL命令 CoInitialize, , \"ole32.dll\", \"CoInitialize\", , 　\n    .参数 pvReserved, 整数型\n\n.DLL命令 CoUninitialize, , \"ole32.dll\", \"CoUninitialize\", , 　\n\n.DLL命令 CreateProcessA, 整数型, \"kernel32.dll\"\n    .参数 lpApplicationName, 文本型\n    .参数 lpCommandLine, 文本型\n    .参数 lpProcessAttributes, 整数型\n    .参数 lpThreadAttributes, 整数型\n    .参数 bInheritHandles, 整数型\n    .参数 dwCreationFlags, 整数型\n    .参数 lpEnvironment, 整数型\n    .参数 lpCurrentDriectory, 文本型\n    .参数 lpStartupInfo, StartupInfo\n    .参数 lpProcessInformation, 进程结构\n\n.DLL命令 InternetOpenA, 整数型, \"wininet.dll\", \"InternetOpenA\", , Internet激活\n    .参数 句柄名称, 文本型, 传址\n    .参数 连接类型, 整数型, , 1直接连接;3代理连接\n    .参数 代理地址, 文本型, 传址\n    .参数 代理掩码, 文本型, 传址\n    .参数 dwFlags, 整数型, , 0\n\n.DLL命令 API_Wow64DisableWow64FsRedirection, 逻辑型, \"kernel32.dll\", \"Wow64DisableWow64FsRedirection\"\n    .参数 oldvalue, 整数型, 传址\n\n.DLL命令 InternetCloseHandle, 逻辑型, \"wininet.dll\", \"InternetCloseHandle\", , Internet关闭句柄\n    .参数 句柄, 整数型\n\n.DLL命令 InternetConnectA, 整数型, \"wininet.dll\", \"InternetConnectA\", , Internet建立连接\n    .参数 Internet句柄, 整数型\n    .参数 域名, 文本型, 传址\n    .参数 服务器端口, 整数型, , 80HTTP;21FTP;\n    .参数 用户名, 文本型, 传址, 空\n    .参数 用户口令, 文本型, 传址, 空\n    .参数 服务类型, 整数型, , 1FTP;3HTTP\n    .参数 dwFlags, 整数型, , 0http;134217728被动FTP模式\n    .参数 dwContext, 整数型, , 0\n\n.DLL命令 HttpOpenRequestA, 整数型, \"wininet.dll\", \"HttpOpenRequestA\", , Http创建请求\n    .参数 Internet连接句柄, 整数型, , 由Internet建立连接返回\n    .参数 访问方式, 文本型, 传址, \"GET\" or \"POST\"为空默认GET\n    .参数 页面路径, 文本型, 传址, 简短路径,不带域名\n    .参数 协议版本, 文本型, 传址, 为空默认HTTP/1.1\n    .参数 引用页, 文本型, 传址, 可为空\n    .参数 识别类型, 文本型, 传址, 可为空\n    .参数 dwFlags, 整数型, , 2147483648更新下载\n    .参数 dwContext, 整数型, , 0\n\n.DLL命令 HttpSendRequestA, 逻辑型, \"wininet.dll\", \"HttpSendRequestA\", , Http发送请求\n    .参数 HTTP请求句柄, 整数型\n    .参数 附加协议头, 文本型, 传址\n    .参数 附加协议头长度, 整数型\n    .参数 提交信息, 文本型, 传址\n    .参数 提交信息长度, 整数型\n\n.DLL命令 HttpSendRequestA_字节集, 逻辑型, \"wininet.dll\", \"HttpSendRequestA\", , Http发送请求\n    .参数 HTTP请求句柄, 整数型\n    .参数 附加协议头, 文本型, 传址\n    .参数 附加协议头长度, 整数型\n    .参数 提交信息, 字节集, 传址\n    .参数 提交信息长度, 整数型\n\n.DLL命令 InternetReadFile, 逻辑型, \"wininet.dll\", \"InternetReadFile\", , Internet读文件\n    .参数 HTTP请求句柄, 整数型\n    .参数 sBuffer, 字节集, 传址\n    .参数 lNumBytesToRead, 整数型\n    .参数 lNumberOfBytesRead, 整数型, 传址\n\n.DLL命令 HttpQueryInfoA, 逻辑型, \"wininet.dll\", \"HttpQueryInfoA\", , HTTP查询信息\n    .参数 Internet请求句柄, 整数型\n    .参数 待查信息, 整数型, , 22返回所有信息;43SET_COOKIE;+2147483648返回文本\n    .参数 返回容器, 文本型, 传址\n    .参数 返回容器长度, 整数型, 传址\n    .参数 lpdwIndex, 整数型复制代码\n\n\n\n4.创建数据类型，复制源码：\n\n\n\n\n\n2345截图20170412202921.png (97.97 KB, 下载次数: 0)\n\n下载附件\n\n2017-4-12 20:31 上传\n\n\n\n\n\n\n.版本 2\n\n.数据类型 正版验证, 公开\n    .成员 name, 文本型, , , 正版游戏名，如果失败返回“”\n    .成员 uuid, 文本型, , , 正版UUID数据，如果失败返回“”\n    .成员 accessToken, 文本型, , , 登录用动态token，如果失败返回“”\n    .成员 twitchToken, 文本型, , , Twitch返回数据，如果没有绑定会返回“”判断是否登录成功无需判断此项，貌似国内被墙了\n\n.数据类型 进程结构\n    .成员 进程句柄, 整数型, , , hProcess\n    .成员 线程句柄, 整数型, , , hThread\n    .成员 进程标识符, 整数型, , , dwProcessId\n    .成员 线程标识符, 整数型, , , dwThreadId\n\n.数据类型 MEMORYSTATUSEX\n    .成员 dwLength, 整数型, , , 64\n    .成员 dwMemoryLoad, 整数型\n    .成员 ullTotalPhys, 长整数型\n    .成员 ullAvailPhys, 长整数型\n    .成员 ullTotalPageFile, 长整数型\n    .成员 ullAvailPageFile, 长整数型\n    .成员 ullTotalVirtual, 长整数型\n    .成员 ullAvailVirtual, 长整数型\n    .成员 ullAvailExtendedVirtual, 长整数型\n\n.数据类型 StartupInfo\n    .成员 cbSize, 整数型\n    .成员 lpReserved, 整数型\n    .成员 lpDesktop, 整数型\n    .成员 lpTitle, 整数型\n    .成员 dwX, 整数型\n    .成员 dwY, 整数型\n    .成员 dwXSize, 整数型\n    .成员 dwYSize, 整数型\n    .成员 dwXCountChars, 整数型\n    .成员 dwYCountChars, 整数型\n    .成员 dwFillAttribute, 整数型\n    .成员 dwFlags, 整数型\n    .成员 wShowWindow, 长整数型\n    .成员 cbReserved2, 长整数型\n    .成员 lpReserved2, 整数型\n    .成员 hStdInput, 整数型\n    .成员 hStdOutput, 整数型\n    .成员 hStdError, 整数型复制代码\n5.查看全局变量，复制源码：\n\n\n\n\n\n2345截图20170412203256.png (77.54 KB, 下载次数: 0)\n\n下载附件\n\n2017-4-12 20:34 上传\n\n\n\n\n\n\n.版本 2\n\n.全局变量 启动命令行, 文本型, 公开, , 返回启动用命令行复制代码\n6.创建程序集，复制源码：\n\n\n\n\n\n2345截图20170412203609.png (97.44 KB, 下载次数: 0)\n\n下载附件\n\n2017-4-12 20:20 上传\n\n\n\n\n\n.版本 2\n\n.程序集 程序集_调用功能\n\n.子程序 文本_替换, 文本型, , 批量替换文本；\n.参数 原文本, 文本型\n.参数 替换进行的次数, 整数型, 可空, 可空；参数值指定对子文本进行替换的次数。如果省略，默认进行所有可能的替换。\n.参数 替换的起始位置, 整数型, 可空, 可空；参数值指定被替换子文本的起始搜索位置。如果省轮，默认从 1 开始\n.参数 是否区分大小写, 逻辑型, 可空, 可空； 初始值为“假”不区分大小写；为真区分大小写。\n.参数 欲被替换的子文本1, 文本型\n.参数 用作替换的子文本1, 文本型\n.参数 欲被替换的子文本2, 文本型, 可空\n.参数 用作替换的子文本2, 文本型, 可空\n.参数 欲被替换的子文本3, 文本型, 可空\n.参数 用作替换的子文本3, 文本型, 可空\n.参数 欲被替换的子文本4, 文本型, 可空\n.参数 用作替换的子文本4, 文本型, 可空\n.参数 欲被替换的子文本5, 文本型, 可空\n.参数 用作替换的子文本5, 文本型, 可空\n.局部变量 局_文本, 文本型\n\n.如果真 (替换的起始位置 ＝ 0)\n    替换的起始位置 ＝ 1\n.如果真结束\n.如果 (是否为空 (替换进行的次数))\n    局_文本 ＝ 子文本替换 (原文本, 欲被替换的子文本1, 用作替换的子文本1, 替换的起始位置, , 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本2, 用作替换的子文本2, 替换的起始位置, , 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本3, 用作替换的子文本3, 替换的起始位置, , 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本4, 用作替换的子文本4, 替换的起始位置, , 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本5, 用作替换的子文本5, 替换的起始位置, , 是否区分大小写)\n.否则\n    局_文本 ＝ 子文本替换 (原文本, 欲被替换的子文本1, 用作替换的子文本1, 替换的起始位置, 替换进行的次数, 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本2, 用作替换的子文本2, 替换的起始位置, 替换进行的次数, 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本3, 用作替换的子文本3, 替换的起始位置, 替换进行的次数, 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本4, 用作替换的子文本4, 替换的起始位置, 替换进行的次数, 是否区分大小写)\n    局_文本 ＝ 子文本替换 (局_文本, 欲被替换的子文本5, 用作替换的子文本5, 替换的起始位置, 替换进行的次数, 是否区分大小写)\n.如果结束\n返回 (局_文本)\n\n.子程序 文本_取出中间文本, 文本型, , 比如：欲取全文本为“12345”,现在要取出“3”，<3>的前面为“2”，<3>的后面为“4”，\n.参数 欲取全文本, 文本型, , 比如：欲取全文本为 12345\n.参数 前面文本, 文本型, , 3的前面为“2”，引号直接用 #引号，如：\"<font color=#引号red#引号>\"\n.参数 后面文本, 文本型, , 3的后面为“4”，引号直接用 #引号，如：\"<font color=#引号red#引号>\"\n.参数 起始搜寻位置, 整数型, 可空, 可空,这里是指搜寻 参数二 前面文本 的开始位置\n.参数 是否不区分大小写, 逻辑型, 可空, 为真不区分大小写，为假区分。\n.局部变量 局_前面文本位置, 整数型\n.局部变量 局_后面文本位置, 整数型\n.局部变量 局_前面文本, 文本型\n.局部变量 局_后面文本, 文本型\n\n局_前面文本 ＝ 子文本替换 (前面文本, “#引号”, #引号, , , 真)\n局_后面文本 ＝ 子文本替换 (后面文本, “#引号”, #引号, , , 真)\n局_前面文本位置 ＝ 寻找文本 (欲取全文本, 局_前面文本, 起始搜寻位置, 是否不区分大小写)\n.如果真 (局_前面文本位置 ≠ -1)\n    局_前面文本位置 ＝ 局_前面文本位置 ＋ 取文本长度 (局_前面文本)\n.如果真结束\n局_后面文本位置 ＝ 寻找文本 (欲取全文本, 局_后面文本, 局_前面文本位置, 是否不区分大小写)\n.如果真 (局_前面文本位置 ＝ -1 或 局_后面文本位置 ＝ -1)\n    返回 (“”)\n.如果真结束\n返回 (取文本中间 (欲取全文本, 局_前面文本位置, 局_后面文本位置 － 局_前面文本位置))\n\n.子程序 文本_取中间_批量, 整数型, , 比如：欲取全文本为<12345>,现在要取出“3”，<3>的前面为“2”，<3>的后面为“4”\n.参数 源文本, 文本型, , 比如：欲取全文本为 12345\n.参数 前面标识文本, 文本型, , 3的前面为“2”\n.参数 后面标识文本, 文本型, , 3的后面为“4”\n.参数 存放取出文本的数组, 文本型, 可空 数组, 存放取出文本的数组\n.参数 是否区分大小写, 逻辑型, 可空, 是否区分大小写\n.参数 文本长度大于此数的不要, 整数型, 可空, 文本长度大于此数的不要;如取出的文本大于50的不要;留空为不限制\n.参数 为取出的文本加上前缀, 文本型, 可空, 在取出的文本前面加上一段字符或汉字！可空！\n.参数 为取出的文本加上后缀, 文本型, 可空, 在取出的文本后面加上一段字符或汉字！可空！\n.参数 连前面标识文本一起取出, 逻辑型, 可空, 是否连<前面标识文本>一起取出? 默认为假，不取出！\n.参数 连后面标识文本一起取出, 逻辑型, 可空, 是否连<后面标识文本>一起取出? 默认为假，不取出！\n.参数 起始搜寻位置, 整数型, 可空, 注明：位置值从 1 开始。如果本参数被省略，默认为 1 。\n.局部变量 局_数组, 文本型, , \"0\"\n.局部变量 局_首次, 逻辑型, 静态\n.局部变量 局_结果, 文本型\n.局部变量 局_位置, 整数型\n.局部变量 局_位置1, 整数型\n\n.如果真 (取反 (局_首次))\n    清除数组 (存放取出文本的数组)\n.如果真结束\n局_首次 ＝ 真\n' //上面这段代码必须加上，判断是否第一次调用该子程序，返回后在初始化\n是否区分大小写 ＝ 取反 (是否区分大小写)\n\n\n' 局_位置 ＝ 寻找文本 (源文本, 前面标识文本, 起始搜寻位置, 是否区分大小写) ＋ 1\n局_位置 ＝ 寻找文本 (源文本, 前面标识文本, 起始搜寻位置, 是否区分大小写)\n\n\n局_位置1 ＝ 寻找文本 (源文本, 后面标识文本, 局_位置 ＋ 取文本长度 (前面标识文本), 是否区分大小写)\n.如果真 (局_位置 ＜ 1 或 局_位置1 ＜ 1)\n    返回 (0)\n.如果真结束\n\n\n' 局_位置 ＝ 局_位置 ＋ 取文本长度 (前面标识文本) － 1\n局_位置 ＝ 局_位置 ＋ 取文本长度 (前面标识文本)\n\n\n局_结果 ＝ 删首尾空 (取文本中间 (源文本, 局_位置, 局_位置1 － 局_位置))\n.如果真 (局_结果 ＝ “”)\n    返回 (0)\n.如果真结束\n.如果真 (文本长度大于此数的不要 ≠ 0 且 取文本长度 (局_结果) ＞ 文本长度大于此数的不要)\n    返回 (0)\n.如果真结束\n局_结果 ＝ 为取出的文本加上前缀 ＋ 局_结果\n局_结果 ＝ 局_结果 ＋ 为取出的文本加上后缀\n.如果真 (连前面标识文本一起取出)\n    局_结果 ＝ 前面标识文本 ＋ 局_结果\n.如果真结束\n.如果真 (连后面标识文本一起取出)\n    局_结果 ＝ 局_结果 ＋ 后面标识文本\n.如果真结束\n加入成员 (存放取出文本的数组, 局_结果)\n文本_取中间_批量 (源文本, 前面标识文本, 后面标识文本, 存放取出文本的数组, 是否区分大小写, 文本长度大于此数的不要, 为取出的文本加上前缀, 为取出的文本加上后缀, 连前面标识文本一起取出, 连后面标识文本一起取出, 局_位置1)\n局_首次 ＝ 假\n返回 (取数组成员数 (存放取出文本的数组))\n\n.子程序 进程_创建, 整数型, , 创建一个程序进程(成功返回进程ID,失败返回0)\n.参数 程序路径, 文本型, , 欲创建进程的执行路径\n.参数 命令行, 文本型, 可空, 附加上程序路径后的命令行参数\n.参数 运行目录, 文本型, 可空, 通常留空,特殊情况下使用\n.参数 进程结构, 进程结构, 参考 可空, 接收进程结构信息的变量\n.局部变量 窗口结构, StartupInfo\n\n.如果真 (运行目录 ＝ “”)\n    运行目录 ＝ 取文本左边 (程序路径, 倒找文本 (程序路径, “\\”, , 假))\n.如果真结束\nCreateProcessA (程序路径, 命令行, 0, 0, 0, 0, 0, 运行目录, 窗口结构, 进程结构)\n返回 (进程结构.进程标识符)\n\n.子程序 网页_访问, 字节集, , 使用WinInet的方式访问网页\n.参数 网址, 文本型, , 完整的网页地址,必须包含http://或者https://\n.参数 访问方式, 整数型, 可空, 0=GET 1=POST\n.参数 提交信息, 文本型, 可空, POST专用\n.参数 提交Cookies, 文本型, 参考 可空, 本参数传递变量时会自动回传返回的Cookie\n.参数 返回Cookies, 文本型, 可空, 返回的Cookie\n.参数 附加协议头, 文本型, 可空, 一行一个请用换行符隔开,建议填写常量值或文本值,防止因传参引发错误\n.参数 返回协议头, 文本型, 参考 可空, Location\n.参数 禁止重定向, 逻辑型, 可空, 默认不禁止网页重定向\n.参数 字节集提交, 字节集, 可空, 提交字节集数据\n.参数 代理地址, 文本型, 可空, 代理地址，格式为 8.8.8.8:88\n.参数 完整协议头, 文本型, 参考 可空, 返回完整的协议头\n.局部变量 局_Internet句柄, 整数型\n.局部变量 局_Internet连接句柄, 整数型\n.局部变量 局_HTTP请求句柄, 整数型\n.局部变量 局_计次, 整数型\n.局部变量 局_字节集, 字节集\n.局部变量 局_访问方式, 文本型\n.局部变量 局_User_Agent, 文本型\n.局部变量 局_返回Cookies, 文本型, , \"0\"\n.局部变量 局_页面内容, 字节集\n.局部变量 局_请求标记, 整数型\n.局部变量 局_重定向地址, 文本型\n\n局_访问方式 ＝ 选择 (访问方式 ＝ 1, “POST”, “GET”)\n.如果 (寻找文本 (附加协议头, “User-Agent:”, , 真) ≠ -1)\n    局_User_Agent ＝ 删首尾空 (文本_取出中间文本 (附加协议头, “User-Agent:”, #换行符))\n    .如果真 (局_User_Agent ＝ “”)\n        局_User_Agent ＝ 内部_协议头取值 (附加协议头)\n    .如果真结束\n\n.否则\n    局_User_Agent ＝ “Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; 125LA; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)”\n.如果结束\n\n.如果 (是否为空 (代理地址))\n    局_Internet句柄 ＝ InternetOpenA (局_User_Agent, 1, 字符 (0), 字符 (0), 0)\n.否则\n    局_Internet句柄 ＝ InternetOpenA (局_User_Agent, 3, “http=” ＋ 代理地址, “”, 0)\n.如果结束\n\n.如果真 (局_Internet句柄 ＝ 0)\n    InternetCloseHandle (局_Internet句柄)\n    返回 ({  })\n.如果真结束\n\n局_Internet连接句柄 ＝ InternetConnectA (局_Internet句柄, 网页_取域名 (网址), 网页_取端口 (网址), 字符 (0), 字符 (0), 3, 0, 0)\n.如果真 (局_Internet连接句柄 ＝ 0)\n    InternetCloseHandle (局_Internet连接句柄)\n    InternetCloseHandle (局_Internet句柄)\n    返回 ({  })\n.如果真结束\n\n局_请求标记 ＝ 位或 (#INTERNET_FLAG_RELOAD, #INTERNET_COOKIE_THIRD_PARTY)\n.如果真 (取反 (是否为空 (提交Cookies)))\n    局_请求标记 ＝ 位或 (局_请求标记, #INTERNET_FLAG_NO_COOKIES)\n.如果真结束\n\n.如果真 (禁止重定向)\n    局_请求标记 ＝ 位或 (局_请求标记, #INTERNET_FLAG_NO_AUTO_REDIRECT)\n.如果真结束\n\n.如果 (到小写 (取文本左边 (网址, 5)) ＝ “https”)\n    局_请求标记 ＝ 位或 (局_请求标记, #INTERNET_FLAG_SECURE)\n.否则\n    局_请求标记 ＝ 位或 (局_请求标记, #INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS)\n.如果结束\n\n局_HTTP请求句柄 ＝ HttpOpenRequestA (局_Internet连接句柄, 局_访问方式, 网页_取页面地址 (网址), “HTTP/1.1”, 字符 (0), 字符 (0), 局_请求标记, 0)\n.如果真 (局_HTTP请求句柄 ＝ 0)\n    InternetCloseHandle (局_HTTP请求句柄)\n    InternetCloseHandle (局_Internet连接句柄)\n    InternetCloseHandle (局_Internet句柄)\n    返回 ({  })\n.如果真结束\n\n.如果真 (寻找文本 (附加协议头, “Referer:”, , 假) ＝ -1)\n    .判断开始 (附加协议头 ＝ “”)\n        附加协议头 ＝ “Referer: ” ＋ 网址\n    .默认\n        附加协议头 ＝ 附加协议头 ＋ #换行符 ＋ “Referer: ” ＋ 网址\n    .判断结束\n\n.如果真结束\n\n.如果真 (寻找文本 (附加协议头, “Accept:”, , 假) ＝ -1)\n    附加协议头 ＝ 附加协议头 ＋ #换行符 ＋ “Accept: */*”\n.如果真结束\n\n.如果真 (寻找文本 (附加协议头, “Accept-Language:”, , 假) ＝ -1)\n    附加协议头 ＝ 附加协议头 ＋ #换行符 ＋ “Accept-Language: zh-cn”\n.如果真结束\n\n.如果真 (寻找文本 (附加协议头, “Content-Type:”, , 假) ＝ -1)\n    附加协议头 ＝ 附加协议头 ＋ #换行符 ＋ “Content-Type: application/x-www-form-urlencoded”\n.如果真结束\n\n.如果真 (提交Cookies ≠ “”)\n    附加协议头 ＝ 附加协议头 ＋ #换行符 ＋ “Cookie: ” ＋ 提交Cookies\n.如果真结束\n\n.判断开始 (访问方式 ＝ 0)\n    HttpSendRequestA (局_HTTP请求句柄, 附加协议头, 取文本长度 (附加协议头), “”, 0)\n.默认\n    .如果真 (字节集提交 ＝ {  })\n        字节集提交 ＝ 到字节集 (提交信息)\n    .如果真结束\n    HttpSendRequestA_字节集 (局_HTTP请求句柄, 附加协议头, 取文本长度 (附加协议头), 字节集提交, 取字节集长度 (字节集提交))\n.判断结束\n\n局_计次 ＝ 0\n.判断循环首 (真)\n    局_字节集 ＝ 取空白字节集 (1024)\n    InternetReadFile (局_HTTP请求句柄, 局_字节集, 1024, 局_计次)\n    .如果 (局_计次 ＝ 0)\n        跳出循环 ()\n    .否则\n        局_页面内容 ＝ 局_页面内容 ＋ 取字节集左边 (局_字节集, 局_计次)\n    .如果结束\n\n.判断循环尾 ()\n完整协议头 ＝ 取空白文本 (5000)\nHttpQueryInfoA (局_HTTP请求句柄, 22, 完整协议头, 5000, 0)\nInternetCloseHandle (局_HTTP请求句柄)\nInternetCloseHandle (局_Internet连接句柄)\nInternetCloseHandle (局_Internet句柄)\n\n局_返回Cookies ＝ 分割文本 (完整协议头, #换行符, )\n返回Cookies ＝ “”\n.计次循环首 (取数组成员数 (局_返回Cookies), 局_计次)\n    .如果真 (寻找文本 (局_返回Cookies [局_计次], “Location:”, , 假) ≠ -1)\n        返回协议头 ＝ 内部_协议头取值 (局_返回Cookies [局_计次])\n    .如果真结束\n\n    .如果真 (寻找文本 (局_返回Cookies [局_计次], “Set-Cookie”, , 假) ≠ -1)\n        返回Cookies ＝ 返回Cookies ＋ 删首尾空 (文本_取出中间文本 (局_返回Cookies [局_计次], “Set-Cookie:”, “;”)) ＋ “; ”\n    .如果真结束\n\n.计次循环尾 ()\n返回Cookies ＝ 取文本左边 (返回Cookies, 取文本长度 (返回Cookies) － 2)\n.如果真 (取反 (是否为空 (提交Cookies)))\n    网页_Cookie合并更新 (提交Cookies, 返回Cookies)\n.如果真结束\n\n.如果真 (返回协议头 ＝ “”)\n    返回协议头 ＝ 完整协议头\n.如果真结束\n返回 (局_页面内容)\n\n.子程序 网页_Cookie合并更新, 文本型, , 返回更新后的Cookie\n.参数 旧Cookie, 文本型, 参考\n.参数 新Cookie, 文本型\n.局部变量 局_旧Cookie组, 文本型, , \"0\"\n.局部变量 局_新Cookie组, 文本型, , \"0\"\n.局部变量 局_计次, 整数型\n\n' 初步格式化\n旧Cookie ＝ 删全部空 (旧Cookie)\n新Cookie ＝ 删全部空 (新Cookie)\n' 开始更新Cookie\n局_旧Cookie组 ＝ 分割文本 (旧Cookie, “;”, )\n局_新Cookie组 ＝ 分割文本 (新Cookie, “;”, )\n.计次循环首 (取数组成员数 (局_旧Cookie组), 局_计次)\n    .如果真 (内部_数组成员是否存在1 (局_新Cookie组, 内部_Cookie取名 (局_旧Cookie组 [局_计次])) ＝ 假)\n        加入成员 (局_新Cookie组, 局_旧Cookie组 [局_计次])\n    .如果真结束\n\n.计次循环尾 ()\n' 去除无效的Cookie\n旧Cookie ＝ “”\n.计次循环首 (取数组成员数 (局_新Cookie组), 局_计次)\n    .如果真 (取文本右边 (局_新Cookie组 [局_计次], 8) ≠ “=deleted”)\n        旧Cookie ＝ 旧Cookie ＋ 局_新Cookie组 [局_计次] ＋ “; ”\n    .如果真结束\n\n.计次循环尾 ()\n旧Cookie ＝ 取文本左边 (旧Cookie, 取文本长度 (旧Cookie) － 2)\n' 对重复的Cookie进行合并\n旧Cookie ＝ 文本_去重复文本 (旧Cookie, “; ”)\n返回 (旧Cookie)\n\n.子程序 文本_去重复文本, 文本型\n.参数 原文本, 文本型\n.参数 分割符, 文本型\n.局部变量 局_数组, 文本型, , \"0\"\n.局部变量 局_数组1, 文本型, , \"0\"\n.局部变量 局_计次, 整数型\n.局部变量 局_文本, 文本型\n\n局_数组 ＝ 分割文本 (原文本, 分割符, )\n.计次循环首 (取数组成员数 (局_数组), 局_计次)\n    .如果真 (内部_数组成员是否存在_文本 (局_数组1, 局_数组 [局_计次]) ＝ -1)\n        加入成员 (局_数组1, 局_数组 [局_计次])\n        局_文本 ＝ 局_文本 ＋ 局_数组 [局_计次] ＋ 分割符\n    .如果真结束\n\n.计次循环尾 ()\n局_文本 ＝ 取文本左边 (局_文本, 取文本长度 (局_文本) － 取文本长度 (分割符))\n返回 (局_文本)\n\n.子程序 内部_数组成员是否存在_文本, 整数型\n.参数 数组, 文本型, 数组\n.参数 要判断值, 文本型\n.局部变量 局_计次, 整数型\n\n.计次循环首 (取数组成员数 (数组), 局_计次)\n    .如果真 (数组 [局_计次] ＝ 要判断值)\n        返回 (局_计次)\n    .如果真结束\n\n.计次循环尾 ()\n返回 (-1)\n\n.子程序 内部_数组成员是否存在1, 逻辑型, , Cookie处理专用\n.参数 数组, 文本型, 数组\n.参数 要判断值, 文本型\n.局部变量 局_计次, 整数型\n\n.计次循环首 (取数组成员数 (数组), 局_计次)\n    .如果真 (内部_Cookie取名 (数组 [局_计次]) ＝ 要判断值)\n        返回 (真)\n    .如果真结束\n\n.计次循环尾 ()\n返回 (假)\n\n.子程序 内部_Cookie取名, 文本型\n.参数 Cookie, 文本型\n.局部变量 位置, 整数型\n.局部变量 结果, 文本型\n\n位置 ＝ 寻找文本 (Cookie, “=”, , 假)\n.判断开始 (位置 ≠ -1)\n    结果 ＝ 取文本左边 (Cookie, 位置 － 1)\n.默认\n    结果 ＝ Cookie\n.判断结束\n返回 (删首尾空 (结果))\n\n.子程序 网页_取端口, 整数型, , 取出网站服务器的默认端口\n.参数 网址, 文本型\n.局部变量 端口, 文本型\n.局部变量 位置, 整数型\n\n端口 ＝ 网页_取域名 (网址, , 真)\n位置 ＝ 倒找文本 (端口, “:”, , 假)\n.判断开始 (位置 ≠ -1)\n    返回 (到整数 (取文本右边 (端口, 取文本长度 (端口) － 位置)))\n.判断 (取文本左边 (到小写 (网址), 5) ＝ “https”)\n    返回 (443)\n.默认\n    返回 (80)\n.判断结束\n\n\n.子程序 内部_协议头取值, 文本型\n.参数 协议头, 文本型\n.局部变量 位置, 整数型\n.局部变量 结果, 文本型\n\n位置 ＝ 寻找文本 (协议头, “:”, , 假)\n.如果真 (位置 ≠ -1)\n    结果 ＝ 取文本右边 (协议头, 取文本长度 (协议头) － 位置)\n.如果真结束\n返回 (删首尾空 (结果))\n\n.子程序 网页_取域名, 文本型, , 通过“/”或者“.”来获取网址中的域名，默认使用“/”方式\n.参数 网址, 文本型\n.参数 去除二级域名, 逻辑型, 可空\n.参数 不过滤端口, 逻辑型, 可空\n.参数 后缀点数量, 整数型, 可空, 不留空表示通过“.”的方式取域名 。如：.com后缀点数量为1 ,.com.cn后缀点数量为2\n.局部变量 域名, 文本型\n.局部变量 位置, 整数型\n.局部变量 二级, 文本型, , \"0\"\n.局部变量 域名长度, 整数型\n.局部变量 前点开始, 整数型, , , 如www.bbs.125.la   www后面.的位置\n.局部变量 前点结束, 整数型, , , 如www.bbs.125.la   bbs后面.的位置\n.局部变量 后点开始, 整数型, , , 如www.bbs.125.la   125后面.的位置\n\n域名 ＝ 到小写 (网址)\n.判断开始 (是否为空 (后缀点数量))  ' 使用“/”方式获取域名，网页_访问() 内部 必须使用这个\n    .如果真 (取文本右边 (域名, 1) ≠ “/”)\n        域名 ＝ 域名 ＋ “/”\n    .如果真结束\n\n    .判断开始 (取文本左边 (域名, 8) ＝ “https://”)\n        域名 ＝ 文本_取出中间文本 (域名, “https://”, “/”)\n    .默认\n        .如果真 (寻找文本 (域名, “http://”, , 假) ＝ -1)\n            域名 ＝ “http://” ＋ 域名\n        .如果真结束\n        域名 ＝ 文本_取出中间文本 (域名, “http://”, “/”)\n    .判断结束\n\n    .如果真 (去除二级域名)\n        二级 ＝ 分割文本 (域名, “.”, )\n        位置 ＝ 取数组成员数 (二级)\n        .如果真 (位置 ＞ 1)\n            域名 ＝ 二级 [位置 － 1] ＋ “.” ＋ 二级 [位置]\n        .如果真结束\n\n    .如果真结束\n\n.默认\n    ' 通过“.”的方式取域名，支持任何后缀域名\n    域名 ＝ 子文本替换 (域名, “http://”, “”, , , 真)\n    域名 ＝ 子文本替换 (域名, “https://”, “”, , , 真)\n    位置 ＝ 寻找文本 (域名, “/”, , 假)  ' 一撇位置\n    .如果真 (位置 ≠ -1)\n        域名 ＝ 取文本左边 (域名, 位置 － 1)\n    .如果真结束\n    连续赋值 (取文本长度 (域名), 域名长度, 后点开始)\n    .计次循环首 (后缀点数量, )\n        后点开始 ＝ 倒找文本 (域名, “.”, 后点开始, 假)\n    .计次循环尾 ()\n    前点结束 ＝ 倒找文本 (域名, “.”, 后点开始, 假)\n    .判断开始 (去除二级域名)\n        域名 ＝ 取文本右边 (域名, 域名长度 － 前点结束)\n    .默认\n        ' 保留二级域名---------------------------------------\n        .如果真 (前点结束 ≠ -1)  ' 至少是二级域名\n            前点开始 ＝ 倒找文本 (域名, “.”, 前点结束, 假)\n            .如果真 (前点开始 ≠ -1)  ' 至少是三级域名\n                域名 ＝ 取文本右边 (域名, 域名长度 － 前点开始)\n            .如果真结束\n\n        .如果真结束\n\n    .判断结束\n\n.判断结束\n' 端口过滤处理--------------------------------------------------------\n.判断开始 (不过滤端口)\n    返回 (域名)\n.默认\n    位置 ＝ 寻找文本 (域名, “:”, , 假)  ' 冒号位置\n    .判断开始 (位置 ≠ -1)\n        返回 (取文本左边 (域名, 位置 － 1))\n    .默认\n        返回 (域名)\n    .判断结束\n\n.判断结束\n\n\n.子程序 网页_取页面地址, 文本型\n.参数 网址, 文本型\n.局部变量 页面地址, 文本型\n.局部变量 符号位置, 整数型\n.局部变量 域名, 文本型\n\n域名 ＝ 网页_取域名 (网址)\n符号位置 ＝ 寻找文本 (网址, “/”, 寻找文本 (网址, 域名, 1, 真), 真)\n.如果 (符号位置 ＞ 0)\n    页面地址 ＝ 取文本右边 (网址, 取文本长度 (网址) － 符号位置 ＋ 1)\n.否则\n    页面地址 ＝ “/”\n.如果结束\n返回 (页面地址)复制代码\n7.创建程序集，复制源码：\n\n\n.版本 2\n\n.程序集 程序集_调试\n\n.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码\n.局部变量 信息, 文本型, , \"3\"\n\n.如果真 (是否为调试版 ())\n    ' 输出调试文本 (#调试输出文本)\n.如果真结束\n是否64位 ()\n_临时子程序 ()  ' 在初始化代码执行完毕后调用测试代码\n返回 (0)  ' 可以根据您的需要返回任意数值\n\n.子程序 _临时子程序复制代码\n8.创建类名，复制源码：\n\n\n\n\n\n2345截图20170412204215.png (97.24 KB, 下载次数: 0)\n\n下载附件\n\n2017-4-12 20:42 上传\n\n\n\n\n\n\n.版本 2\n\n.程序集 JSON\n.程序集变量 对象, 对象\n.程序集变量 dataName, 文本型, , , 需要调用时的名字\n\n.子程序 _初始化, , , 当基于本类的对象被创建后，此方法会被自动调用\n\ndataName ＝ “da”\n初始化 ()\n\n\n.子程序 _销毁, , , 当基于本类的对象被销毁前，此方法会被自动调用\n\n对象.清除 ()\nCoUninitialize ()\n\n\n.子程序 初始化\n\nCoInitialize (0)\n对象.创建 (“MSScriptControl.ScriptControl”, )  ' 创建\n对象.写属性 (“Language”, “JavaScript”)\n' 对象.数值方法 (“AddCode”, #JSON操作)\n对象.数值方法 (“AddCode”, #js2)\n对象.数值方法 (“Eval”, “var ” ＋ dataName ＋ “={}”)\n\n\n.子程序 解析, 逻辑型, 公开\n.参数 数据文本, 文本型, , json的文本数据\n\n' 初始化 ()\n对象.数值方法 (“Eval”, “var ” ＋ dataName ＋ “=null”)\n对象.数值方法 (“AddCode”, “var ” ＋ dataName ＋ “=eval(” ＋ 数据文本 ＋ “)”)\n返回 (对象.逻辑方法 (“Eval”, “null !=” ＋ dataName))\n\n\n.子程序 到文本, 文本型, 公开\n\n' 返回 (对象.文本方法 (“Eval”, dataName ＋ “.toJSONString()”))\n返回 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ dataName ＋ “)”))\n\n\n.子程序 置属性, , 公开\n.参数 名字, 文本型, , 支持a.b.c[0]\n.参数 值, 文本型\n\n.' 如果真 (为对象)\n    ' 对象.方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “= eval(” ＋ 值 ＋ “)”)\n    ' 返回 ()\n.如果真结束\n对象.方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “='” ＋ 值 ＋ “'”)\n\n\n.子程序 置属性对象, , 公开, 属性解析为json对象,数组\n.参数 名字, 文本型, , 支持a.b.c[0]\n.参数 值, 文本型\n\n对象.方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “= eval(” ＋ 值 ＋ “)”)\n\n\n.子程序 置属性数值, , 公开\n.参数 名字, 文本型, , 支持a.b.c[0]\n.参数 值, 双精度小数型\n\n对象.方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “=” ＋ 到文本 (值) ＋ “”)\n\n\n.子程序 取属性数值, 双精度小数型, 公开\n.参数 名字, 文本型, , 支持a.b.c[0]\n\n返回 (对象.数值方法 (“Eval”, dataName ＋ “.” ＋ 名字))\n\n\n.子程序 取属性对象, 文本型, , 返回对象文本\n.参数 名字, 文本型, , 支持a.b.c[0]\n\n' 返回 (对象.文本方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “.toJSONString()”))\n' “JSON.stringify(” ＋ dataName ＋ “)”\n返回 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ dataName ＋ “.” ＋ 名字 ＋ “)”))\n\n\n.子程序 取通用属性, 文本型, 公开, 返回文本\n.参数 名字, 文本型, , 支持a.b.c[0]或者[0].a.b\n.参数 为对象, 逻辑型, 可空, 为真解析属性为 数值,json{},不然有转义\"\"\n.局部变量 a, 文本型\n\n.如果真 (取文本左边 (名字, 1) ≠ “[”)\n    a ＝ “.”\n.如果真结束\n.如果真 (为对象)\n    返回 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ dataName ＋ a ＋ 名字 ＋ “)”))\n.如果真结束\n返回 (对象.文本方法 (“Eval”, dataName ＋ a ＋ 名字))\n\n\n.子程序 取属性, JSON, 公开\n.参数 名字, 文本型, , 支持a.b.c[0]或者[0].a.b\n.局部变量 临时, JSON\n.局部变量 a, 文本型\n\n.如果真 (取文本左边 (名字, 1) ≠ “[”)\n    a ＝ “.”\n.如果真结束\n临时.解析 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ dataName ＋ a ＋ 名字 ＋ “)”))\n返回 (临时)\n\n\n.子程序 成员数, 整数型, 公开\n.参数 名字, 文本型, 可空, 支持a.b.c,根目录为空\n\n.如果 (名字 ≠ “”)\n    名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    名字 ＝ dataName\n.如果结束\n返回 (对象.数值方法 (“Eval”, 名字 ＋ “.length”))\n\n\n.子程序 加成员, , 公开\n.参数 成员值, 文本型, , 对象\n.参数 名字, 文本型, 可空, 支持a.b.c\n.参数 为对象, 逻辑型, 可空, 数值,json节点\n.局部变量 a, 文本型\n\n.如果 (名字 ≠ “”)\n    名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    名字 ＝ dataName\n.如果结束\n.如果真 (为对象 ＝ 假)\n    a ＝ “'”\n.如果真结束\n对象.方法 (“Eval”, “if (Object.prototype.toString.call(” ＋ 名字 ＋ “) != '[object Array]') { ” ＋ 名字 ＋ “=new Array();} ” ＋ 名字 ＋ “.push(” ＋ a ＋ 成员值 ＋ a ＋ “)”)\n\n\n.子程序 取成员, JSON, 公开\n.参数 索引, 整数型\n.参数 名字, 文本型, 可空, 支持a.b.c,为空是根节点\n.局部变量 临时, JSON\n.局部变量 _名字, 文本型\n\n.如果 (名字 ≠ “”)\n    _名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    _名字 ＝ dataName\n.如果结束\n临时.解析 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ _名字 ＋ “[” ＋ 到文本 (索引) ＋ “])”))\n\n返回 (临时)\n\n\n.子程序 取成员文本, 文本型, 公开\n.参数 索引, 整数型, , 支持a.b.c\n.参数 名字, 文本型, 可空, 支持a.b.c,为空是根节点\n.参数 为对象, 逻辑型, 可空, 对象为真,否则返回obj,数值,json节点\n.局部变量 _名字, 文本型\n\n.如果 (名字 ≠ “”)\n    _名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    _名字 ＝ dataName\n.如果结束\n.如果真 (为对象)\n    返回 (对象.文本方法 (“Eval”, “JSON.stringify(” ＋ _名字 ＋ “[” ＋ 到文本 (索引) ＋ “])”))\n\n.如果真结束\n返回 (对象.文本方法 (“Eval”, _名字 ＋ “[” ＋ 到文本 (索引) ＋ “]”))\n\n\n.子程序 置成员, , 公开\n.参数 索引, 整数型, , 支持a.b.c\n.参数 成员值, 文本型\n.参数 为对象, 逻辑型, 可空, 数值,json节点\n.局部变量 a, 文本型\n\n.如果真 (为对象 ＝ 假)\n    a ＝ “'”\n.如果真结束\n对象.方法 (“Eval”, dataName ＋ “[” ＋ 到文本 (索引) ＋ “]=” ＋ a ＋ 成员值 ＋ a)\n\n\n.子程序 删成员, , 公开\n.参数 索引, 整数型, , 支持a.b.c\n\n对象.方法 (“Eval”, dataName ＋ “.splice(” ＋ 到文本 (索引) ＋ “,1)”)\n\n\n.子程序 置类型, , 公开\n.参数 值, 整数型, , 0空,4对象,5数组\n\n.如果真 (值 ＝ 0)\n    对象.数值方法 (“Eval”, “var ” ＋ dataName ＋ “={}”)\n    返回 ()\n.如果真结束\n.如果真 (值 ＝ 4)\n    对象.数值方法 (“Eval”, “var ” ＋ dataName ＋ “={}”)\n    返回 ()\n.如果真结束\n.如果真 (值 ＝ 5)\n    对象.数值方法 (“Eval”, “var ” ＋ dataName ＋ “=new Array()”)\n    返回 ()\n.如果真结束\n\n\n.子程序 赋值, , 公开\n.参数 值, 文本型\n.参数 为对象, 逻辑型, 可空, 数值,json节点\n.局部变量 a, 文本型\n\n.如果真 (为对象 ＝ 假)\n    a ＝ “'”\n.如果真结束\n对象.逻辑方法 (“Eval”, dataName ＋ “=” ＋ a ＋ 值 ＋ a)\n\n\n.子程序 属性是否存在, 逻辑型, 公开\n.参数 名字, 文本型, , 支持a.b.c\n\n返回 (对象.逻辑方法 (“Eval”, dataName ＋ “.” ＋ 名字 ＋ “ !=null”))\n\n\n.子程序 取所有属性名, , 公开\n.参数 属性名数组, 文本型, 参考 数组\n.参数 名字, 文本型, 可空, a.b,空为根节点\n.局部变量 obj, 文本型\n.局部变量 _名字, 文本型\n\n.如果 (名字 ≠ “”)\n    _名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    _名字 ＝ dataName\n.如果结束\nobj ＝ 对象.文本方法 (“Eval”, “var ary=''; for (var key in ” ＋ _名字 ＋ “) {ary=ary+ key+','; }”)\n对象.通用方法 (“Eval”, “ary=null”)\n输出调试文本 (obj)\n属性名数组 ＝ 分割文本 (obj, “,”, )\n\n\n' var jsons = { name: \"1111\", age: 18 };\n' \"for (var key in jsons){alert(key);alert(jsons[key]);}\"\n\n\n.子程序 取类型, 整数型, 公开, 空0数2对象4数组5文本6\n.参数 名字, 文本型, 可空\n.局部变量 l, 文本型\n.局部变量 _名字, 文本型\n\n.如果 (名字 ≠ “”)\n    _名字 ＝ dataName ＋ “.” ＋ 名字\n.否则\n    _名字 ＝ dataName\n.如果结束\n.如果真 (对象.逻辑方法 (“Eval”, 名字 ＋ “ !=null”) ＝ 假)\n    返回 (0)\n.如果真结束\nl ＝ 对象.文本方法 (“Eval”, “Object.prototype.toString.call(” ＋ _名字 ＋ “) ”)\n' 输出调试文本 (l)\n\n.判断开始 (l ＝ “[object String]”)\n    返回 (6)\n.判断 (l ＝ “[object Object]”)\n    返回 (4)\n.判断 (l ＝ “[object Number]”)\n    返回 (2)\n.判断 (l ＝ “[object Array]”)\n    返回 (5)\n\n.默认\n\n.判断结束\n返回 (4)\n复制代码\n9.创建程序集，复制源码：\n\n\n.版本 2\n.支持库 spec\n\n.程序集 程序集_附加功能\n\n.子程序 是否64位, 逻辑型, 公开, 判断是否为64位系统，如果是返回真，否则返回假\n.局部变量 szWinSysDir, 文本型\n.局部变量 uSize, 整数型\n.局部变量 unResult, 整数型\n.局部变量 szKernel32File, 文本型\n.局部变量 hLibKernel32, 整数型\n.局部变量 lpIsWow64Process, 整数型\n.局部变量 bIsWow64Process, 逻辑型\n\nszWinSysDir ＝ 取空白文本 (256)\nuSize ＝ 256\nunResult ＝ GetSystemDirectory (szWinSysDir, uSize)\n.如果真 (unResult ＞ 0)\n    szKernel32File ＝ szWinSysDir ＋ “\\kernel32.dll”\n    hLibKernel32 ＝ LoadLibrary (szKernel32File)\n.如果真结束\n.如果真 (hLibKernel32 ＝ 0)\n    hLibKernel32 ＝ LoadLibrary (“kernel32.dll”)\n.如果真结束\n.如果真 (hLibKernel32 ≠ 0)\n    lpIsWow64Process ＝ GetProcAddress (hLibKernel32, “IsWow64Process”)\n.如果真结束\n.如果真 (lpIsWow64Process ≠ 0)\n    .如果真 (IsWow64Process (GetCurrentProcess (), bIsWow64Process) ＝ 0)\n        FreeLibrary (hLibKernel32)\n        返回 (假)\n    .如果真结束\n\n.如果真结束\n.如果真 (hLibKernel32 ＝ 0)\n    FreeLibrary (hLibKernel32)\n    返回 (假)\n.如果真结束\n\n返回 (bIsWow64Process)\n\n\n.子程序 java信息, , 公开\n.参数 信息, 文本型, 参考 数组, 信息[1]：版本；    信息[2]：路径；    信息3：JAVA位数\n\n.如果真 (是否64位 ())\n    信息 [3] ＝ “x64”\n    信息 [1] ＝ 读取64位注册表键值 (“HKEY_LOCAL_MACHINE”, “SOFTWARE\\JavaSoft\\Java Runtime Environment”, “CurrentVersion”)\n    信息 [2] ＝ 读取64位注册表键值 (“HKEY_LOCAL_MACHINE”, “SOFTWARE\\JavaSoft\\Java Runtime Environment\\” ＋ 信息 [1], “JavaHome”)\n.如果真结束\n.如果真 (删首尾空 (信息 [1]) ＝ “”)\n    信息 [3] ＝ “x86”\n    信息 [1] ＝ 读取32位注册表键值 (“HKEY_LOCAL_MACHINE”, “SOFTWARE\\JavaSoft\\Java Runtime Environment”, “CurrentVersion”)\n    信息 [2] ＝ 读取32位注册表键值 (“HKEY_LOCAL_MACHINE”, “SOFTWARE\\JavaSoft\\Java Runtime Environment\\” ＋ 信息 [1], “JavaHome”)\n.如果真结束\n.如果 (删首尾空 (信息 [1]) ＝ “”)\n    信息 [2] ＝ “”\n    信息 [1] ＝ “”\n.否则\n    信息 [2] ＝ 信息 [2] ＋ “\\bin\\”\n.如果结束\n\n\n\n\n.子程序 读取32位注册表键值, 文本型\n.参数 根键, 文本型\n.参数 子健路径, 文本型\n.参数 键名, 文本型\n.局部变量 fkey, 整数型\n\n.判断开始 (删首尾空 (到大写 (根键)) ＝ “HKEY_CLASSES_ROOT”)\n    fkey ＝ #根类\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_CURRENT_USER”)\n    fkey ＝ #现行用户\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_LOCAL_MACHINE”)\n    fkey ＝ #本地机器\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_USERS”)\n    fkey ＝ #所有用户\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_CURRENT_CONFIG”)\n    fkey ＝ #现行设置\n.默认\n\n.判断结束\n\n返回 (取文本注册项 (fkey, 子健路径 ＋ “\\” ＋ 键名, ))\n\n.子程序 读取64位注册表键值, 文本型\n.参数 根键, 文本型\n.参数 子健路径, 文本型\n.参数 键名, 文本型\n.局部变量 hkey, 整数型\n.局部变量 phkey, 整数型\n.局部变量 oldwow64state, 整数型\n.局部变量 lptype, 整数型\n.局部变量 result, 文本型\n.局部变量 resultsize, 整数型\n.局部变量 type, 整数型\n\n' 如果 (是否64位 ())\n.判断开始 (删首尾空 (到大写 (根键)) ＝ “HKEY_CLASSES_ROOT”)\n    hkey ＝ #HKEY_CLASSES_ROOT\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_CURRENT_USER”)\n    hkey ＝ #HKEY_CURRENT_USER\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_LOCAL_MACHINE”)\n    hkey ＝ #HKEY_LOCAL_MACHINE\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_USERS”)\n    hkey ＝ #HKEY_USERS\n.判断 (删首尾空 (到大写 (根键)) ＝ “HKEY_CURRENT_CONFIG”)\n    hkey ＝ #HKEY_CURRENT_CONFIG\n.默认\n\n.判断结束\n.如果真 (hkey ＝ 0)\n    返回 (“”)\n.如果真结束\n.如果真 (API_Wow64DisableWow64FsRedirection (oldwow64state))  ' 关闭文件系统转向\n    API_RegOpenKeyEx (hkey, 子健路径, 0, #KEY_ALL_WOW64, 取变量数据地址 (phkey))\n    API_RegDisableReflectionKey (phkey)  ' 打开注册表转向（禁止特定项的注册表反射）\n    lptype ＝ 0\n    result ＝ 取空白文本 (1024)\n    resultsize ＝ 1024\n    API_RegQueryValueEx (phkey, 键名, 0, 取变量数据地址 (type), 取变量数据地址 (result), 取变量数据地址 (resultsize))\n    API_RegQueryValueEx (phkey, 键名, 0, 取变量数据地址 (type), 取变量数据地址 (result), 取变量数据地址 (resultsize))\n    API_RegEnableReflectionKey (phkey)  ' 打开注册表转向（开启特定项的注册表反射）\n    API_RegCloseKey (phkey)\n.如果真结束\nAPI_Wow64RevertWow64FsRedirection (oldwow64state)  ' 打开文件系统转向\n返回 (result)\n\n\n.子程序 取内存容量信息, 整数型, 公开, 取内存容量信息，单位为M（兆）。本命令为初级命令。\n.参数 内存类型, 整数型, 可空, 0、#接口常量.总物理内存；1、#接口常量.可用物理内存；2、#接口常量.总虚拟内存；3、#接口常量.可用虚拟内存；4、#接口常量.总页面文件；5、#接口常量.可用页面文件。\n.局部变量 内存指针, MEMORYSTATUSEX\n.局部变量 返回值, 整数型\n\n内存指针.dwLength ＝ 64\nGlobalMemoryStatusEx (内存指针)\n.判断开始 (内存类型 ＝ 0)\n    返回值 ＝ 四舍五入 (内存指针.ullTotalPhys ÷ 1048576, )\n.判断 (内存类型 ＝ 1)\n    返回值 ＝ 四舍五入 (内存指针.ullAvailPhys ÷ 1048576, )\n.判断 (内存类型 ＝ 2)\n    返回值 ＝ 四舍五入 (内存指针.ullTotalVirtual ÷ 1048576, )\n.判断 (内存类型 ＝ 3)\n    返回值 ＝ 四舍五入 (内存指针.ullAvailVirtual ÷ 1048576, )\n.判断 (内存类型 ＝ 4)\n    返回值 ＝ 四舍五入 (内存指针.ullTotalPageFile ÷ 1048576, )\n.判断 (内存类型 ＝ 5)\n    返回值 ＝ 四舍五入 (内存指针.ullAvailPageFile ÷ 1048576, )\n.默认\n\n.判断结束\n返回 (返回值)\n\n.子程序 最佳内存, 文本型, 公开\n.参数 是否64位, 逻辑型\n.局部变量 内存大小, 整数型\n.局部变量 ram, 小数型\n\n内存大小 ＝ 取内存容量信息 ()\n.如果 (是否64位)\n    .如果 (内存大小 ％ 1024 ≠ 0)\n        ram ＝ 1024 × 四舍五入 (取内存容量信息 () ÷ 1024, ) ÷ 2\n    .否则\n        ram ＝ 1024 × 取内存容量信息 () ÷ 1024 ÷ 2\n    .如果结束\n    返回 (到文本 (到整数 (ram)))\n.否则\n    .判断开始 (内存大小 ≤ 1024)\n        返回 (“512”)\n    .默认\n        返回 (“1024”)\n    .判断结束\n\n.如果结束复制代码（想获取更新点我）后记\n\n今天源码分享到这周五晚继续更新软件的布局和使用！\n求金粒！\n\n\n\n\n\n",
    "replies": [
        {
            "author": "zjq1379657371",
            "timestamp": 1492225020,
            "txt_content": "纯原创？"
        },
        {
            "author": "子树",
            "timestamp": 1492929120,
            "txt_content": "表示本人第一次在MCBBS里混，楼主大佬发的是源代码吗？"
        },
        {
            "author": "8974867",
            "timestamp": 1494341700,
            "txt_content": "楼主QQ多少？我加下你"
        },
        {
            "author": "Grasscraft",
            "timestamp": 1497107220,
            "txt_content": "8974867 发表于 2017-5-9 22:55\n楼主QQ多少？我加下你\n1650821306（新的号）"
        },
        {
            "author": "炎黄始祖",
            "timestamp": 1497145200,
            "txt_content": "表示看不懂所有东西的萌新就是我，，"
        },
        {
            "author": "KN000306",
            "timestamp": 1499340120,
            "txt_content": " 本帖最后由 KN000306 于 2017-7-6 19:35 编辑 \n\n大佬，找不到指定的常量名称“HKEY_CLASSES_ROOT”。怎么破"
        },
        {
            "author": "q23223514",
            "timestamp": 1507088760,
            "txt_content": "感谢分享"
        },
        {
            "author": "Ant繁星飞跃",
            "timestamp": 1507097280,
            "txt_content": "zjq1379657371 发表于 2017-4-15 10:57\n纯原创？\n不存在原创的   本来又不是他的东西"
        },
        {
            "author": "大可乐2333",
            "timestamp": 1507193040,
            "txt_content": "炎黄始祖 发表于 2017-6-11 09:40\n表示看不懂所有东西的萌新就是我，，\n易语言的代码这么简单"
        },
        {
            "author": "彩色小黑",
            "timestamp": 1507288320,
            "txt_content": "新人都是怪物系列"
        },
        {
            "author": "q23223514",
            "timestamp": 1516419300,
            "txt_content": "楼主大大易语言怎么读取服务器信息"
        }
    ]
}