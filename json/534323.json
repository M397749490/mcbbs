{
    "title": "Tiger的插件开发  一个实例（7） 从入门到精通",
    "author": "tiger999",
    "replyCount": 14,
    "timestamp": 1451085780,
    "txt_content": "大家好，今天这节课是一个实例\n先说上节课的作业，答案是\n\n        public void onEnable()\n        {\n                Bukkit.getPluginManager().registerEvents(this, this);\n                  if(!getDataFolder().exists()) {\n                            getDataFolder().mkdir();\n                          }\n                          File file=new File(getDataFolder(),\"config.yml\");\n                          if (!(file.exists())) {saveDefaultConfig();}\n                          reloadConfig();\n                          getLogger().info(\"启用完毕！\");\n        }\n                \n        @EventHandler\n        public void onPlayerJoin(PlayerQuitEvent evt){\n                String msg=getConfig().getString(\"msg\");\n                Bukkit.broadcastMessage(msg);\n        }\n//读取config这里段大家可能和我不一样，但是假如是监听器不一样你可能就有一点问题了\n\n\nOK，这节课我们讲的是一个实例，什么实例呢？是我做的一个Gamble赌博插件\n地址是\nhttp://www.mcbbs.net/thread-530039-1-1.html\n大家可以看看，我们首先来看看源代码\npackage com.github.berry64;\n\nimport java.io.File;\nimport java.util.Random;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.event.Listener;\nimport org.bukkit.inventory.Inventory;\nimport org.bukkit.plugin.RegisteredServiceProvider;\nimport org.bukkit.plugin.java.JavaPlugin;\n\nimport net.milkbowl.vault.economy.Economy;\n\npublic class gamble extends JavaPlugin implements Listener{\n        private Economy economy;\n        @SuppressWarnings(\"unused\")\n        private boolean isEco = false;\n        private boolean setEconomy() {\n                RegisteredServiceProvider<Economy> eco = getServer()\n                                .getServicesManager().getRegistration(\n                                                net.milkbowl.vault.economy.Economy.class);\n                if (eco != null) {\n                        economy = eco.getProvider();\n                }\n                return (economy != null);\n        }\n        \n\n\n        \n        @Override\n        public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args){if (cmd.getName().equalsIgnoreCase(\"gamble\")){\n                String name=sender.getName();\n                if (args.length==1){\n                if  (args[0].equalsIgnoreCase(\"small\")){\n                        int open=getConfig().getInt(\"small\");\n                        if (open==1){\n                        int mymoney=(int) economy.getBalance(name);\n                        int sspend=getConfig().getInt(\"sspend\");\n                        if(mymoney>=sspend){\n                                economy.withdrawPlayer(name, sspend);\n                                 int schance=getConfig().getInt(\"schance\");\n                                 int swinmax=getConfig().getInt(\"swinmax\");\n                                 int swinmin=getConfig().getInt(\"swinmin\");\n                                 \n                                 int max=100;\n                                 int min=1;\n                                 Random random = new Random();\n                                 int ram = random.nextInt(max)%(max-min+1) + min;\n                                 int swin = random.nextInt(swinmax)%(swinmax-swinmin+1) + swinmin;\n                                 if (schance>=ram){\n                                         \n                                         sender.sendMessage(\"恭喜你，你赌博成功了，你获得了\"+swin+\"块钱\");\n                                         economy.depositPlayer(name, swin);\n                                 }else{\n                                         sender.sendMessage(\"对不起，你赌博失败了，一定是你的姿势不对\");\n                                 }\n                        }else{\n                                sender.sendMessage(\"你的钱数不够，需要\"+sspend+\"块钱才可以赌博\");\n                        }\n                        }else{\n                                sender.sendMessage(\"对不起，服务器没有开放small类型的赌博\");\n                        }\n                }else if  (args[0].equalsIgnoreCase(\"middle\")){\n                        int open=getConfig().getInt(\"middle\");\n                        if (open==1){\n                        int mymoney=(int) economy.getBalance(name);\n                        int mspend=getConfig().getInt(\"mspend\");\n                        if(mymoney>=mspend){\n                                economy.withdrawPlayer(name, mspend);\n                                 int mchance=getConfig().getInt(\"mchance\");\n                                 int mwinmax=getConfig().getInt(\"mwinmax\");\n                                 int mwinmin=getConfig().getInt(\"mwinmin\");\n                                 int max=100;\n                                 int min=1;\n                                 Random random = new Random();\n                                 int ram = random.nextInt(max)%(max-min+1) + min;\n                                 int mwin = random.nextInt(mwinmax)%(mwinmax-mwinmin+1) + mwinmin;\n                                 if (mchance>=ram){\n                                         \n                                         sender.sendMessage(\"恭喜你，你赌博成功了，你获得了\"+mwin+\"块钱\");\n                                         economy.depositPlayer(name, mwin);\n                                 }else{\n                                         sender.sendMessage(\"对不起，你赌博失败了，一定是你的姿势不对\");\n                                 }\n                        }else{\n                                sender.sendMessage(\"你的钱数不够，需要\"+mspend+\"块钱才可以赌博\");\n                        }\n                        }else{\n                                sender.sendMessage(\"对不起，服务器没有开放middle类型的赌博\");\n                        }\n                }else if  (args[0].equalsIgnoreCase(\"big\")){\n                                int open=getConfig().getInt(\"big\");\n                                if (open==1){\n\n                        int mymoney=(int) economy.getBalance(name);\n                        int bspend=getConfig().getInt(\"bspend\");\n                        if(mymoney>=bspend){\n                                economy.withdrawPlayer(name, bspend);\n                                 int bchance=getConfig().getInt(\"bchance\");\n                                 int bwinmax=getConfig().getInt(\"bwinmax\");\n                                 int bwinmin=getConfig().getInt(\"bwinmin\");\n                                 int max=100;\n                                 int min=1;\n                                 Random random = new Random();\n                                 int ram = random.nextInt(max)%(max-min+1) + min;\n                                 int bwin = random.nextInt(bwinmax)%(bwinmax-bwinmin+1) + bwinmin;\n                                 if (bchance>=ram){\n                                         \n                                         sender.sendMessage(\"恭喜你，你赌博成功了，你获得了\"+bwin+\"块钱\");\n                                         economy.depositPlayer(name, bwin);\n                                 }else{\n                                         sender.sendMessage(\"对不起，你赌博失败了，一定是你的姿势不对\");\n                                 }\n                        }else{\n                                sender.sendMessage(\"你的钱数不够，需要\"+bspend+\"块钱才可以赌博\");\n                        }\n                        }else{\n                                        sender.sendMessage(\"对不起，服务器没有开放big类型的赌博\");\n                                }\n                        \n                }else{\n                        sender.sendMessage(\"缺少参数或参数不对\");\n                }\n                }else if(args.length==0){\n                        sender.sendMessage(\"/gamble [small,middle,big]\");\n                }\n        return true;\n        }\n        return false;\n        }\n        \n}复制代码economy.xxx的东西大家不用管，那是Vault，我会在进阶教程里面讲到\n你看懂了吗？\n这里有许多随机数的函数，可能大家还不会，在进阶教程，我会专门讲一些关于随机数这里类算法的东西\n回到索引\n\n读完吱一声。读完看懂就开始撒人气金币吧！没看懂的，问完也开始撒人气金币！\n",
    "replies": [
        {
            "author": "tiger999",
            "timestamp": 1451086320,
            "txt_content": "居然没有乱码，我好感动{:10_512:}"
        },
        {
            "author": "爱杂食的圳",
            "timestamp": 1451094240,
            "txt_content": "tiger999大大，我想请问一下：没有诠释新手要怎么看呢？\n请您标注一下诠释吧~"
        },
        {
            "author": "tiger999",
            "timestamp": 1451104680,
            "txt_content": "爱杂食的圳 发表于 2015-12-26 09:44\ntiger999大大，我想请问一下：没有诠释新手要怎么看呢？\n请您标注一下诠释吧~ ...\n嗯，好的"
        },
        {
            "author": "tiger999",
            "timestamp": 1451104860,
            "txt_content": "爱杂食的圳 发表于 2015-12-26 09:44\ntiger999大大，我想请问一下：没有诠释新手要怎么看呢？\n请您标注一下诠释吧~ ...\n话说你是哪里不懂，可以来问我(不想编辑了，太麻烦了，得审查好久好久)"
        },
        {
            "author": "爱杂食的圳",
            "timestamp": 1451105340,
            "txt_content": "tiger999 发表于 2015-12-26 12:41\n话说你是哪里不懂，可以来问我(不想编辑了，太麻烦了，得审查好久好久)\ntiger999大大…\n其实我都看得懂，而且这些代码还能再删除一些累赘，Java8的信特性…\n其实吧，审核久也没什事~有质量保证的帖才是好帖。"
        },
        {
            "author": "tiger999",
            "timestamp": 1451105460,
            "txt_content": "爱杂食的圳 发表于 2015-12-26 09:44\ntiger999大大，我想请问一下：没有诠释新手要怎么看呢？\n请您标注一下诠释吧~ ...\n你可以加我qq 2624183401"
        },
        {
            "author": "tiger999",
            "timestamp": 1451105580,
            "txt_content": "爱杂食的圳 发表于 2015-12-26 12:49\ntiger999大大…\n其实我都看得懂，而且这些代码还能再删除一些累赘，Java8的信特性…\n其实吧，审核久也没 ...\n嗯，其实我不加也是有原因的\n出了economy和随机数没讲，其他的我都讲过\n所以假如不会的就会看前面的，这样子大家就可以学的扎实一点"
        },
        {
            "author": "t9044",
            "timestamp": 1451295360,
            "txt_content": "例子没有注释，对于新手来说就太复杂了\n而且Java是面向对象语言呀，你可以把一些代码抽象为基础方法来实现。例如搞两个接口方法之类的，看着清楚，用的方便。纯属个人见解~"
        },
        {
            "author": "情已死",
            "timestamp": 1452009420,
            "txt_content": "求加Q详细教"
        },
        {
            "author": "tiger999",
            "timestamp": 1452082140,
            "txt_content": "情已死 发表于 2016-1-5 23:57\n求加Q详细教\n2624183401"
        },
        {
            "author": "情已死",
            "timestamp": 1452094980,
            "txt_content": "tiger999 发表于 2016-1-6 20:09\n2624183401\n谢谢。。。。。。。。"
        },
        {
            "author": "黄总",
            "timestamp": 1469523960,
            "txt_content": "请教一个问题\nargs[0].equalsIgnoreCase(\"small\")\n这个地方，为什么是args[0]？一个指令的第一个单词是0，第二个是1，不是这样吗？这里的指令是/gameble small？还是/small？"
        },
        {
            "author": "tiger999",
            "timestamp": 1470021180,
            "txt_content": "黄总 发表于 2016-7-26 17:06\n请教一个问题\nargs[0].equalsIgnoreCase(\"small\")\n这个地方，为什么是args[0]？一个指令的第一个单词是0， ...\n这里的指令当然是/gamble small，虽然第一个单词确实是gamble，但是你可以把它理解为，gamble是他的名字，你必须叫了他才能给他命令让他执行任务，args[0]是small不是gamble"
        },
        {
            "author": "冰影v",
            "timestamp": 1471164240,
            "txt_content": "还行吧.."
        }
    ]
}