{
    "title": "关于GUI界面的物品保存问题",
    "author": "mohuang521",
    "replyCount": 21,
    "timestamp": 1558681860,
    "txt_content": "写了一个简单的GUI界面,玩家放入物品后点击确认时候会跳到另一个GUI界面，但是这相当于之前的GUI界面关闭了，因为之前防止GUI界面吞物品所以写了一个关闭事件如果关闭了这个特定的GUI界面物品会还给玩家，有没有办法暂时保存那些物品等第二个GUI界面操作执行完了再回到第一个GUI界面\n流程如下\n玩家打开GUI-A放入物品,点击确定跳到GUI-B（GUI-A中的物品不会还给玩家）,玩家在GUI-B中点击确认的话会执行一些东西(例如清空GUI-A物品并执行某些操作),如果点击GUI-B中的取消的话会回到GUI-A并且GUI-A中的物品完好摆放",
    "replies": [
        {
            "author": "q549365815",
            "timestamp": 1558683780,
            "txt_content": "把这些数据放到一个Map中  任何后续操作都修改这个Map"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1558684020,
            "txt_content": "都跟你说了就是不听, 创建一个类, 包含两个 Inventory 对象, 然后在这个类里单独写一个监听器, 这个监听器只关心这两个 Inv 对象的动作, 不关心别的. 然后在类中弄一个变量, 用作控制监听器的行为, 监听器通过读写这个变量来决定保存与否, 关闭还是退回上一个界面.\n\n用箱子界面搞 GUI 最不能把 Inventory 当成界面来操作, 因为你根本无法往 inv 里添加字段, 也无法让它和其他的 inv 产生关系, 而且没有包装的类你监听器只能堆在一起, 界面多了就得 equals 一个一个判断界面名字, 可读性极差, 可维护性=0.\n\n你要是非不愿意创建一个统一的 GUI 类也行, 弄个公共变量也能存数据. 不过就是代码看着比较烂而已"
        },
        {
            "author": "鸭蛋只吃黄",
            "timestamp": 1558684200,
            "txt_content": "http://www.mcbbs.net/thread-693784-1-1.html\n我在第三点说的就非常明确, 要单独的监听器, 不要统一的监听器, 好好读帖\n\n创建一个新的类又不麻烦, 你在里面写一个数组, 保存数据, 爱怎么折腾怎么折腾, 愿意持久化保存直接在类里面些方法就行了, 这么好的解决方案你怎么就是不听呢\n\n而且你今年二战, 别写插件了, 耽误时间. 别指望这些人能感谢你\n"
        },
        {
            "author": "q549365815",
            "timestamp": 1558684200,
            "txt_content": "http://www.mcbbs.net/thread-774705-1-1.html"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558684740,
            "txt_content": "q549365815 发表于 2019-5-24 15:50\nhttp://www.mcbbs.net/thread-774705-1-1.html\n这个可以看源码嘛？"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558684920,
            "txt_content": "q549365815 发表于 2019-5-24 15:50\nhttp://www.mcbbs.net/thread-774705-1-1.html\n感觉这还不是我现在的技术可以结合的= =！"
        },
        {
            "author": "roj234",
            "timestamp": 1558692060,
            "txt_content": "Map<Integer,ItemStack> .....\n = new HashMap<>();\n// onInit\nfor(int slotId=0;slotId<inv.size();slotId++){\n    map.put(slotId, inv.getStackInSlot(slotId));\n}\n每个GUI都创建一次\n如果你就是不愿意也可以这样:\nMap<Player,Map<Integer,ItemStack>>\n不过会麻烦许多就是了"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558694160,
            "txt_content": "roj234 发表于 2019-5-24 18:01\nMap .....\n = new HashMap();\n// onInit\n但是依然有个问题是你切换到GUI-B得时候GUI-A的物品会回到玩家背包,因为背包关闭事件写的关闭GUI-A会自动还给玩家物品"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558694160,
            "txt_content": "q549365815 发表于 2019-5-24 15:43\n把这些数据放到一个Map中  任何后续操作都修改这个Map\n但是依然有个问题是你切换到GUI-B得时候GUI-A的物品会回到玩家背包,因为背包关闭事件写的关闭GUI-A会自动还给玩家物品"
        },
        {
            "author": "q549365815",
            "timestamp": 1558694820,
            "txt_content": "mohuang521 发表于 2019-5-24 18:36\n但是依然有个问题是你切换到GUI-B得时候GUI-A的物品会回到玩家背包,因为背包关闭事件写的关闭GUI-A会自动 ...\n你这设计模式都错了 建议重构"
        },
        {
            "author": "roj234",
            "timestamp": 1558695060,
            "txt_content": "mohuang521 发表于 2019-5-24 18:36\n但是依然有个问题是你切换到GUI-B得时候GUI-A的物品会回到玩家背包,因为背包关闭事件写的关闭GUI-A会自动 ...\nnew GuiB(guiA)"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558695480,
            "txt_content": "q549365815 发表于 2019-5-24 18:47\n你这设计模式都错了 建议重构\n难道要点击的时候重新画一遍GUI的方法来绕过关闭GUI重新打开嘛= =！"
        },
        {
            "author": "q549365815",
            "timestamp": 1558695660,
            "txt_content": "mohuang521 发表于 2019-5-24 18:58\n难道要点击的时候重新画一遍GUI的方法来绕过关闭GUI重新打开嘛= =！\n你说之前写了个关于 在玩家关闭Inventory的时候 会把 Inventory 里面的 Item 返回给玩家\n那么给 这个方法添加个开关器\n"
        },
        {
            "author": "q549365815",
            "timestamp": 1558695720,
            "txt_content": "建议还是重新写吧  "
        },
        {
            "author": "mohuang521",
            "timestamp": 1558695840,
            "txt_content": "q549365815 发表于 2019-5-24 19:01\n你说之前写了个关于 在玩家关闭Inventory的时候 会把 Inventory 里面的 Item 返回给玩家\n那么给 这个方法 ...\n我有设置过一个全局变量来做，比如点击GUI-A要跳转到B的时候将静态变量stats设置为+1，但是发现如果同时有一个玩家也跳转了就会再+1，才知道这里的全局变量是真的全局变量，全游戏通用只要不重启"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558695840,
            "txt_content": "q549365815 发表于 2019-5-24 19:02\n建议还是重新写吧\n重新写肯定可以啊，但是也要解决这种问题啊"
        },
        {
            "author": "q549365815",
            "timestamp": 1558695900,
            "txt_content": "mohuang521 发表于 2019-5-24 19:04\n我有设置过一个全局变量来做，比如点击GUI-A要跳转到B的时候将静态变量stats设置为+1，但是发现如果同时 ...\n....\n用Map存放\nMap<UUID,int>"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558696020,
            "txt_content": "q549365815 发表于 2019-5-24 19:05\n....\n用Map存放\nMap\n其实归根结底貌似就是一个问题困扰着。。关闭事件能否判断是用户自行关闭的还是打开另一个GUI而被动关闭的= =！"
        },
        {
            "author": "q549365815",
            "timestamp": 1558696260,
            "txt_content": "mohuang521 发表于 2019-5-24 19:07\n其实归根结底貌似就是一个问题困扰着。。关闭事件能否判断是用户自行关闭的还是打开另一个GUI而被动关闭 ...\n...不能判断\n你代码写错了"
        },
        {
            "author": "mohuang521",
            "timestamp": 1558696860,
            "txt_content": "q549365815 发表于 2019-5-24 19:11\n...不能判断\n你代码写错了\n如果不是这个逻辑的话，检测背包A关闭事件肯定要有，那就是如何点击背包A的变成一个新GUI啊，肯定不能让游戏误认为是关闭了背包A啊"
        },
        {
            "author": "lgou2w",
            "timestamp": 1558699980,
            "txt_content": "不如来试试 LDK 开发套件框架，像附魔强化插件的一些实现都使用了 LDK 库。你可以看一下这几张链接实现的高级 Gui 界面。\n\n\nLDK 开源仓库： https://github.com/lgou2w/ldk\nLDK-Gui 模块的快速创建菜单界面的例子代码：\nGuiBuilder.of(GuiType.CHEST_6, \"菜单\")\n  .button(3, 3) // 二维坐标 x, y\n  .stack(Material.DIAMOND) // 钻石物品\n  .clicked(event -> { // 当点击\n    event.getClicker().sendMessage(\"你点击了钻石.\");\n    return Unit.INSTANCE;\n  })\n  .origin()\n  .allowMove(false) // Gui 不能移动物品\n  .build()\n  .open(Bukkit.getPlayer(\"lgou2w\")); // 打开给玩家复制代码"
        }
    ]
}