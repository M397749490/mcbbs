{
    "title": "[Bukkit]SpawnArrow不起作用",
    "author": "lmhppt",
    "replyCount": 14,
    "timestamp": 1593155040,
    "txt_content": "想实现的效果：玩家手持铁剑，右键后从玩家向玩家所面对的方向发射一个箭。但是不起作用，右键有Message提示，但是没有箭。\n求教~\n\n@EventHandler\n        public void FlyArrow(PlayerInteractEvent a) {\n                if (a.hasItem() == true) {\n                        if (a.getAction() == Action.RIGHT_CLICK_AIR || a.getAction() == Action.RIGHT_CLICK_BLOCK) {\n                                if (a.getItem().getType() == Material.REDSTONE) {\n                                        SendAPlayerToLobby(a.getPlayer());\n                                } else {\n                                        if (a.getItem().getType() == Material.IRON_SWORD && a.getPlayer() == Killer) {\n                                                if (KillerThrowSwordCooldown == 5) {\n                                                        Spawn.getWorld().spawnArrow(a.getPlayer().getLocation(), a.getPlayer().getLocation().getDirection(), (float)0.6, 12);\n                                                                                a.getPlayer().sendMessage(Prefix + To(\"&a&l你投掷了飞刀！\"));\n                                                }\n                                        }\n                                }\n                        }\n                }\n                \n        }复制代码\n\n",
    "replies": [
        {
            "author": "William_Shi",
            "timestamp": 1593156120,
            "txt_content": "你的代码风格。。。\n为什么事件这个变量命名为 a？？？\n还有就是嵌套的if 多了会很不好\n建议在一些条件控制的时候这么写\n\nif(!(event.hasItem())){\nreturn;\n}\n//xx\n\n就是说不满足条件就return\n看起来绝对比你现在这一堆if else 舒服的多"
        },
        {
            "author": "William_Shi",
            "timestamp": 1593156180,
            "txt_content": "if (a.getItem().getType() == Material.IRON_SWORD && a.getPlayer() == Killer) {\n\nPlayer 对象不可能通过==比较\n我建议比较玩家的用户名或者是UUID\n一般来说都是使用UUID为多"
        },
        {
            "author": "lmhppt",
            "timestamp": 1593156360,
            "txt_content": "William_Shi 发表于 2020-6-26 15:23\nif (a.getItem().getType() == Material.IRON_SWORD && a.getPlayer() == Killer) {\n\nPlayer 对象不可能通 ...\n主要是啥呢，之前一直写C++，一下子写Java就有点不大习惯"
        },
        {
            "author": "William_Shi",
            "timestamp": 1593156600,
            "txt_content": "lmhppt 发表于 2020-6-26 15:26\n主要是啥呢，之前一直写C++，一下子写Java就有点不大习惯\n关键问题是\n比较的应该是玩家UUID、用户名 而不是 玩家对象本身"
        },
        {
            "author": "lmhppt",
            "timestamp": 1593157800,
            "txt_content": "William_Shi 发表于 2020-6-26 15:30\n关键问题是\n比较的应该是玩家UUID、用户名 而不是 玩家对象本身\n这个是木有问题的，因为我之前就把Killer赋值了这个Player，现在问题就是这个SpawnArrow不起效果"
        },
        {
            "author": "William_Shi",
            "timestamp": 1593157920,
            "txt_content": "lmhppt 发表于 2020-6-26 15:50\n这个是木有问题的，因为我之前就把Killer赋值了这个Player，现在问题就是这个SpawnArrow不起效果 ...\n从来没有人直接比较两个Player对象的\n请比较UUID"
        },
        {
            "author": "洞穴夜莺",
            "timestamp": 1593158100,
            "txt_content": "                                                if (KillerThrowSwordCooldown == 5) {\n                                                        Spawn.getWorld().spawnArrow(a.getPlayer().getLocation(), a.getPlayer().getLocation().getDirection(), (float)0.6, 12);\n                                                                                a.getPlayer().sendMessage(Prefix + To(\"&a&l你投掷了飞刀！\"));\n                                                }复制代码\n不要误导性缩进\nSpawn.getWorld().spawnArrow(a.getPlayer().getLocation(), a.getPlayer().getLocation().getDirection(), (float)0.6, 12);复制代码\n其次你没有填写射击者，这会导致箭射出去之后立即命中射击者自身或者命中队友（如果有填写的情况下箭在射出的前0.25秒内不会命中自身）"
        },
        {
            "author": "lmhppt",
            "timestamp": 1593158340,
            "txt_content": "William_Shi 发表于 2020-6-26 15:52\n从来没有人直接比较两个Player对象的\n请比较UUID\n改好了，有消息提示，但是依然没有箭射出qwq"
        },
        {
            "author": "洞穴夜莺",
            "timestamp": 1593158940,
            "txt_content": " 本帖最后由 洞穴夜莺 于 2020-6-26 16:12 编辑 \nlmhppt 发表于 2020-6-26 15:59\n改好了，有消息提示，但是依然没有箭射出qwq\n你改成啥了？\n写程序之前，先想想如何玩Minecraft\n这样你才会少写出这种有悖Minecraft游戏机制的代码\n"
        },
        {
            "author": "William_Shi",
            "timestamp": 1593159060,
            "txt_content": "lmhppt 发表于 2020-6-26 15:59\n改好了，有消息提示，但是依然没有箭射出qwq\n刚刚\nhttps://www.mcbbs.net/forum.php? ... 49&pid=18702107\n我对于原版的细节了解不太足够\n会mod开发的大佬点拨之后应该能解决了\n\nhttps://bukkit.windit.net/javado ... bukkit.util.Vector-\n用这个"
        },
        {
            "author": "lmhppt",
            "timestamp": 1593159360,
            "txt_content": "洞穴夜莺 发表于 2020-6-26 15:55\n不要误导性缩进\n\n其次你没有填写射击者，这会导致箭射出去之后立即命中射击者自身或者命中队友（如果有填 ...\n这个缩进是mcbbs弄得我这显示很正常\n如何填写射击者呢？"
        },
        {
            "author": "洞穴夜莺",
            "timestamp": 1593160260,
            "txt_content": " 本帖最后由 洞穴夜莺 于 2020-6-26 16:35 编辑 \nlmhppt 发表于 2020-6-26 16:16\n这个缩进是mcbbs弄得我这显示很正常\n如何填写射击者呢？\n参考楼上大佬的回答，我是玩mod的，几乎没写过插件\n从反编译的bukkit代码来看似乎是（注意你这样填写坐标的话箭是从脚底射出的）\n((Projectile) Spawn.getWorld().spawnArrow(a.getPlayer().getLocation(), a.getPlayer().getLocation().getDirection(), (float)0.6, 12)).setShooter(a.getPlayer());复制代码"
        },
        {
            "author": "William_Shi",
            "timestamp": 1593160320,
            "txt_content": "lmhppt 发表于 2020-6-26 16:16\n这个缩进是mcbbs弄得我这显示很正常\n如何填写射击者呢？\nhttps://bukkit.windit.net/javado ... bukkit.util.Vector-\n\n是这样的，billy大佬是写fabric的但是你在问Bukkit的相关问题\n你应该有一个思路自己去写的\n\nPlayer接口（由obc的CraftPlayer负责进一步实现，最底层实现在nms）\n的父接口，有一个是ProjectileSource\n然后你再调用其launchProjectile方法就可以解决问题了"
        },
        {
            "author": "lmhppt",
            "timestamp": 1593161280,
            "txt_content": "William_Shi 发表于 2020-6-26 16:32\nhttps://bukkit.windit.net/javadoc/org/bukkit/projectiles/ProjectileSource.html#launchProjectile-ja ...\n自己解决啦！谢谢！\n还是自己太傻了......"
        }
    ]
}