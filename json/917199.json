{
    "title": "(bukkit)如何获取范围内最近的玩家？",
    "author": "345733248",
    "replyCount": 3,
    "timestamp": 1570007460,
    "txt_content": "我使用loc.distance(player.getLocation())的方法判定玩家处于范围内并存入集合中，但集合内的玩家是按照字符串大小来排序的。请问一下该如何像原版命令的@p一样获取距离最近的玩家呢？或者请给我提供一个思路吧。",
    "replies": [
        {
            "author": "粘兽",
            "timestamp": 1570011000,
            "txt_content": "首先用getNearbyEntities得到范围内的实体\n随后new 一个map用来做排序\n然后用loc.distance得到两者的距离 为map的key 实体为map的value\n最后整一个冒泡排序就完事了"
        },
        {
            "author": "云闪",
            "timestamp": 1570011600,
            "txt_content": "需要按距离排序的玩家列表 见楼上\n\n如果仅仅是需要最近的，使用两个变量，double minDistance，Player minDisPlayer，分别记录最近距离和最近距离的玩家，如果有距离更近的就更新两个变量即可"
        },
        {
            "author": "可畏",
            "timestamp": 1570027920,
            "txt_content": " 本帖最后由 可畏 于 2019-10-2 22:54 编辑 \n    /**\n     * 获取指定玩家最近的玩家\n     * @param player 指定玩家\n     * @param range 最大距离\n     * @return 距离最近的另一个玩家，或者null\n     */\n    public Player getNearestPlayer(Player player, double range){\n        double distance = range;\n        Entity target = null;\n        // 可能低版本没有Player.getNearbyEntities这个方法，不过也类似吧\n        for (Entity entity : player.getNearbyEntities(range, range, range)){\n            if (!(entity instanceof Player)){\n                continue;\n            }\n            double d = entity.getLocation().distance(player.getLocation());\n            if (d <= range){\n                range = d;\n                target = entity;\n            }\n        }\n        if (target == null) return null;\n        return (Player) target;\n    }复制代码\n"
        }
    ]
}