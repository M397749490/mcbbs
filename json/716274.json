{
    "title": "[Bukkit][未知之域]JAVA机制-反射 通过反射调用成员方法",
    "author": "qianji20000420",
    "replyCount": 0,
    "timestamp": 1501996500,
    "txt_content": " 本帖最后由 qianji20000420 于 2017-8-6 13:40 编辑 \n\n 导读 通过反射获取成员方法并遍历通过反射调用成员方法通过反射调用非公共成员方法\n\n\n 获取成员方法 public class Demo_01 {\n        public static void main(String[] args) throws Exception {\n                Class<?> c = Class.forName(\"indi.Tshoiasc.reflect.test_01\");\n                \n        }\n}\n\nclass test_01 {\n        public void a(){\n                \n        }\n\n}复制代码老样子，先把Class对象获取到。\n\n然后查询API\n\n\n\n\nQQ截图20170806124903.png (21.41 KB, 下载次数: 12)\n\n下载附件\n\n2017-8-6 12:58 上传\n\n\n\n\n\n\n\n\nQQ截图20170806124918.png (21.01 KB, 下载次数: 12)\n\n下载附件\n\n2017-8-6 12:58 上传\n\n\n\n\n\n发现和成员方法有关的有这四个方法。\n那Declared就不用我说了吧，\n那我们就获取所有的吧，然后遍历一下\nMethod[] m = c.getDeclaredMethods();\n                for(Method e:m){\n                        System.out.println(e);\n                }复制代码\n\n\n\n\nQQ截图20170806125059.png (2.69 KB, 下载次数: 3)\n\n下载附件\n\n2017-8-6 12:59 上传\n\n\n\n\n\n那获取单个的呢？\nMethod m = c.getDeclaredMethod(\"a\");复制代码getDeclaredMethod的参数有两个 第一个是方法名 然后第二个是可变参 和之前构造方法的大同小异，都是传入方法参数对应的Class对象\n那如果a方法加一个参数String 该如何获取呢\nMethod m = c.getDeclaredMethod(\"a\",String.class);复制代码当然就是这样啦。\n\n\n 调用成员方法 日常API：\n既然这个机制叫反射，那调用应该也是反着调用。 我们就应该查看一下Method类的方法\n\n\n\n\nmehod.png (2.78 KB, 下载次数: 6)\n\n下载附件\n\n2017-8-6 13:04 上传\n\n\n\n\n\n找到了！\n那就用它调用一下吧\n我们还是先调用无参的\n但是 ， 那第一个参数是什么？  看API\n对带有指定参数的指定对象调用由此 Method 对象表示的底层方法。\n那当然是传对象了。 就用我们之前讲的那个 newInstance来创建\npublic class Demo_01 {\n        public static void main(String[] args) throws Exception {\n                Class<?> c = Class.forName(\"indi.Tshoiasc.reflect.test_01\");\n                //创建对象\n                test_01 t = (test_01) c.getConstructor().newInstance();\n                \n                Method m = c.getDeclaredMethod(\"a\");\n                m.invoke(t);\n        }\n}\n\nclass test_01 {\n        public test_01(){\n                \n        }\n        public void a(){\n                System.out.println(\"yes\");\n        }\n\n}复制代码\n\n\n\n\nyes.png (16.62 KB, 下载次数: 13)\n\n下载附件\n\n2017-8-6 13:09 上传\n\n\n\n\n\n这不就调用成功了？\n\n那带参的怎么办呢？  一样\n获取方法参考Part.1\n只需要将invoke参数后面加上你需要传入的参数就行了\nMethod m = c.getDeclaredMethod(\"a\",String.class);\n                m.invoke(t,\"ccc\");复制代码\n\n 调用非公共成员方法 private void a(String a){\n                System.out.println(a);\n        }复制代码按照常规我们先把a的权限修饰符改成private\n然后我们还是按上面的方式调用\n是不是抛了异常 IllegalAccessException\n这就不用我说了吧。\n直接setAccessible(true);\n\n\n\n\nccc.png (70.63 KB, 下载次数: 13)\n\n下载附件\n\n2017-8-6 13:14 上传\n\n\n\n\n\n什么私有，在反射面前都是渣渣~\n\n\n 导读 反射如何绕过泛型检查？\n返回索引贴\n第一次做教程，如果教程中有遗漏的或说错的地方请及时指出哇。~[groupid=1181]Unknown Domain[/groupid]\n",
    "replies": []
}