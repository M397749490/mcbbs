{
    "title": "ClassLoader加载的jar无法使用",
    "author": "冰上云梦",
    "replyCount": 6,
    "timestamp": 1590570840,
    "txt_content": "源代码图片：\n\n\n\n\n@%6A4GK8}GOV[J`@@CJ4IE1.png (169.68 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-27 17:10 上传\n\n\n\n\n\n\n\n\n\nR9_(U3AB~MGIMLYIX7U}[AD.png (101.04 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-27 17:10 上传\n\n\n\n\n\n错误信息：\nClassNotFoundException: org.python.util.PythonInterpreter\n\nGithub项目地址：https://github.com/BingZi-233/BZLimit\n\n",
    "replies": [
        {
            "author": "土球球",
            "timestamp": 1590579900,
            "txt_content": "道理我都懂，但到底哪一行报错了啊 ...\n\n\n\n\n\nScreenshot from 2020-05-27 19-42-51.png (15.06 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-27 19:43 上传\n\n\n\n\n\n\n盲猜这一行：你很可能是从插件主类里调用的这个方法，那 JVM 只会从你插件所属的 ClassLoader 找类，自然找不到了。\n"
        },
        {
            "author": "冰上云梦",
            "timestamp": 1590582120,
            "txt_content": " 本帖最后由 季末旋律 于 2020-5-27 21:45 编辑 \n土球球 发表于 2020-5-27 19:45\n道理我都懂，但到底哪一行报错了啊 ...\n这一行是在那个类加载器的文件中执行的，他们同属于一个类。\n我创建了一个主方法在运行的时候没有出现任何异常，但是放在服务器里面就无法找到类每次报错都是在new那个对象的时候出现了错误，找不到我载入的类。\n\n\n\n\n\nQQ截图20200527214453.png (70.06 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-27 21:45 上传\n\n\n\n\n\n"
        },
        {
            "author": "夏雨吖",
            "timestamp": 1590672420,
            "txt_content": "\n\n\n\n\n图片.png (39.96 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-28 21:13 上传\n\n\n\n\n\n大概看了一下，问题应该在Class.forName\nforName的作用域是调用forName的类可访问的所有类，但是你的类加载到的ClassLoader是新建的ClassLoader，在你这个类的作用域里当然找不到你加载的类啦\n\nBootstrapClassLoader -> ExtensionClassLoader -> AppClassLoader -> PluginClassLoader\n如果你的插件的类是用PluginClassLoader加载的话，在你当前的作用域里面只能找到自己的类加载器和每一级父级类加载器加载的所有类，而你自己加载的类在另外的一个URLClassLoader里面，在当前作用域里面forName肯定找不到\n\n\n\n\n\n图片.png (13.12 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-28 21:27 上传\n\n\n\n\n\n\n"
        },
        {
            "author": "冰上云梦",
            "timestamp": 1590677280,
            "txt_content": " 本帖最后由 季末旋律 于 2020-5-28 22:56 编辑 \nM8_mve 发表于 2020-5-28 21:27\n大概看了一下，问题应该在Class.forName\nforName的作用域是调用forName的类可访问的所有类，但是你的类加 ...\n但是我的Python部分是在和classloader一个类中，也是无法找到该class。\n我是不是应该用系统加载器进行加载，让整个环境都拥有这个类的读取。\n或者把加载过程移动到onEnable阶段？？？"
        },
        {
            "author": "夏雨吖",
            "timestamp": 1590732480,
            "txt_content": "季末旋律 发表于 2020-5-28 22:48\n但是我的Python部分是在和classloader一个类中，也是无法找到该class。\n我是不是应该用系统加载器进行加载 ...\n简单的说就是你自己的类加载器加载的类PluginClassLoader找不到，有两个办法\n可以把你要用到的类加载到PluginClassLoader也可以用反射把PluginClassLoader的parent改成你的类加载器\n如果你还有问题就是你没有懂ClassLoader的原理"
        },
        {
            "author": "冰上云梦",
            "timestamp": 1590744180,
            "txt_content": "M8_mve 发表于 2020-5-29 14:08\n简单的说就是你自己的类加载器加载的类PluginClassLoader找不到，有两个办法\n可以把你要用到的类加载到Pl ...\norg.bukkit.plugin.java.PluginClassLoader\n已经指定了classloader加载器，剩下的就是让它正常的运行了"
        }
    ]
}