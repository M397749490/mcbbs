{
    "title": "【已解决】1.12.2玩家拾取物品事件已过时，该用什么代替？",
    "author": "GhostSkyV9",
    "replyCount": 21,
    "timestamp": 1593748980,
    "txt_content": " 本帖最后由 sky295 于 2020-7-18 17:54 编辑 \n\n过时的事件再使用，还能有用嘛？\n\n\n\n\n\nQQ截图20200703120252.png\n(12.7 KB, 下载次数: 2)\n\n\n\n\n下载附件\n\n\n2020-7-3 12:03 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593749400,
            "txt_content": "替代：EntityPickupItemEvent\n\nPlayerPickupItemEvent仍可工作，但不推荐"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593749640,
            "txt_content": "疾风暗影 发表于 2020-7-3 12:10\n替代：EntityPickupItemEvent\n\nPlayerPickupItemEvent仍可工作，但不推荐\n这个事件无法获取到getPlayer这个方法，要怎么办？"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593749820,
            "txt_content": "sky295 发表于 2020-7-3 12:14\n这个事件无法获取到getPlayer这个方法，要怎么办？\ngetEntity​()，然后instanceof Player，之后强制类型转换\n\n请阅读https://hub.spigotmc.org/javadoc ... ickupItemEvent.html"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593749940,
            "txt_content": " 本帖最后由 sky295 于 2020-7-3 12:22 编辑 \n疾风暗影 发表于 2020-7-3 12:17\ngetEntity​()，然后instanceof Player，之后强制类型转换\n\n请阅读https://hub.spigotmc.org/javadocs/sp ...    @EventHandler\n    public void onPickItemPlayer(EntityPickupItemEvent event){\n        Player player=(Player) event.getEntity();\n        String name=player.getDisplayName();\n        if (event.getItem().getItemStack().getItemMeta().getLore().equals(name)){\n            event.setCancelled(true);\n            player.sendMessage(\"§c该物品不属于你，无法拾取\");\n        }\n    }复制代码\n是这样嘛，我只要获取到这个事件的玩家"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593750180,
            "txt_content": "sky295 发表于 2020-7-3 12:19\nPlayer player=(Player) event.getEntity();\n是这样嘛，我只要获取到这个事件的玩家\n不可以跳过instanceof判断\n\nEntityPickupItemEvent是所有实体捡起物品都会触发，不止是player\n比如村民、僵尸等捡起物品，不经判断直接强制转换会导致cannot cast error使服务器崩溃\n\n请自行学习java多态相关的知识"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593750720,
            "txt_content": "疾风暗影 发表于 2020-7-3 12:23\n不可以跳过instanceof判断\n\nEntityPickupItemEvent是所有实体捡起物品都会触发，不止是player\n    @EventHandler\n    public void onPickItemPlayer(EntityPickupItemEvent event){\n        Player player=(Player) event.getEntity();\n        if (player instanceof Player){\n            String name=player.getDisplayName();\n            if (event.getItem().getItemStack().getItemMeta().getLore().equals(name)){\n                event.setCancelled(true);\n                player.sendMessage(\"§c该物品不属于你，无法拾取\");\n            }\n        }\n    }\n是这样写的嘛"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593750900,
            "txt_content": "sky295 发表于 2020-7-3 12:32\n@EventHandler\n    public void onPickItemPlayer(EntityPickupItemEvent event){\n        Player pl ...\n错\n你先转换就已经可能抛出异常了\n\n先判断LivingEntity是不是，再转换类型\n\nLivingEntity entity = event.getEntity();\nif(entity instanceof Player)复制代码\n\n后续判断自己写"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593751080,
            "txt_content": "疾风暗影 发表于 2020-7-3 12:35\n错\n你先转换就已经可能抛出异常了\n    @EventHandler\n    public void onPickItemPlayer(EntityPickupItemEvent event){\n        LivingEntity entity = event.getEntity();\n        if(entity instanceof Player){\n            Player player=(Player) event.getEntity();\n            String name=player.getDisplayName();\n            if (event.getItem().getItemStack().getItemMeta().getLore().equals(name)){\n                event.setCancelled(true);\n                player.sendMessage(\"§c该物品不属于你，无法拾取\");\n            }\n        }\n    }\n\n这样嘛"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593751260,
            "txt_content": "[12:40:40 ERROR]: 无法加载位于文件夹 plugins 中的 plugins\\BindPlayer.jar ，因为插件无效\n org.bukkit.plugin.InvalidPluginException: java.lang.IllegalArgumentException: Plugin already initialized!\n        at org.bukkit.plugin.java.JavaPluginLoader.loadPlugin(JavaPluginLoader.java:133) ~[JavaPluginLoader.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.SimplePluginManager.loadPlugin(SimplePluginManager.java:323) ~[SimplePluginManager.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.SimplePluginManager.loadPlugins(SimplePluginManager.java:245) [SimplePluginManager.class:1.12.2-5b88dcf]\n        at org.bukkit.craftbukkit.v1_12_R1.CraftServer.loadPlugins(CraftServer.java:389) [CraftServer.class:1.12.2-5b88dcf]\n        at net.minecraft.server.MinecraftServer.func_71247_a(MinecraftServer.java:343) [MinecraftServer.class:?]\n        at net.minecraft.server.dedicated.DedicatedServer.func_71197_b(DedicatedServer.java:316) [nz.class:?]\n        at net.minecraft.server.MinecraftServer.run(MinecraftServer.java:591) [MinecraftServer.class:?]\n        at java.lang.Thread.run(Unknown Source) [?:1.8.0_221]\nCaused by: java.lang.IllegalArgumentException: Plugin already initialized!\n        at org.bukkit.plugin.java.PluginClassLoader.initialize(PluginClassLoader.java:135) ~[PluginClassLoader.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.java.JavaPlugin.<init>(JavaPlugin.java:50) ~[JavaPlugin.class:1.12.2-5b88dcf]\n        at com.github.sky295.Main.<init>(Main.java:19) ~[?:?]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_221]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at java.lang.Class.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at org.bukkit.plugin.java.PluginClassLoader.<init>(PluginClassLoader.java:65) ~[PluginClassLoader.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.java.JavaPluginLoader.loadPlugin(JavaPluginLoader.java:129) ~[JavaPluginLoader.class:1.12.2-5b88dcf]\n        ... 7 more\nCaused by: java.lang.IllegalStateException: Initial initialization\n        at org.bukkit.plugin.java.PluginClassLoader.initialize(PluginClassLoader.java:138) ~[PluginClassLoader.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.java.JavaPlugin.<init>(JavaPlugin.java:50) ~[JavaPlugin.class:1.12.2-5b88dcf]\n        at com.github.sky295.Main.<init>(Main.java:19) ~[?:?]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:1.8.0_221]\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at java.lang.reflect.Constructor.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at java.lang.Class.newInstance(Unknown Source) ~[?:1.8.0_221]\n        at org.bukkit.plugin.java.PluginClassLoader.<init>(PluginClassLoader.java:65) ~[PluginClassLoader.class:1.12.2-5b88dcf]\n        at org.bukkit.plugin.java.JavaPluginLoader.loadPlugin(JavaPluginLoader.java:129) ~[JavaPluginLoader.class:1.12.2-5b88dcf]\n        ... 7 more复制代码\n\n这是什么情况"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593751440,
            "txt_content": "sky295 发表于 2020-7-3 12:38\n@EventHandler\n    public void onPickItemPlayer(EntityPickupItemEvent event){\n        LivingEnt ...\n还是有错。。\n\nevent.getItem().getItemStack().getItemMeta().getLore()复制代码\n\n官方文档：\nPlugins should check if hasLore() returns true before calling this method.\n\n不先判断hasLore()的情况下getLore将返回null值报错\n\n以及代码里还有其他两处错误，自己找出来解决\n\n以及建议仔细阅读java doc及学习java基础知识"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593752400,
            "txt_content": "疾风暗影 发表于 2020-7-3 12:44\n还是有错。。\n那我后台的那个报错是什么情况？"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593752700,
            "txt_content": "sky295 发表于 2020-7-3 13:00\n那我后台的那个报错是什么情况？Plugin already initialized\n\n不要重复例化插件主体， 尤其是初始化静态对象的时候"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593753240,
            "txt_content": "疾风暗影 发表于 2020-7-3 13:05\n不要重复例化插件主体， 尤其是初始化静态对象的时候\n我并没有重复实例化插件主类呀"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593753360,
            "txt_content": "sky295 发表于 2020-7-3 13:14\n我并没有重复实例化插件主类呀\n贴你自己Main.java的内容"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593754020,
            "txt_content": " 本帖最后由 sky295 于 2020-7-3 13:29 编辑 \n\n这下可以了。。。。。。"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593754200,
            "txt_content": "疾风暗影 发表于 2020-7-3 13:16\n贴你自己Main.java的内容\n如何强制将玩家背包里的物品扔出？"
        },
        {
            "author": "天辉胡萝卜",
            "timestamp": 1593754980,
            "txt_content": "sky295 发表于 2020-7-3 13:30\n如何强制将玩家背包里的物品扔出？\n请自行阅读官方文档"
        },
        {
            "author": "GhostSkyV9",
            "timestamp": 1593755760,
            "txt_content": "疾风暗影 发表于 2020-7-3 13:43\n请自行阅读官方文档\n在API文档的哪一栏目里"
        },
        {
            "author": "Dutst",
            "timestamp": 1593967800,
            "txt_content": "就这样吧  咱也不会  哈哈哈"
        },
        {
            "author": "Sssss...",
            "timestamp": 1594085820,
            "txt_content": "EntityPickupItemEvent\n\n参见API文档"
        },
        {
            "author": "Sssss...",
            "timestamp": 1594085880,
            "txt_content": "sky295 发表于 2020-7-3 13:14\n我并没有重复实例化插件主类呀\n你是不是有多个类都extends JavaPlugin了？"
        }
    ]
}