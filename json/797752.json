{
    "title": "制作插件碰到的问题 需要大哥帮忙下",
    "author": "790859937",
    "replyCount": 9,
    "timestamp": 1528120080,
    "txt_content": "我想制作一个插件 功能是\n输入/test 启动闪电模式\n当我手中持有钻石剑时，右键某地则闪电 闪击某处\n\n监听器可以实现，但是 监听器不知道如何设置权限，意味着任何人都能用\n但是用命令的话我不知道该如何做到，我现在只能实现将钻石剑拿在手上然后输入test 他只是发出电击一下 甚至不用右键\n命令该如何配合监听器实现？\npackage cn.jediking;\n\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.event.HandlerList;\nimport org.bukkit.event.Listener;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class PlayerJoinWorld extends JavaPlugin {\n    @Override\n    public void onEnable()\n    {\n        getServer().getPluginManager().registerEvents(new Listeners(),this);\n        getLogger().info(\"插件启用成功\");\n        //启用插件\n    }\n    \n    public void onDisable()\n    {\n        HandlerList.unregisterAll();\n        getLogger().info(\"插件卸载成功\");\n        //关闭插件\n    }\n       \n    @Override\n    public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args){\n        if(cmd.getName().equalsIgnoreCase(\"test\")){ //如果输入\"test\"则返回true\n                sender.sendMessage(\"闪电模式启动\");\n                return true;\n        }\n        // 如果不是test，则返回false，如果你没有添加这个命令，系统就会显示：“没有这个命令”\n        return false;\n    }\n}\n\npackage cn.jediking;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.Material;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.PlayerInteractEvent;\nimport org.bukkit.event.player.PlayerJoinEvent;\n\nimport net.minecraft.server.v1_7_R4.PlayerAbilities;\n\npublic class Listeners implements Listener {\n    @EventHandler\n    public void listenjoin (PlayerJoinEvent event){\n        Bukkit.broadcastMessage(\"欢迎 \"+event.getPlayer().getName()+\" 进入游戏\");\n        \n        \n    }\n    \n    @EventHandler\n    public void Lighting (PlayerInteractEvent event){\n        Player player = event.getPlayer();\n        if (player.getItemInHand().getType()==Material.DIAMOND_SWORD){\n            player.getWorld().strikeLightning(player.getTargetBlock(null, 300).getLocation());\n        }\n    }\n\n}\n\n顺便请教一下该如何找一些对我有益处的教程\n\n\n",
    "replies": [
        {
            "author": "zhanshi123",
            "timestamp": 1528123680,
            "txt_content": "用hasPermission方法判断是否有指定权限 或 使用Vault判断权限\n\n根据你的代码，用hasPermission方法的示例，vault的自己去查wiki\n    @EventHandler\n    public void Lighting (PlayerInteractEvent event){\n        Player player = event.getPlayer();\n        if(!player.hasPermission(\"xxx.xx\")){\n            return;\n        }\n        if (player.getItemInHand().getType()==Material.DIAMOND_SWORD){\n            player.getWorld().strikeLightning(player.getTargetBlock(null, 300).getLocation());\n        }\n    }\n另外 你所写的代码 没有判断手中物品是否为空\n有NPE风险\n\n服务端所有方法都在javadoc里面 地址\nhttps://hub.spigotmc.org/javadoc ... erview-summary.html\n在这个里面可以找到相应方法的用法和说明"
        },
        {
            "author": "790859937",
            "timestamp": 1528157760,
            "txt_content": "zhanshi123 发表于 2018-6-4 22:48\n用hasPermission方法判断是否有指定权限 或 使用Vault判断权限\n\n根据你的代码，用hasPermission方法的示例 ...\nNPE风险是什么?可以加QQ交流下吗"
        },
        {
            "author": "790859937",
            "timestamp": 1528163220,
            "txt_content": "zhanshi123 发表于 2018-6-4 22:48\n用hasPermission方法判断是否有指定权限 或 使用Vault判断权限\n\n根据你的代码，用hasPermission方法的示例 ...\n还有就是请教一下配置的读写修改\n\n我的文件格式大概是这样 我的主类在PlyerJoinWorld \n关于配置文件读写 我在主类文件可以使用getconfig 但是在我监听器这里不行，怎么引用它？"
        },
        {
            "author": "轻光233",
            "timestamp": 1528326300,
            "txt_content": "790859937 发表于 2018-6-5 09:47\n还有就是请教一下配置的读写修改\n\n我的文件格式大概是这样 我的主类在PlyerJoinWorld \n居然还有过期方法"
        },
        {
            "author": "790859937",
            "timestamp": 1528345140,
            "txt_content": "轻光233 发表于 2018-6-7 07:05\n居然还有过期方法\n我不知道新方法啊。。。很惨"
        },
        {
            "author": "@@Leo",
            "timestamp": 1528353780,
            "txt_content": "790859937 发表于 2018-6-5 08:16\nNPE风险是什么?可以加QQ交流下吗\nNPE就是NullPointerException，即空指针\n当你手上没有东西的时候player.getItemInHand()会返回null\n然后就会造成让null使用方法getType()然后出错233\n\n一般情况下我都是使用命令然后把这个玩家加到某个List里，然后用监听检测有List里的玩家使用钻石剑时就会放闪电233"
        },
        {
            "author": "轻光233",
            "timestamp": 1528357380,
            "txt_content": "轻光233 发表于 2018-6-7 07:05\n居然还有过期方法\n可以看注解啊，看不懂就翻译一下，大概就知道什么意思了"
        },
        {
            "author": "2609848420",
            "timestamp": 1528363500,
            "txt_content": "790859937 发表于 2018-6-5 09:47\n还有就是请教一下配置的读写修改\n\n我的文件格式大概是这样 我的主类在PlyerJoinWorld \ngetConfig();方法是在org.bukkit.plugin.java.JavaPlugin类中的方法 你的主类继承了该类 所以可以使用 但是你的监听器类没有继承 所以不可用"
        },
        {
            "author": "lliiooll",
            "timestamp": 1528533480,
            "txt_content": "790859937 发表于 2018-6-5 09:47\n还有就是请教一下配置的读写修改\n\n我的文件格式大概是这样 我的主类在PlyerJoinWorld \n你可以在主类注册一个字段来供插件使用\npublic static Main plugin;\n在其他类调用就是Main.plugin.xxxxxxx;\n比如Main.plugin.getConfig():"
        }
    ]
}