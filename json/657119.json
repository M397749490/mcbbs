{
    "title": "[管理|修正]villagerNoLibrarian ——村民中的图书管理员都下岗了[1.9.4]",
    "author": "神隐的间隙",
    "replyCount": 16,
    "timestamp": 1482735840,
    "txt_content": " 本帖最后由 神隐的间隙 于 2016-12-26 19:02 编辑 \n\n我的世界1.9中将新增两个新附魔，冰霜行者和经验修补，这两个附魔都是特殊的宝藏型\"附魔，她们的获取和其他附魔完全不一样，是无法主动附魔出来的，只能通过箱子战利品、钓鱼或交易获得附魔书才能获取。其中经验修复可以说是小半个无限耐久。但是这两个附魔只要繁殖一些村民找到图书管理员，就可以瞬间烂大街。所以花了半个小时写了这个插件。\n\n没有权限，没有指令，玩家对图书馆理员右键的时候就会将图书管理员变成其他职业。\n配置：\n#是否发送图书管理员职业变化消息\nEnableMessage: \"true\"\nMessage: \"[villagerNoLibrarian] 图书管理员罢工了，他变成了其他职业\"\n#图书管理员变成的职业：FARMER(农民)、BUTCHER(屠夫)、BLACKSMITH(铁匠)、PRIEST(牧师)\nLIBRARIAN_is: \"FARMER\"复制代码\n源码：仅供互相学习，有不足的地方希望可以指出。\n\npackage src;\n\nimport java.io.File;\n\nimport org.bukkit.Bukkit;\nimport org.bukkit.ChatColor;\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.command.ConsoleCommandSender;\nimport org.bukkit.entity.Player;\nimport org.bukkit.entity.Villager;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.PlayerInteractEntityEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class villagerNoLibrarian extends JavaPlugin implements Listener{\n         @Override\n     public void onEnable(){\n             getLogger().info(\"村民中没有图书管理员插件已启动!\");\n             CreateConfig();\n             getServer().getPluginManager().registerEvents(this, this);\n     }\n     public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args){\n             \n             return true;\n     }\n     public void CreateConfig(){\n             if (!new File(getDataFolder() + File.separator + \"config.yml\").exists()) {\n                     saveDefaultConfig();\n                     say(ChatColor.YELLOW + \"无法找到config.yml,正在创建\");\n             } try {\n                     reloadConfig();\n                     say(ChatColor.YELLOW + \"成功加载config\");\n             } catch (Exception e) {\n                     e.printStackTrace();\n           getServer().getPluginManager().disablePlugin(this);\n           say(ChatColor.RED + \"无法读取config，插件已关闭\");\n             }\n     }\n     public void say(String s){\n             ConsoleCommandSender sender = Bukkit.getConsoleSender();\n             sender.sendMessage(s);\n     }\n     //玩家打开村民交易的时候\n     @EventHandler\n     public void onPlayerInteractEntityEvent(PlayerInteractEntityEvent event){\n                 Player P=event.getPlayer();\n                 \n                 Villager v1=(Villager) event.getRightClicked();\n                   if(v1.getProfession().equals(Villager.Profession.LIBRARIAN)){\n                          if(getConfig().getString(\"EnableMessage\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\").equalsIgnoreCase(\"true\")){\n                                  P.sendMessage(getConfig().getString(\"Message\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\"));\n                          }\n                          if(getConfig().getString(\"LIBRARIAN_is\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\").equalsIgnoreCase(\"FARMER\")){\n                                  v1.setProfession(Villager.Profession.FARMER);\n                          }else if(getConfig().getString(\"LIBRARIAN_is\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\").equalsIgnoreCase(\"BUTCHER\")){\n                                  v1.setProfession(Villager.Profession.BUTCHER);\n                          }else if(getConfig().getString(\"LIBRARIAN_is\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\").equalsIgnoreCase(\"BLACKSMITH\")){\n                                  v1.setProfession(Villager.Profession.BLACKSMITH);\n                          }else if(getConfig().getString(\"LIBRARIAN_is\").replaceAll(\"<reason>\", \"\").replaceAll(\"&\", \"§\").equalsIgnoreCase(\"PRIEST\")){\n                                  v1.setProfession(Villager.Profession.PRIEST);\n                          }\n                          \n                  }\n         }\n     }\n\n     \n复制代码经测试1.7.x到1.10.2都可以成功加载(不过我没有1.7和1.10客户端没有进去测试)，1.9以前的需要将配置文件转码否则会报错。\n\n",
    "replies": [
        {
            "author": "Pangxie",
            "timestamp": 1482736740,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "LRual",
            "timestamp": 1482736920,
            "txt_content": "Pangxie 发表于 2016-12-26 15:19\n这插件。。。会不会影响平衡\n难道 不是因为图书管理员太影响平衡了\n才有了这个插件？"
        },
        {
            "author": "TimmyOVO",
            "timestamp": 1482739020,
            "txt_content": " 本帖最后由 星燚 于 2016-12-26 15:59 编辑 \n\n這個應該1.7+都能用吧"
        },
        {
            "author": "ruhuasiyu",
            "timestamp": 1482741240,
            "txt_content": "其实挺好的啊，图书管理员卖的附魔书一般都能卖出高价，这使得赚钱变得太容易了"
        },
        {
            "author": "Pangxie",
            "timestamp": 1482744780,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "xiaodobi2333",
            "timestamp": 1482748620,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "神隐的间隙",
            "timestamp": 1482748740,
            "txt_content": "xiaodobi2333 发表于 2016-12-26 18:37\n应该说是去控制\"图书管理员\"这个村民职业的数量，这样完全扼杀不好,\n\n而且右键才去修改,这方式并不怎么好 ...\n如果是控制不出生的话那么以前存在的依然还存在"
        },
        {
            "author": "神隐的间隙",
            "timestamp": 1482748980,
            "txt_content": "Pangxie 发表于 2016-12-26 17:33\n支持1.10.2吗\n你可以试试，我刚刚测试了一下可以"
        },
        {
            "author": "羽羽___",
            "timestamp": 1482753060,
            "txt_content": "图书管理员和你有多大仇？紫djwxiwhduwjdwadw"
        },
        {
            "author": "神隐的间隙",
            "timestamp": 1482753240,
            "txt_content": "羽羽___ 发表于 2016-12-26 19:51\n图书管理员和你有多大仇？紫djwxiwhduwjdwadw\n咳咳，服务器里玩家直接附魔个经验修复，无限耐久的物品都不好卖了"
        },
        {
            "author": "羽羽___",
            "timestamp": 1482753300,
            "txt_content": "神隐的间隙 发表于 2016-12-26 19:54\n咳咳，服务器里玩家直接附魔个经验修复，无限耐久的物品都不好卖了\n好吧紫婆婆（手动滑稽）"
        },
        {
            "author": "炫宙菌",
            "timestamp": 1482753420,
            "txt_content": "虽然用处不大，但毕竟是楼主良苦用心，赞"
        },
        {
            "author": "你离开的梦",
            "timestamp": 1483952280,
            "txt_content": "可以把这个插件换成 获得经验修补附魔书之后 自动变成其他附魔书"
        },
        {
            "author": "rxsglzc",
            "timestamp": 1512193860,
            "txt_content": "你好，我使用时候有个小报错\n插件功能使用正常,编码正确，服务器版本 水龙头194\nCould not pass event PlayerInteractEntityEvent to villagerNoLibrarian v0.1\norg.bukkit.event.EventException\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:310) ~[spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.java:62) ~[spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at org.bukkit.plugin.SimplePluginManager.fireEvent(SimplePluginManager.java:502) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.java:487) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.PlayerConnection.a(PlayerConnection.java:1531) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.PacketPlayInUseEntity.a(SourceFile:68) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.PacketPlayInUseEntity.a(SourceFile:12) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.PlayerConnectionUtils$1.run(SourceFile:13) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) [?:1.8.0_101]\n        at java.util.concurrent.FutureTask.run(Unknown Source) [?:1.8.0_101]\n        at net.minecraft.server.v1_9_R2.SystemUtils.a(SourceFile:45) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.MinecraftServer.D(MinecraftServer.java:726) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.DedicatedServer.D(DedicatedServer.java:399) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.MinecraftServer.C(MinecraftServer.java:665) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at net.minecraft.server.v1_9_R2.MinecraftServer.run(MinecraftServer.java:564) [spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        at java.lang.Thread.run(Unknown Source) [?:1.8.0_101]\nCaused by: java.lang.ClassCastException: org.bukkit.craftbukkit.v1_9_R2.entity.CraftPlayer cannot be cast to org.bukkit.entity.Villager\n        at src.villagerNoLibrarian.onPlayerInteractEntityEvent(villagerNoLibrarian.java:50) ~[?:?]\n        at sun.reflect.GeneratedMethodAccessor1121.invoke(Unknown Source) ~[?:?]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:1.8.0_101]\n        at java.lang.reflect.Method.invoke(Unknown Source) ~[?:1.8.0_101]\n        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.java:306) ~[spigot-1.9.4-R0.1-SNAPSHOT.jar:git-Spigot-c6871e2-0cd0397]\n        ... 15 more复制代码"
        },
        {
            "author": "sa22sa",
            "timestamp": 1594344420,
            "txt_content": "老头牛逼就完了"
        },
        {
            "author": "卜世超",
            "timestamp": 1596533160,
            "txt_content": "6666666666666666666666"
        }
    ]
}