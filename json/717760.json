{
    "title": "Nucleus 官方文档翻译——Developers 部分",
    "author": "土球球",
    "replyCount": 0,
    "timestamp": 1502268780,
    "txt_content": " 本帖最后由 ustc_zzzz 于 2017-8-9 16:54 编辑 \n\n\nOne simple essentials plugin. Many amazing possibilities.\n\n\n概述Nucleus是针对Sponge服务器的基础插件之一，被誉为“Sponge上的Essentials”。Nucleus具有Bukkit服务器基础插件Essentials的许多功能，甚至包含有一些Essentials插件未具备的基础功能。\n\n本帖翻译的主要内容是Nucleus官方文档（https://nucleuspowered.org/）的第二部分：Developers，针对想要协作开发的开发者的文档。文档原文本身仍有部分尚未补完，因此翻译目前也只能翻译已补完的部分。\n\n本人将陆陆续续地翻译Nucleus官方文档的所有内容，请耐心等待。\n\n\n该文档本体及翻译均采用CC-BY-SA 4.0协议。\n\n正文\n2.1 开发者指南\n\n这一块内容现在还乱糟糟的，我们正在致力于改善这一问题。\n\n我是一个希望让插件和Nucleus协同工作的插件开发者\n\n我们大概没法帮你做什么，不过你可以看看我们的API文档，至于里面的内容，我们之后会多添加一些的。\n\n请参见API文档（2.2）部分\n\n我想参与到Nucleus的开发中\n\n好吧……我们恐怕更没办法帮你做什么了。不过我们写了一点东西！\n\n请参见贡献指南（2.4）部分\n\n2.2 Nucleus的API\n\nNucleus旨在于让开发者可以更方便地利用Nucleus的一些特性。想使用Maven或者Gradle？你可以用下面的集成仓库：\n\nRepository: http://repo.drnaylor.co.uk/artifactory/list/minecraft  \nDependency (1.10.2): io.github.nucleuspowered:nucleus-api:<version>-S5.1  \nDependency (1.11.2): io.github.nucleuspowered:nucleus-api:<version>-S6.0  \n\n或者使用JitPack\n\nRepository: https://jitpack.io  \nDependency (1.10.2): com.github.NucleusPowered.Nucleus:nucleus-api:<version>  \nDependency (1.11.2): com.github.NucleusPowered.Nucleus:nucleus-api:<version>-6.0  \n\nJavaDocs\n\n你可以在这里找到JavaDocs\n\n相关文章\n\n使用占位符（2.3）\n\n2.3 使用占位符\n\n介绍\n\nNucleus使用了很多用于解析文本的方法，包括创建自定义的占位符。不管什么情况，你都需要获取NucleusMessageTokenService，如果服务端安装有Nucleus，那么这个服务总是存在的。\n\n获取特定服务\n\n你可以通过Sponge的服务管理器获取到NucleusMessageTokenService，也可以通过NucleusAPI类的NucleusAPI.getMessageTokenService()静态方法获取到它。\n\n使用Nucleus方式的解析文本，也就是NucleusTextTemplate\n\nNucleus允许你使用两种类型的输入以解析为Nucleus形式的文本，一种是以TextTemplate的类型输入，另一种以我们的&符号开头。你可以把相关的字符串传入到NucleusMessageTokenService.createFromString(String)这一API方法，从而得到一个NucleusTextTemplate的实例。然后你就可以使用NucleusTextTemplate#getForCommandSource(CommandSource)方法，得到针对特定执行命令的对象量身定制的文本，该方法会解析所有的点位符，从而返回得到你需要的Text对象。\n\n创建你自己的占位符\n\n如果你是插件开发者，并且你希望在Nucleus用到的文本里显示动态信息，比如MOTD文件里的内容，那么你可以使用Nucleus提供的基于插件的服务。\n\n为了防止冲突，Nucleus为每个插件对应的占位符提供了一个相应的模板，{{pl:[pluginid]:<identifier>}}。插件将收到一个名为identifier的字符串用作占位符的名称，从而插件本身可以返回其想返回的东西，当然也可以返回一个空的Optional，代表相应的占位符不合法。\n\n为了达成这一目标，插件首先要向Nucleus注册一个NucleusMessageTokenService.TokenParser接口的实例对象。这个接口十分简单，只是用于让Nucleus知悉针对你的插件的占位符是什么样的。你可以使用NucleusMessageTokenService.register(PluginContainer, TokenParser)这一方法针对你的插件注册相应的TokenParser。\n\n下面是一个示例，展示了为特定插件注册相应的占位符的方式：\n\nPluginContainer pluginContainer = Sponge.getPluginManager().fromInstance(this); // example, let's say the plugin id is \"eggs\"\ntry {\n    NucleusAPI.getMessageTokenService().register(pluginContainer, (tokenInput, source, variables) -> {\n        if (tokenInput.equals(\"bacon\") {\n            return Text.of(\"bacon \", source.getName());\n        }\n\n        if (tokenInput.startsWith(\"spam\") {\n            return Text.of(\"lovely \", tokenInput, \" \", source.getName());\n        }\n\n        // Indicates this is not valid.\n        return Optional.empty();\n    });\n} catch (PluginAlreadyRegisteredException ex) {\n    // You've tried to register the plugin more than once.\n}复制代码\n相应的{{pl:[pluginid]:<id>}}占位符便以完成注册，而你的TokenParser将获取到<id>这一部分代表的东西。在上面的示例里，如果Nucleus在向一个名为“spamalot”的玩家展示含有你提供的占位符的消息的话，那么它们将会显示成这个样子：\n\n{{pl:eggs:bacon}}bacon spamalot{{pl:eggs:bacon2}}Empty Optional{{pl:eggs:spam}}lovely spam spamalot{{pl:eggs:spamspam}}lovely spamspam spamalot{{pl:eggs:somethingelse}}Empty Optional\n\n当然了，你并不总需要把你的TokenParser写成Lambda表达式的形式，比如说，如果你更愿意把它写成一个实现类的形式，然后注册其实例的话，那么这样的方式也是可以正常工作的。\n\n创建一个主占位符（{{id}}）\n\nNucleus当然也允许你创建一个名为“主占位符”的东西。主占位符不需要指定特定的插件，它的工作方式类似于其他的Nucleus自己的占位符，比如{{name}}，实际上，这些都是别名。\n\n你必须先为你的插件注册一个TokenParser，然后才能注册主占位符。\n\n比如说你想注册一个{{lovelyspam}}占位符，然后希望它和{{pl:eggs:spam}}的作用是一样的，那么你只需要调用下面这个方法：\n\nboolean registerPrimaryToken(String primaryIdentifier, PluginContainer registeringPlugin, String identiferToMapTo)复制代码\n针对这个示例中的情况，你需要这么做：\n\nboolean result = registerPrimaryToken(\"lovelyspam\", pluginContainer, \"spam\");复制代码\n\n2.4 向Nucleus贡献代码\n\nNucleus是一个基于模块的复杂插件，大大方便了使用插件的管理员和第三方插件，使其得以关掉想要关掉的Nucleus的部分特性，并对启动时间、冷却时间、和相应的费用进行全局设置。尽管听进来Nucleus插件的内部组成应该是个庞然大物，但是对于一般的开发者而言，如果只是想要为Nucleus添加特性，那么是没有什么必要洞悉内部特性的，开发者只需要把它们的工作重心放在想要实现的核心特性就好了。\n\n概述\n\nNucleus是怎么组织起来的？模块装载器快速指南\n\n\n预备知识\n\n这一部分我们将考虑如何为一个模块添加命令、监听器、以及任务，还有为玩家、世界、乃至整个服务器添加持久化数据。\n\n命令、监听器、以及任务\n命令事件监听器可重复执行的任务可注入对象\n\n\n存取数据\n获取玩家、世界、或通用数据添加玩家、世界、或通用数据获取配置选项\n\n\n模块和配置\n\n在这一部分，我们将考虑模块是如何创建的，以及相应的配置选项是如何和模块建立联系的。\n\n模块\n创建一个简单的模块创建一个包含有配置选项的模块添加管理器\n\n\n配置\n添加若干配置选项\n\n\n\n[groupid=534]InfinityStudio[/groupid]\n",
    "replies": []
}