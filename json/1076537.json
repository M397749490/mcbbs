{
    "title": "关于服务器插件连接数据库的问题",
    "author": "ketikai",
    "replyCount": 7,
    "timestamp": 1594494060,
    "txt_content": " 本帖最后由 ketikai 于 2020-7-12 19:28 编辑 \n\n服务器系统 CentOS 7.8\nMySQL 5.6.48\n服务端核心为 Mohist-1.12.2-fc80d13-server.jar\n用到数据库的插件为 GlobalShop、BBSToper 、CoreProtect、PlayerTitle、PlotSquared、QuickShop、QianDao 等等\n都是本地数据库、端口也是默认的3306\n数据库连接参数实例：\n    ip：localhost 或 127.0.0.1\n    port：3306\n    prefix：gs_\n    database：mc_globalshop_\n    username：mc_globalshop_\n    password：2jeYPycE**DYh7R\n报错日志：\n\n\n\n\nQuickShop.log\n(50.8 KB, 下载次数: 4)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\nGlobalShop.log\n(19.98 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\nPlotSquared.log\n(5.61 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\nPlayerTitle.log\n(6.49 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\nPlayerPoints.log\n(2.08 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\nCoreProtect.log\n(5.1 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\nBBSToper.log\n(7.25 KB, 下载次数: 1)\n\n\n\n2020-7-12 03:00 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "埃拉拉",
            "timestamp": 1594494060,
            "txt_content": "ketikai 发表于 2020-7-12 19:52\n是的 我有考虑过读写权限问题 但是忘了去尝试 你这么一说我想起来了 我去试试 ...\n按照现在的情况，数据库本身没问题，文件夹权限也没问题，但服务端本身没有排查过（其实也没必要排查），以及，MySQL的命名规范，下划线虽然可以加，但除了前缀外，不应该在数据库名和用户名最后加下划线吧（纯属推测），另外就是连接数据库时，数据库的地址（真不知道是不是想多了，我都快江郎才尽了QAQ）"
        },
        {
            "author": "埃拉拉",
            "timestamp": 1594515060,
            "txt_content": " 本帖最后由 ElaBosak 于 2020-7-12 08:57 编辑 \n\n\n我稍微看了看，也就是这两个错误在重复出现了，第一个是无法连接，第二个是拒绝访问，建议先试试看使用数据库工具能否访问你的MySQL数据库，然后再对服务器进行调试，可能是端口未开放的问题，端口拒绝访问，这个问题就出现在连接步骤上"
        },
        {
            "author": "ketikai",
            "timestamp": 1594548600,
            "txt_content": "ElaBosak 发表于 2020-7-12 08:51\n我稍微看了看，也就是这两个错误在重复出现了，第一个是无法连接，第二个是拒绝访问，建议先试试看使用数 ...\n这些我都尝试过 比如更换数据库的默认端口 安全组防火墙上都放通了 重要的是我的网站在访问数据库时是正常的 所以我就很迷惑不知道什么问题"
        },
        {
            "author": "埃拉拉",
            "timestamp": 1594554180,
            "txt_content": "ketikai 发表于 2020-7-12 18:10\n这些我都尝试过 比如更换数据库的默认端口 安全组防火墙上都放通了 重要的是我的网站在访问数据库时是正 ...\n是linux服务器吗？如果是linux服务器还可以考虑考虑Spigot服务端文件夹的权限问题，我都直接 chmod  777，避免不必要的麻烦"
        },
        {
            "author": "ketikai",
            "timestamp": 1594554720,
            "txt_content": "ElaBosak 发表于 2020-7-12 19:43\n是linux服务器吗？如果是linux服务器还可以考虑考虑Spigot服务端文件夹的权限问题，我都直接 chmod  777 ...\n是的 我有考虑过读写权限问题 但是忘了去尝试 你这么一说我想起来了 我去试试"
        },
        {
            "author": "ketikai",
            "timestamp": 1594564740,
            "txt_content": " 本帖最后由 ketikai 于 2020-7-12 22:47 编辑 \nElaBosak 发表于 2020-7-12 22:27\n按照现在的情况，数据库本身没问题，文件夹权限也没问题，但服务端本身没有排查过（其实也没必要排查）， ...\n刚刚翻了翻 用root用户进到管理页 点了一下这些库 在授权处的一二条是否 于是我设置成是 本来以为能解决 结果依旧无法连接 而且这时的库名是和插件名相同的\n\n\n\n\nimage.png (66.49 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-12 22:36 上传\n\n\n\n\n\n\nps：很奇怪的是 现在用的服务器是自己组的 还有一台huawei云的也会出现这类问题 起初我以为是数据库版本问题 于是更换成MySQL 8.0但是依旧没有作用\n"
        },
        {
            "author": "ketikai",
            "timestamp": 1594570380,
            "txt_content": " 本帖最后由 ketikai 于 2020-7-13 00:18 编辑 \nElaBosak 发表于 2020-7-12 03:01\n按照现在的情况，数据库本身没问题，文件夹权限也没问题，但服务端本身没有排查过（其实也没必要排查）， ...\n的确是你说的ip问题 因为127.0.0.1我下意识的认为如此便是对 所以一直没去考虑这方面\n有可能是因为我服务器运行在docker中 所以127.0.0.1并不是真的主机（数据库所在）地址 可以看到网卡docker0的地址为172.17.0.1 那么运行在其中的服务器中的127.0.0.1是否等于172.17.0.1呢？我不太清楚抱着试一试的心态 我在huaweiyun的服务器上新建了个数据库 用云服的外网ip连接 发现连接成功了\n于是我将需要用到数据库的插件配置地址（默认为127.0.0.1或localhost）修改为192.168.0.168也就是enp7s0（主机的默认联网网卡 也可能是【eth0】之类的）这个网卡的地址后便能正常连接\n\n\n\n\nimage.png (36.05 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-13 00:06 上传\n\n\n\n\n\n\n\n"
        }
    ]
}