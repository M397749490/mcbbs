{
    "title": "MySql连接出问题",
    "author": "TONY_All",
    "replyCount": 3,
    "timestamp": 1591498380,
    "txt_content": "求助,我写的插件放到服务器上运行出现这个bug,而本地测试没有问题.(用户名密码数据库链接配置都没问题)\n\n[10:41:56 WARN]: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\nThe last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.[10:41:56 WARN]: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure  The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server. [10:41:56 WARN]:         at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [10:41:56 WARN]:         at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) [10:41:56 WARN]:         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) [10:41:56 WARN]:         at java.lang.reflect.Constructor.newInstance(Constructor.java:423) [10:41:56 WARN]:         at com.mysql.jdbc.Util.handleNewInstance(Util.java:407) [10:41:56 WARN]:         at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116) [10:41:56 WARN]:         at com.mysql.jdbc.MysqlIO.(MysqlIO.java:343) [10:41:56 WARN]:         at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2334) [10:41:56 WARN]:         at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2371) [10:41:56 WARN]:         at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2163) [10:41:56 WARN]:         at com.mysql.jdbc.ConnectionImpl.(ConnectionImpl.java:794) [10:41:56 WARN]:         at com.mysql.jdbc.JDBC4Connection.(JDBC4Connection.java:47) [10:41:56 WARN]:         at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [10:41:56 WARN]:         at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) [10:41:56 WARN]:         at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) [10:41:56 WARN]:         at java.lang.reflect.Constructor.newInstance(Constructor.java:423) [10:41:56 WARN]:         at com.mysql.jdbc.Util.handleNewInstance(Util.java:407) [10:41:56 WARN]:         at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:378) [10:41:56 WARN]:         at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305) [10:41:56 WARN]:         at java.sql.DriverManager.getConnection(DriverManager.java:664) [10:41:56 WARN]:         at java.sql.DriverManager.getConnection(DriverManager.java:247) [10:41:56 WARN]:         at cn.maxmc.play.MaxMcPay.getMySql(MaxMcPay.java:245) [10:41:56 WARN]:         at cn.maxmc.play.MySql.(MySql.java:25) [10:41:56 WARN]:         at cn.maxmc.play.MaxMcPay.onEnable(MaxMcPay.java:48) [10:41:56 WARN]:         at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:321) [10:41:56 WARN]:         at org.bukkit.plugin.java.JavaPluginLoader.enablePlugin(JavaPluginLoader.java:340) [10:41:56 WARN]:         at org.bukkit.plugin.SimplePluginManager.enablePlugin(SimplePluginManager.java:405) [10:41:56 WARN]:         at org.bukkit.craftbukkit.v1_8_R3.CraftServer.loadPlugin(CraftServer.java:357) [10:41:56 WARN]:         at org.bukkit.craftbukkit.v1_8_R3.CraftServer.enablePlugins(CraftServer.java:317) [10:41:56 WARN]:         at net.minecraft.server.v1_8_R3.MinecraftServer.s(MinecraftServer.java:414) [10:41:56 WARN]:         at net.minecraft.server.v1_8_R3.MinecraftServer.k(MinecraftServer.java:378) [10:41:56 WARN]:         at net.minecraft.server.v1_8_R3.MinecraftServer.a(MinecraftServer.java:333) [10:41:56 WARN]:         at net.minecraft.server.v1_8_R3.DedicatedServer.init(DedicatedServer.java:263) [10:41:56 WARN]:         at net.minecraft.server.v1_8_R3.MinecraftServer.run(MinecraftServer.java:525) [10:41:56 WARN]:         at java.lang.Thread.run(Thread.java:748) [10:41:56 WARN]: Caused by: java.net.ConnectException: Connection refused (Connection refused) [10:41:56 WARN]:         at java.net.PlainSocketImpl.socketConnect(Native Method) [10:41:56 WARN]:         at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) [10:41:56 WARN]:         at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) [10:41:56 WARN]:         at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) [10:41:56 WARN]:         at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) [10:41:56 WARN]:         at java.net.Socket.connect(Socket.java:606) [10:41:56 WARN]:         at java.net.Socket.connect(Socket.java:555) [10:41:56 WARN]:         at java.net.Socket.(Socket.java:451) [10:41:56 WARN]:         at java.net.Socket.(Socket.java:261) [10:41:56 WARN]:         at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:254) [10:41:56 WARN]:         at com.mysql.jdbc.MysqlIO.(MysqlIO.java:292) [10:41:56 WARN]:         ... 28 more插件的配置在此\n\n\n\nconfig.yml\n(71 Bytes, 下载次数: 3)\n\n\n\n2020-6-7 10:49 上传\n点击文件名下载附件\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "天辉胡萝卜",
            "timestamp": 1591501200,
            "txt_content": "检查你服务器上的mysql服务是否运行，以及是否使用了3336端口\n\n以及自己尝试在服务器上用\nmysql -s -h 127.0.0.1 --port=3336复制代码\n检查是否能连接"
        },
        {
            "author": "1378495772",
            "timestamp": 1591504500,
            "txt_content": " 本帖最后由 1378495772 于 2020-6-7 12:37 编辑 \n\n如果你使用了长连接之类的玩意（只连接一次数据库，在有其他数据库操作时不再次链接）\n请检查 MySQL 中的 wait_timeout 项是否过小（phpStudy 默认 120 秒，如果没记错的话）\n建议将 wait_timeout 改为 28800 （默认值），并用 Scheduler 定期续期（执行任意 SQL 语句）"
        },
        {
            "author": "xiaodong150",
            "timestamp": 1591925580,
            "txt_content": "得看你是多少版本的mysql，如果要是服务启动了，本地的mysql能用的话，就得看版本了，然后查当前版本需要去设置超时的参数吗"
        }
    ]
}