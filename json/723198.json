{
    "title": "写插件的vault支持",
    "author": "wszwq",
    "replyCount": 3,
    "timestamp": 1503279900,
    "txt_content": "我做了一个小插件，输入指令消耗游戏币回复血量，要把vault.jar也导入吗，继承javaplugin下面还要继承吗，继承啥plugin.yml我记得要写一个什么，soft 什么的\n\n\n\n",
    "replies": [
        {
            "author": "cc7w",
            "timestamp": 1503279900,
            "txt_content": "wszwq 发表于 2017-8-21 09:50\n具体扣游戏币的事件怎么写，有vault的doc吗\nhttps://github.com/MilkBowl/VaultAPI\n先要在主类搞起这段代码\n\npackage com.example.plugin;\n\nimport java.util.logging.Logger;\n\nimport net.milkbowl.vault.chat.Chat;\nimport net.milkbowl.vault.economy.Economy;\nimport net.milkbowl.vault.economy.EconomyResponse;\nimport net.milkbowl.vault.permission.Permission;\n\nimport org.bukkit.command.Command;\nimport org.bukkit.command.CommandSender;\nimport org.bukkit.entity.Player;\nimport org.bukkit.plugin.RegisteredServiceProvider;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic class ExamplePlugin extends JavaPlugin {\n    \n    private static final Logger log = Logger.getLogger(\"Minecraft\");\n    private static Economy econ = null;\n    private static Permission perms = null;\n    private static Chat chat = null;\n\n    @Override\n    public void onDisable() {\n        log.info(String.format(\"[%s] Disabled Version %s\", getDescription().getName(), getDescription().getVersion()));\n    }\n\n    @Override\n    public void onEnable() {\n        if (!setupEconomy() ) {\n            log.severe(String.format(\"[%s] - Disabled due to no Vault dependency found!\", getDescription().getName()));\n            getServer().getPluginManager().disablePlugin(this);\n            return;\n        }\n        setupPermissions();\n        setupChat();\n    }\n    \n    private boolean setupEconomy() {\n        if (getServer().getPluginManager().getPlugin(\"Vault\") == null) {\n            return false;\n        }\n        RegisteredServiceProvider<Economy> rsp = getServer().getServicesManager().getRegistration(Economy.class);\n        if (rsp == null) {\n            return false;\n        }\n        econ = rsp.getProvider();\n        return econ != null;\n    }\n    \n    private boolean setupChat() {\n        RegisteredServiceProvider<Chat> rsp = getServer().getServicesManager().getRegistration(Chat.class);\n        chat = rsp.getProvider();\n        return chat != null;\n    }\n    \n    private boolean setupPermissions() {\n        RegisteredServiceProvider<Permission> rsp = getServer().getServicesManager().getRegistration(Permission.class);\n        perms = rsp.getProvider();\n        return perms != null;\n    }\n    \n    public boolean onCommand(CommandSender sender, Command command, String commandLabel, String[] args) {\n        if(!(sender instanceof Player)) {\n            log.info(\"Only players are supported for this Example Plugin, but you should not do this!!!\");\n            return true;\n        }\n        \n        Player player = (Player) sender;\n        \n        if(command.getLabel().equals(\"test-economy\")) {\n            // Lets give the player 1.05 currency (note that SOME economic plugins require rounding!)\n            sender.sendMessage(String.format(\"You have %s\", econ.format(econ.getBalance(player.getName()))));\n            EconomyResponse r = econ.depositPlayer(player, 1.05);\n            if(r.transactionSuccess()) {\n                sender.sendMessage(String.format(\"You were given %s and now have %s\", econ.format(r.amount), econ.format(r.balance)));\n            } else {\n                sender.sendMessage(String.format(\"An error occured: %s\", r.errorMessage));\n            }\n            return true;\n        } else if(command.getLabel().equals(\"test-permission\")) {\n            // Lets test if user has the node \"example.plugin.awesome\" to determine if they are awesome or just suck\n            if(perms.has(player, \"example.plugin.awesome\")) {\n                sender.sendMessage(\"You are awesome!\");\n            } else {\n                sender.sendMessage(\"You suck!\");\n            }\n            return true;\n        } else {\n            return false;\n        }\n    }\n    \n    public static Economy getEcononomy() {\n        return econ;\n    }\n    \n    public static Permission getPermissions() {\n        return perms;\n    }\n    \n    public static Chat getChat() {\n        return chat;\n    }\n}复制代码\n\nhttp://milkbowl.github.io/VaultAPI/\n这个是全doc文档"
        },
        {
            "author": "cc7w",
            "timestamp": 1503280140,
            "txt_content": "softDepend: [Vault]\nvault.jar要和你的服务端文件一样作为外部jar导入\n\n然后你还要去github地址了解下怎么调用"
        },
        {
            "author": "wszwq",
            "timestamp": 1503280200,
            "txt_content": "1345979462 发表于 2017-8-21 09:49\nsoftDepend: [Vault]\nvault.jar要和你的服务端文件一样作为外部jar导入\n具体扣游戏币的事件怎么写，有vault的doc吗"
        }
    ]
}