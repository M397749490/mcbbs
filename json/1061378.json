{
    "title": "【Fabric】怎么制作一个类似沉浸的电线与制作能量",
    "author": "糖果sweet",
    "replyCount": 2,
    "timestamp": 1592052540,
    "txt_content": "据我所知，Fabric的教程是很少的，所以像这种教程应该没有。我刚入坑，所以……解答尽量详细一点（带源码的）\n\n\n类似沉浸的电线：\n\n   可以渲染？obj？\n   要有弧度的，\n   位于两方块之间，\n   可以斜着连接，\n   可以限制长度。\n\n\n能量（能量单位：V）：\n   差不多与工业的一样吧。\n   那个线可以传输能量，\n   分类型的（普通、中、高压），\n   通线了就可以充能的\n\n如果解答不清楚加我 QQ：3212517216（记得备注）\n\n\n",
    "replies": [
        {
            "author": "南派董卓",
            "timestamp": 1592055000,
            "txt_content": "见铁轨代码\npublic class RailBlock extends AbstractRailBlock {\n    public static final EnumProperty<RailShape> SHAPE;\n\n    protected RailBlock(Settings settings) {\n        super(false, settings);\n        this.setDefaultState((BlockState)((BlockState)this.stateFactory.getDefaultState()).with(SHAPE, RailShape.NORTH_SOUTH));\n    }\n\n    protected void updateBlockState(BlockState state, World world, BlockPos pos, Block neighbor) {\n        if (neighbor.getDefaultState().emitsRedstonePower() && (new RailPlacementHelper(world, pos, state)).method_10460() == 3) {\n            this.updateBlockState(world, pos, state, false);\n        }\n\n    }\n\n    public Property<RailShape> getShapeProperty() {\n        return SHAPE;\n    }\n\n    public BlockState rotate(BlockState state, BlockRotation rotation) {\n        switch(SyntheticClass_1.field_11371[rotation.ordinal()]) {\n        case 1:\n            switch(SyntheticClass_1.field_11372[((RailShape)state.get(SHAPE)).ordinal()]) {\n            case 1:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_WEST);\n            case 2:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_EAST);\n            case 3:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_SOUTH);\n            case 4:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_NORTH);\n            case 5:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_WEST);\n            case 6:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_EAST);\n            case 7:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_EAST);\n            case 8:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_WEST);\n            }\n        case 2:\n            switch(SyntheticClass_1.field_11372[((RailShape)state.get(SHAPE)).ordinal()]) {\n            case 1:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_NORTH);\n            case 2:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_SOUTH);\n            case 3:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_WEST);\n            case 4:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_EAST);\n            case 5:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_EAST);\n            case 6:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_EAST);\n            case 7:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_WEST);\n            case 8:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_WEST);\n            case 9:\n                return (BlockState)state.with(SHAPE, RailShape.EAST_WEST);\n            case 10:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_SOUTH);\n            }\n        case 3:\n            switch(SyntheticClass_1.field_11372[((RailShape)state.get(SHAPE)).ordinal()]) {\n            case 1:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_SOUTH);\n            case 2:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_NORTH);\n            case 3:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_EAST);\n            case 4:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_WEST);\n            case 5:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_WEST);\n            case 6:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_WEST);\n            case 7:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_EAST);\n            case 8:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_EAST);\n            case 9:\n                return (BlockState)state.with(SHAPE, RailShape.EAST_WEST);\n            case 10:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_SOUTH);\n            }\n        default:\n            return state;\n        }\n    }\n\n    public BlockState mirror(BlockState state, BlockMirror mirror) {\n        RailShape railShape = (RailShape)state.get(SHAPE);\n        switch(SyntheticClass_1.field_11370[mirror.ordinal()]) {\n        case 1:\n            switch(SyntheticClass_1.field_11372[railShape.ordinal()]) {\n            case 3:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_SOUTH);\n            case 4:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_NORTH);\n            case 5:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_EAST);\n            case 6:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_WEST);\n            case 7:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_WEST);\n            case 8:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_EAST);\n            default:\n                return super.mirror(state, mirror);\n            }\n        case 2:\n            switch(SyntheticClass_1.field_11372[railShape.ordinal()]) {\n            case 1:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_WEST);\n            case 2:\n                return (BlockState)state.with(SHAPE, RailShape.ASCENDING_EAST);\n            case 3:\n            case 4:\n            default:\n                break;\n            case 5:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_WEST);\n            case 6:\n                return (BlockState)state.with(SHAPE, RailShape.SOUTH_EAST);\n            case 7:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_EAST);\n            case 8:\n                return (BlockState)state.with(SHAPE, RailShape.NORTH_WEST);\n            }\n        }\n\n        return super.mirror(state, mirror);\n    }\n\n    protected void appendProperties(Builder<Block, BlockState> builder) {\n        builder.add(new Property[]{SHAPE});\n    }\n\n    static {\n        SHAPE = Properties.RAIL_SHAPE;\n    }复制代码\n这里可以看出如何做到更具方位改变方块指向\n{\n    \"variants\": {\n        \"shape=north_south\": { \"model\": \"block/rail\" },\n        \"shape=east_west\": { \"model\": \"block/rail\", \"y\": 90 },\n        \"shape=ascending_east\": { \"model\": \"block/rail_raised_ne\", \"y\": 90 },\n        \"shape=ascending_west\": { \"model\": \"block/rail_raised_sw\", \"y\": 90 },\n        \"shape=ascending_north\": { \"model\": \"block/rail_raised_ne\" },\n        \"shape=ascending_south\": { \"model\": \"block/rail_raised_sw\" },\n        \"shape=south_east\": { \"model\": \"block/rail_corner\" },\n        \"shape=south_west\": { \"model\": \"block/rail_corner\", \"y\": 90 },\n        \"shape=north_west\": { \"model\": \"block/rail_corner\", \"y\": 180 },\n        \"shape=north_east\": { \"model\": \"block/rail_corner\", \"y\": 270 }\n    }\n}复制代码对于能量的传播可以参考红石代码\n\n"
        },
        {
            "author": "3TUSK",
            "timestamp": 1592079000,
            "txt_content": " 本帖最后由 3TUSK 于 2020-6-14 04:14 编辑 \n类似沉浸的电线\n这个电线不是方块，不是实体，什么都不是。它只是「这两个点之间有根电线」这么一个数据，然后单纯渲染出来的特效而已。\n首先你需要存储所有连接的信息，然后根据这些信息（具体来说是电线的两端的位置——电线的两端是方块）在两点之间画一条线。\n所以「斜着连接」、「两方块之间」这样的需求只需要你自己计算并验证就行了。\n要有弧度的\n简单一点的有弧度的线可以是普通的二次函数曲线，这个大抵是初中数学的内容，你现在知道了二次函数的两个零点，然后你只需要给定一个极值（最大/最小值）就可以唯一确定这个二次函数的表达式了。\n不过既然都说到二次函数的曲线了……有人应该想到“用三个[控制]点确定的曲线了吧”：贝兹曲线（Bézier Curve）。\n\n\n\n\n\n1.png (2.59 KB, 下载次数: 1)\n\n下载附件\n\n2020-6-14 04:01 上传\n\n\n\n\n\n（图出自上述链接。）\n虽然说这个曲线可能高中数学也不会讲，但粗体的 P 是控制点，t 是变量且取值范围为 [0,1]，B(t) 是最终组成曲线的每一个点。\nt 的步进越小，最终曲线越精细，但计算量也越大。\n\n能量\nhttps://blog.ustc-zzzz.net/forge-energy-demo-5/ \nhttps://www.mcbbs.net/thread-1034965-1-1.html\n两个链接实际上是一样的内容。\n虽然标题说是 Forge，但是能源网的概念和 Minecraft 或者 Mod 开发框架无关，本质上能源网是图连通问题，所以…… 还是直接看上面的教程吧。\n\n\n\n另外，我能说楼上发的东西毫无帮助且纯属误导吗？用铁轨/红石线的方式实现能源网，且不说能不能实现，就算是能，想必也是异常低效的。\n"
        }
    ]
}