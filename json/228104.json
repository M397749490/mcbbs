{
    "title": "【DreamWork新年礼物】[原创] PocketMine-MP 插件制作教程【01/31更】",
    "author": "Snake1999",
    "replyCount": 29,
    "timestamp": 1391049000,
    "txt_content": " 本帖最后由 Snake1999 于 2014-2-6 16:44 编辑 \n\nP o c k e t M i n e - M P 插  件  制  作  教  程 二     菌     出     品\n\nNow, let's begin.【前言】\n      咳咳，大家好，我是二菌。今天我给大家带来的就是我的PM插件制作教程。\n      PM，全称PocketMine-MP，是PE服务器软件中最流行的一种，用PHP编成，尤其以插件的多样性吸引了大多数PE腐竹的目光。PM发布以来，网上插件层出不穷，包括多世界插件、防作弊插件等等许多种类。PM插件对于菜鸟来说似乎遥不可及，只能瞻仰着各路大神的插件漫天飞舞。但是，制作插件真的真的真的很困难吗？\n      不是的。PHP我认为是软件中BASIC、E语言以外最简单的语言，多用性、可塑性很强，特别好懂。学习一门像PHP的语言看起来似乎遥不可及，但是你一旦用心，就能和大神们一起创造。学习插件和玩PE一样，创造性强，没有做不到，只有想不到。相信屏幕前谁问你既然有一颗PE的心，那么一定能学好PM插件的。\n      你想制作一个自己的插件吗？如果是，又不知如何入手，那么让二菌我来引导你 ——\n\n【首先，你得会开服务器】\n开PM服务器教程网上挺多，可以去翻翻，可以参考下面的教程：\nhttp://www.mcbbs.net/thread-101500-1-1.html\n\n如果真看不懂，让二菌我来教你——\n图片来源：https://github.com/PocketMine/PocketMine-MP/wiki/Setting-up-a-Server\n\n第一步，搭建服务器环境 \n方法1【荐】：\n这里我用Windows 2008 Server演示一下\n1.先去下载 PHP5.4库\n   - 原帖下载地址貌似被墙，我这里有一个： 【点我！】 \n2.然后去下载ZIP的源代码\n    - 先打开官网 www.pocketmine.net 看到这里\n \n    - 然后往下看，点这里下载\n \n    - 下载完和刚才的PHP库解压后放在一起\n \n方法2：\n直接去首页www.pocketmine.net下载EXE安装包，按照提示安装\n不过貌似连接被墙了，大多数时候上不起来\n \nok , 第一步完成\n\n第二步，运行服务器\n\n双击start.bat即可开服。\n\n有同学可能注意到控制台的字是彩色的，如果发现自己的字不是彩色的，说明你的bin/mintty.exe没有找到，可以去下载我的PHP5.4库试一试，在方法1里面。{:10_492:}\n服务器的其他指令我这里就不多讲了，可以去网上查一下。\n\n【其次，你得会玩PHP】其实网上PHP教程也很多，这里有几个可以看看\nhttp://www.w3school.com.cn/php/index.asp\nhttp://www.php100.com/html/shipinjiaocheng/ \n真的看不懂？没事，别忘了这篇帖子是二菌写的...{:10_505:}\n1.PHP的基本语法\n> PHP程序格式\n作为一个PHP程序，PHP要求每个程序以\"<?php\"开头，\"?>\"结尾，即：<?php\n\n?>复制代码- PocketMine的插件作为大的PHP程序的一个片段，结尾可以不用输入，你愿意的话输入也可以。\n> 给你的程序添加注释\nPHP的程序有时候需要用到注释来解释你的程序，毕竟程序是写给人看的{:10_509:}\n注释有两种：单行注释//和注释块/*..*/，注释是写起来给人看的，不会在机器里面运行。看这个例子：\n<?php\n/* 注释块！！！\n    这里不会被运行！\n*/\n\n//我是单行注释\n?>复制代码这个程序运行后什么都不会发生。{:10_522:}\n第一讲完\n2.PHP的变量\n\n> 变量的基本特征\nPHP的变量和其它语言类似，也可以存储一个数字、字符串或者其它东西，并且可以在设置、赋值后重复调用。\n不过，PHP是拜金主义者，它的每个变量调用和设置时都要把$放在变量名字前面（众：LZ你怎么说话的{:10_498:}）\n我们谈论变量时，一般用变量名字来谈论名字，而用$加上变量名字来代表变量本身。\n变量名字必须符合以下规则：\n- 变量名字必须以字母或者下划线\"_\"开头，如\"abc\"\"_1a\"是可以的，但是\"1a\"\"变量a\"\"#123\"是不可以的。\n- 变量名字必须只含数字、字母或者下划线，所以\"a变量\"\"b#%\"是不可以的。\n- 变量名字不能有空格。\n> 设置变量的方法\nPHP中设置变量的方法是这样的：$var = value;复制代码var : 变量名字\nvalue : 要设置的值\n不要忘了PHP是拜金主义者，变量前面要加上$，漏掉后变量就无效了。\n这样就可以设变量：\n内容引用自shoghicp 的SimpleAuth:url找不到，抱歉\n \n> 变量的类型\nPHP的变量类型是怎么设定的呢？我们看下面：\n内容引用自W3SCHOOL:http://www.w3school.com.cn/php/php_variables.asp\nPHP 是一门松散类型的语言（Loosely Typed Language）\n在 PHP 中，不需要在设置变量之前声明该变量。\n在上面的例子中，您看到了，不必向 PHP 声明该变量的数据类型。\n根据变量被设置的方式，PHP 会自动地把变量转换为正确的数据类型。\n在强类型的编程语言中，您必须在使用前声明变量的类型和名称。\n在 PHP 中，变量会在使用时被自动声明。\n但是有时候我们需要把变量类型转换掉，所以我们需要改变变量的类型。怎么改变呢？请使用(变量类型)$变量名字。看下面的例子：$a = \"1\";\n$b = \"2\";\n$c = (string)((double)$a + (double)$b);复制代码这个例子里面，$a和$b是字符串，不能做数学的加减，所以我们需要把它转化为double类型来进行加减，然后转化会string类型输出。所以，它的输出是： 3 。\n虽然PHP是一门松散类型的语言，但是变量的转化对它仍然重要。现将PHP中变量类型列表如下：\n类型名字存贮类型例子string字符串\"PHP Program!\"boolean布尔值truedouble双精度数字（精度很高，±1.7E-308~±1.7E+308，含0）1.23456integer整数（-2147483648~+2147483647)123array数组（下面会讲）array(123,456)object对象（可理解为class类等）ServerAPI关于变量类型的其它信息可以参考这里：http://zhidao.baidu.com/link?url=5-7dbhJRiJ1kvICLEDeIt9SKPL-xFhO2NcdfxXX7wfbq6W5VPz5uY1QiE-C8DCNvlzMnAzluVlxSrd2rtQmYN_\nPHP变量的定义就这么简单，你学会了吗？\n第二讲完 \n3.PHP的字符串\n> 字符串的特征  \nphp中，字符串必须以\"\"开头和结尾，所以在字符串中一些字符的打法有些不同，详见下表：\n字符字符串中打法\"\\\"\\\\\\换行\\n送出CR\\rtab跳位\\t\\n\\r\\t的详细解释可以参考这里：http://blog.csdn.net/jjmaiz/article/details/8212314\n> 字符串变量\nphp中，字符串变量是一类变量，允许你存储一条字符串。在下面的例子里面，PHP把\"PHP Program!\"存进$str里面：<?php\n$str = \"PHP Program!\";\necho $str;\n?>复制代码上面代码的输出 :PHP Program!\n现在，我们来试试用代码来处理我们的字符串。\n> 并置运算符（Concatenation Operator）\n在PHP中，并置运算符只有一个，它就是 —— . 。\n别小看这个小圆点，TA可以把两个字符串连接起来！看这儿：<?php\n$a = \"1\";\n$str = \"abc\".$a.\"def\";\necho str;\n?>复制代码上面代码的输出： abc1def。是不是连起来了呢？\n\n再看下面的例子：\n内容引用自PocketMine Team的PocketMine-MP/src/ConsoleAPI.php:www.pocketmine.net\n \n红色：字符串1\n蓝色：字符串2\n红色和蓝色之间的部分： 并置运算符 . \n这样\"console.command.\"和$cmd就连接起来了，如果$cmd = \"abc\"那么连起来的值就是\"console.command.abc\"\n\n字符串的函数还有很多，可以去看这里：http://www.w3school.com.cn/php/php_ref_string.asp ，二菌就先讲一个：\n\n> strlen() 函数\nstrlen() 函数用于计算字符串的长度。我们来计算\"PHP Program!\"的长度：\n<?php\necho strlen(\"PHP Program!\");\n?>复制代码\n上面代码的输出： 12\n> 其它函数在这里可以找到：http://www.w3school.com.cn/php/php_ref_string.asp\n第三讲完\n4.PHP的运算符\n > 运算符\n运算符能对值进行运算。我把PHP完整的运算符列表于此：\n- 算数运算符\n运算符说明例子返回+求两个值的和x=1+1;x=2-求两个值的差x=2-1;x=1*求两个值的积x=2*2;x=4/求两个值相除的商x=6/3;x=2%求两个值相除的余数x=7%3;\ny=9%3;x=1\ny=0++让一个值自加1x=1;x++;x=2--让一个值自减1x=3;x--;x=2+  -  *  /  小学老师都教过吧，不用说明了。% 就是求余数，小学老师好像也教过的，不过要注意左右两边不可以是小数。\n++ 就是自加，让一个变量自加1，-- 类似。\n大家都会了吗？{:10_521:} \n- 赋值运算符\n运算符说明例子返回=赋值（貌似说过）x=2;x=2+=自添加x=3;x+=4;x=3+4=7-=自减去x=5;x-=3;x=5-3=2*=自乘x=2;x*=3;x=2*3=6/=自除以x=6;x/=3;x=6/3=2%=得到余数x=7;x%=3;x=7%3=1.=在末尾加上x=\"1\";x.=\"2\"x=\"1\".\"2\"=\"12\"不用解释了吧= =\n\n- 比较运算符\n运算符说明例子返回==是否相等1+1==3false!=是否不等1+1!=3true>=是否大于等于2>=3false<=是否小于等于2<=3true>是否大于1>2false<是否小于1<2true比较运算符里面需要注意的是大于等于和小于等于，先写><，再写=，别弄反了（众：>_<）\nPHP里面还可能用到类型的比较，这时候我们可以用下面含有类型的比较运算符：\n运算符返回true条件例子返回===类型相等\n值相等2===\"2\"\n2===2false\ntrue!==类型不等\n值相等2!==\"2\"\n2!==2true\nfalse\n- 逻辑运算符\n运算符说明例子返回&&和(1==1)&&(2==2)true||或(1>2)||(3<2)false!非!(1>2)true 逻辑运算符中和或非的定义可以参照这里：http://baike.baidu.com/view/397415.htm\n\n- instanceof\n还有一种运算符叫作instanceof，它能判断一个变量是否属于这个类型。例子：echo (string)(\"2\" instanceof double)复制代码返回值：0，字符串\"2\"类型是string不是double，所以返回false即0。\n\nPHP的运算符在实际的判断中有很大的应用，将在下面的If中提到。\n第四讲完 \n5.PHP的数组\n \n> 数组是什么?\n内容引用自W3SCHOOL:http://www.w3school.com.cn/php/php_variables.asp \n在使用 PHP 进行开发的过程中，你可能需要创建许多相似的变量。无需很多相似的变量，你可以把数据作为元素存储在数组中。\n数组中的元素都有自己的 ID，因此可以方便地访问它们。\n所以，我们可以方便地通过数组来规定一系列变量。\n\n> 数组的规定\n数组存储的每个元素都带有一 ID 键，ID键可以是数字，也可以是以单引号开头结尾的一串字符(例如'abc')。数组有两种规定方法：\n- 直接规定：\n$arr = array(\"a\",1,true);复制代码这时ID键会自动分配。从上面我们看到，数组每个元素不一定都是一种变量。\nID键自动分配的结果就是会以从0开始给每个元素分配ID键。所以上面的数组可以表示为：\n ID键 值 0 \"a\" 11  2true \n当然，我们在定义时也可以自己规定ID键：\n$arr = array(\n  \"str\" => \"a\",\n  0 => 1,\n  \"bool\" => true,\n);复制代码这里要注意的是，=>不要写错成=，逗号不要写错成分号。\n也可以在后续的代码里面自己添加ID键：\n$arr['str'] = \"a\";\n$arr[0] = 1;\n$arr['bool'] = true;复制代码这里我们看到了调用数组的一个方法：$变量名字[ID键]\n当然，调用时ID键可以可以是变量，例如：\n$arr = array(\n  \"str\" => \"a\",\n  0 => 1,\n  \"bool\" => true,\n);\n复制代码程序输出：a 。\n当然，嵌套的数组也是OK的，例如：$a = array(\n  0 => array(\n    \"x\" => \"a\",\n  ),\n  1 => 2,\n);复制代码这时我们把嵌套的数组叫做多维数组。\n多为数组的调用方法：$数组名字[$ID键][$ID键][$ID键]......\n例如：\n$a = array(\n  0 => array(\n    \"x\" => \"a\",\n  ),\n  1 => 2,\n);\necho $a[0]['x'];复制代码输出： a\n\n> print_r()函数\nprint_r($数组名字)可以直接打印出数组，例如：\n$a = array(\n  0 => array(\n    \"a\",复制代码程序输出：\nArray\n(\n  [0] => Array\n  (\n    [0] => a\n    [1] => b\n    [2] => c\n  )\n  [1] => 2\n)\n于是数组所有的内容都出来了~！神奇吧~{:10_521:}\n数组的其它命令可以参考这里：http://www.w3school.com.cn/php/php_ref_array.asp\n第五讲完 \n6.PHP的基本语句块【If Switch 和循环语句】\n \n> If、else和elseif\nIf、else和elseif这三个指令可以允许你判断，然后为判断的结果做出不同的动作。\n- 如果你要在一个条件成立时使用代码，请用If。If的用法：\nif(判断条件) 命令;复制代码如果命令为多行，你应该用{}括起来，像这样：if(判断条件){\n 命令;\n}复制代码\n- 如果你要判断一个条件成立或不成立是使用两个不同的代码，请用If和else。这两个东西的用法：\nif(判断条件) 为true时执行命令;\nelse 为false时执行命令;复制代码如果命令为多行，你也应该用{}括起来，像这样： if(判断条件) {\n 为true时执行命令;\n}else{\n 为false时执行命令;\n}复制代码- 如果你想要多个条件成立之一时运行不同的代码，请用If、else和elseif。用法：\nif(判断条件1) 判断条件1为true时命令;\nelseif(判断条件2) 判断条件2为true时命令;\nelseif(判断条件3) 判断条件3为true时命令;\n.......复制代码同样地，我们应该这样设置多行:if(判断条件1) {\n 判断条件1为true时命令;\n}elseif(判断条件2){\n 判断条件2为true时命令;\n}elseif(判断条件3){\n 判断条件3为true时命令;\n.......\n}else{\n 判断条件全部为false时命令;\n}复制代码嗯..讲的太多是不是有些晕呢？（众：{:10_499:}）那么我们来看一下例子。请看这儿：\n内容引用自shoghicp的WorldEditor:url找不到，抱歉 \n  \n这是一个简单的if else判断句。\n红色：判断条件\n蓝色：红色为true时的执行语句\n绿色：红色是false时的执行语句\n也就是说，如果$totalCount > 524288，那么$send = false；如果!($totalCount > 524288)，那么$send = true.\n再看这儿：\n内容引用自Snake1999的SignTp:http://www.mcbbs.net/thread-226762-1-1.html\n \n红色：判断条件 \n蓝色：红色为true时的执行语句 \n粉色：判断条件2\n黑色：粉色为true时执行的语句\n灰色：判断条件全都是false时执行的语句\n也就是说，如果(double)$ver1e[1]<(double)$ver2e[1]，那么返回值就是\"2\"；如果....；如果(double)$ver1e[3]=(double)$ver2e[3]，那么返回\"0\"；如果全都是false，那么返回\"1\"。\n\n现在懂了吗？{:10_496:}\n> ... ? ... : ... 语句块\n还有一种..?..:..语句块，方法与单行if..else类似：$变量 = (判断条件)?为true是返回值 : 为false时返回值 ;复制代码例子：\necho (1+1==3)?\"1+1竟然等于3\":\"1+1不等于3\";复制代码返回：1+1不等于3 \n\n\n不知大家发现了没，如果用elseif重复判断一个值是否为另一个值，会让代码过于麻烦，这时用搜寻语句块switch即可解决问题。{:10_525:}\n> Switch\n如果你希望有选择地执行若干代码块之一，可以使用 Switch 语句，这样可以避免冗长的if..elseif..else代码块。\n- Switch 的工作原理\n内容引用自 w3schoool:http://www.w3school.com.cn/php/php_switch.asp\n1.对表达式（通常是变量）进行一次计算\n2.把表达式的值与结构中 case 的值进行比较\n3.如果存在匹配，则执行与 case 关联的代码\n4.代码执行后，break 语句阻止代码跳入下一个 case 中继续执行\n5.如果没有 case 为真，则使用 default 语句\n所以，正确的 Switch 应该是这样的：\nswitch(表达式){\n case 值1:\n  表达式=值1时执行的代码;\n  break;\n case 值2:\n  表达式=值2时执行的代码;\n  break;\n default:\n  表达式都不等时执行的代码;\n  break;\n}\n   复制代码如果我们希望在表达式和两个值分别相等时都执行相同的代码，我们可以这样做：switch(表达式){\n case 值1:\n case 值2:\n  表达式=值1或值2时执行的代码;\n  break;\n default:\n  表达式都不等时执行的代码;\n  break;\n}复制代码这样就方便多喽~{:10_492:}我们看这里：\n\n内容引用自Snake1999的SignTp:http://www.mcbbs.net/thread-226762-1-1.html  \n \n\n这样我们可以看到，输入/st help [命令名字] 里面命令名字不同时，会返回不同的帮助文字，而且命令名不是下面列出的就会返回总的命令帮助。如果用if..else那会有多麻烦！{:10_499:} \n还好PHP的发明者给我们带来了switch{:10_512:}\n> 循环语句\nPHP中循环语句有4种：while、do..while、for、foreach。喝杯茶，我们继续 ——\n> while 和 do..while\n- while 和 do..while 的用法\nwhile(表达式) 执行的代码;\n\nwhile(表达式){\n 执行的代码;\n}\n\ndo{\n 执行的代码;\n}\nwhile(表达式);复制代码\n- while 和 do..while 的区别\nwhile 和 do..while 都会在表达式成立的情况下重复执行代码，但是不同的是：\nwhile 先判断表达式，后执行代码，再重复；\ndo..while 先执行代码，后判断表达式，再重复。\n联想着判断语句的位置就会很好记。\n> for\n已经确定了代码块的重复执行次数时，可以使用 for 语句。\n- for语句的原理：\n1.先执行定义来定义循环所需变量和初始值，\n2.然后执行一次代码，\n3.再然后判断条件，如果为false则跳出循环\n4.最后执行一次增量来增加变量。\n- for语句的用法：\nfor(定义;条件;增量){\n 代码;\n}复制代码有点难懂？我们来看下面的例子：\nfor(i=0;i<3;i++){\n echo i;\n}复制代码这个代码先会定义i=0，然后echo i;，然后判断i是否小于3，最后执行i++;。所以它的输出是：012\n懂了吗？那我继续讲{:10_508:}\n> foreach\nforeach 语句用于循环遍历数组。用法有两种：\nforeach($数组名字 as $数组元素){\n 代码;\n}\n\nforeach($数组名字 as $数组ID键 => $数组元素){\n 代码;\n}复制代码比较好懂，是吗？\n我们先看例子：\n内容引用自ljyloo 的 TpMultiWorld:http://www.mcbbs.net/thread-148950-1-2.html \n \n在这里foreach可以遍历$this->worlds数组，每个元素存储到$w中，然后达到列出所有世界的效果。\n\n呼~终于讲完了{:10_508:}你懂了吗？\n第六讲完 \n7.PHP函数\n \n> 函数\n函数是一种可以在任何被需要的时候执行的代码块。每个函数需要有一个名字来区分，名字的命名规则同变量名字的命名规则（忘了？返回去看看）。简单的函数创建需要以下几个步骤：\n内容引用自W3SCHOOL:http://www.w3school.com.cn/php/php_functions.asp 1.所有的函数都使用关键词 \"function()\" 来开始\n2.命名函数 - 函数的名称应该提示出它的功能。函数名称以字母或下划线开头。\n3.添加 \"{\" - 开口的花括号之后的部分是函数的代码。\n4.插入函数代码\n5.添加一个 \"}\" - 函数通过关闭花括号来结束。\n也就是说，一个简单的函数应该是这样的：function 函数名字(){\n  代码;\n}复制代码函数怎么调用呢？下面是一个例子：\nfunction pr(){\n  echo \"PHP Program!\\n\";\n}\npr();\npr();复制代码从这里可以看到，我创建了一个名为pr的函数，可以输出abc然后换行，我可以直接用pr();来调用函数输出。于是上面的程序输出是：\nPHP Program! \nPHP Program! \n懂了吗？{:10_505:}\n> 带有参数的函数\n我们例子里面的函数只是是一个非常简单的函数。它只能输出一个静态的字符串{:10_506:}。\n加上参数后会让函数变得多姿多彩{:10_508:}。\n通过可以添加参数，我们向函数添加更多的功能。参数类似一个变量。\n你可能注意到了，函数名称后面有一个括号，比如 pr()。参数就是在括号中规定的。就像这样，我们就可以更改输出的字符：\nfunction pr($str){\n  echo $str.\" Program!\\n\";\n}\npr(\"PHP\");\npr(\"Not a C\");复制代码这里函数的参数是$str，在使用函数时输入参数，就可以实现特定的功能。比如上面的程序输出是：\nPHP Program! \nNot a C Program!  \n如果要求用户没有输入某个参数是也能实现特定的功能，我们要规定参数的默认值，就像这样：function pr($str = \"PHP\",$str2 = \" Program!\"){\n  echo $str.$str2.\"\\n\";\n}\npr(,\"Program!\");\npr(\"Not a C\");\n复制代码这里可以看到第一个调用没有输入第一个参数，但是pr的定义里面规定了第一个参数的默认值，所以第一个参数就编程了\"PHP\"，于是程序的输出是：\nPHP Program! \nNot a C Program!  \n第二个调用没有输入最后一个参数，这时候可以省略前面的逗号。\n函数的参数我们学到这里。懂了吗？{:10_525:}\n\n> 返回值\n函数大家初中都学过，带入不同的x值会有不同的y值，为什么PHP的函数不能有函数值呢？于是，PHP的返回值就出现了{:10_500:} \n返回值应该怎么设置和调用呢？看这儿：function add($a,$b){\n  return $a+$b;\n}\necho add(1,2);复制代码可以看出，return 值; 是返回值得一个关键。返回了一个值，就可以对它进行运算，甚至调用到其它函数里面，你可以像变量一样折腾一个函数的返回值，一样可以用echo打印输出。所以这个程序的输出是： 3\n我们来看下面的例子：\n内容引用自PocketMine Team的PocketMine-MP/src/ConsoleAPI，部分折叠:www.pocketmine.net \n\n红色：参数定义\n蓝色：返回命令\n从这里看到，run这个函数定义了几个参数，都设定了默认值，又加了return来返回值，是一个比较复杂的函数了。\n关于函数，就讲到这里。你懂了吗？{:10_531:}\n第七讲完 \n8.PHP class类\n \n没错，你看到这里的时候，没看的PHP的教程只有一节了。加油，把它看完！\n> class类\nPHP中，有时候需要把零散的代码分成几个部分，于是，类的概念就诞生了。每个class，或者说类，由以下几个部分组成：\n内容引用自kv516 的 PocketEssentials:http://www.mcbbs.net/thread-196684-1-1.html\n \n红色：声明这是一个class\n蓝色：class的名字\n绿色：接口，右边的Plugin是接口名字（下面会讲），省略即为一般class\n黑色：声明{}里面是class的内容。\n粉色：class的内容\n于是，这样一个class就声明好了。\n> 调用方法\n在class内，我们用$this来代表class本身，所以：\n- class内定义变量（非函数内定义）的调用方法为：$this->变量\n- class内定义函数的调用方法为：$this->函数名字(参数)\n但是函数内定义变量调用方法仍为$变量。看下面：\nclass a{\n  public $a = \"a\",$b = \"This is b\";\n  public function get($isb){\n    if($isb){\n      return $this->b;\n    }else{\n      return $this->a;\n    } \n  }\n}复制代码这个例子里面$isb是函数内定义变量，调用方法仍为$isb，而class内定义变量$a、$b则需要用$this->a和$this->b来调用。\n> 跨class调用方法\n我们在玩PHP的时候可能会用到调用另外一个class的变量或者函数，这时候我们需要这样做：\n- 另外一个class的名字::变量\n- 另外一个class的名字::函数(参数)\n请看下面的例子：\nclass a{\n  public $a = \"a\",$b = \"This is b\";\n  public function get($isb){\n    if($isb){\n      return $this->b;\n    }else{\n      return $this->a;\n    } \n  }\n}\nclass b{\n  public function init(){\n    echo a::get(true);\n  }\n}\n复制代码这个例子里面在class a里面定义了get这个函数，如果我们运行class b的init函数，就会调用class a返回a::b的值，然后输出。所以这个程序的输出是：This is b\n懂了吗？{:10_505:}\n> 使用范围\n声明玩一个class后，一个问题出来了：class里面有些函数和变量仅适合class内部使用或者不希望公开，其它的一些希望公开，那该怎么办呢？我们可以使用public和private。 使用范围说明 例子  public 公用（class以外可以调用）public function init(){}  private 私有（仅class内可以使用）private $api;怎么理解呢？在定义函数和变量时前面加上public，就可以允许其它class用::来调用，private则不允许。我们看这里：内容引用自Snake1999 的 SignTp:http://www.mcbbs.net/thread-226762-1-1.html\n \n这里不同的function都用颜色标出来了，但是里面一些变量不希望外面调用，所以是private。\n> class接口\n【WARNING：前方高能，请无关人员迅速撤离！{:10_542:}】\n什么是接口？接口允许你创建一类相似的class，以便调用。\nclass定义时接上这个接口，意味着需要含有接口规定的一切函数和变量。例如上面的Plugin就是一个接口，定义了一类相似的class。我们看这里：\n内容引用自PocketMine Team的PocketMine-MP/src/PluginAPI:www.pocketmine.net\n \n上面的例子规定了一个叫做Plugin的接口，然后创建了一个叫做DummyPlugin的类，这个DummyPlugin就是一个标准的Plugin，拥有接口规定的所有函数（含参数）和变量。如果缺少任何一个，就不是这个接口对应的class。\n现在懂了吗？\n第八讲完\n孩子，你看到这里了，说明你对于PHP玩的差不多了，为制作一个PM插件已经打好了基础，往下看吧。\n\n\n【最后，再想着做插件】\n大家上面看完了吗？（众：看~完~了~）\n那好，我们就开始做插件吧。\n\n接下来，我们以SignTp插件作为目标，一步一步完成。\n我们的插件要可以：\n> 扔一个牌子就能传送到目的地！\n> 有自动更新功能！\n所以它需要：\n> 有一堆命令\n> 检测一堆事件\n> 读取一堆配置文件\n> 等等......\n这看起来似乎很难的样子，让我们一步一步制作完毕。\n\n0.一些准备\n文本部分来自 http://www.mcbbs.net/thread-204040-1-1.html ，原帖为JS，其实PHP和JS编辑器是基本一样的。\n> 首先你需要装了PM服务端的电脑一台，用作开服务器（技术宅可以用安卓手机，详情右转【此处】）\n> 然后你需要文本编辑器一只，这个种类繁多，下面我来推荐几个： 系统软件windowsnotepad++，ultraedit（用Notepad的请受小神一拜）linuxgvimandroid920文本编辑器，rootexplorer自带的文本编辑器iOS这个真没有= => 其次是装了MCPE手机或平板一台，用作调试\n1.你的第一个PM插件\n> 无中生有的第一步\n> 首先，你需要打开你的服务端然后关闭，我们会发现多了一些文件夹，我们的插件就要放在/plugins里面。\n\n> 然后，我们在/plugins里面创建一个php文件，名字可以最好能表现插件的名字等等。\n这里我们以SignTp为例子，创建一个SignTp.php\n\n> 在编辑器里打开，没错，空的。\n还记得上面PHP教程怎么说的？（众：php文件一定要以\"<?php\"开头）好的，我们加上。\n> 作为一个PM的插件，我们需要用Plugin这个接口。看这儿：内容引用自PocketMine Team的PocketMine-MP/src/PluginAPI:www.pocketmine.net\n  \n这个接口说明了一个Plugin必备的三个函数，所以一般的PM插件格式是这样的：\n内容引用自Snake1999 的 SignTp:http://www.mcbbs.net/thread-226762-1-1.html\n\n天蓝：PM插件必备的注释部分。请看这里：   \n             /*\n             __PocketMine Plugin__\n             name=PluginXXX                 <<插件名字，会在控制台插件加载时显示\n             description=                        <<插件说明，貌似没用\n             version=0.0.1                      <<插件版本，会在控制台插件加载时显示\n             author=XXX                        <<插件作者，会在控制台插件加载时显示，也能说明版权\n             class=PluginXXX                  <<插件主类名字，和下面的class PluginXXX ....名字应该一样\n             apiversion=11                     <<插件兼容API版本，用逗号隔开（以后会讲）\n              */\n紫红：插件的主类。里面塞着插件大部分的内容。\n深蓝：预处理插件时触发的function。这里需要定义api这个变量作为插件与服务器沟通的桥梁。\n绿色：卸载时触发的function。<<Tip：这里的卸载是加载的反义词，不是删除！！\n红色：插件加载时促发的function。\n\n所以，一个空的插件应该是这样的：<?php\n     \n/*\n__PocketMine Plugin__\nname=PluginXXX\ndescription=\nversion=0.0.1\nauthor=XXX\nclass=PluginXXX\napiversion=11\n*/\n   \nclass PluginXXX implements Plugin{\n        private $api;\n        public function __construct(ServerAPI $api, $server = false){\n                 $this->api = $api;\n        }\n         public function __destruct(){}\n        public function init(){}\n}复制代码保存，打开Start.bat，我们会看到：\n\n没错，你的插件被加载了！{:10_509:} 虽然没什么用。{:10_494:}\n赶紧放到SignTp里面，于是我们的代码是这样的：<?php\n     \n/*\n__PocketMine Plugin__\nname=SignTp\ndescription=\nversion=0.0.1\nauthor=DreamWork Studio\nclass=SignTp\napiversion=11\n*/\n   \nclass SignTp implements Plugin{\n        private $api;\n        public function __construct(ServerAPI $api, $server = false){\n                 $this->api = $api;\n        }\n         public function __destruct(){}\n        public function init(){}\n}复制代码第一讲完\n2.给你的插件添加命令\n> 键盘敲一敲，服务器嗨起来\n \n> 命令的用法命令能干啥？很多插件都需要命令。命令允许玩家在游戏中玩转插件，那么该怎么添加命令呢？\n我们先看这里：\n内容引用自kv516 的 PocketEssentials:http://www.mcbbs.net/thread-196684-1-1.html\n\n红色：从api提供的方法注册一个命令\n蓝色：命令的名字\n粉色：命令在 \" /help 名字 \" 里面显示出的帮助文字\n青色：激活命令后触发的function所在的类，一般用$this\n棕色：激活命令后触发的function名字，下面要相同\n那么如果我们需要让命令实现同样的功能，或者能让一般玩家可以用，该怎么办呢？\n我们先看这里：\n内容引用自ljyloo 的 TpMultiWorld:http://www.mcbbs.net/thread-148950-1-2.html\n\n红2：注册一个相同的命令，即/w 和/tpw 有相同的作用，在下面command只需要规定/tpw即可。\n粉2：要注册相同指令的目标指令，即未规定但要与元指令相同指令。\n绿2：要注册相同指令的原指令，即规定要与目标指令相同的指令。\n蓝2：注册一个一般玩家可以能用的指令\n黑2：要注册一般玩家可以能用的指令命令的名字\n于是，我们注册了一个命令，接下来要定义它的作用。我们继续看上面的图：\n红1：要和注册指令右边的红圈相同，是激活命令后触发的function名字。\n黑1：$cmd : 激活的命令名称，比如\"tpw\" \"listw\"等\n蓝1：$params : 激活的子命令的名称\n紫1：$issuer : 该玩家的Player对象\n绿1：$alias : 这个命令的相同的指令，如\"tpw\" 的alias 是\"w\"，多个就是数组\n其实这里$cmd等等名字改掉是可以的，但是$cmd这几个大家都习惯了，所以建议保留，详细看下面。\n请看这里的例子：\n    如果一个玩家输入了/tpw 123 456 789\n    那么返回的$cmd = \"tpw\"\n                    $params[0] = \"123\"\n                    $params[1] = \"456\"\n                    $params[2] = \"789\"\n                    $issuer = 该玩家的Player对象（以后会讲）\n                    $alias = \"w\"\n然后，加上一个switch，就可以让命令有作用喽~\n就像这样：\n内容引用自MinecrafterJPN 的 PocketMoney:http://forums.pocketmine.net/plugins/pocketmoney.63/\n\n就这样搜寻以后/money指令就起作用了，赶紧拿来试试！<?php\n     \n/*\n__PocketMine Plugin__\nname=SignTp\ndescription=\nversion=0.0.1\nauthor=DreamWork Studio\nclass=SignTp\napiversion=11\n*/\n   \nclass SignTp implements Plugin{\n    private $api;\n    public function __construct(ServerAPI $api, $server = false){\n                $this->api = $api;\n    }\n    public function __destruct(){}\n    public function init(){\n                $this->api->console->register(\"st\", \" : SignTp command.\", array($this, \"command\"));\n        }\n    public function command($cmd, $params, $issuer, $alias){\n                 switch($cmd){\n                        case \"st\":\n                                console(\"123\");\n                                break;\n                }\n        }\n}\n复制代码保存，运行  \n在粉色部分，我们看到我们的插件被加载了，输入/st以后，console返回了123；在/? st里面也有了相应的解释。说明我们的命令起作用喽~\n在命令执行的部分，我们可以使用return来返回一个值让使用者知道，所以上面代码可以改为：\n<?php\n     \n/*\n__PocketMine Plugin__\nname=SignTp\ndescription=\nversion=0.0.1\nauthor=DreamWork Studio\nclass=SignTp\napiversion=11\n*/\n   \nclass SignTp implements Plugin{\n    private $api;\n    public function __construct(ServerAPI $api, $server = false){\n                $this->api = $api;\n    }\n    public function __destruct(){}\n    public function init(){\n                $this->api->console->register(\"st\", \" : SignTp command.\", array($this, \"command\"));\n        }\n    public function command($cmd, $params, $issuer, $alias){\n                 switch($cmd){\n                        case \"st\":\n                                return \"123\";\n                                break;\n                }\n        }\n}\n复制代码这样console返回就是 [CMD] 123 了。同样地，玩家也能使用/st来返回123。\n> 添加功能\n我们玩过的插件命令功能绝没有输出123那么简单，这时候我们就需要发挥想象力，参考下面的附录可以看你能干啥，然后搭配好代码，就能让你的命令多姿多彩。\n第二讲完 \n================== 坑 线 =================\n3.为你的插件检测事件\n> 石头：现在你还你敢敲我？\n \n\n第三讲完 \n  \n【附录】\n1.PM常见命令\n> console\nconsole命令用于在控制台输出一条带现在时间的信息。\n用法：console($message, $EOL = true, $log = true, $level = 1)\n$message：信息的文本。\n$EOL：决定是否在信息末尾加上PHP_EOL（换行）。默认true为加上。\n$log：决定是否记录在console.log内。默认true。\n$level：这个我也不知道= =谁来告诉我\n- $message含下面的内容将会设置输出文字的颜色，下面是常用的颜色：\n 内容 颜色  FORMAT_AQUA 浅绿色  FORMAT_RED 红色 FORMAT_GRAY 灰色 FORMAT_YELLOW 黄色 FORMAT_RESET 黑色所有的颜色可以在/src/utils/TextFormat.php里面查看。\n添加颜色的方法：把内容用 . 连接到字符串里，如：console(FORMAT_RED . \"RED\" . FORMAT_RESET . \"BLACK\");复制代码输出：[CMD] REDBLACK\n> API11的常见命令就这么一个= =待添加第一讲完\n2.PM数据类型\n> Vector3\n在PM插件制作时，很多时候会用到三轴坐标，于是Vector3就诞生了。{:10_525:}\n- 定义方法\n$变量名字 = new Vector3(x,y,z);复制代码\n这里new这个单词能告诉PHP要创建一个新Vector3类型的变量；xyz参数告诉PHP这个三轴坐标的位置。\n- Vector3类型的常用方法\n假如$var(1.4, -2, 3.6)是一个vector3对象，你可以......\n使用方法返回作用例子返回值$varstring得到$var的三轴坐标$var\"Vector3(x=1.4,y=2,z=3.6)\"$var->getX()\n$var->getRight()\n$var->getSouth()variant得到$var的x轴坐标$var->getX()1.4$var->getY()\n$var->getUp()variant得到$var的y轴坐标$var->getY()-2$var->getZ()\n$var->getForward()\n$var->getWest()variant得到$var的z轴坐标$var->getZ()3.6$var->getFloorX()integer得到$var的x轴坐标并取整$var->getFloorX()1$var->getFloorY()integer得到$var的y轴坐标并取整 $var->getFloorY()-2$var->getFloorZ()integer得到$var的z轴坐标并取整$var->getFloorZ()3$var->add ($x, $y, $z)Vector3将$var的三轴坐标加上对应值后返回$var->add(1, -2, 3)Vector3(2.4, -4, 6.6)$var->add (Vector3 $x)Vector3将$var的三轴坐标加上$x的对应值后返回$var2 = new Vector3(1, -2, 3);\n$var->add($var2)Vector3(2.4, -4, 6.6)$var->subtract ($x, $y, $z)Vector3将$var的三轴坐标减去对应值后返回$var->subtract(-1, 2,- 3)Vector3(2.4, -4, 6.6)$var->subtract (Vector3 $x)Vector3将$var的三轴坐标减去$x的对应值后返回$var2 = new Vector3(-1, 2, -3); \n$var->add($var2)Vector3(2.4, -4, 6.6)$var->multiply ($number)Vector3将$var的三轴坐标都乘$number并返回$var->multiply(2)Vector3(2.8, -4, 7.2)$var->divide($number)Vector3将$var的三轴坐标都除以$number并返回$var->divide(2)Vector3(0.7, -1, 1.8)$var->celi()Vector3将$var的三轴坐标都+1且取整后返回$var->celi()Vector3(2, -1, 4)$var->floor()Vector3将$var的三轴坐标取整后返回$var->floor()Vector3(1, -2, 3)$var->round()Vector3将$var的三轴坐标四舍五入后返回$var->round()Vector3(1, -2, 4)$var->abs()Vector3将$var的三轴坐标取绝对值后返回$var->abs()Vector3(1.4, 2, 3.6)$var->getSide($side)Vector3得到与$var相邻的一个坐标 *$var->getSide(0)Vector3(1.4, -3, 3.6)$var-> distance ($x=0,$y=0,$z=0)double得到$var与Vector3($x,$y,$z)的距离$var->distance(0, 2, 3)4.2801869118065$var-> distance (Vecrot3 $x)double得到$var与$x的距离$var2 = new Vector3(0, 2, 3);\n$var->distance($var2)4.2801869118065$var-> distanceSquared ($x=0,$y=0,$z=0)double得到$var与Vector3($x,$y,$z)\n的距离的平方$var->distanceSquared\n(0, 2, 3)18.32$var-> distanceSquared (Vecrot3 $x)double得到$var与$x的距离的平方$var2 = new Vector3(0, 2, 3);\n$var->distanceSquared($var2)18.32$var->dot (Vecrot3 $x)double得到$var与$x点乘的结果\n点乘是什么？【左转这里】$var2 = new Vector3(0, 2, 3);\n$var->dot($var2)6.8$var->cross (Vecrot3 $x)Vector3得到$var与$x叉乘的结果\n叉乘又是啥？【右转这里】$var2 = new Vector3(0, 2, 3);\n$var->cross($var2)Vector3(-13.2, -4.2, 2.8)* 相邻坐标的定义见下：如果坐标方向按MC的定义且x轴向右z轴向前，即\n\n\n\n\nxyz.jpg (2.82 KB, 下载次数: 188)\n\n下载附件\n\n2014-1-31 13:34 上传\n\n\n\n\n\n那么：\n $side值表示XYZ坐标变化 相当于 0x不变，y减一，z不变 下面 1x不变，y加一，z不变  上面 2x不变，y不变，z减一 后面 3x不变，y不变，z加一 前面 4x减一，y不变，z不变 左面 5x加一，y不变，z不变 右面有点乱是吗？（众：{:10_499:}）其实Vector3还有很多方法，可以看/src/math/Vector3.php，这里只列出常用的一部分。有了Vector3，就可以方便地表示坐标了{:10_525:}> PM API11常用的数据类型貌似就这一个了= =\n第二讲完\n3.PM对象\n> 对象是什么\n对象(object)是一种变量类型，允许你调用程序内部特定的内容。比如，一个世界就是一个level对象，你的插件可以通过更改level对象来改变世界的信息。\n> Position对象\n- 源文件位置（忘记指令之类的可以去翻源文件，接下来不再提示）：/src/world/Position.php\n- 特性\nPosition对象用于表达一个事物的坐标，包括xyz坐标和世界。\nPosition对象源文件的开头有这样一句话：\nclass Position extends Vector3{复制代码也就是说：Position其实就是一个Vector3对象，接口了Vector3{:10_496:}，于是Vector3的方法和Position的方法是相似滴~ \n- 方法\n如果$pos是一个Position对象，那么你除了可以用Vector3的方法，还可以——\n方法类型作用$posstring返回这个点的三轴坐标\n\"Position(level=xxx,x=x,y=y,z=z)\"$pos->x\n$pos->y\n$pos->zvariant返回这个点某个轴的坐标$pos->levelLevel返回Position所在的世界$pos->getSide($side)Position同Vector3的getSide$pos->distance(同Vector3)double同Vector3的distance这样子表示位置是不是方便多了呢~\n\n> Level对象\n- 源文件位置：/src/world/Level.php\n- 方法\n如果$lev是一个level对象，那么你可以——\n======================== 坑  线 ==========================  \n第三讲完\n======================== 坑  线 ========================== \n4.PM API解析【已更API11】\n\n\n\n第四讲完\n[groupid=422]PocketMine开发&讨论[/groupid]",
    "replies": [
        {
            "author": "Snake1999",
            "timestamp": 1391049060,
            "txt_content": " 本帖最后由 Snake1999 于 2014-1-30 10:38 编辑 \n\n本楼备用！！"
        },
        {
            "author": "我勒个去234567",
            "timestamp": 1391049300,
            "txt_content": "不是金锭我不收"
        },
        {
            "author": "hsk001ufo",
            "timestamp": 1391049300,
            "txt_content": "大哥说了多少遍了=。=能都发一楼么"
        },
        {
            "author": "hsk001ufo",
            "timestamp": 1391049420,
            "txt_content": "话说我怎么感觉发错地方了=。="
        },
        {
            "author": "592764254",
            "timestamp": 1391097360,
            "txt_content": ".           "
        },
        {
            "author": "hsk001ufo",
            "timestamp": 1391151960,
            "txt_content": "有更新了啊=。="
        },
        {
            "author": "hsk001ufo",
            "timestamp": 1391670480,
            "txt_content": "在【其次，你得会玩PHP】里面有及部分引用PM内部代码的部分路径不对，如PocketMine-MP/src/ConsoleAPI这个应该是PocketMine-MP/src/API/ConsoleAPI.php，希望能改正一下"
        },
        {
            "author": "ljyloo",
            "timestamp": 1391701320,
            "txt_content": "好，涨姿势了{:10_505:}"
        },
        {
            "author": "uuuu1",
            "timestamp": 1391754660,
            "txt_content": "怎么监视文件...\n还有，php怎么读取txt内容。。"
        },
        {
            "author": "Snake1999",
            "timestamp": 1392271860,
            "txt_content": "uuuu1 发表于 2014-2-7 14:31\n怎么监视文件...\n还有，php怎么读取txt内容。。\n这个你去看W3SCHOOL的教程，我这里限于篇幅不多讲"
        },
        {
            "author": "西瓜太郎",
            "timestamp": 1392722700,
            "txt_content": "赞               "
        },
        {
            "author": "zmdd",
            "timestamp": 1395395400,
            "txt_content": "那啥。。为什么我在上面写了中文回复是乱码？"
        },
        {
            "author": "梦の小黑",
            "timestamp": 1396875780,
            "txt_content": "lz你好牛！智商好高！赞一个！然后·······我的脑子炸了（我一小学生懂个毛函数啊啊······）"
        },
        {
            "author": "XM君君",
            "timestamp": 1396960320,
            "txt_content": "二菌快更啊= =还有我编写了一端插件，档读取木牌文本的时候pm的使用内存暴增，然后崩溃了。。。肿么破"
        },
        {
            "author": "asdfff啊",
            "timestamp": 1409146320,
            "txt_content": "楼主好人 我要开始学习了"
        },
        {
            "author": "q1272686154",
            "timestamp": 1411637280,
            "txt_content": "哎呀受教了，嘿嘿，顶起→_→"
        },
        {
            "author": "850639946",
            "timestamp": 1414422180,
            "txt_content": "太吊了，我还以为和PC的bukkit插件差不多，看了别人的源码-_-||"
        },
        {
            "author": "martinsmith",
            "timestamp": 1414675260,
            "txt_content": "PHP有点像C语言和Java。。。"
        },
        {
            "author": "圣_痕",
            "timestamp": 1423495440,
            "txt_content": "话说，我怎么越到后面越听不懂"
        },
        {
            "author": "nmh1234",
            "timestamp": 1424888520,
            "txt_content": "楼主加qq1766355378 我需要您的帮助 多少钱都可以接受的， 我最近开服"
        },
        {
            "author": "nmh1234",
            "timestamp": 1424891820,
            "txt_content": "楼主在？ 给你钱来我的服务器定制插件吧。都是同类人 我只不过是pc的1.7.9API弄罢了被pm限制了 求楼主加qq1766355378"
        },
        {
            "author": "CLOST",
            "timestamp": 1442758500,
            "txt_content": "毛线，e才简单QwQ"
        },
        {
            "author": "DHRSW",
            "timestamp": 1445043900,
            "txt_content": "这。。。。。。看完我还是不会啊"
        },
        {
            "author": "y4399荣耀君",
            "timestamp": 1449368700,
            "txt_content": "路过帮顶"
        },
        {
            "author": "孤独秋叶",
            "timestamp": 1451022360,
            "txt_content": "教程完全比java还难"
        },
        {
            "author": "2503180246",
            "timestamp": 1471439040,
            "txt_content": "提示: 作者被禁止或删除 内容自动屏蔽"
        },
        {
            "author": "究竟2000",
            "timestamp": 1501489320,
            "txt_content": "顶顶顶顶顶顶顶顶顶顶顶顶顶顶"
        },
        {
            "author": "wyywang",
            "timestamp": 1565615820,
            "txt_content": "蟹蟹楼主！！"
        },
        {
            "author": "mohist",
            "timestamp": 1570266840,
            "txt_content": "谢谢楼主分享，教程很棒很有用"
        }
    ]
}