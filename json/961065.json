{
    "title": "1.15.2区块问题",
    "author": "书与笔",
    "replyCount": 14,
    "timestamp": 1581783300,
    "txt_content": "尝试过NoSpawnChunks和LaggRemover卸载区块，但没任何效果\n服务器无论有没有人，全部世界都会占用至少361区块\n\n\n\n\n\nQQ图片20200215235030.png\n(27.66 KB, 下载次数: 0)\n\n\n\n\n下载附件\n\n\n2020-2-16 00:11 上传\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "极光creeper",
            "timestamp": 1581783300,
            "txt_content": " 本帖最后由 极光creeper 于 2020-2-16 14:09 编辑 \n\n//停 楼上的，不要在这个回复下面拿我帖子当答案啊\n//这也太不负责了，对着我帖子优化，也不见得能好成什么样\n//再说问题完全不在这里\n\n//我当然欢迎别人发我帖子的链接，我想，我写出来就是给大家看的\n//但是如果可以的话，还是需要仔细的说明一下会比较好\n\n删除多世界，就可以让你的resource下两个世界在没有玩家进入过的时候，全都是0区块0Entity 0Tile Entity\n还是进得去，放心\n\n但是我要和楼主讲的不是上面这个\n分析下数据，你tps虽然没怎么掉，但是吃了更多的内存(400MB)\n单从你给出的数据来看，我可以确认的是，你jvm参数(GC)和其他优化插件肯定是没到位\n当然我也不排除entity的ai自己在那边狂吃资源\n\n但是我要和楼主讲的还不是上面这个\n玩家进入某个世界，假设服务端需要封装128个区块的数据包发给玩家\n如果它已经在缓存里了，那么我直接封包，然后发给玩家就好了\n但是如果它不在呢？我需要花一点时间把它找出来(我认为，这至少会有100msのlag)，并且丢到缓存里\n然后再发给玩家\n\n但是请注意，服务端和客户端不会让玩家在没有收到世界文件的时候让玩家加入世界\n这样的\"不同步\"，是不安全的\n你玩家会卡在世界加载的那个界面，在那里卡一会儿\n如果在这个时候遇上lag pikes( 即延迟峰值 )，我认为会出更大的问题，客户端可能会未响应一段时间\n\n但是我要和楼主讲的 重点 不在上面\n我们上面说了这么多，得出的结论是，这个常驻区块，其实是一种优化\n开发者万万没想到会有人误以为这会拖垮服务器，所以连关闭的选项都没有\n\n如果你认为老娘说的还算清楚的话，可以考虑给个最佳吗！！！\n不清楚的话 可以 继续问(笑\n\n\n"
        },
        {
            "author": "_CrazyNut_",
            "timestamp": 1581784020,
            "txt_content": "感觉正常把- - 这问题不大啊  消耗不了多少性能"
        },
        {
            "author": "卑微小吴",
            "timestamp": 1581794580,
            "txt_content": "这些是常驻区块,常驻区块可以减少CPU占用,但是会增加内存占用.\n因为这些可能是出生地的区块,让他一直加载他是占用非常非常少的内存,这样可以减少玩家每次传送到这里的时候都需要重新加载.\n减少了CPU占用\n开着占用非常少的内存\n关掉常驻区块会增加CPU的负担\n多世界配置文件内可以修改是否让出生地区块常驻\n\n其实你可以看你服务器自己调整\n内存多的你可以开启加载\n内存少CPU性能好可以关掉减少内存占用"
        },
        {
            "author": "书与笔",
            "timestamp": 1581794940,
            "txt_content": "卑微小吴 发表于 2020-2-16 03:23\n这些是常驻区块,常驻区块可以减少CPU占用,但是会增加内存占用.\n因为这些可能是出生地的区块,让他一直加载他 ...\n哪一个设置选项中能关闭常驻区块?"
        },
        {
            "author": "卑微小吴",
            "timestamp": 1581799620,
            "txt_content": "emmmm~\n好像1.15这插件还没支持\n\n其实这些区块不会占用多少内存只要你不进去就不占用内存"
        },
        {
            "author": "1213866518",
            "timestamp": 1581817380,
            "txt_content": "有一些区块例如出生点附近的区块为常驻区块，他们是保证游戏正常运行的根本"
        },
        {
            "author": "零落Y_",
            "timestamp": 1581818220,
            "txt_content": "参考https://www.mcbbs.net/thread-916822-1-1.html优化章节中paper.yml的第14"
        },
        {
            "author": "EmptyLava",
            "timestamp": 1581821940,
            "txt_content": "361区块是出生点周围的,必须加载,无法卸载区块\n此外laggremover对1.14以上的优化效果极差"
        },
        {
            "author": "安不生",
            "timestamp": 1581831060,
            "txt_content": " 本帖最后由 安不生 于 2020-2-16 13:42 编辑 \n\nMultiverse-Core里的keepSpawnInMemory: 'true'改为'false' (提示: 在world.yml文件内，每个世界的配置里都有这个选项)\n 但是我并不推荐关闭这个选项，保持出生点区块常驻可以让你的玩家进入世界时更加流畅而不至于每次进入都要重新加载一遍区块\n另外区块卸载也没必要用NoSpawnChunk LaggRemover等插件\n我认为核心自带的chunk-gc也是非常好用的(提示,在bukkit.yml内可以调节)\n"
        },
        {
            "author": "安不生",
            "timestamp": 1581831480,
            "txt_content": "极光creeper 发表于 2020-2-16 10:02\n停 楼上的，不要在这个回复下面拿我帖子当答案啊\n这也太不负责了，对着我帖子优化，也不见得能好成什么样\n ...\n我已经见过很多拿你的帖子去当万能答案的人了,说实话，这种人真的让人非常反感"
        },
        {
            "author": "yangxianchisolm",
            "timestamp": 1581834300,
            "txt_content": "......................"
        },
        {
            "author": "yangxianchisolm",
            "timestamp": 1581834300,
            "txt_content": "................................"
        },
        {
            "author": "书与笔",
            "timestamp": 1581863400,
            "txt_content": "极光creeper 发表于 2020-2-16 10:02\n//停 楼上的，不要在这个回复下面拿我帖子当答案啊\n//这也太不负责了，对着我帖子优化，也不见得能好成什么 ...\n1.\n如果在这个时候遇上lag pikes( 即延迟峰值 )，我认为会出更大的问题\n我想知道如果遇上延迟峰值，一般或最严重的问题是什么\n\n2.\n楼下有说\n361区块是出生点周围的\n这出生点周围的361区块是如何判定的，玩家可视距离？\n\n3.\n地狱世界不是玩家常去世界，我能不能关掉这个世界的常驻区块来留出一点内存"
        },
        {
            "author": "极光creeper",
            "timestamp": 1581865380,
            "txt_content": " 本帖最后由 极光creeper 于 2020-2-16 23:11 编辑 \n书与笔 发表于 2020-2-16 22:30\n1.\n\n我想知道如果遇上延迟峰值，一般或最严重的问题是什么\n1 崩客户端，没了，spigot写的很安全，虽然有些地方写的非常不安全，但是这里很安全\n   但我不保证你的其他插件不会在这过程中报错\n2 目测不只可视距离，会稍微大一点\n3 可以 完全可以 但是你的内存很充足，至少目前是的\n   这点常驻区块什么都不影响，如果你真的觉得有必要，那么可以\n"
        }
    ]
}