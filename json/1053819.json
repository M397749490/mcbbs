{
    "title": "PVPIN教程RL--试着做一个插件版的拔刀剑",
    "author": "yhzyhz",
    "replyCount": 2,
    "timestamp": 1590832020,
    "txt_content": " 本帖最后由 yhzyhz 于 2020-7-30 18:53 编辑 \n\n\nRT，这是一个用PVPINDemoRL做拔刀剑插件的教程缓慢更新中源码Github\n7/30更新 使用耀魂修理拔刀剑(上)\n\n\n这个教程在我的另一个帖子\nPVPIN教程RL--使用nms，给物品增加杀敌计数\n\n\n\n\n本教程系PVPIN教程复刻系列\n索引见https://www.mcbbs.net/thread-1034477-1-1.html\n本教程不做排版，如果你觉得不舒服，可以选择退出本页面\n本教程所有代码全部在coding开源，详见索引本教程可能存在一定吞代码问题，总体上以开源地址的代码为准\n\n本教程涵盖内容：\n使用NMS操作NBT\n玩家获取经验事件\n玩家物品损坏事件\nItemStack的小程度使用\n\n介绍本节实例：\n我们要让任意有耀魂的剑在损坏时掉落不定量的刀之耀魂\n\n那么首先，我们要给我们的刀加上耀魂计数\n注：下面两张图代码缩进位置以Github源码为准，实际上，图1的最后一行和图2的第一行是同级的\n\n\n\n\n\nTIM截图20200530173457.png (105.88 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-30 17:35 上传\n\n\n\n\n\n\n\n\n\n\nTIM截图20200530173510.png (84.48 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-30 17:35 上传\n\n\n\n\n\n\n在这里我们使用了PlayerExpChangeEvent，这个事件会监听玩家的经验自然变化\n\n设置完耀魂，我们需要先制作出 刀之耀魂 这个物品\n因为目前只有在掉落的代码里用到刀之耀魂，所以我们新建PSDropLis(Proud Soul Drop Listener)类，并创建如下代码\n\n\n\n\nTIM截图20200530173842.png (60.08 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-30 17:38 上传\n\n\n\n\n\n\n物品准备好了，我们要开始让他掉落了\n\n\n\n\n\nTIM截图20200530174126.png (131.77 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-30 17:41 上传\n\n\n\n\n\n\n在这里我们使用了PlayerItemBreakEvent，这个事件会监听玩家的物品损坏。\n\n写好后，我们进入服务器看一看\n\n\n\n\n\nTIM截图20200530174459.png (7.69 KB, 下载次数: 0)\n\n下载附件\n\n2020-5-30 17:45 上传\n\n\n\n\n\n\n\n\n\n\n终于考完了，漫长的考试周从七月初持续到月末\n\n\n\n本教程系PVPIN教程复刻系列\n索引见https://www.mcbbs.net/thread-1034477-1-1.html\n本教程不做排版，如果你觉得不舒服，可以选择退出本页面\n本教程所有代码全部在coding开源，详见索引本教程可能存在一定吞代码问题，总体上以开源地址的代码为准\n\n本教程涵盖内容：\nPrepareAnvilEvent\n\n\n在上一页我们做出了耀魂并让它在刀断掉的时候随机掉落，那么接下来我们要做的就是让刀可以用耀魂修复\n\n\n具体用到的就是PrepareAnvilEvent(因为没有找到铁砧修复配方，所以用这个做替代)\n这个Event触发的时间是你在铁砧里放入物品之后，显示结果之前\n我们可以通过这个event操作结果，然后在下节让它取出刀\n\n简单来讲，就是通过检测铁砧物品栏的内容后，在结果处输出想要的结果\n\n\n\n\n\nTIM截图20200730182908.png (39.31 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-30 18:31 上传\n\n\n\n\n\n\n在这里，我新建了RepairLis类，负责监听铁砧修复拔刀剑事件\n接着，通过PrepareAnvilEvent监听事件，并获取目标铁砧物品栏\n然后检测物品槽。按照标准，铁砧有三个物品槽，从左到右的id分别是0,1,2\n\n\n\n\n\n\nTIM截图20200730182944.png (71.51 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-30 18:31 上传\n\n\n\n\n\n\n接着，检测待修复物品，即0号物品槽中的物品有没有ProudSoul耀魂nbt，没有的话理论上要么不是拔刀剑要么不需要修\n\n然后获取并保存耀魂数，为后续做准备\n接着，使用Damageable获取物品的伤害值。因为目标是武器，所以伤害值即为消耗的耐久。\n因为我们想要复刻敲五次即可修复，所以将最大耐久整除5，再减去消耗的耐久，就是一次修复的结果\n特别的，因为上一步我们用的是整除，所以修复五次后可能会存在0-4点耐久消耗，所以我们吧所有小于5的伤害值归零，包括修复过量的值(负数\n然后把耐久设置回meta，待用\n\n\n\n\n\nTIM截图20200730182953.png (76.19 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-30 18:31 上传\n\n\n\n\n\n\n下面开始修改结果物品的属性。先获取一份原有物品，并把meta设置进去。\n然后获取nbt，修改耀魂数nbt，更新lore，在设置进result里，得到的result就是修复好的拔刀剑\n\n\n\n\n\nTIM截图20200730183003.png (13.34 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-30 18:31 上传\n\n\n\n\n\n\n最后，设置经验消耗，设置结果，得到如下效果\n\n\n\n\n\nTIM截图20200604092633.png (18.6 KB, 下载次数: 0)\n\n下载附件\n\n2020-7-30 18:41 上传\n\n\n\n\n\n\n已经达到我们想要的预期了。但是我们并不能拿出来\n我们将在下节中使用InventoryClickEvent将修好的拔刀剑拿出来\n\n\n\n\n\n\n\n\n\n",
    "replies": [
        {
            "author": "William_Shi",
            "timestamp": 1590832620,
            "txt_content": " 本帖最后由 William_Shi 于 2020-5-30 17:58 编辑 \n\n请修改您的代码\n根据google java 开发规范\nhttps://google.github.io/styleguide/javaguide.html#s4.1-braces\n\n4.1.1 Braces are used where optional\n\nBraces are used with if, else, for, do and while statements, even when the body is empty or contains only a single statement.\n\n同样的意思在阿里巴巴Java开发规范也有提及\n\n请不要使用\n\n else if (xxx) do sth\n\n使用\n\n else if (xxx){\ndo sth\n}\n尤其是你二者混用就更不合适了\n教程类代码需要更高标准\n\n——PVPIN教程复刻计划发起人"
        },
        {
            "author": "yhzyhz",
            "timestamp": 1590832800,
            "txt_content": "William_Shi 发表于 2020-5-30 17:57\n请修改您的代码\n根据google java 开发规范\nhttps://google.github.io/styleguide/javaguide.html#s4.1-brac ...\n刚刚做作业来着，写顺手了"
        }
    ]
}